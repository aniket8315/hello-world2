!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(w,e){"use strict";if(!w.fn.dotdotdot){w.fn.dotdotdot=function(t){if(0===this.length)return w.fn.dotdotdot.debug('No element found for "'+this.selector+'".'),this;if(1<this.length)return this.each(function(){w(this).dotdotdot(t)});var i=this,a=i.contents();i.data("dotdotdot")&&i.trigger("destroy.dot"),i.data("dotdotdot-style",i.attr("style")||""),i.css("word-wrap","break-word"),"nowrap"===i.css("white-space")&&i.css("white-space","normal"),i.bind_events=function(){return i.bind("update.dot",function(t,e){switch(i.removeClass("is-truncated"),t.preventDefault(),t.stopPropagation(),typeof o.height){case"number":o.maxHeight=o.height;break;case"function":o.maxHeight=o.height.call(i[0]);break;default:o.maxHeight=function(t){for(var e=t.innerHeight(),n=["paddingTop","paddingBottom"],r=0,i=n.length;r<i;r++){var a=parseInt(t.css(n[r]),10);isNaN(a)&&(a=0),e-=a}return e}(i)}o.maxHeight+=o.tolerance,void 0!==e&&(("string"==typeof e||"nodeType"in e&&1===e.nodeType)&&(e=w("<div />").append(e).contents()),e instanceof w&&(a=e)),(s=i.wrapInner('<div class="dotdotdot" />').children()).contents().detach().end().append(a.clone(!0)).find("br").replaceWith("  <br />  ").end().css({height:"auto",width:"auto",border:"none",padding:0,margin:0});var n=!1,r=!1;return d.afterElement&&((n=d.afterElement.clone(!0)).show(),d.afterElement.detach()),b(s,o)&&(r="children"==o.wrap?function(t,e,n){var r=t.children(),i=!1;t.empty();for(var a=0,o=r.length;a<o;a++){var d=r.eq(a);if(t.append(d),n&&t.append(n),b(t,e)){d.remove(),i=!0;break}n&&n.detach()}return i}(s,o,n):function e(n,r,i,a,o){var d=!1;n.contents().detach().each(function(){var t=w(this);if(void 0===this)return!0;if(t.is("script, .dotdotdot-keep"))n.append(t);else{if(d)return!0;n.append(t),!o||t.is(a.after)||t.find(a.after).length||n[n.is("a, table, thead, tbody, tfoot, tr, col, colgroup, object, embed, param, ol, ul, dl, blockquote, select, optgroup, option, textarea, script, style")?"after":"append"](o),b(i,a)&&(d=3==this.nodeType?function(t,e,n,r,i){var a=t[0];if(!a)return!1;var o=T(a),d=-1!==o.indexOf(" ")?" ":"　",l="letter"==r.wrap?"":d,s=o.split(l),c=-1,u=-1,h=0,f=s.length-1;r.fallbackToLetter&&0===h&&0===f&&(l="",s=o.split(l),f=s.length-1);if(r.maxLength)o=y(o.trim().substr(0,r.maxLength),r),x(a,o);else{for(;h<=f&&(0!==h||0!==f);){var p=Math.floor((h+f)/2);if(p==u)break;u=p,x(a,s.slice(0,u+1).join(l)+r.ellipsis),n.children().each(function(){w(this).toggle().toggle()}),b(n,r)?(f=u,r.fallbackToLetter&&0===h&&0===f&&(l="",s=s[0].split(l),u=c=-1,h=0,f=s.length-1)):h=c=u}if(-1==c||1===s.length&&0===s[0].length){var g=t.parent();t.detach();var v=i&&i.closest(g).length?i.length:0;if(g.contents().length>v?a=C(g.contents().eq(-1-v),e):(a=C(g,e,!0),v||g.detach()),a&&(o=y(T(a),r),x(a,o),v&&i)){var m=i.parent();w(a).parent().append(i),w.trim(m.html())||m.remove()}}else o=y(s.slice(0,c+1).join(l),r),x(a,o)}return!0}(t,r,i,a,o):e(t,r,i,a,o)),d||o&&o.detach()}});r.addClass("is-truncated");return d}(s,i,s,o,n)),s.replaceWith(s.contents()),s=null,w.isFunction(o.callback)&&o.callback.call(i[0],r,a),d.isTruncated=r}).bind("isTruncated.dot",function(t,e){return t.preventDefault(),t.stopPropagation(),"function"==typeof e&&e.call(i[0],d.isTruncated),d.isTruncated}).bind("originalContent.dot",function(t,e){return t.preventDefault(),t.stopPropagation(),"function"==typeof e&&e.call(i[0],a),a}).bind("destroy.dot",function(t){t.preventDefault(),t.stopPropagation(),i.unwatch().unbind_events().contents().detach().end().append(a).attr("style",i.data("dotdotdot-style")||"").removeClass("is-truncated").data("dotdotdot",!1)}),i},i.unbind_events=function(){return i.unbind(".dot"),i},i.watch=function(){if(i.unwatch(),"window"==o.watch){var t=w(window),e=t.width(),n=t.height();t.bind("resize.dot"+d.dotId,function(){e==t.width()&&n==t.height()&&o.windowResizeFix||(e=t.width(),n=t.height(),l&&clearInterval(l),l=setTimeout(function(){i.trigger("update.dot")},100))})}else r=u(i),l=setInterval(function(){if(i.is(":visible")){var t=u(i);r.width==t.width&&r.height==t.height||(i.trigger("update.dot"),r=t)}},500);return i},i.unwatch=function(){return w(window).unbind("resize.dot"+d.dotId),l&&clearInterval(l),i};var e,n,o=w.extend(!0,{},w.fn.dotdotdot.defaults,t),d={},r={},l=null,s=null;return o.lastCharacter.remove instanceof Array||(o.lastCharacter.remove=w.fn.dotdotdot.defaultArrays.lastCharacter.remove),o.lastCharacter.noEllipsis instanceof Array||(o.lastCharacter.noEllipsis=w.fn.dotdotdot.defaultArrays.lastCharacter.noEllipsis),d.afterElement=(e=o.after,n=i,!!e&&("string"!=typeof e?!!e.jquery&&e:!!(e=w(e,n)).length&&e)),d.isTruncated=!1,d.dotId=c++,i.data("dotdotdot",!0).bind_events().trigger("update.dot"),o.watch&&i.watch(),i},w.fn.dotdotdot.defaults={ellipsis:"... ",wrap:"word",fallbackToLetter:!0,lastCharacter:{},tolerance:0,callback:null,after:null,height:null,watch:!1,windowResizeFix:!0,maxLength:null},w.fn.dotdotdot.defaultArrays={lastCharacter:{remove:[" ","　",",",";",".","!","?"],noEllipsis:[]}},w.fn.dotdotdot.debug=function(t){};var c=1,n=w.fn.html;w.fn.html=function(t){return t!=e&&!w.isFunction(t)&&this.data("dotdotdot")?this.trigger("update",[t]):n.apply(this,arguments)};var r=w.fn.text;w.fn.text=function(t){return t!=e&&!w.isFunction(t)&&this.data("dotdotdot")?(t=w("<div />").text(t).html(),this.trigger("update",[t])):r.apply(this,arguments)}}function b(t,e){return t.innerHeight()>e.maxHeight||e.maxLength&&t.text().trim().length>e.maxLength}function y(t,e){for(;-1<w.inArray(t.slice(-1),e.lastCharacter.remove);)t=t.slice(0,-1);return w.inArray(t.slice(-1),e.lastCharacter.noEllipsis)<0&&(t+=e.ellipsis),t}function u(t){return{width:t.innerWidth(),height:t.innerHeight()}}function x(t,e){t.innerText?t.innerText=e:t.nodeValue?t.nodeValue=e:t.textContent&&(t.textContent=e)}function T(t){return t.innerText?t.innerText:t.nodeValue?t.nodeValue:t.textContent?t.textContent:""}function a(t){for(;(t=t.previousSibling)&&1!==t.nodeType&&3!==t.nodeType;);return t}function C(t,e,n){var r,i=t&&t[0];if(i){if(!n){if(3===i.nodeType)return i;if(w.trim(t.text()))return C(t.contents().last(),e)}for(r=a(i);!r;){if((t=t.parent()).is(e)||!t.length)return!1;r=a(t[0])}if(r)return C(w(r),e)}return!1}});