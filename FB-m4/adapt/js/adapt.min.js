define("core/js/models/lockingModel",[],function(){var e=Backbone.Model.prototype.set;_.extend(Backbone.Model.prototype,{set:function(t,i,s){var n=!this.lockedAttributes||typeof t==="object"||typeof i!=="boolean"||!this.isLocking(t);if(n)return e.apply(this,arguments);s=s||{};var r=s&&s.pluginName;if(!r){console.error("Must supply a pluginName to change a locked attribute");s.pluginName="compatibility"}var o=s.pluginName;if(this.defaults[t]!==undefined){this.lockedAttributes[t]=!this.defaults[t]}var a=this.lockedAttributes[t];var l=a===i;if(l){this.setLockState(t,true,{pluginName:o,skipcheck:true});return e.call(this,t,a)}this.setLockState(t,false,{pluginName:o,skipcheck:true});var c=this.getLockCount(t,{skipcheck:true});if(c===0){return e.call(this,t,!a)}return this},setLocking:function(e,t){if(this.isLocking(e))return;if(!this.lockedAttributes)this.lockedAttributes={};this.lockedAttributes[e]=t},unsetLocking:function(e){if(!this.isLocking(e))return;if(!this.lockedAttributes)return;delete this.lockedAttributes[e];delete this._lockedAttributesValues[e];if(_.keys(this.lockedAttributes).length===0){delete this.lockedAttributes;delete this._lockedAttributesValues}},isLocking:function(e){var t=e===undefined;var i=this.lockedAttributes!==undefined;if(t){return i}if(!i)return false;var s=this.lockedAttributes[e]!==undefined;if(!s)return false;if(this._lockedAttributesValues===undefined){this._lockedAttributesValues={}}if(this._lockedAttributesValues[e]===undefined){this._lockedAttributesValues[e]={}}return true},isLocked:function(e,t){var i=t&&t.skipcheck;if(!i){var s=!this.isLocking(e);if(s)return}return this.getLockCount(e)>0},getLockCount:function(e,t){var i=t&&t.skipcheck;if(!i){var s=!this.isLocking(e);if(s)return}var n=t&&t.pluginName;if(n){return this._lockedAttributesValues[e][t.pluginName]?1:0}var r=_.values(this._lockedAttributesValues[e]);var o=_.reduce(r,function(e,t){return e+(t?1:0)},0);return o},setLockState:function(e,t,i){var s=i&&i.skipcheck;if(!s){var n=!this.isLocking(e);if(n)return this}var r=i&&i.pluginName;if(!r){console.error("Must supply a pluginName to set a locked attribute lock value");i.pluginName="compatibility"}if(t){this._lockedAttributesValues[e][i.pluginName]=t}else{delete this._lockedAttributesValues[e][i.pluginName]}return this}})});define("core/js/wait",[],function(){var e=Backbone.Controller.extend({initialize:function(){_.bindAll(this,"begin","end")},_waitCount:0,_callbackHandle:null,isWaiting:function(){return this._waitCount!==0},begin:function(){if(!this.isWaiting()){this.trigger("wait")}this._waitCount++;if(this._callbackHandle){clearTimeout(this._callbackHandle);this._callbackHandle=null}return this},end:function(){if(!this.isWaiting()){return this}this._waitCount--;if(this.isWaiting()){return this}if(this._callbackHandle){return this}this._callbackHandle=setTimeout(function(){this._callbackHandle=null;this.trigger("ready")}.bind(this),0);return this},queue:function(e){this.begin();this.once("ready",e);this.end();return this},"for":function(e){this.begin();_.defer(function(){e(this.end)}.bind(this));return this}});return e});define("core/js/adapt",["core/js/models/lockingModel","core/js/wait"],function(e,t){var i=Backbone.Model.extend({defaults:{_canScroll:true,_outstandingCompletionChecks:0,_pluginWaitCount:0,_isStarted:false},lockedAttributes:{_canScroll:false},initialize:function(){this.setupWait()},checkingCompletion:function(){var e=this.get("_outstandingCompletionChecks");this.set("_outstandingCompletionChecks",++e)},checkedCompletion:function(){var e=this.get("_outstandingCompletionChecks");this.set("_outstandingCompletionChecks",--e)},deferUntilCompletionChecked:function(e){if(this.get("_outstandingCompletionChecks")===0)return e();var t=function(i,n){if(n!==0)return;s.off("change:_outstandingCompletionChecks",t);e()};s.on("change:_outstandingCompletionChecks",t)},setupWait:function(){this.wait=new t;var e=function(){s.log.warn("DEPRECATED - Use Adapt.wait.begin() as Adapt.trigger('plugin:beginWait') may be removed in the future");this.wait.begin()}.bind(this);var i=function(){s.log.warn("DEPRECATED - Use Adapt.wait.end() as Adapt.trigger('plugin:endWait') may be removed in the future");this.wait.end()}.bind(this);var n=function(){if(this.wait.isWaiting()){return}var e=this._events["plugins:ready"];if(!e){return}s.log.warn("DEPRECATED - Use Adapt.wait.queue(callback) as Adapt.on('plugins:ready', callback) may be removed in the future");this.trigger("plugins:ready")}.bind(this);this.listenTo(this.wait,"ready",n);this.listenTo(this,{"plugin:beginWait":e,"plugin:endWait":i})},isWaitingForPlugins:function(){s.log.warn("DEPRECATED - Use Adapt.wait.isWaiting() as Adapt.isWaitingForPlugins() may be removed in the future");return this.wait.isWaiting()},checkPluginsReady:function(){s.log.warn("DEPRECATED - Use Adapt.wait.isWaiting() as Adapt.checkPluginsReady() may be removed in the future");if(this.isWaitingForPlugins()){return}this.trigger("plugins:ready")}});var s=new i;s.location={};s.componentStore={};s.mappedIds={};s.loadScript=window.__loadScript;s.initialize=function(){s.deferUntilCompletionChecked(function(){s.trigger("adapt:start");if(!Backbone.History.started){Backbone.history.start()}s.set("_isStarted",true);s.trigger("adapt:initialize")})};s.scrollTo=function(e,t){var i=s.location._contentType?s.location._contentType:s.location._currentLocation;s.trigger(i+":scrollTo",e);var t=t||{};var n=s.config.has("_disableAnimation")?s.config.get("_disableAnimation"):false;if(n){t.duration=0}else if(!t.duration){t.duration=$.scrollTo.defaults.duration}var r=-$(".navigation").outerHeight();if(s.config.get("_accessibility")._isActive&&$(e).hasClass("component")){r-=$(e).find(".aria-label").height()||0}if(!t.offset)t.offset={top:r,left:0};if(t.offset.top===undefined)t.offset.top=r;if(t.offset.left===undefined)t.offset.left=0;if(t.offset.left===0)t.axis="y";if(s.get("_canScroll")!==false){$.scrollTo(e,t)}_.delay(function(){$(e).a11y_focus();s.trigger(i+":scrolledTo",e)},t.duration+300)};s.navigateToElement=function(e,t){var t=t||{};var i=e.replace(/\./g,"");var n=s.findById(i);var r=n._siblings==="contentObjects"?n:n.findAncestor("contentObjects");if(r.get("_id")===s.location._currentId){return s.scrollTo(e,t)}s.once("pageView:ready",function(){_.defer(function(){s.scrollTo(e,t)})});var o=t.replace||false;Backbone.history.navigate("#/id/"+r.get("_id"),{trigger:true,replace:o})};s.register=function(e,t){if(s.componentStore[e])throw Error("This component already exists in your project");if(t.view){if(!t.view.template)t.view.template=e}else{if(!t.template)t.template=e}s.componentStore[e]=t;return t};s.setupMapping=function(){s.mappedIds={};s.mappedIds[s.course.get("_id")]="course";var e=["contentObjects","articles","blocks","components"];for(var t=0,i=e.length;t<i;t++){var n=e[t];var r=s[n].models;for(var o=0,a=r.length;o<a;o++){var l=r[o];s.mappedIds[l.get("_id")]=n}}};s.mapById=function(e){return s.mappedIds[e]};s.findById=function(e){if(e===s.course.get("_id")){return s.course}var t=s.mapById(e);if(!t){console.warn("Adapt.findById() unable to find collection type for id: "+e);return}return s[t]._byAdaptID[e][0]};s.parseRelativeString=function(e){if(e[0]==="@"){e=e.substr(1)}var t=e.match(/(component|block|article|page|menu)/);if(!t){s.log.error("Adapt.parseRelativeString() could not match relative type",e);return}t=t[0];var i=parseInt(e.substr(t.length).trim()||0);if(isNaN(i)){s.log.error("Adapt.parseRelativeString() could not parse relative offset",e);return}return{type:t,offset:i}};s.remove=function(){s.trigger("preRemove");s.trigger("remove");_.defer(function(){s.trigger("postRemove")})};return s});define("core/js/adaptCollection",["core/js/adapt"],function(e){var t=Backbone.Collection.extend({initialize:function(e,t){this.url=t.url;this.once("reset",this.loadedData,this);if(this.url){this.fetch({reset:true,error:_.bind(function(e,t,i){console.error("ERROR: unable to load file "+this.url)},this)})}},loadedData:function(){e.trigger("adaptCollection:dataLoaded")}});return t});define("core/js/startController",["core/js/adapt"],function(e){var t=Backbone.Controller.extend({model:null,initialize:function(){this.model=new Backbone.Model(e.course.get("_start"))},setStartLocation:function(){if(!this.isEnabled())return;window.history.replaceState("","",this.getStartHash())},getStartHash:function(t){var i=this.getStartId();var s=i?true:false;var n=_.indexOf(window.location.href,"#")>-1;var r=t||this.model.get("_force");var o=s&&(!n||r);var a="#/";if(o){if(i!==e.course.get("_id")){a="#/id/"+i}}else{var l=window.location.hash?true:false;a=l?window.location.hash:a}return a},isEnabled:function(){if(!this.model||!this.model.get("_isEnabled"))return false;return true},getStartId:function(){var t=this.model.get("_id");var i=this.model.get("_startIds");var s=$("html");var n=i&&i.length>0;if(n){for(var r=0,o=i.length;r<o;r++){var a=i[r];var l=a._className;var c=a._skipIfComplete;var d=e.findById(a._id);if(!d){console.log("startController: cannot find id",a._id);continue}if(c){if(d.get("_isComplete"))continue}if(!l||s.is(l)||s.hasClass(l)){t=a._id;break}}}return t}});e.once("adapt:start",function(){var e=new t;e.setStartLocation()});return t});define("core/js/enums/logLevelEnum",[],function(){var e=ENUM(["DEBUG","INFO","WARN","ERROR","FATAL"]);return e});define("core/js/logging",["core/js/adapt","core/js/enums/logLevelEnum"],function(e,t){var i=Backbone.Controller.extend({_config:{_isEnabled:true,_level:t.INFO.asLowerCase,_console:true},initialize:function(){e.once("configModel:loadCourseData",this.onLoadCourseData.bind(this))},onLoadCourseData:function(){this.loadConfig();this.debug("Logging config loaded");this.trigger("log:ready")},loadConfig:function(){if(e.config.has("_logging")){this._config=e.config.get("_logging")}this.checkQueryStringOverride()},checkQueryStringOverride:function(){var e=window.location.search.match(/[?&]loglevel=([a-z]*)/i);if(!e||e.length<2)return;var i=t(e[1].toUpperCase());if(!i)return;this._config._level=i.asLowerCase;this.debug("Loglevel override in query string:",this._config._level)},debug:function(){this._log(t.DEBUG,Array.prototype.slice.call(arguments))},info:function(){this._log(t.INFO,Array.prototype.slice.call(arguments))},warn:function(){this._log(t.WARN,Array.prototype.slice.call(arguments))},error:function(){this._log(t.ERROR,Array.prototype.slice.call(arguments))},fatal:function(){this._log(t.FATAL,Array.prototype.slice.call(arguments))},_log:function(e,i){var s=this._config._isEnabled;if(!s)return;var n=t(this._config._level.toUpperCase());var r=e>=n;if(!r)return;this._logToConsole(e,i);this.trigger("log",e,i);this.trigger("log:"+e.asLowerCase,e,i)},_logToConsole:function(e,t){var i=this._config._console;if(!i)return;var s=[e.asUpperCase+":"];t&&s.push.apply(s,t);if(console[e.asLowerCase]){console[e.asLowerCase].apply(console,s)}else{console.log.apply(console,s)}}});e.log=new i});define("core/js/models/buildModel",["core/js/adapt","core/js/logging"],function(e){var t=Backbone.Model.extend({defaults:{jsonext:"json"},initialize:function(t,i){this.url=i.url;this.fetch({success:_.bind(function(){this.isLoaded=true;e.trigger("buildModel:dataLoaded")},this),error:function(){console.log("Unable to load adapt/js/build.js");e.trigger("buildModel:dataLoaded")}})}});return t});define("core/js/models/adaptModel",["core/js/adapt","core/js/logging"],function(e){var t=Backbone.Model.extend({defaults:{_canShowFeedback:true,_classes:"",_canReset:false,_isComplete:false,_isInteractionComplete:false,_requireCompletionOf:-1,_isEnabled:true,_isResetOnRevisit:false,_isAvailable:true,_isOptional:false,_isReady:false,_isVisible:true,_isLocked:false,_isHidden:false},trackable:["_id","_isComplete","_isInteractionComplete"],initialize:function(){this.listenToOnce(e,"app:dataLoaded",this.setupModel)},setupModel:function(){if(this.get("_type")==="page"){this._children="articles"}if(this._siblings==="contentObjects"&&this.get("_parentId")!==e.course.get("_id")){this._parent="contentObjects"}if(this._children){if(this.get("_isOptional"))this.setOptional(true);this.setupChildListeners()}this.init();_.defer(_.bind(function(){if(this._children){this.checkCompletionStatus();this.checkInteractionCompletionStatus();this.checkLocking()}this.setupTrackables()},this))},setupTrackables:function(){var t=this.triggerTrackableState;this.triggerTrackableState=_.compose(_.bind(function(){this.triggerTrackableState.isQueued=true},this),_.debounce(_.bind(function(){t.apply(this);this.triggerTrackableState.isQueued=false},this),17));this.listenTo(this,"change",function(t,i){if(this.triggerTrackableState.isQueued||!e.attributes._isStarted){return}var s=_.result(this,"trackable",[]);var n=_.keys(t.changed);var r=_.find(n,function(e,t){return _.contains(s,e)}.bind(this));if(r){this.triggerTrackableState()}})},setupChildListeners:function(){var e=this.getChildren();if(!e.length){return}this.listenTo(e,{"change:_isReady":this.checkReadyStatus,"change:_isComplete":this.onIsComplete,"change:_isInteractionComplete":this.checkInteractionCompletionStatus})},init:function(){},getTrackableState:function(){var e=this.resultExtend("trackable",[]);var t=this.toJSON();var i=e;i.unshift(t);return _.pick.apply(_,i)},setTrackableState:function(e){var t=this.resultExtend("trackable",[]);var i=t;i.unshift(e);e=_.pick.apply(_,i);this.set(e);return this},triggerTrackableState:function(){e.trigger("state:change",this,this.getTrackableState())},reset:function(e,t){if(!this.get("_canReset")&&!t)return;e=e||true;switch(e){case"hard":case true:this.set({_isEnabled:true,_isComplete:false,_isInteractionComplete:false});break;case"soft":this.set({_isEnabled:true,_isInteractionComplete:false});break}},checkReadyStatus:function(){var e=this.getAvailableChildModels();if(_.find(e,function(e){return e.get("_isReady")===false})){return}this.set({_isReady:true})},setCompletionStatus:function(){if(this.get("_isVisible")){this.set("_isComplete",true);this.set("_isInteractionComplete",true)}},checkCompletionStatus:function(){e.checkingCompletion();_.defer(_.bind(this.checkCompletionStatusFor,this,"_isComplete"))},checkInteractionCompletionStatus:function(){e.checkingCompletion();_.defer(_.bind(this.checkCompletionStatusFor,this,"_isInteractionComplete"))},checkCompletionStatusFor:function(t){if(!t)t="_isComplete";var i=false;var s=this.getAvailableChildModels();var n=this.get("_requireCompletionOf");if(n===-1){i=_.find(s,function(e){return!e.get(t)&&!e.get("_isOptional")})===undefined}else{i=_.filter(s,function(e){return e.get(t)&&!e.get("_isOptional")}).length>=n}this.set(t,i);e.checkedCompletion()},findAncestor:function(e){var t=this.getParent();if(this._parent===e){return t}var i=t.getParent();if(t._parent!==e){i=i.getParent()}return i},findDescendantModels:function(e){var t=this.getChildren().models;if(this._children===e){return t}var i=[];var s;var n;function r(t){for(var o=0,a=t.length;o<a;o++){var l=t[o];i.push(l.getChildren().models);s=_.flatten(i)}n=s;if(t.length===0||t[0]._children===e){return}else{i=[];r(n)}}r(t);return n},getAllDescendantModels:function(e){var t=[];if(this.get("_type")==="component"){t.push(this);return t}var i=this.getChildren();for(var s=0,n=i.models.length;s<n;s++){var r=i.models[s];if(r.get("_type")==="component"){t.push(r);continue}var o=r.getAllDescendantModels(e);if(e===true){t.push(r)}t=t.concat(o);if(e!==true){t.push(r)}}return t},findDescendants:function(t){e.log.warn("DEPRECATED - Use findDescendantModels() as findDescendants() may be removed in the future");if(this._children===t){return this.getChildren()}var i=[];var s;var n=this.getChildren();var r;function o(e){var n=e.models;for(var a=0,l=n.length;a<l;a++){var c=n[a];var d=c.getChildren().models;i.push(d);s=_.flatten(i)}r=new Backbone.Collection(s);if(e.models.length===0||e.models[0]._children===t){return}else{i=[];o(r)}}o(n);return r},findRelativeModel:function(t,i){var s=["menu","page","article","block","component"];i=i||{};var n=this.get("_id");var r=this.get("_type");var o=e.course;if(i.limitParentId){o=e.findById(i.limitParentId)}var a=e.parseRelativeString(t);var l=_.indexOf(s,r)>_.indexOf(s,a.type);var c=r===a.type;var d=a.offset<0;var u=Math.abs(a.offset);var h=0;var f=!c&&!l;var p;if(d){p=o.getAllDescendantModels(true);p.reverse();if(f){u-=1}}else if(f){p=o.getAllDescendantModels(true)}else if(c||l){p=o.getAllDescendantModels(false)}if(typeof i.filter==="function"){p=_.filter(p,i.filter)}var m=_.findIndex(p,function(e){if(e.get("_id")===n){return true}return false});if(i.loop){var g={};p.forEach(function(e){var t=e.get("_type");g[t]=g[t]||0;g[t]++});u=u%g[a.type];p=p.concat(p.slice(0))}for(var v=m,b=p.length;v<b;v++){var w=p[v];if(w.get("_type")===a.type){if(h===u){return e.findById(w.get("_id"))}h++}}return undefined},getChildren:function(){if(this.get("_children"))return this.get("_children");var t;if(!this._children){t=new Backbone.Collection}else{var i=e[this._children].where({_parentId:this.get("_id")});t=new Backbone.Collection(i)}if(this.get("_type")=="block"&&t.length==2&&t.models[0].get("_layout")!=="left"&&this.get("_sortComponents")!==false){t.comparator="_layout";t.sort()}this.set("_children",t);return t},getAvailableChildModels:function(){return this.getChildren().where({_isAvailable:true})},getAvailableChildren:function(){e.log.warn("DEPRECATED - Use getAvailableChildModels() as getAvailableChildren() may be removed in the future");return new Backbone.Collection(this.getChildren().where({_isAvailable:true}))},getParent:function(){if(this.get("_parent"))return this.get("_parent");if(this._parent==="course"){return e.course}var t=e.findById(this.get("_parentId"));this.set("_parent",t);return t},getAncestorModels:function(e){var t=[];var i=this;if(e)t.push(i);while(i.has("_parentId")){i=i.getParent();t.push(i)}return t.length?t:null},getParents:function(t){e.log.warn("DEPRECATED - Use getAncestorModels() as getParents() may be removed in the future");var i=[];var s=this;if(t)i.push(s);while(s.has("_parentId")){s=s.getParent();i.push(s)}return i.length?new Backbone.Collection(i):null},getSiblings:function(t){var i;if(!t){if(this._hasSiblingsAndSelf===false){return this.get("_siblings")}i=_.reject(e[this._siblings].where({_parentId:this.get("_parentId")}),_.bind(function(e){return e.get("_id")==this.get("_id")},this));this._hasSiblingsAndSelf=false}else{if(this._hasSiblingsAndSelf){return this.get("_siblings")}i=e[this._siblings].where({_parentId:this.get("_parentId")});this._hasSiblingsAndSelf=true}var s=new Backbone.Collection(i);this.set("_siblings",s);return s},setOnChildren:function(e,t,i){var s=arguments;this.set.apply(this,s);if(!this._children)return;var n=this.getChildren();var r=n.models;for(var o=0,a=r.length;o<a;o++){var l=r[o];l.setOnChildren.apply(l,s)}},setOptional:function(e){this.set({_isOptional:e})},checkLocking:function(){var e=this.get("_lockType");if(!e)return;switch(e){case"sequential":this.setSequentialLocking();break;case"unlockFirst":this.setUnlockFirstLocking();break;case"lockLast":this.setLockLastLocking();break;case"custom":this.setCustomLocking();break;default:console.warn('AdaptModel.checkLocking: unknown _lockType "'+e+'" found on '+this.get("_id"))}},setSequentialLocking:function(){var e=this.getAvailableChildModels();for(var t=1,i=e.length;t<i;t++){e[t].set("_isLocked",!e[t-1].get("_isComplete"))}},setUnlockFirstLocking:function(){var e=this.getAvailableChildModels();var t=e[0].get("_isComplete");for(var i=1,s=e.length;i<s;i++){e[i].set("_isLocked",!t)}},setLockLastLocking:function(){var e=this.getAvailableChildModels();var t=e.length-1;for(var i=t-1;i>=0;i--){if(!e[i].get("_isComplete")){return e[t].set("_isLocked",true)}}e[t].set("_isLocked",false)},setCustomLocking:function(){var e=this.getAvailableChildModels();for(var t=0,i=e.length;t<i;t++){var s=e[t];s.set("_isLocked",this.shouldLock(s))}},shouldLock:function(t){var i=t.get("_lockedBy");if(!i)return false;for(var s=i.length-1;s>=0;s--){var n=i[s];try{var r=e.findById(n);if(!r.get("_isAvailable"))continue;if(!r.get("_isComplete"))return true}catch(o){console.warn('AdaptModel.shouldLock: unknown _lockedBy ID "'+n+'" found on '+t.get("_id"))}}return false},onIsComplete:function(){this.checkCompletionStatus();this.checkLocking()}});return t});define("core/js/models/articleModel",["core/js/adapt","core/js/models/adaptModel"],function(e,t){var i=t.extend({_parent:"contentObjects",_siblings:"articles",_children:"blocks"});return i});define("core/js/models/blockModel",["core/js/adapt","core/js/models/adaptModel"],function(e,t){var i=t.extend({_parent:"articles",_siblings:"blocks",_children:"components",defaults:function(){return _.extend({_sortComponents:true},t.prototype.defaults)}});return i});define("core/js/models/configModel",["core/js/adapt"],function(e){var t=Backbone.Model.extend({defaults:{screenSize:{small:520,medium:760,large:1024},_forceRouteLocking:false,_canLoadData:true,_disableAnimation:false},initialize:function(t,i){this.url=i.url;this.fetch({success:function(){e.trigger("offlineStorage:prepare");e.wait.queue(function(){e.trigger("configModel:dataLoaded");if(this.get("_canLoadData")){e.trigger("configModel:loadCourseData")}if(this.get("_defaultDirection")==="rtl"){$("html").addClass("dir-rtl")}var t=this.get("_disableAnimationFor");if(t&&t.length>0){for(var i=0;i<t.length;i++){if($("html").is(t[i])){this.set("_disableAnimation",true);console.log("Animation disabled.")}}}}.bind(this))}.bind(this),error:function(){console.log("Unable to load course/config.json")}})},loadData:function(){}});return t});define("core/js/models/contentObjectModel",["core/js/adapt","core/js/models/adaptModel"],function(e,t){var i=t.extend({_parent:"course",_siblings:"contentObjects",_children:"contentObjects"});return i});define("core/js/models/componentModel",["core/js/adapt","core/js/models/adaptModel"],function(e,t){var i=t.extend({_parent:"blocks",_siblings:"components",trackable:t.resultExtend("trackable",["_userAnswer"])});return i});define("core/js/models/courseModel",["core/js/adapt","core/js/models/adaptModel"],function(e,t){var i=t.extend({initialize:function(i,s){t.prototype.initialize.apply(this,arguments);e.trigger("courseModel:dataLoading");this.url=s.url;this.on("sync",this.loadedData,this);if(this.url){this.fetch({error:_.bind(function(e,t,i){console.error("ERROR: unable to load file "+this.url)},this)})}},loadedData:function(){e.trigger("courseModel:dataLoaded")},_children:"contentObjects"});return i});define("core/js/enums/buttonStateEnum",[],function(){var e=ENUM(["SUBMIT","CORRECT","INCORRECT","SHOW_CORRECT_ANSWER","HIDE_CORRECT_ANSWER","SHOW_FEEDBACK","RESET"]);return e});define("core/js/models/questionModel",["core/js/adapt","core/js/models/componentModel","core/js/enums/buttonStateEnum"],function(e,t,i){var s=t.extend({defaults:function(){return t.resultExtend("defaults",{_isQuestionType:true,_shouldDisplayAttempts:false,_canShowModelAnswer:true,_canShowFeedback:true,_canShowMarking:true,_isSubmitted:false,_questionWeight:e.config.get("_questionWeight")})},trackable:t.resultExtend("trackable",["_isSubmitted","_score","_isCorrect","_attemptsLeft"]),init:function(){this.setupDefaultSettings();this.listenToOnce(e,"adapt:initialize",this.onAdaptInitialize)},setupDefaultSettings:function(){this.setupWeightSettings();this.setupButtonSettings()},setupButtonSettings:function(){var t=e.course.get("_buttons");if(!this.has("_buttons")){this.set("_buttons",t)}else{var i=this.get("_buttons");for(var s in i){if(typeof i[s]==="object"){if(!i[s].buttonText&&t[s].buttonText){i[s].buttonText=t[s].buttonText}if(!i[s].ariaLabel&&t[s].ariaLabel){i[s].ariaLabel=t[s].ariaLabel}}if(!i[s]&&t[s]){i[s]=t[s]}}}},setupWeightSettings:function(){},onAdaptInitialize:function(){this.restoreUserAnswers()},restoreUserAnswers:function(){},canSubmit:function(){},updateAttempts:function(){if(!this.get("_attemptsLeft")){this.set("_attemptsLeft",this.get("_attempts"))}this.set("_attemptsLeft",this.get("_attemptsLeft")-1)},setQuestionAsSubmitted:function(){this.set({_isEnabled:false,_isSubmitted:true})},storeUserAnswer:function(){},markQuestion:function(){if(this.isCorrect()){this.set("_isCorrect",true)}else{this.set("_isCorrect",false)}},isCorrect:function(){},setScore:function(){},checkQuestionCompletion:function(){var e=this.get("_isCorrect")||this.get("_attemptsLeft")===0;if(e){this.setCompletionStatus()}return e},updateButtons:function(){var e=this.get("_isInteractionComplete");var t=this.get("_isCorrect");var s=this.get("_isEnabled");var n=this.get("_buttonState");var r=this.get("_canShowModelAnswer");if(e){if(t||!r){this.set("_buttonState",i.CORRECT)}else{switch(n){case i.SUBMIT:case i.HIDE_CORRECT_ANSWER:this.set("_buttonState",i.SHOW_CORRECT_ANSWER);break;default:this.set("_buttonState",i.HIDE_CORRECT_ANSWER)}}}else{if(s){this.set("_buttonState",i.SUBMIT)}else{this.set("_buttonState",i.RESET)}}},setupFeedback:function(){if(this.get("_isCorrect")){this.setupCorrectFeedback()}else if(this.isPartlyCorrect()){this.setupPartlyCorrectFeedback()}else{this.setupIncorrectFeedback()}},isPartlyCorrect:function(){},setupCorrectFeedback:function(){var e=this.get("_feedback");this.set({feedbackTitle:this.getFeedbackTitle(e),feedbackMessage:e.correct||""})},setupPartlyCorrectFeedback:function(){var e=this.get("_feedback");if(!e)return;if(e._partlyCorrect){if(this.get("_attemptsLeft")===0||!e._partlyCorrect.notFinal){if(e._partlyCorrect.final){this.set({feedbackTitle:this.getFeedbackTitle(e),feedbackMessage:e._partlyCorrect.final})}else{this.setupIncorrectFeedback()}}else{this.set({feedbackTitle:this.getFeedbackTitle(e),feedbackMessage:e._partlyCorrect.notFinal?e._partlyCorrect.notFinal:""})}}else{this.setupIncorrectFeedback()}},setupIncorrectFeedback:function(){var e=this.get("_feedback");if(this.get("_attemptsLeft")===0||e&&!e._incorrect.notFinal){this.set({feedbackTitle:this.getFeedbackTitle(e),feedbackMessage:e?e._incorrect.final:""})}else{this.set({feedbackTitle:this.getFeedbackTitle(e),feedbackMessage:e?e._incorrect.notFinal:""})}},getFeedbackTitle:function(e){return e.title||this.get("displayTitle")||this.get("title")||""},reset:function(e,s){if(!this.get("_canReset")&&!s)return;e=e||true;t.prototype.reset.call(this,e,s);var n=this.get("_attempts");this.set({_attemptsLeft:n,_isCorrect:undefined,_isSubmitted:false,_buttonState:i.SUBMIT})},setQuestionAsReset:function(){this.set({_isEnabled:true,_isSubmitted:false})},resetUserAnswer:function(){},refresh:function(){this.trigger("question:refresh")},getButtonState:function(){if(this.get("_isCorrect")){return i.CORRECT}if(this.get("_attemptsLeft")===0){return this.get("_canShowModelAnswer")?i.SHOW_CORRECT_ANSWER:i.INCORRECT}return this.get("_isSubmitted")?i.RESET:i.SUBMIT},getInteractionObject:function(){return{}},getResponse:function(){},getResponseType:function(){}});return s});define("core/js/views/accessibilityView",["core/js/adapt"],function(e){var t=Backbone.View.extend({el:"#accessibility-toggle",initialize:function(){this.render()},events:{click:"toggleAccessibility"},render:function(){var t=e.config.has("_accessibility")&&e.config.get("_accessibility")._isEnabled;if(!t){return}else{var i=e.config.get("_accessibility")._isActive;var s=e.course.get("_globals")&&(e.course.get("_globals")._accessibility.accessibilityToggleTextOff||e.course.get("_globals")._accessibility._accessibilityToggleTextOff);var n=e.course.get("_globals")&&(e.course.get("_globals")._accessibility.accessibilityToggleTextOn||e.course.get("_globals")._accessibility._accessibilityToggleTextOn);var r=i?s:n;this.$el.attr("aria-label",e.course.get("title")+". "+e.course.get("_globals")._accessibility._ariaLabels.accessibilityToggleButton+". "+$.a11y_normalize(r))}},toggleAccessibility:function(t){t.preventDefault();var i=e.config.get("_accessibility")._isActive;var s=i?false:true;e.config.get("_accessibility")._isActive=s;e.trigger("accessibility:toggle");this.render();Backbone.history.navigate(window.location.hash||"#/",{trigger:true})}});return t});define("core/js/views/navigationView",["core/js/adapt","core/js/views/accessibilityView"],function(e,t){var i=Backbone.View.extend({className:"navigation",initialize:function(){this.listenToOnce(e,{"courseModel:dataLoading":this.remove,"accessibility:toggle":this.onA11yToggle});this.listenTo(e,"router:menu router:page",this.hideNavigationButton);this.template="navigation";this.preRender()},events:{"click [data-event]":"triggerEvent"},preRender:function(){e.trigger("navigationView:preRender",this);this.render()},render:function(){var t=Handlebars.templates[this.template];this.$el.html(t({_globals:e.course.get("_globals"),_accessibility:e.config.get("_accessibility")})).insertBefore("#wrapper");_.defer(_.bind(function(){e.trigger("navigationView:postRender",this)},this));this.setupA11yButton();if(e.accessibility.isActive()){this.setupUsageInstructions()}return this},triggerEvent:function(t){t.preventDefault();var i=$(t.currentTarget).attr("data-event");e.trigger("navigation:"+i)},hideNavigationButton:function(e){if(e.get("_type")==="course"){$(".navigation").addClass("display-none");$("#wrapper").addClass("removePadding");$(".navigation-back-button, .navigation-home-button").addClass("display-none");this.$(".navigation-label").html("")}else{this.$(".navigation-label").html(e.get("title"));$(".navigation").removeClass("display-none");$("#wrapper").removeClass("removePadding");this.showNavigationButton()}},showNavigationButton:function(){$(".navigation-back-button, .navigation-home-button").removeClass("display-none")},setupA11yButton:function(){new t},setupUsageInstructions:function(){var t=e.course.get("_globals")._accessibility;if(!t||!t._accessibilityInstructions){this.$("#accessibility-instructions").remove();return}var i=t._accessibilityInstructions;var s;if(i[e.device.browser]){s=i[e.device.browser]}else if(Modernizr.touch){s=i.touch||""}else{s=i.notouch||""}this.$("#accessibility-instructions").html(s)},onA11yToggle:function(){if(e.accessibility.isActive()){this.setupUsageInstructions()}}});return i});define("core/js/accessibility",["core/js/adapt","a11y"],function(e){var t={_menu:1,_menuItem:2,_page:1,_article:2,_block:3,_component:4,_componentItem:5};var i=Backbone.Controller.extend({$html:$("html"),_hasUsageInstructionRead:false,_isLoaded:false,_hasCourseLoaded:false,reset:function(){_.extend(this,{_hasUsageInstructionRead:false})},initialize:function(){if(this._isLoaded)return;this.removeLegacyElements();e.once("app:dataLoaded",function(){this._hasCourseLoaded=true;e.config.get("_accessibility")._isActive=e.offlineStorage.get("a11y")||false;this.setupAccessibility()},this);e.on("accessibility:toggle",this.setupAccessibility,this);e.once("app:dataLoaded",this.setupHelpers,this);e.on("device:changed",this.setupNoSelect);this.listenToOnce(e,"app:dataReady",this.configureA11yLibrary);this.listenTo(e,{"router:location":this.onNavigationStart,"pageView:ready menuView:ready router:plugin":this.onNavigationEnd})},removeLegacyElements:function(){var t=$("body").children("#accessibility-toggle, #accessibility-instructions");if(!t.length)return;e.log.warn("DEPRECATED - #accessibility-toggle and #accessibility-instructions have been moved to the navigation bar. Please remove them from all of your .html files.");t.remove()},setupAccessibility:function(){if(!this.isEnabled())return;e.offlineStorage.set("a11y",e.config.get("_accessibility")._isActive);this.reset();this.configureA11yLibrary();if(this.isActive()){this.setupDocument();this.setupPopupListeners();this.setupLogging()}else{this.revertDocument();this.revertPopupListeners();this.removeUsageInstructionListener();this.revertLogging()}},setupHelpers:function(){var i=e.config.has("_accessibility")?e.config.get("_accessibility"):false;var s={a11y_text:function(e){if(i&&i._isTextProcessorEnabled===false){return e}else{return $.a11y_text(e)}},a11y_normalize:function(e){return $.a11y_normalize(e)},a11y_remove_breaks:function(e){return $.a11y_remove_breaks(e);
},a11y_aria_label:function(e){return new Handlebars.SafeString('<div class="aria-label prevent-default'+o()+'" '+r()+' role="region">'+e+"</div>")},a11y_aria_label_relative:function(e){return new Handlebars.SafeString('<div class="aria-label relative prevent-default'+o()+'" '+r()+' role="region">'+e+"</div>")},a11y_wrap_focus:function(e){return new Handlebars.SafeString('<a class="a11y-focusguard a11y-ignore a11y-ignore-focus" '+r()+' role="button">&nbsp;</a>')},a11y_attrs_heading:function(i){var s=e.config.get("_accessibility");var n=1;if(this._ariaLevel){i=this._ariaLevel}if(isNaN(i)===false){n=i}else if(_.isString(i)){s._ariaLevels=s._ariaLevels||t;if(s._ariaLevels&&s._ariaLevels["_"+i]!==undefined){n=s._ariaLevels["_"+i]}}return new Handlebars.SafeString(' role="heading" aria-level="'+n+'" '+r()+" ")},a11y_attrs_tabbable:function(){return new Handlebars.SafeString(' role="region" '+r()+" ")}};for(var n in s){if(s.hasOwnProperty(n)){Handlebars.registerHelper(n,s[n])}}var r=function(){return this.isActive()?'tabindex="0"':'tabindex="-1"'}.bind(this);var o=function(){return $.a11y.options.isTabbableTextEnabled?"":" a11y-ignore"}.bind(this)},setupNoSelect:function(){if(!e.config.get("_accessibility")||!e.config.get("_accessibility")._disableTextSelectOnClasses)return;var t=e.config.get("_accessibility")._disableTextSelectOnClasses.split(" ");var i=false;for(var s=0,n;n=t[s++];){if($("html").is(n)){i=true;break}}if(i){$("html").addClass("no-select")}else{$("html").removeClass("no-select")}},configureA11yLibrary:function(){var t=$(".navigation").height();var i=0;$.a11y.options.focusOffsetTop=t;$.a11y.options.focusOffsetBottom=i;$.a11y.options.OS=e.device.OS.toLowerCase();$.a11y.options.isTouchDevice=e.device.touch;if(this.isActive()){_.extend($.a11y.options,{isTabbableTextEnabled:true,isUserInputControlEnabled:true,isFocusControlEnabled:true,isFocusLimited:true,isRemoveNotAccessiblesEnabled:true,isAriaLabelFixEnabled:true,isFocusWrapEnabled:true,isScrollDisableEnabled:true,isScrollDisabledOnPopupEnabled:false,isSelectedAlertsEnabled:true,isAlertsEnabled:true})}else{_.extend($.a11y.options,{isTabbableTextEnabled:false,isUserInputControlEnabled:true,isFocusControlEnabled:true,isFocusLimited:false,isRemoveNotAccessiblesEnabled:true,isAriaLabelFixEnabled:true,isFocusWrapEnabled:true,isScrollDisableEnabled:true,isScrollDisabledOnPopupEnabled:false,isSelectedAlertsEnabled:false,isAlertsEnabled:false})}this.setupNoSelect();$.a11y.ready()},onNavigationStart:function(){this._isLoaded=false;$("#a11y-focuser").a11y_focus(true);_.defer(function(){$.a11y_on(false,".page");$.a11y_on(false,".menu")})},onNavigationEnd:function(t){if(t&&t.model){if(t.model.get("_id")!=e.location._currentId)return}_.defer(function(){$("body").a11y_aria_label(true)});this._isLoaded=true;$.a11y_on(false,".page");$.a11y_on(false,".menu");this.configureA11yLibrary();$.a11y_update();this.setNavigationBar();$("#accessibility-toggle").focus();_.delay(_.bind(function(){this.focusInitial()},this),500)},setNavigationBar:function(){var e=$(".navigation").find(".aria-label").not("#accessibility-instructions");if(this.isActive()){e.attr("tabindex",0).removeAttr("aria-hidden").removeClass("a11y-ignore")}else{e.attr("tabindex",-1).attr("aria-hidden","true")}},isActive:function(){return e.config.has("_accessibility")&&e.config.get("_accessibility")._isEnabled&&e.config.get("_accessibility")._isActive},isEnabled:function(){return e.config.has("_accessibility")&&e.config.get("_accessibility")._isEnabled},setupDocument:function(){this.$html.addClass("accessibility");if(e.config.get("_accessibility")._isTextProcessorEnabled){this.$html.addClass("text-to-speech")}$(".skip-nav-link").removeClass("a11y-ignore a11y-ignore-focus");$.a11y(true);$.a11y_on(true,"#accessibility-instructions")},setupPopupListeners:function(){this.listenTo(e,"popup:opened popup:closed",this.onPop)},setupLogging:function(){if(!e.config.get("_accessibility")||!e.config.get("_accessibility")._logReading)return;$(document).on("reading",this.onRead)},revertDocument:function(){this.$html.removeClass("accessibility text-to-speech");$(".skip-nav-link").addClass("a11y-ignore a11y-ignore-focus");$.a11y(false);$.a11y_on(false,"#accessibility-instructions");$.a11y_on(true,"#accessibility-toggle")},revertPopupListeners:function(){this.stopListening(e,"popup:opened popup:closed",this.onPop)},removeUsageInstructionListener:function(){$("#accessibility-instructions").off("blur",this.onFocusInstructions)},revertLogging:function(){if(e.course.has("_globals")&&(!e.course.get("_globals")._accessibility||!e.course.get("_globals")._accessibility._logReading))return;$($.a11y).off("reading",this.onRead)},focusInitial:function(){if(!this.isActive())return;var t=_.debounce(_.bind(function(){if(!this._hasUsageInstructionRead){this._hasUsageInstructionRead=true;$.a11y_on(true,".page");$.a11y_on(true,".menu");$("#accessibility-instructions").one("blur",this.onFocusInstructions);_.delay(function(){$("#accessibility-instructions").focusNoScroll()},250)}else{if(e.location._currentId&&$.a11y.options.OS!="mac"){var t=e.findById(e.location._currentId);var i=" ";switch(t.get("_type")){case"page":if(e.course.get("_globals")&&e.course.get("_globals")._accessibility&&e.course.get("_globals")._accessibility._ariaLabels&&e.course.get("_globals")._accessibility._ariaLabels.pageLoaded){i=e.course.get("_globals")._accessibility._ariaLabels.pageLoaded}break;case"menu":default:if(e.course.get("_globals")&&e.course.get("_globals")._accessibility&&e.course.get("_globals")._accessibility._ariaLabels&&e.course.get("_globals")._accessibility._ariaLabels.menuLoaded){i=e.course.get("_globals")._accessibility._ariaLabels.menuLoaded}break}$.a11y_alert(i)}_.delay(_.bind(function(){var e=$(window).scrollTop();var t=$(document).scrollTop();$.a11y_on(true,".page");$.a11y_on(true,".menu");if(e>0||t>0)return;_.delay(function(){$.a11y_focus()},500)},this),500)}},this),100);t()},onRead:function(e,t){console.log("READING: "+t)},onPop:function(){if(this.isActive()){$.a11y_update()}},onFocusInstructions:function(t){if(!e.accessibility._isLoaded)return;$("#accessibility-instructions").addClass("a11y-ignore-focus").off("blur",e.accessibility.onFocusInstructions)}});e.accessibility=new i;return e.accessibility});define("core/js/offlineStorage",["core/js/adapt"],function(e){var t=Backbone.Controller.extend({ready:true,_handler:undefined,initialize:function(e){if(!e){return}this.ready=false;this._handler=e},hasHandler:function(){return this._handler!==undefined},set:function(e,t){if(this._handler&&this._handler.set){return this._handler.set.apply(this._handler,arguments)}this[e]=t},get:function(e){if(this._handler&&this._handler.get){return this._handler.get.apply(this._handler,arguments)}return this[e]},setReadyStatus:function(){this.ready=true;e.trigger("offlineStorage:ready")}});e.offlineStorage=new t;return e.offlineStorage});define("core/js/enums/completionStateEnum",[],function(){var e=ENUM(["INCOMPLETE","COMPLETED","PASSED","FAILED"]);return e});define("core/js/tracking",["core/js/adapt","core/js/enums/completionStateEnum"],function(e,t){var i=Backbone.Controller.extend({_config:{_requireContentCompleted:true,_requireAssessmentCompleted:false},_assessmentState:null,initialize:function(){e.once("configModel:loadCourseData",this.loadConfig.bind(this));e.on("app:dataReady",this.setupEventListeners.bind(this))},setupEventListeners:function(){if(this._config._requireAssessmentCompleted){this.listenTo(e,"assessment:complete",this.onAssessmentComplete)}if(this._config._requireContentCompleted){this.listenTo(e.course,"change:_isComplete",this.checkCompletion)}},onAssessmentComplete:function(e){this._assessmentState=e;this.checkCompletion()},checkCompletion:function(){var i=this.getCompletionData();if(i.status===t.INCOMPLETE){return}e.trigger("tracking:complete",i);e.log.debug("tracking:complete",i)},getCompletionData:function(){var i={status:t.INCOMPLETE,assessment:null};if(this._config._requireContentCompleted&&!e.course.get("_isComplete")){return i}if(this._config._requireAssessmentCompleted){if(!this._assessmentState){return i}i.status=this._assessmentState.isPass?t.PASSED:t.FAILED;i.assessment=this._assessmentState;return i}i.status=t.COMPLETED;return i},loadConfig:function(){if(e.config.has("_completionCriteria")){this._config=e.config.get("_completionCriteria")}}});e.tracking=new i;return e.tracking});define("core/js/device",["core/js/adapt","bowser"],function(e,t){var i=$("html");var s=$(window);e.device={touch:Modernizr.touchevents,screenWidth:r(),screenHeight:o(),browser:(t.name||"").toLowerCase(),version:(t.version||"").toLowerCase(),OS:a().toLowerCase(),osVersion:t.osversion||"",renderingEngine:l()};Object.defineProperties(e.device,{orientation:{get:function(){return this.screenWidth>=this.screenHeight?"landscape":"portrait"}},aspectRatio:{get:function(){return this.screenWidth/this.screenHeight}}});e.once("app:dataReady",function(){e.device.screenSize=n();i.addClass("size-"+e.device.screenSize);if(e.device.orientation){i.addClass("orientation-"+e.device.orientation)}s.on("resize orientationchange",c)});function n(){var t=e.config.get("screenSize");var i;if(e.device.screenWidth>t.medium){i="large"}else if(e.device.screenWidth>t.small){i="medium"}else{i="small"}return i}function r(){return d()?u():window.innerWidth||s.width()}function o(){return d()?h():window.innerHeight||s.height()}function a(){var e="";var i=["windows","mac","linux","windowsphone","chromeos","android","ios","blackberry","firefoxos","webos","bada","tizen","sailfish"];for(var s=0;s<i.length;s++){if(t[i[s]]){e=i[s];break}}if(e===""){var n=navigator.platform;var r=["Win","Mac","Linux"];e="PlatformUnknown";for(var s=0;s<r.length;s++){if(n.indexOf(r[s])!=-1){e=r[s].toLowerCase();break}}if(e=="win"){e="windows"}}return e}function l(){var e="";var i=["webkit","blink","gecko","msie","msedge"];for(var s=0;s<i.length;s++){if(t[i[s]]){e=i[s];break}}return e}var c=_.debounce(function v(){var t=e.device.screenWidth;var s=e.device.screenHeight;e.device.screenWidth=r();e.device.screenHeight=o();if(t===e.device.screenWidth&&s===e.device.screenHeight){return}var a=n();if(a!==e.device.screenSize){e.device.screenSize=a;i.removeClass("size-small size-medium size-large").addClass("size-"+e.device.screenSize);if(e.device.orientation){i.removeClass("orientation-landscape orientation-portrait").addClass("orientation-"+e.device.orientation)}e.trigger("device:changed",e.device.screenSize)}e.trigger("device:preResize device:resize device:postResize",e.device.screenWidth)},100);function d(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream}function u(){return Math.abs(window.orientation)===90?screen.height:screen.width}function h(){return Math.abs(window.orientation)===90?screen.width:screen.height}function f(){var e="";var i=["iphone","ipad","ipod"];for(var s=0;s<i.length;s++){if(t[i[s]]){e=i[s];break}}return e}function p(){var e=window.devicePixelRatio||1;if(e>=3){return"ultra-high"}else if(e>=2){return"high"}else if(e>=1.5){return"medium"}else{return"low"}}var m=e.device.browser.toLowerCase();var g=m.replace(/msie|internet explorer/,"ie");g=g+" version-"+e.device.version+" OS-"+e.device.OS+" "+f();g+=g.replace(".","-").toLowerCase();i.addClass(g+" pixel-density-"+p())});define("core/js/views/drawerView",["core/js/adapt"],function(e){var t=Backbone.View.extend({className:"drawer display-none",disableAnimation:false,escapeKeyAttached:false,initialize:function(){this.disableAnimation=e.config.has("_disableAnimation")?e.config.get("_disableAnimation"):false;this._isVisible=false;this.drawerDir="right";if(e.config.get("_defaultDirection")=="rtl"){this.drawerDir="left"}this.setupEventListeners();this.render();this.drawerDuration=e.config.get("_drawer")._duration;this.drawerDuration=this.drawerDuration?this.drawerDuration:400;this.$wrapper=$("#wrapper")},setupEventListeners:function(){this.listenTo(e,{"navigation:toggleDrawer":this.toggleDrawer,"drawer:triggerCustomView":this.openCustomView,"drawer:closeDrawer":this.onCloseDrawer,remove:this.onCloseDrawer,"drawer:remove":this.remove,"accessibility:toggle":this.onAccessibilityToggle});this._onKeyUp=_.bind(this.onKeyUp,this);this.setupEscapeKey()},setupEscapeKey:function(){var t=e.config.has("_accessibility")&&e.config.get("_accessibility")._isActive;if(!t&&!this.escapeKeyAttached){$(window).on("keyup",this._onKeyUp);this.escapeKeyAttached=true}else{$(window).off("keyup",this._onKeyUp);this.escapeKeyAttached=false}},onAccessibilityToggle:function(){this.setupEscapeKey()},onKeyUp:function(e){if(e.which!=27)return;e.preventDefault();this.onCloseDrawer()},events:{"click .drawer-back":"onBackButtonClicked","click .drawer-close":"onCloseDrawer"},render:function(){var t=Handlebars.templates["drawer"];$(this.el).html(t({_globals:e.course.get("_globals")})).prependTo("body");var i=Handlebars.templates["shadow"];$(i()).prependTo("body");_.defer(_.bind(function(){this.postRender()},this));return this},postRender:function(){this.$("a, button, input, select, textarea").attr("tabindex",-1);this.checkIfDrawerIsAvailable()},openCustomView:function(t,i){this._hasBackButton=i;this._isCustomViewVisible=true;e.trigger("drawer:empty");this.showDrawer();this.$(".drawer-holder").html(t);if(t.hasClass("resources")){this.$(".resource-name").html("Resources")}else if(t.hasClass("page-level-progress")){this.$(".resource-name").html("Topic List")}else{this.$(".resource-name").html("")}},checkIfDrawerIsAvailable:function(){if(this.collection.length==0){$(".navigation-drawer-toggle-button").addClass("display-none");e.trigger("drawer:noItems")}else{$(".navigation-drawer-toggle-button").removeClass("display-none")}},onBackButtonClicked:function(e){e.preventDefault();this.showDrawer(true)},onCloseDrawer:function(e){if(e){e.preventDefault()}this.hideDrawer()},toggleDrawer:function(){if(this._isVisible&&this._isCustomViewVisible===false){this.hideDrawer()}else{this.showDrawer(true)}},showDrawer:function(t){this.$el.removeClass("display-none");if(!this._isVisible){e.trigger("popup:opened",this.$el);$("body").scrollDisable();this._isVisible=true}var i=this.$el.width();this.$("a, button, input, select, textarea").attr("tabindex",0);if(t){this.$(".drawer-back").addClass("display-none");this._isCustomViewVisible=false;this.emptyDrawer();if(this.collection.models.length===1){e.trigger(this.collection.models[0].get("eventCallback"))}else{this.renderItems();e.trigger("drawer:openedItemView")}}else{if(this._hasBackButton&&this.collection.models.length>1){this.$(".drawer-back").removeClass("display-none")}else{this.$(".drawer-back").addClass("display-none")}e.trigger("drawer:openedCustomView")}if(this.disableAnimation){$("#shadow").removeClass("display-none");var s={};s[this.drawerDir]=0;this.$el.css(s);o.call(this)}else{$("#shadow").velocity({opacity:1},{duration:this.drawerDuration,begin:_.bind(function(){$("#shadow").removeClass("display-none");o.call(this)},this)});var n=e.config.get("_drawer")._showEasing;var r=n?n:"easeOutQuart";var s={};s[this.drawerDir]=0;this.$el.velocity(s,this.drawerDuration,r)}function o(){this.addShadowEvent();e.trigger("drawer:opened");this.$el.a11y_focus()}},emptyDrawer:function(){this.$(".drawer-holder").empty()},renderItems:function(){e.trigger("drawer:empty");this.emptyDrawer();var t=this.collection.models;for(var s=0,n=t.length;s<n;s++){var r=t[s];new i({model:r})}},hideDrawer:function(){if(this._isVisible){e.trigger("popup:closed");this._isVisible=false;$("body").scrollEnable()}else{return}if(this.disableAnimation){var t={};t[this.drawerDir]=-this.$el.width();this.$el.css(t).addClass("display-none");$("#shadow").addClass("display-none");e.trigger("drawer:closed")}else{var i=e.config.get("_drawer")._hideEasing;var s=i?i:"easeOutQuart";var t={};t[this.drawerDir]=-this.$el.width();this.$el.velocity(t,this.drawerDuration,s,_.bind(function(){this.$el.addClass("display-none");e.trigger("drawer:closed")},this));$("#shadow").velocity({opacity:0},{duration:this.drawerDuration,complete:function(){$("#shadow").addClass("display-none")}})}this._isCustomViewVisible=false;this.removeShadowEvent()},addShadowEvent:function(){$("#shadow").one("click touchstart",_.bind(function(){this.onCloseDrawer()},this))},removeShadowEvent:function(){$("#shadow").off("click touchstart")},remove:function(){Backbone.View.prototype.remove.apply(this,arguments);$(window).off("keyup",this._onKeyUp);e.trigger("drawer:empty");this.collection.reset();$("#shadow").remove()}});var i=Backbone.View.extend({className:"drawer-item",initialize:function(){this.listenTo(e,"drawer:empty",this.remove);this.render()},events:{"click .drawer-item-open":"onDrawerItemClicked"},render:function(){var e=this.model.toJSON();var t=Handlebars.templates["drawerItem"];$(this.el).html(t(e)).appendTo(".drawer-holder");return this},onDrawerItemClicked:function(t){t.preventDefault();var i=this.model.get("eventCallback");e.trigger(i)}});return t});define("core/js/drawer",["core/js/adapt","core/js/views/drawerView"],function(e,t){var i=new Backbone.Collection(null,{comparator:"drawerOrder"});var s={};s.addItem=function(e,t){e.eventCallback=t;i.add(e)};s.triggerCustomView=function(t,i){if(i!==false){i=true}e.trigger("drawer:triggerCustomView",t,i)};e.on({"adapt:start":function(){new t({collection:i})},"app:languageChanged":function(){e.trigger("drawer:remove")}});e.drawer=s});define("core/js/views/notifyView",["core/js/adapt"],function(e){var t=Backbone.View.extend({className:function(){var e="notify ";e+=this.model.get("_classes")||"";return e},disableAnimation:false,escapeKeyAttached:false,initialize:function(){this.disableAnimation=e.config.has("_disableAnimation")?e.config.get("_disableAnimation"):false;this.setupEventListeners();this.model.set("_globals",e.course.get("_globals"));this.render()},setupEventListeners:function(){this.listenTo(e,{"remove page:scrollTo":this.closeNotify,"notify:resize":this.resetNotifySize,"notify:cancel":this.cancelNotify,"notify:close":this.closeNotify,"device:resize":this.resetNotifySize,"accessibility:toggle":this.onAccessibilityToggle});this._onKeyUp=_.bind(this.onKeyUp,this);this.setupEscapeKey()},setupEscapeKey:function(){var t=e.config.has("_accessibility")&&e.config.get("_accessibility")._isActive;if(!t&&!this.escapeKeyAttached){$(window).on("keyup",this._onKeyUp);this.escapeKeyAttached=true}else{$(window).off("keyup",this._onKeyUp);this.escapeKeyAttached=false}},onAccessibilityToggle:function(){this.setupEscapeKey()},onKeyUp:function(e){if(e.which!=27)return;e.preventDefault();this.cancelNotify()},events:{"click .notify-popup-alert-button":"onAlertButtonClicked","click .notify-popup-prompt-button":"onPromptButtonClicked","click .notify-popup-done":"onCloseButtonClicked","click .notify-shadow":"onShadowClicked"},render:function(){var e=this.model.toJSON();var t=Handlebars.templates["notify"];this.$el.css("visibility","hidden");this.$el.html(t(e)).prependTo("body");this.$(".notify-popup").css("visibility","hidden");this.$el.css("visibility","visible");this.showNotify();return this},onAlertButtonClicked:function(t){t.preventDefault();this.closeNotify();e.trigger(this.model.get("_callbackEvent"),this)},onPromptButtonClicked:function(t){t.preventDefault();this.closeNotify();e.trigger($(t.currentTarget).attr("data-event"))},onCloseButtonClicked:function(e){e.preventDefault();this.cancelNotify()},onShadowClicked:function(e){e.preventDefault();if(this.model.get("_closeOnShadowClick")===false)return;this.cancelNotify()},cancelNotify:function(){if(this.model.get("_isCancellable")===false)return;this.closeNotify();e.trigger("notify:cancelled")},resetNotifySize:function(){$(".notify-popup").removeAttr("style");this.resizeNotify()},resizeNotify:function(){var e=$(window).height();var t=this.$(".notify-popup").outerHeight();if(t>e){this.$(".notify-popup").css({height:"100%","max-height":"300px","overflow-y":"scroll","margin-top":-(e/2),"-webkit-overflow-scrolling":"touch"})}else{this.$(".notify-popup").css({"margin-top":-(t/2)})}},showNotify:function(){this.addSubView();e.trigger("notify:opened",this);this.$el.imageready(_.bind(t,this));function t(){if(this.disableAnimation){this.$(".notify-shadow").css("display","block")}else{this.$(".notify-shadow").velocity({opacity:0},{duration:0}).velocity({opacity:1},{duration:400,begin:_.bind(function(){this.$(".notify-shadow").css("display","block")},this)})}this.resizeNotify();if(this.disableAnimation){this.$(".notify-popup").css("visibility","visible");t.call(this)}else{this.$(".notify-popup").velocity({opacity:0},{duration:0}).velocity({opacity:1},{duration:400,begin:_.bind(function(){this.$(".notify-popup").css("visibility","visible");t.call(this)},this)})}function t(){e.trigger("popup:opened",this.$(".notify-popup"));$("body").scrollDisable();$("html").addClass("notify");this.$(".notify-popup").a11y_focus()}}},addSubView:function(){this.subView=this.model.get("_view");if(!this.subView)return;this.$(".notify-popup-content-inner").append(this.subView.$el)},closeNotify:function(t){this.$(".notify-popup").addClass("display-none");if(this.disableAnimation){this.$(".notify-popup").css("visibility","hidden");this.$el.css("visibility","hidden");this.remove()}else{this.$(".notify-popup").velocity({opacity:0},{duration:400,complete:_.bind(function(){this.$(".notify-popup").css("visibility","hidden")},this)});this.$(".notify-shadow").velocity({opacity:0},{duration:400,complete:_.bind(function(){this.$el.css("visibility","hidden");this.remove()},this)})}$("body").scrollEnable();$("html").removeClass("notify");e.trigger("popup:closed");e.trigger("notify:closed")},remove:function(){this.removeSubView();Backbone.View.prototype.remove.apply(this,arguments)},removeSubView:function(){if(!this.subView)return;this.subView.remove();this.subView=null}});return t});define("core/js/views/notifyPushView",["core/js/adapt"],function(e){var t=Backbone.View.extend({className:function(){return"notify-push "+this.model.get("_classes")},initialize:function(){this.listenTo(e,"notify:pushShown notify:pushRemoved",this.updateIndexPosition);this.listenTo(this.model.collection,"remove",this.updateIndexPosition);this.listenTo(this.model.collection,"change:_index",this.updatePushPosition);this.listenTo(e,"remove",this.remove);this.model.set("_globals",e.course.get("_globals"));this.preRender();this.render()},events:{"click .notify-push-close":"closePush","click .notify-push-inner":"triggerEvent"},preRender:function(){this.hasBeenRemoved=false},render:function(){var e=this.model.toJSON();var t=Handlebars.templates["notifyPush"];this.$el.html(t(e)).appendTo("#wrapper");_.defer(_.bind(function(){this.postRender()},this));return this},postRender:function(){this.$el.addClass("show");_.delay(_.bind(function(){this.closePush()},this),this.model.get("_timeout"));e.trigger("notify:pushShown")},closePush:function(t){if(t){t.preventDefault()}if(this.hasBeenRemoved===false){this.hasBeenRemoved=true;this.$el.removeClass("show");_.delay(_.bind(function(){this.model.collection.remove(this.model);e.trigger("notify:pushRemoved",this);this.remove()},this),600)}},triggerEvent:function(t){e.trigger(this.model.get("_callbackEvent"));this.closePush()},updateIndexPosition:function(){if(!this.hasBeenRemoved){var e=this.model.collection.models;for(var t=0,i=e.length;t<i;t++){var s=t;var n=e[t];if(n.get("_isActive")===true){n.set("_index",s);this.updatePushPosition()}}}},updatePushPosition:function(){if(this.hasBeenRemoved){return}if(this.model.get("_index")!=undefined){var e=this.$el.height();var t=20;var i=$(".navigation").height();var s=this.model.get("_index");var n=s==0?1:0;if(this.model.collection.where({_isActive:true}).length===1){n=0}var r=(e+t)*n+i+t;this.$el.css("top",r)}}});return t});define("core/js/models/notifyModel",[],function(){var e=Backbone.Model.extend({defaults:{_isActive:false,_showIcon:false,_timeout:3e3}});return e});define("core/js/notify",["core/js/adapt","core/js/views/notifyView","core/js/views/notifyPushView","core/js/models/notifyModel"],function(e,t,i,s){var n=Backbone.Collection.extend({model:s,initialize:function(){this.listenTo(this,"add",this.onPushAdded);this.listenTo(e,"notify:pushRemoved",this.onRemovePush)},onPushAdded:function(e){this.checkPushCanShow(e)},checkPushCanShow:function(e){if(this.canShowPush()){e.set("_isActive",true);this.showPush(e)}},canShowPush:function(){var e=this.where({_isActive:true});if(e.length>=2){return false}return true},showPush:function(e){new i({model:e})},onRemovePush:function(e){var t=this.where({_isActive:false});if(t.length>0){this.checkPushCanShow(t[0])}}});var r=new n;e.on("notify:alert",function(e){o("alert",e)});e.on("notify:prompt",function(e){o("prompt",e)});e.on("notify:popup",function(e){o("popup",e)});e.on("notify:push",function(e){o("push",e)});function o(e,i){i._isCancellable=i._isCancellable===undefined?true:i._isCancellable;i._showCloseButton=i._showCloseButton===undefined?true:i._showCloseButton;i._closeOnShadowClick=i._closeOnShadowClick===undefined?true:i._closeOnShadowClick;i._type=e;if(e==="push"){r.push(i);return}var n=new t({model:new s(i)})}});define("core/js/popupManager",["core/js/adapt"],function(e){e.on("popup:opened",function(e){var t=e||$(document.activeElement);t.a11y_popup()});e.on("popup:closed",function(){$.a11y_popdown()})});define("core/js/models/routerModel",["core/js/adapt"],function(e){var t=Backbone.Model.extend({defaults:{_canNavigate:true},lockedAttributes:{_canNavigate:false}});return t});define("core/js/views/adaptView",["core/js/adapt"],function(e){var t=Backbone.View.extend({attributes:function(){return{"data-adapt-id":this.model.get("_id")}},initialize:function(){this.listenTo(e,"remove",this.remove);this.listenTo(this.model,{"change:_isVisible":this.toggleVisibility,"change:_isHidden":this.toggleHidden,"change:_isComplete":this.onIsCompleteChange});this.model.set({_globals:e.course.get("_globals"),_isReady:false});this._isRemoved=false;this.preRender();this.render();this.setupOnScreenHandler()},preRender:function(){},postRender:function(){this.addChildren()},render:function(){e.trigger(this.constructor.type+"View:preRender",this);var t=this.model.toJSON();t.view=this;var i=Handlebars.templates[this.constructor.template];this.$el.html(i(t));_.defer(function(){if(this._isRemoved)return;this.postRender();e.trigger(this.constructor.type+"View:postRender",this)}.bind(this));return this},setupOnScreenHandler:function(){var e=this.model.get("_onScreen");if(!e||!e._isEnabled)return;this.$el.on("onscreen.adaptView",function(t,i){if(!i.onscreen)return;var s=e._percentInviewVertical||33;if(i.percentInviewVertical<s)return;this.$el.addClass(e._classes||"onscreen").off("onscreen.adaptView")}.bind(this))},addChildren:function(){var t=0;var i=this.model.getChildren();var s=i.models;for(var n=0,r=s.length;n<r;n++){var o=s[n];if(o.get("_isAvailable")){t++;var a;var l=this.constructor.childView||e.componentStore[o.get("_component")];if(l.view)a=l.view;else a=l;if(a){var c=this.$(this.constructor.childContainer);o.set("_nthChild",t);if(e.config.get("_defaultDirection")=="rtl"&&o.get("_type")=="component"){c.prepend(new a({model:o}).$el)}else{c.append(new a({model:o}).$el)}}else{throw"The component '"+s[n].attributes._id+"'"+" ('"+s[n].attributes._component+"')"+" has not been installed, and so is not available in your project."}}}},setReadyStatus:function(){this.model.set("_isReady",true)},setCompletionStatus:function(){if(this.model.get("_isVisible")){this.model.set({_isComplete:true,_isInteractionComplete:true})}},resetCompletionStatus:function(e){if(!this.model.get("_canReset"))return;var t=this.model.findDescendantModels("components");if(t.length===0){this.model.reset(e)}else{_.each(t,function(t){t.reset(e)})}},preRemove:function(){},remove:function(){this.preRemove();this._isRemoved=true;e.wait.for(function(e){this.$el.off("onscreen.adaptView");this.model.setOnChildren("_isReady",false);this.model.set("_isReady",false);Backbone.View.prototype.remove.call(this);e()}.bind(this));return this},setVisibility:function(){var e="visibility-hidden";if(this.model.get("_isVisible")){e=""}return e},toggleVisibility:function(){if(this.model.get("_isVisible")){return this.$el.removeClass("visibility-hidden")}this.$el.addClass("visibility-hidden")},setHidden:function(){var e="";if(this.model.get("_isHidden")){e="display-none"}return e},toggleHidden:function(){if(!this.model.get("_isHidden")){return this.$el.removeClass("display-none")}this.$el.addClass("display-none")},onIsCompleteChange:function(e,t){this.$el.toggleClass("completed",t)}});return t});define("core/js/views/blockView",["core/js/views/adaptView","core/js/adapt"],function(e,t){var i=e.extend({className:function(){return"block "+this.model.get("_id")+" "+this.model.get("_classes")+" "+this.setVisibility()+" "+this.setHidden()+" nth-child-"+this.model.get("_nthChild")+" "+(this.model.get("_isComplete")?"completed":"")},postRender:function(){e.prototype.postRender.apply(this,arguments);var i=this;_.defer(function(){setTimeout(function(){if(!t.device.touch&&i.$el.height()<t.device.screenHeight){i.$el.height(t.device.screenHeight)}},1500)})}},{childContainer:".component-container",type:"block",template:"block"});return i});define("core/js/views/articleView",["core/js/views/adaptView","core/js/views/blockView"],function(e,t){var i=e.extend({className:function(){return"article "+this.model.get("_id")+" "+this.model.get("_classes")+" "+this.setVisibility()+" "+this.setHidden()+" nth-child-"+this.model.get("_nthChild")+" "+(this.model.get("_isComplete")?"completed":"")}},{childContainer:".block-container",childView:t,type:"article",template:"article"});return i});define("core/js/views/pageView",["core/js/adapt","core/js/views/adaptView","core/js/views/articleView"],function(e,t,i){var s=t.extend({className:function(){return"page "+this.model.get("_id")+" "+this.model.get("_classes")+" "+this.setVisibility()+" "+(this.model.get("_isComplete")?"completed":"")},preRender:function(){this.disableAnimation=e.config.has("_disableAnimation")?e.config.get("_disableAnimation"):false;this.$el.css("opacity",0);this.listenTo(this.model,"change:_isReady",this.isReady);var t=e.config.get("_accessibility");if(!t._isEnabled&&!t._isEnabledOnTouchDevices){return}this.$pageLabel=$("<div/>",{"class":"aria-label relative a11y-ignore-focus prevent-default",tabindex:0,role:"region",text:e.course.get("_globals")._accessibility._ariaLabels.pageEnd}).appendTo("body")},isReady:function(){if(this.model.get("_isReady")){_.defer(_.bind(function(){$(".loading").hide();$(window).scrollTop(0);e.trigger("pageView:ready",this);var t={opacity:1};if(this.disableAnimation){this.$el.css(t);$.inview()}else{this.$el.velocity(t,{duration:"fast",complete:function(){$.inview()}})}$(window).scroll()},this))}},remove:function(){if(this.$pageLabel){this.$pageLabel.remove()}t.prototype.remove.call(this)}},{childContainer:".article-container",childView:i,type:"page",template:"page"});return s});define("core/js/router",["core/js/adapt","core/js/models/routerModel","core/js/views/pageView","core/js/startController"],function(e,t,i){e.router=new t(null,{reset:true});var s=Backbone.Router.extend({_isCircularNavigationInProgress:false,initialize:function(){this.showLoading();this.$wrapper=$("#wrapper");this.$html=$("html");e.once("app:dataReady",function(){document.title=e.course.get("title")});this.listenTo(e,{"navigation:backButton":this.navigateToPreviousRoute,"navigation:homeButton":this.navigateToHomeRoute,"navigation:skipNavigation":this.skipNavigation,"navigation:parentButton":this.navigateToParent,"router:navigateTo":this.navigateToArguments})},routes:{"":"handleRoute","id/:id":"handleRoute",":pluginName(/*location)(/*action)":"handleRoute"},pruneArguments:function(e){var t=_.toArray(e);if(t.length!==0){t=_.without(e,null)}return t},handleRoute:function(){var t=this.pruneArguments(arguments);if(e.router.get("_canNavigate")){this._isCircularNavigationInProgress=false}if(this._isCircularNavigationInProgress===false){
e.trigger("router:navigate",t)}if(e.router.get("_canNavigate")){e.router.set("_canNavigate",false,{pluginName:"adapt"});switch(t.length){case 1:return this.handleId.apply(this,t);case 2:return this.handlePluginRouter.apply(this,t);default:return this.handleCourse()}}if(this._isCircularNavigationInProgress){this._isCircularNavigationInProgress=false;return}this._isCircularNavigationInProgress=true;e.trigger("router:navigationCancelled",t);this.navigateToCurrentRoute(true)},handlePluginRouter:function(t,i,s){var n=t;if(i){n=n+"-"+i;if(s){n=n+"-"+s}}this.updateLocation(n,null,null,function(){e.trigger("router:plugin:"+t,t,i,s);e.trigger("router:plugin",t,i,s);e.router.set("_canNavigate",true,{pluginName:"adapt"})})},handleCourse:function(){if(e.course.has("_start")){var t=e.course.get("_start");if(t._isEnabled==true&&t._isMenuDisabled==true){return}}this.showLoading();this.removeViews(_.bind(function(){e.course.set("_isReady",false);this.setContentObjectToVisited(e.course);this.updateLocation("course",null,null,_.bind(function(){e.once("menuView:ready",function(){e.router.set("_canNavigate",true,{pluginName:"adapt"})});e.trigger("router:menu",e.course)},this))},this))},handleId:function(t){var s=e.findById(t);var n="";if(!s){e.router.set("_canNavigate",true,{pluginName:"adapt"});return}n=s.get("_type");switch(n){case"page":case"menu":if(s.get("_isLocked")&&e.config.get("_forceRouteLocking")){e.log.warn("Unable to navigate to locked id: "+t);e.router.set("_canNavigate",true,{pluginName:"adapt"});if(e.location._previousId===undefined){return this.navigate("#/",{trigger:true,replace:true})}else{return Backbone.history.history.back()}}else{this.showLoading();this.removeViews(_.bind(function(){this.setContentObjectToVisited(s);if(n=="page"){var r="page-"+t;this.updateLocation(r,"page",t,_.bind(function(){e.once("pageView:ready",function(){e.router.set("_canNavigate",true,{pluginName:"adapt"})});e.trigger("router:page",s);this.$wrapper.append(new i({model:s}).$el)},this))}else{var r="menu-"+t;this.updateLocation(r,"menu",t,_.bind(function(){e.once("menuView:ready",function(){e.router.set("_canNavigate",true,{pluginName:"adapt"})});e.trigger("router:menu",s)},this))}},this))}break;default:e.router.set("_canNavigate",true,{pluginName:"adapt"});e.navigateToElement("."+t,{replace:true})}},removeViews:function(t){e.remove();e.wait.queue(t)},showLoading:function(){$(".loading").show()},navigateToArguments:function(t){t=this.pruneArguments(t);var i={trigger:false,replace:false};switch(t.length){case 0:this.navigate("#/",i);break;case 1:if(e.findById(t[0])){this.navigate("#/id/"+t[0],i)}else{this.navigate("#/"+t[0],i)}break;case 2:case 3:this.navigate("#/"+t.join("/"),i);break;default:e.log.warn("DEPRECATED - use Backbone.history.navigate or "+'window.location.href instead of Adapt.trigger("router:navigateTo")');this.handleRoute.apply(this,t)}},skipNavigation:function(){$("."+e.location._contentType).a11y_focus()},navigateToPreviousRoute:function(t){if(e.router.get("_canNavigate")||t){if(!e.location._currentId){return Backbone.history.history.back()}if(e.location._previousContentType==="page"&&e.location._contentType==="menu"){return this.navigateToParent()}if(e.location._previousContentType==="page"){return Backbone.history.history.back()}if(e.location._currentLocation==="course"){return}this.navigateToParent()}},navigateToHomeRoute:function(t){if(e.router.get("_canNavigate")||t){this.navigate("#/",{trigger:true})}},navigateToCurrentRoute:function(t){if(e.router.get("_canNavigate")||t){if(!e.location._currentId){return}var i=e.location._currentId;var s=i===e.course.get("_id")?"#/":"#/id/"+i;this.navigate(s,{trigger:true,replace:true})}},navigateToParent:function(t){if(e.router.get("_canNavigate")||t){var i=e.contentObjects.findWhere({_id:e.location._currentId}).get("_parentId");var s=i===e.course.get("_id")?"#/":"#/id/"+i;this.navigate(s,{trigger:true})}},setContentObjectToVisited:function(e){e.set("_isVisited",true)},updateLocation:function(t,i,s,n){e.location._previousId=e.location._currentId;e.location._previousContentType=e.location._contentType;if(t==="course"){e.location._currentId=e.course.get("_id");e.location._contentType="menu";e.location._lastVisitedMenu=t}else if(!i){e.location._currentId=null;e.location._contentType=null}else if(_.isString(s)){e.location._currentId=s;e.location._contentType=i;if(i==="menu"){e.location._lastVisitedType="menu";e.location._lastVisitedMenu=s}else if(i==="page"){e.location._lastVisitedType="page";e.location._lastVisitedPage=s}}e.location._currentLocation=t;var r=e.location._currentId?"location-"+e.location._contentType+" location-id-"+e.location._currentId:"location-"+e.location._currentLocation;var o=e.location._previousClasses;if(o){this.$html.removeClass(o)}e.location._previousClasses=r;this.$html.addClass(r).attr("data-location",e.location._currentLocation);this.$wrapper.removeClass().addClass(r).attr("data-location",e.location._currentLocation);this.setDocumentTitle();e.trigger("router:location",e.location);e.wait.queue(n)},setDocumentTitle:function(){if(!e.location._currentId)return;var t=e.findById(e.location._currentId);var i="";if(t&&t.get("_type")!=="course"){var s=t.get("title");if(s){i=" | "+s}}var n=e.course.get("title");var r=$("<div>"+n+i+"</div>").text();e.once("pageView:ready menuView:ready",function(){document.title=r})}});return new s({model:new Backbone.Model})});define("core/js/helpers",["handlebars","core/js/adapt"],function(e,t){var i={lowercase:function(e){return e.toLowerCase()},capitalise:function(e){return e.charAt(0).toUpperCase()+e.slice(1)},inc:function(e){return e+1},dec:function(e){return e-1},odd:function(e){return(e+1)%2===0?"even":"odd"},equals:function(e,t,s){return i.compare.call(this,e,"==",t,s)},compare:function(e,t,i,s){switch(t){case"===":if(e===i)return s.fn(this);break;case"=":case"==":if(e==i)return s.fn(this);break;case">=":if(e>=i)return s.fn(this);break;case"<=":if(e<=i)return s.fn(this);break;case">":if(e>i)return s.fn(this);break;case"<":if(e<i)return s.fn(this);break}return s.inverse(this)},math:function(e,t,i,s){e=parseFloat(e);i=parseFloat(i);switch(t){case"+":return e+i;case"-":return e-i;case"*":return e*i;case"/":return e/i;case"%":return e%i}},any:function(){var e=Array.prototype.slice.call(arguments,0,-1);var t=Array.prototype.slice.call(arguments,-1)[0];return _.any(e)?t.fn(this):t.inverse(this)},all:function(){var e=Array.prototype.slice.call(arguments,0,-1);var t=Array.prototype.slice.call(arguments,-1)[0];return _.all(e)?t.fn(this):t.inverse(this)},compile:function(t,i){if(!t)return"";if(t instanceof Object)t=t.toString();var s=this;if(i){s=!i.data||!i.data.root?i:i.data.root}return e.compile(t)(s)},compile_a11y_text:function(t,s){if(!t)return"";if(t instanceof Object)t=t.toString();return e.helpers.a11y_text.call(this,i.compile.call(this,t,s))},compile_a11y_normalize:function(t,s){if(!t)return"";if(t instanceof Object)t=t.toString();return e.helpers.a11y_normalize.call(this,i.compile.call(this,t,s))},compile_a11y_remove_breaks:function(t,s){if(!t)return"";return e.helpers.a11y_remove_breaks.call(this,i.compile.call(this,t,s))},import_globals:function(e){if(e.data.root._globals)return"";e.data.root._globals=t.course.get("_globals");return""},import_adapt:function(e){if(e.data.root.Adapt)return;var i=e.data.root.Adapt={};var s,n,r;var o=["config","course"];for(s=0,n=o.length;s<n;s++){r=o[s];i[r]=t[r].toJSON()}var a=["contentObjects","articles","blocks","components"];for(s=0,n=a.length;s<n;s++){r=a[s];var l=t[r].toJSON();var c={};for(var d=0,u=l.length;d<u;d++){var h=l[d];c[h._id]=h}i[r]=c}return""}};i["if_value_equals"]=i["equals"];i["numbers"]=i["inc"];i["lowerCase"]=i["lowercase"];for(var s in i){if(i.hasOwnProperty(s)){e.registerHelper(s,i[s])}}return i});define("core/js/views/componentView",["core/js/adapt","core/js/views/adaptView"],function(e,t){var i=t.extend({className:function(){return"component "+this.model.get("_component")+"-component "+this.model.get("_id")+" "+this.model.get("_classes")+" "+this.setVisibility()+" "+this.setHidden()+" component-"+this.model.get("_layout")+" nth-child-"+this.model.get("_nthChild")+" "+(this.model.get("_isComplete")?"completed":"")},initialize:function(){t.prototype.initialize.apply(this,arguments);this.renderState()},renderState:function(){if(!Handlebars.partials["state"])return;if(this.model.get("_disableAccessibilityState"))return;if(this.$el.is(".not-accessible"))return;if(this.$el.is(".no-state"))return;var t=this.$(".accessibility-state");var i=t.length;var s=_.extend(this.model.toJSON(),{a11yConfig:e.config.get("_accessibility")});var n=Handlebars.partials["state"](s);if(i){t.html(n)}else{this.$el.append(n)}this.listenToOnce(this.model,"change:_isComplete",this.renderState)},postRender:function(){}},{type:"component"});return i});define("components/adapt-animatedImages/js/adapt-animatedImages",["require","coreViews/componentView","coreJS/adapt"],function(e){var t=e("coreViews/componentView");var i=e("coreJS/adapt");var s=t.extend({preRender:function(){this.listenTo(this.model,"device:reSize",this.replaceWithGraphic);this.listenTo(this.model,"device:changed",this.replaceWithGraphic);this.$el.addClass("no-state");if(i.device.screenSize!=="small"){this.model.set("_isDesktop",true)}else{this.model.set("_isDesktop",false)}this.checkIfResetOnRevisit();var e=this.model.get("_id");_.each(this.model.get("_items"),function(t,i){t.id=e+"-"+i})},postRender:function(){this.setReadyStatus();this.$(".component-inner").on("inview",_.bind(this.inview,this));_.each(this.model.get("_items"),function(e,t){if(e._isClickOnImg){if(e.link){var i=e.link;this.$("#"+e.id).find("img").addClass("clickOnImg");this.$("#"+e.id).click(function(){window.open(i)})}}})},checkIfResetOnRevisit:function(){var e=this.model.get("_isResetOnRevisit");if(e){this.model.reset(e)}},replaceWithGraphic:function(){if(window.innerWidth>768){this.model.set("_isDesktop",true)}else{this.model.set("_isDesktop",false)}},inview:function(e,t,i,s){if(t){if(s==="top"){this._isVisibleTop=true}else if(s==="bottom"){this._isVisibleBottom=true}else if(i==="left"){this._isVisibleLeft=true}else if(i==="right"){this._isVisibleRight=true}else{this._isVisibleTop=true;this._isVisibleBottom=true;this._isVisibleLeft=true;this._isVisibleRight=true}if(this._isVisibleTop&&this._isVisibleBottom){this.animation();this.$(".component-widget").off("inview")}}if(t===undefined){this.animation()}},animation:function(){var e=this;var t=this.$(".animation").children();var s=0;function n(){t.eq(s).fadeIn(1500,function(){s++;if(s!=t.length)n();else e.setCompletionStatus()})}if(i.device.screenSize==="small"){e.setCompletionStatus()}n()}});i.register("animatedImages",s);return s});define("core/js/views/buttonsView",["core/js/adapt","core/js/enums/buttonStateEnum"],function(e,t){var i={SUBMIT:"submit",CORRECT:"correct",INCORRECT:"incorrect",SHOW_CORRECT_ANSWER:"showCorrectAnswer",HIDE_CORRECT_ANSWER:"hideCorrectAnswer",SHOW_FEEDBACK:"showFeedback",RESET:"reset"};var s=Backbone.View.extend({initialize:function(t){this.parent=t.parent;this.listenTo(e,"remove",this.remove);this.listenTo(this.model,"change:_buttonState",this.onButtonStateChanged);this.listenTo(this.model,"change:feedbackMessage",this.onFeedbackMessageChanged);this.listenTo(this.model,"change:_attemptsLeft",this.onAttemptsChanged);this.render()},events:{"click .buttons-action":"onActionClicked","click .buttons-feedback":"onFeedbackClicked"},render:function(){var t=this.model.toJSON();var i=Handlebars.templates["buttons"];_.defer(_.bind(function(){this.postRender();e.trigger("buttonsView:postRender",this)},this));this.$el.html(i(t))},postRender:function(){this.refresh()},checkResetSubmittedState:function(){var e=this.model.get("_isSubmitted");if(!e){var t=this.$(".buttons-marking-icon");t.removeClass("icon-cross");t.removeClass("icon-tick");t.addClass("display-none");this.$el.removeClass("submitted");this.model.set("feedbackMessage",undefined);this.$(".buttons-feedback").a11y_cntrl_enabled(false)}else{this.$el.addClass("submitted")}},onActionClicked:function(){var e=this.model.get("_buttonState");this.trigger("buttons:stateUpdate",t(e));this.checkResetSubmittedState()},onFeedbackClicked:function(){this.trigger("buttons:stateUpdate",t.SHOW_FEEDBACK)},onFeedbackMessageChanged:function(e,t){if(t&&this.model.get("_canShowFeedback")){this.$(".buttons-feedback").a11y_cntrl_enabled(true)}else{this.$(".buttons-feedback").a11y_cntrl_enabled(false)}},onButtonStateChanged:function(e,s){var n=t(s);if(s===t.CORRECT||s===t.INCORRECT){this.$(".buttons-action").a11y_cntrl_enabled(false);if(!this.model.get("_canShowFeedback")){if(!this.$el.is(".no-state")){_.defer(_.bind(function(){$("."+this.model.get("_id")+" .accessibility-state [tabindex]").focusNoScroll()},this))}}}else{var r=i[n.asString];var o=this.model.get("_buttons")["_"+r].ariaLabel;var a=this.model.get("_buttons")["_"+r].buttonText;this.$(".buttons-action").a11y_cntrl_enabled(true).html(a).attr("aria-label",o);switch(s){case t.SHOW_CORRECT_ANSWER:case t.HIDE_CORRECT_ANSWER:this.$(".buttons-action").a11y_cntrl(false)}}this.updateAttemptsCount()},checkFeedbackState:function(){var e=this.model.get("_canShowFeedback");this.$(".buttons-action").toggleClass("buttons-action-fullwidth buttons-action-enlarge",!e);this.$(".buttons-feedback").toggleClass("no-feedback",!e);this.$(".buttons-marking-icon").toggleClass("no-feedback",!e)},updateAttemptsCount:function(e,t){var i=this.model.get("_isInteractionComplete");var s=this.model.get("_attemptsLeft")?this.model.get("_attemptsLeft"):this.model.get("_attempts");var n=this.model.get("_isCorrect");var r=this.model.get("_shouldDisplayAttempts");var o;this.checkResetSubmittedState();if(!i&&s!=0){o=s+" ";if(s>1){o+=this.model.get("_buttons").remainingAttemptsText}else if(s===1){o+=this.model.get("_buttons").remainingAttemptText}}else{this.$(".buttons-display-inner").addClass("visibility-hidden");this.showMarking()}if(r){this.$(".buttons-display-inner").a11y_text(o)}},showMarking:function(){if(!this.model.get("_canShowMarking"))return;this.$(".buttons-marking-icon").removeClass("display-none").addClass(this.model.get("_isCorrect")?"icon-tick":"icon-cross")},refresh:function(){this.updateAttemptsCount();this.checkResetSubmittedState();this.checkFeedbackState();this.onButtonStateChanged(null,this.model.get("_buttonState"));this.onFeedbackMessageChanged(null,this.model.get("feedbackMessage"))}});return s});define("core/js/views/questionView",["core/js/adapt","core/js/views/componentView","core/js/views/buttonsView","core/js/models/questionModel","core/js/enums/buttonStateEnum"],function(e,t,i,s,n){var r=false;var o=t.extend({className:function(){return"component "+"question-component "+this.model.get("_component")+"-component "+this.model.get("_id")+" "+this.model.get("_classes")+" "+this.setVisibility()+" component-"+this.model.get("_layout")+" nth-child-"+this.model.get("_nthChild")+(this.model.get("_isComplete")?" completed":"")},preRender:function(){this.listenTo(this.model,"change:_isEnabled",this.onEnabledChanged);this.listenTo(this.model,"question:refresh",this.refresh);this.checkIfResetOnRevisit();this._runModelCompatibleFunction("setupDefaultSettings");this.setupQuestion()},onEnabledChanged:function(e,t){if(!t){this.$(".component-widget").addClass("disabled");this.disableQuestion()}else{this.$(".component-widget").removeClass("disabled");this.enableQuestion()}},disableQuestion:function(){},enableQuestion:function(){},checkIfResetOnRevisit:function(){var e=this.model.get("_isResetOnRevisit");if(e){this.model.reset(e,true);_.defer(_.bind(function(){this.resetQuestionOnRevisit(e)},this))}else{var t=this.model.get("_isInteractionComplete");if(t){this.model.set("_buttonState",n.HIDE_CORRECT_ANSWER);_.defer(_.bind(function(){this.onHideCorrectAnswerClicked()},this))}else{this.model.set("_buttonState",n.SUBMIT);_.defer(_.bind(function(){this.onResetClicked()},this))}}},resetQuestionOnRevisit:function(e){},setupQuestion:function(){},postRender:function(){this.addButtonsView();this.onQuestionRendered()},addButtonsView:function(){this.buttonsView=new i({model:this.model,el:this.$(".buttons")});this.listenTo(this.buttonsView,"buttons:stateUpdate",this.onButtonStateUpdate)},onButtonStateUpdate:function(e){switch(e){case n.SUBMIT:this.onSubmitClicked();break;case n.RESET:this.onResetClicked();break;case n.SHOW_CORRECT_ANSWER:this.onShowCorrectAnswerClicked();break;case n.HIDE_CORRECT_ANSWER:this.onHideCorrectAnswerClicked();break;case n.SHOW_FEEDBACK:this.showFeedback();break}},onQuestionRendered:function(){},onSubmitClicked:function(){var e=this._runModelCompatibleFunction("canSubmit");if(!e){this.showInstructionError();this.onCannotSubmit();return}this._runModelCompatibleFunction("updateAttempts");this._runModelCompatibleFunction("setQuestionAsSubmitted");this.removeInstructionError();this._runModelCompatibleFunction("storeUserAnswer");this._runModelCompatibleFunction("markQuestion","isCorrect");this._runModelCompatibleFunction("setScore");this.showMarking();this._runModelCompatibleFunction("checkQuestionCompletion");this.recordInteraction();this._runModelCompatibleFunction("setupFeedback");this._runModelCompatibleFunction("updateButtons");this.showFeedback();this.onSubmitted()},showInstructionError:function(){this.$(".component-instruction-inner").addClass("validation-error");this.$el.a11y_focus()},onCannotSubmit:function(){},onSubmitted:function(){},setQuestionAsSubmitted:function(){this.model.setQuestionAsSubmitted();this.$(".component-widget").addClass("submitted")},removeInstructionError:function(){this.$(".component-instruction-inner").removeClass("validation-error")},showMarking:function(){},checkQuestionCompletion:function(){var e=this.model.checkQuestionCompletion();if(e){this.$(".component-widget").addClass("complete show-user-answer")}},recordInteraction:function(){if(this.model.get("_recordInteraction")===true||!this.model.has("_recordInteraction")){e.trigger("questionView:recordInteraction",this)}},showFeedback:function(){if(this.model.get("_canShowFeedback")){e.trigger("questionView:showFeedback",this)}else{e.trigger("questionView:disabledFeedback",this)}},onResetClicked:function(){this.setQuestionAsReset();this._runModelCompatibleFunction("updateButtons");this._runModelCompatibleFunction("resetUserAnswer");this.resetQuestion();if(this.model.get("_isReady")){_.defer(_.bind(function(){this.$el.a11y_focus()},this))}},setQuestionAsReset:function(){this.model.setQuestionAsReset();this.$(".component-widget").removeClass("submitted");var t=e.findById(e.location._currentId);if(t&&t.get("_isReady")){this.$el.a11y_focus()}},resetQuestion:function(){},refresh:function(){this.renderState();this.model.set("_buttonState",this.model.getButtonState());if(this.model.get("_canShowMarking")&&this.model.get("_isInteractionComplete")&&this.model.get("_isSubmitted")){this.showMarking()}if(this.buttonsView){_.defer(_.bind(this.buttonsView.refresh,this.buttonsView))}},onShowCorrectAnswerClicked:function(){this.setQuestionAsShowCorrect();this._runModelCompatibleFunction("updateButtons");this.showCorrectAnswer()},setQuestionAsShowCorrect:function(){this.$(".component-widget").addClass("submitted show-correct-answer").removeClass("show-user-answer")},showCorrectAnswer:function(){},onHideCorrectAnswerClicked:function(){this.setQuestionAsHideCorrect();this._runModelCompatibleFunction("updateButtons");this.hideCorrectAnswer()},setQuestionAsHideCorrect:function(){this.$(".component-widget").addClass("submitted show-user-answer").removeClass("show-correct-answer")},hideCorrectAnswer:function(){},getLatency:function(){return null},_runModelCompatibleFunction:function(e,t){return this.model[e]()}},{_isQuestionType:true});if(r)return o;var a={getInteractionObject:function(){return this.model.getInteractionObject()},getResponse:function(){return this.model.getResponse()},getResponseType:function(){return this.model.getResponseType()},setupDefaultSettings:function(){return this.model.setupDefaultSettings()},setupButtonSettings:function(){return this.model.setupButtonSettings()},setupWeightSettings:function(){return this.model.setupWeightSettings()},canSubmit:function(){return this.model.canSubmit()},updateAttempts:function(){return this.model.updateAttempts()},storeUserAnswer:function(){return this.model.storeUserAnswer()},resetUserAnswer:function(){return this.model.resetUserAnswer()},markQuestion:function(){if(this._isInViewOnlyCompatibleMode("isCorrect")){if(this.isCorrect()){this.model.set("_isCorrect",true)}else{this.model.set("_isCorrect",false)}}else{return this.model.markQuestion()}},isCorrect:function(){return this.model.isCorrect()},setScore:function(){return this.model.setScore()},updateButtons:function(){return this.model.updateButtons()},setupFeedback:function(){if(this._isInViewOnlyCompatibleMode("isPartlyCorrect")){if(this.model.get("_isCorrect")){this._runModelCompatibleFunction("setupCorrectFeedback")}else if(this.isPartlyCorrect()){this._runModelCompatibleFunction("setupPartlyCorrectFeedback")}else{this._runModelCompatibleFunction("setupIncorrectFeedback")}}else{this.model.setupFeedback()}},isPartlyCorrect:function(){return this.model.isPartlyCorrect()},setupCorrectFeedback:function(){return this.model.setupCorrectFeedback()},setupPartlyCorrectFeedback:function(){return this.model.setupPartlyCorrectFeedback()},setupIncorrectFeedback:function(){return this.model.setupIncorrectFeedback()},_runModelCompatibleFunction:function(e,t){if(this._isInViewOnlyCompatibleMode(e,t)){return this[e]()}else{return this.model[e]()}},_isInViewOnlyCompatibleMode:function(e,t){var i=t||e;if(!this.constructor.prototype[i])return false;if(this.constructor.prototype[i]===a[i]){switch(i){case"setupFeedback":case"markQuestion":return true}return false}return true}};return o.extend(a,{_isQuestionType:true})});define("components/adapt-balloonActivity/js/balloonActivityView",["core/js/views/questionView","core/js/adapt"],function(e,t){var s=e.extend({events:{"click .balloonActivity-text":"onItemTextClicked","click .balloonActivity-start":"onStartClicked"},resetQuestionOnRevisit:function(){this.setAllItemsEnabled(true);this.resetQuestion()},setupQuestion:function(){this.model.setupRandomisation()},disableQuestion:function(){this.setAllItemsEnabled(false)},enableQuestion:function(){this.setAllItemsEnabled(true)},onQuestionRendered:function(){console.log(this.model.get("_isSubmitted"));if(this.model.get("_isSubmitted")){this.setItem()}else{this.$(".balloonActivity-item").css("animation-play-state","paused");this.seconds=0;this.minutes=0;this.hours=0}this.setReadyStatus();if(!this.model.get("_isSubmitted"))return;this.showMarking()},setItem:function(){var e=this.model.get("_itemEnabled");_.each(this.$(".balloonActivity-background-image"),function(t,i){this.$(".balloonActivity-text-"+e).removeClass("display-none")},this);var t=this.model.get("_timeRequiredInSeconds");var i=this.$(".balloonActivity-time-text")[0];i.textContent="00:00:"+t;this.setAllItemsEnabled(false)},onStartClicked:function(e){this.$(".balloonActivity-item").css("animation-play-state","running");this.setTheText();this.timer();this.setAllItemsEnabled(true)},timer:function(){var e=this;this.t=setTimeout(function(){e.add()},1e3)},add:function(){var e=this.$(".balloonActivity-time-text")[0];this.seconds++;if(this.seconds>=60){this.seconds=0;this.minutes++;if(this.minutes>=60){this.minutes=0;this.hours++}}e.textContent=(this.hours?this.hours>9?this.hours:"0"+this.hours:"00")+":"+(this.minutes?this.minutes>9?this.minutes:"0"+this.minutes:"00")+":"+(this.seconds>9?this.seconds:"0"+this.seconds);if(this.seconds==this.model.get("_timeRequiredInSeconds")){this.clearTimeAndInterval();return}this.timer()},clearTimeAndInterval:function(){clearTimeout(this.t);clearInterval(this.interval);this.setCompletionStatus();this.showCommonFeedback();this.$(".balloonActivity-start").prop("disabled",true);this.$(".balloonActivity-start").addClass("disabled");this.setAllItemsEnabled(false)},setAllItemsEnabled:function(e){var t=this.$(".balloonActivity-background-image");if(e){t.removeClass("disabled");t.prop("disabled",false);t.addClass("hvr-buzz");t.css("animation-play-state","running")}else{t.addClass("disabled");t.prop("disabled",true);t.find(".balloonActivity-text-container").css("cursor","default");t.removeClass("hvr-buzz");t.removeClass("balloonActivity-background-break-image");t.parent().css("animation-play-state","paused");t.css("animation-play-state","paused")}},setTheText:function(){var e=this;var t=this.model.get("_items");var i=t[0].displayAnswers.length;var s=0;var n;this.interval=setInterval(function(){var t=e.$(".balloonActivity-text-"+s);if(t.hasClass("display-none")){e.$(".balloonActivity-text").addClass("display-none");t.removeClass("display-none");var n=t.parent().parent();if(n.hasClass("balloonActivity-background-break-image")){n.removeClass("balloonActivity-background-break-image");n.addClass("balloonActivity-background-image")}e.$(".balloonActivity-text").removeClass("breakBalloon")}s++;if(s==i){s=0}},2e3)},onItemTextClicked:function(e){var t=$(e.currentTarget);if(t.hasClass("correctAnswer"))return;var i=t.parent().parent();if(i.hasClass("disabled"))return;this.setCorrectAnswers(t,i)},setCorrectAnswers:function(e,t){var s=e.attr("data-id");var n=t.attr("parent-id");var r=this.model.get("_items")[n].correctAnswers;for(i=0;i<r.length;i++){if(r[i]==s){e.addClass("correctAnswer");t.addClass("balloonActivity-background-break-image");t.removeClass("balloonActivity-background-image");t.addClass("hvr-buzz")}}},showCommonFeedback:function(){var e=this.model.get("_commonFeedback");var i={title:"Common Feedback",body:e};$("body").scrollDisable();this.model.set("_isSubmitted",true);this.setUserAnswer();t.trigger("notify:popup",i);$(".notify-popup").addClass(this.model.get("_component"));$(".notify-popup").attr("data-adapt-id",this.model.get("_id"))},setUserAnswer:function(){var e;_.each(this.$(".balloonActivity-text"),function(t,i){if(!$(t).hasClass("display-none")){e=$(t).attr("data-id")}},this);console.log(e);this.model.set("_itemEnabled",e)},onCannotSubmit:function(){},showMarking:function(){if(!this.model.get("_canShowMarking"))return},resetQuestion:function(){this.deselectAllItems();this.resetItems()},deselectAllItems:function(){},resetItems:function(){},showCorrectAnswer:function(){},setOptionSelected:function(e,t){},hideCorrectAnswer:function(){}});return s});define("components/adapt-balloonActivity/js/balloonActivityModel",["core/js/models/questionModel"],function(e){var t=e.extend({init:function(){e.prototype.init.call(this)},setupQuestionItemIndexes:function(){var e=this.get("_items");if(e&&e.length>0){for(var t=0,i=e.length;t<i;t++){if(e[t]._index===undefined)e[t]._index=t}}},restoreUserAnswers:function(){if(!this.get("_isSubmitted"))return},setupRandomisation:function(){if(this.get("_isRandom")&&this.get("_isEnabled")){this.set("_items",_.shuffle(this.get("_items")))}}});return t});define("components/adapt-balloonActivity/js/adapt-balloonActivity",["core/js/adapt","./balloonActivityView","./balloonActivityModel"],function(e,t,i){return e.register("balloonActivity",{view:t,model:i})});define("components/adapt-clickAndLearn-horizontal/js/adapt-clickAndLearn-horizontal",["coreViews/componentView","coreJS/adapt"],function(e,t){var i=e.extend({events:{"click .adapt-clickAndLearn-horizontal-indicator":"onClickDisplayItem","click .adapt-clickAndLearn-horizontal-popup-close":"onClickCloseItem"},preRender:function(){this.listenTo(t,"device:resize",this.resizeControl,this);this.listenTo(t,"notify:closed",this.closeNotify,this);if(t.device.screenSize!=="large"){var e=this.model.get("mobileInstruction");this.model.set("instruction",e)}},resizeControl:function(){this.setDeviceSize();var e=this.$(".adapt-clickAndLearn-horizontal-tabViewContainer");if(!this.model.get("_isDesktop")){e.hide()}else if(this.getVisitedItems().length>0){e.show()}},setDeviceSize:function(){if(t.device.screenSize==="large"){this.$el.addClass("desktop").removeClass("mobile");this.model.set("_isDesktop",true)}else{this.$el.addClass("mobile").removeClass("desktop");this.model.set("_isDesktop",false)}},postRender:function(){this.setDeviceSize();var e=this.model.get("_flag");if(e=="horizontal"){this.$(".adapt-clickAndLearn-horizontal-container").addClass("adapt-clickAndLearn-horizontal-horizontal");this.setHorizontalWidth()}else if(e=="vertical"){this.$(".adapt-clickAndLearn-horizontal-container").addClass("adapt-clickAndLearn-horizontal-vertical");this.setVerticalWidth()}this.$(".adapt-clickAndLearn-horizontal-tabViewContainer").show();this.$(".adapt-clickAndLearn-horizontal-widget").imageready(_.bind(function(){this.setReadyStatus()},this))},setHorizontalWidth:function(){this.$(".adapt-clickAndLearn-horizontal-content").css("width",this.model.get("_itemWidth")+"%")},setVerticalWidth:function(){this.$(".adapt-clickAndLearn-horizontal-navContainer").css("width",this.model.get("_itemWidth")+"%")},checkIfResetOnRevisit:function(){var e=this.model.get("_isResetOnRevisit");if(e){this.model.reset(e)}_.each(this.model.get("_items"),function(e){e._isVisited=false})},onClickDisplayItem:function(e){if(e&&e.preventDefault)e.preventDefault();var t=$(e.currentTarget);var i=this.$(".adapt-clickAndLearn-horizontal-indicator").index(t);this.setDeviceSize();var s=this.$(".adapt-clickAndLearn-horizontal-tabViewContainer");if(!this.model.get("_isDesktop")){s.hide()}else if(this.getVisitedItems().length>0){s.show()}this.$(".adapt-clickAndLearn-horizontal-navContainer .adapt-clickAndLearn-horizontal-indicator").removeClass("adapt-clickAndLearn-horizontal-indicatorActive");if(t.hasClass("adapt-clickAndLearn-horizontal-indicator-img")){t.closest(".adapt-clickAndLearn-horizontal-indicator").addClass("adapt-clickAndLearn-horizontal-indicatorActive")}else{t.addClass("adapt-clickAndLearn-horizontal-indicatorActive")}this.$(".adapt-clickAndLearn-horizontal-tabViewContainer .adapt-clickAndLearn-horizontal-tabItem:eq("+i+")").show();t.closest(".adapt-clickAndLearn-horizontal-indicator").attr("background-color","red");if(!this.model.get("_isDesktop")){this.openPopup(i)}t.css({background:"#3a3939",cursor:"auto"});this.setVisited(i)},openPopup:function(e){var i=this.getCurrentItem(e);var s={title:i.title,body:i.body};i._isVisited=true;t.trigger("notify:popup",s)},closeNotify:function(){this.checkCompletionStatus()},onClickCloseItem:function(e){if(e&&e.preventDefault)e.preventDefault();this.$(".adapt-clickAndLearn-horizontal-popup-close").blur();this.$(".adapt-clickAndLearn-horizontal-popup").addClass("display-none")},setVisited:function(e){var t=this.model.get("_items")[e];t._isVisited=true;this.checkCompletionStatus()},getCurrentItem:function(e){return this.model.get("_items")[e]},getVisitedItems:function(){return _.filter(this.model.get("_items"),function(e){return e._isVisited})},checkCompletionStatus:function(){if(this.getVisitedItems().length===this.model.get("_items").length){this.setCompletionStatus()}}});t.register("adapt-clickAndLearn-horizontal",i);return i});define("components/adapt-contrib-accordion/js/adapt-contrib-accordion",["require","coreViews/componentView","coreJS/adapt"],function(e){var t=e("coreViews/componentView");var i=e("coreJS/adapt");var s=t.extend({events:{"click .accordion-item-title":"toggleItem"},toggleSpeed:200,preRender:function(){this.checkIfResetOnRevisit()},postRender:function(){this.setReadyStatus()},checkIfResetOnRevisit:function(){var e=this.model.get("_isResetOnRevisit");if(e){this.model.reset(e);_.each(this.model.get("_items"),function(e){e._isVisited=false})}},toggleItem:function(e){e.preventDefault();var t=$(e.currentTarget);var i=t.parent(".accordion-item");var s=t.hasClass("selected");if(this.model.get("_shouldCollapseItems")===false){this.closeItem(i)}else{var n=this.$(".accordion-item");var r=n.length;for(var o=0;o<r;o++){this.closeItem($(n[o]))}}if(!s){this.openItem(i)}},closeItem:function(e){if(!e){return false;
}var t=$(".accordion-item-body",e).first();var i=$("button",e).first();var s=$(".accordion-item-title-icon",e).first();t.stop(true,true).slideUp(this.toggleSpeed);i.removeClass("selected");i.attr("aria-expanded",false);s.addClass("icon-plus");s.removeClass("icon-minus")},openItem:function(e){if(!e){return false}var t=$(".accordion-item-body",e).first();var s=$("button",e).first();var n=$(".accordion-item-title-icon",e).first();t=t.stop(true,true).slideDown(this.toggleSpeed,function(){var e=i.config.get("_accessibility");if(!e||!e._isActive)return;_.delay(function(){t.a11y_focus()},500)});s.addClass("selected");s.attr("aria-expanded",true);this.setVisited(e.index());s.addClass("visited");n.removeClass("icon-plus");n.addClass("icon-minus")},setVisited:function(e){var t=this.model.get("_items")[e];t._isVisited=true;this.checkCompletionStatus()},getVisitedItems:function(){return _.filter(this.model.get("_items"),function(e){return e._isVisited})},checkCompletionStatus:function(){if(this.getVisitedItems().length==this.model.get("_items").length){this.setCompletionStatus()}}});i.register("accordion",s);return s});define("components/adapt-contrib-analysis/js/adapt-contrib-analysis",["require","coreViews/questionView","coreJS/adapt"],function(e){var t=e("coreViews/questionView");var i=e("coreJS/adapt");var s=t.extend({events:{"focus .analysis-item input":"onItemFocus","blur .analysis-item input":"onItemBlur","change .analysis-item input":"onItemSelected","keyup .analysis-item input":"onKeyPress"},resetQuestionOnRevisit:function(){this.setAllItemsEnabled(true);this.resetQuestion()},setupQuestion:function(){this.model.set("_selectedItems",[]);this.setupQuestionItemIndexes();this.setupRandomisation();this.restoreUserAnswers()},setupQuestionItemIndexes:function(){var e=this.model.get("_items");for(var t=0,i=e.length;t<i;t++){if(e[t]._index===undefined)e[t]._index=t}},setupRandomisation:function(){if(this.model.get("_isRandom")&&this.model.get("_isEnabled")){this.model.set("_items",_.shuffle(this.model.get("_items")))}},restoreUserAnswers:function(){if(!this.model.get("_isSubmitted"))return;var e=[];var t=this.model.get("_items");var i=this.model.get("_userAnswer");_.each(t,function(t,s){t._isSelected=i[t._index];if(t._isSelected){e.push(t)}});this.model.set("_selectedItems",e);this.setQuestionAsSubmitted();this.markQuestion();this.setScore();this.showMarking();this.setupFeedback()},disableQuestion:function(){this.setAllItemsEnabled(false)},enableQuestion:function(){this.setAllItemsEnabled(true)},setAllItemsEnabled:function(e){_.each(this.model.get("_items"),function(t,i){var s=this.$("label").eq(i);var n=this.$("input").eq(i);if(e){s.removeClass("disabled");n.prop("disabled",false)}else{s.addClass("disabled");n.prop("disabled",true)}},this)},onQuestionRendered:function(){this.setReadyStatus()},onKeyPress:function(e){if(e.which===13){this.onItemSelected(e)}},onItemFocus:function(e){if(this.model.get("_isEnabled")&&!this.model.get("_isSubmitted")){$("label[for='"+$(e.currentTarget).attr("id")+"']").addClass("highlighted")}},onItemBlur:function(e){$("label[for='"+$(e.currentTarget).attr("id")+"']").removeClass("highlighted")},onItemSelected:function(e){if(this.model.get("_isEnabled")&&!this.model.get("_isSubmitted")){var t=this.model.get("_items")[$(e.currentTarget).parent(".component-item").index()];this.toggleItemSelected(t,e)}},toggleItemSelected:function(e,t){var i=this.model.get("_selectedItems");var s=_.indexOf(this.model.get("_items"),e),n=this.$("label").eq(s),r=this.$("input").eq(s),o=!n.hasClass("selected");if(o){if(this.model.get("_selectable")===1){this.$("label").removeClass("selected");this.$("input").prop("checked",false);this.deselectAllItems();i[0]=e}else if(i.length<this.model.get("_selectable")){i.push(e)}else{t.preventDefault();return}n.addClass("selected");n.a11y_selected(true)}else{i.splice(_.indexOf(i,e),1);n.removeClass("selected");n.a11y_selected(false)}r.prop("checked",o);e._isSelected=o;this.model.set("_selectedItems",i)},canSubmit:function(){var e=0;_.each(this.model.get("_items"),function(t){if(t._isSelected){e++}},this);return e>0?true:false},onCannotSubmit:function(){},storeUserAnswer:function(){var e=[];var t=this.model.get("_items").slice(0);t.sort(function(e,t){return e._index-t._index});_.each(t,function(t,i){e.push(t._isSelected)},this);this.model.set("_userAnswer",e)},isCorrect:function(){var e=0;var t=0;var i=0;var s=0;_.each(this.model.get("_items"),function(n,r){var o=n._isSelected||false;if(n._shouldBeSelected){e++;if(o){t++;n._isCorrect=true;this.model.set("_isAtLeastOneCorrectSelection",true)}}else i++;if(!n._shouldBeSelected&&o){s++}},this);this.model.set("_correctSelected",t);this.model.set("_correctRquired",e);this.model.set("_inCorrectSelected",s);this.model.set("_inCorrectRquired",i);var n=t===e&&s===0;return n},setScore:function(){var e=this.model.get("_questionWeight");var t=this.model.get("_isCorrect");var i=t?e:0;this.model.set("_score",i)},setupFeedback:function(){var e=0;var t=0;var i=null;e=this.model.get("_correctSelected")/this.model.get("_correctRquired")*100;t=this.model.get("_inCorrectSelected")/this.model.get("_inCorrectRquired")*100;if(e<60&&t>=60){i={title:this.model.get("_feedback").title,body:this.model.get("_feedback").first}}else if(e>=60&&t<60){i={title:this.model.get("_feedback").title,body:this.model.get("_feedback").second}}else if(e>=60&&t>=60){i={title:this.model.get("_feedback").title,body:this.model.get("_feedback").third}}else if(e<=60&&t<=60){i={title:this.model.get("_feedback").title,body:this.model.get("_feedback").fourth}}this.model.set("feedbackMessage",i.body);this.model.get("feedbackTitle",i.title)},setupIndividualFeedback:function(e){this.model.set({feedbackTitle:this.model.get("title"),feedbackMessage:e.feedback})},showMarking:function(){_.each(this.model.get("_items"),function(e,t){var i=this.$(".component-item").eq(t);i.removeClass("correct incorrect").addClass(e._isCorrect?"correct":"incorrect")},this)},isPartlyCorrect:function(){return this.model.get("_isAtLeastOneCorrectSelection")},resetUserAnswer:function(){this.model.set({_userAnswer:[]})},resetQuestion:function(){this.deselectAllItems();this.resetItems()},deselectAllItems:function(){this.$el.a11y_selected(false);_.each(this.model.get("_items"),function(e){e._isSelected=false},this)},resetItems:function(){this.$(".component-item label").removeClass("selected");this.$(".component-item").removeClass("correct incorrect");this.$("input").prop("checked",false);this.model.set({_selectedItems:[],_isAtLeastOneCorrectSelection:false})},showCorrectAnswer:function(){_.each(this.model.get("_items"),function(e,t){this.setOptionSelected(t,e._shouldBeSelected)},this)},setOptionSelected:function(e,t){var i=this.$("label").eq(e);var s=this.$("input").eq(e);if(t){i.addClass("selected");s.prop("checked",true)}else{i.removeClass("selected");s.prop("checked",false)}},hideCorrectAnswer:function(){_.each(this.model.get("_items"),function(e,t){this.setOptionSelected(t,this.model.get("_userAnswer")[e._index])},this)},getResponse:function(){var e=_.where(this.model.get("_items"),{_isSelected:true});var t=_.pluck(e,"_index");for(var i=0,s=t.length;i<s;i++){t[i]++}return t.join(",")},getResponseType:function(){return"choice"}});i.register("analysis",s);return s});define("components/adapt-contrib-assessmentResults/js/adapt-contrib-assessmentResults",["core/js/adapt","core/js/views/componentView"],function(e,t){var i=t.extend({events:{inview:"onInview","click .results-retry-button button":"onRetry","click .homeButton":"navigateToHome","click .review-answer":"reviewAnswer"},preRender:function(){if(this.model.setLocking)this.model.setLocking("_isVisible",false);this.saveOriginalTexts();this.setupEventListeners();this.setupModelResetEvent();this.checkIfComplete();this.checkIfVisible();this.counter=0},saveOriginalTexts:function(){this.model.set({originalTitle:this.model.get("title"),originalBody:this.model.get("body"),originalInstruction:this.model.get("instruction")})},navigateToHome:function(t){t.preventDefault();var i=t.currentTarget.dataset.id;if(i){e.navigateToElement("."+i,{duration:1e3})}else{e.trigger("navigation:homeButton")}},reviewAnswer:function(t){t.preventDefault();var i=e.assessment.get(this.model.get("_assessmentId"));e.navigateToElement("."+i.get("_children").models[1].get("_id"),{duration:1e3});$("."+i.get("_id")).removeClass("for-marking")},checkIfVisible:function(){if(!e.assessment){return false}var t=this.model.get("_isVisibleBeforeCompletion")||false;var i=false;var s=this.model.get("_isVisible");var n=e.assessment.get(this.model.get("_assessmentId"));if(!n||n.length===0)return;var r=n.getState();var o=r.isComplete;var a=r.attemptInProgress;var l=r.attemptsSpent;var c=!a&&l>0;i=t&&!o||c;if(!s&&i)i=false;this.model.set("_isVisible",i,{pluginName:"assessmentResults"})},checkIfComplete:function(){if(!e.assessment){return false}var t=e.assessment.get(this.model.get("_assessmentId"));if(!t||t.length===0)return;var i=t.getState();if(i.isComplete){this.onAssessmentsComplete(i)}else{this.model.reset("hard",true)}},setupModelResetEvent:function(){if(this.model.onAssessmentsReset)return;this.model.onAssessmentsReset=function(e){if(this.get("_assessmentId")===undefined||this.get("_assessmentId")!=e.id)return;this.reset("hard",true)};this.model.listenTo(e,"assessments:reset",this.model.onAssessmentsReset)},postRender:function(){this.setReadyStatus();this.showCustomFeedback(this.model.get("_state"));if($("#LearnerName")[0].innerHTML==" "&&this.counter==0){var e=document.getElementById("toPrint").innerHTML;if($(".pDiv").length==0){$("#wrapper").parent().prepend('<div class="pDiv">'+e+"</div>");this.counter++}}$(".pDiv").hide();$("#toPrint").hide()},setupEventListeners:function(){this.listenTo(e,"assessments:complete",this.onAssessmentsComplete);this.listenToOnce(e,"remove",this.onRemove)},removeEventListeners:function(){this.stopListening(e,"assessments:complete",this.onAssessmentsComplete);this.stopListening(e,"remove",this.onRemove)},onAssessmentsComplete:function(e){if(this.model.get("_assessmentId")===undefined||this.model.get("_assessmentId")!=e.id)return;this.model.set({_state:e,attempts:e.attempts,attemptsSpent:e.attemptsSpent,attemptsLeft:e.attemptsLeft,score:e.score,scoreAsPercent:e.scoreAsPercent,maxScore:e.maxScore,isPass:e.isPass});var t=this.getFeedbackBand();this.setFeedback(t);this.addClassesToArticle(t);this.render();this.show();this.showCustomFeedback(e)},showCustomFeedback:function(e){if(!e)return;if(e.attemptsLeft==0||e.isPass){this.$(".review-answer").removeClass("display-none")}if(!e.isPass){if(e.attemptsSpent%2==0){this.$(".results-widget").html(this.model.get("_customFeedback").second.replace(/{{scoreAsPercent}}/gi,e.scoreAsPercent))}else{this.$(".assessmentResults-body-inner").html(this.model.get("_customFeedback").first.replace(/{{scoreAsPercent}}/gi,e.scoreAsPercent))}}},onAssessmentComplete:function(e){this.model.set("_state",e);var t=this.getFeedbackBand();this.setFeedback(t);this.addClassesToArticle(t);this.render();this.show()},onInview:function(e,t,i,s){if(t){if(s==="top"){this._isVisibleTop=true}else if(s==="bottom"){this._isVisibleBottom=true}else{this._isVisibleTop=true;this._isVisibleBottom=true}if(this._isVisibleTop||this._isVisibleBottom){this.setCompletionStatus();if(this.model.get("_isComplete")){this.$el.off("inview")}}}},onRetry:function(){var t=this.model.get("_state");var i=e.assessment.get(t.id);this.restoreOriginalTexts();i.reset();if(!t.isPass&&t.attemptsSpent%this.model.get("resetAfterAttempts")==0){this.resetPageProgress();return}},resetPageProgress:function(){if(this.model.get("resetPageId")){e.trigger("reset:progress",this.model.get("resetPageId"))}},restoreOriginalTexts:function(){this.model.set({title:this.model.get("originalTitle"),body:this.model.get("originalBody"),instruction:this.model.get("originalInstruction")})},show:function(){if(!this.model.get("_isVisible")){this.model.set("_isVisible",true,{pluginName:"assessmentResults"})}},setFeedback:function(e){var t=this.model.get("_state");t.feedbackBand=e;this.model.set("feedback",Handlebars.compile(e.feedback)(this.model.toJSON()));this.checkRetryEnabled();this.model.set("body",this.model.get("_completionBody"))},addClassesToArticle:function(e){if(!e.hasOwnProperty("_classes"))return;this.$el.parents(".article").addClass(e._classes)},getFeedbackBand:function(){var e=this.model.get("_state");var t=e.isPercentageBased?"scoreAsPercent":"score";var i=_.sortBy(this.model.get("_bands"),"_score");for(var s=i.length-1;s>=0;s--){if(e[t]>=i[s]._score){return i[s]}}return""},checkRetryEnabled:function(){var t=this.model.get("_state");var i=e.assessment.get(t.id);if(!i.canResetInPage())return false;var s=t.feedbackBand._allowRetry!==false;var n=t.attemptsLeft>0||t.attemptsLeft==="infinite";var r=s&&n;this.model.set("_isRetryEnabled",r);if(r){var o=this.model.get("_retry").feedback;this.model.set("retryFeedback",o)}else{this.model.set("retryFeedback","")}},onRemove:function(){if(this.model.unsetLocking)this.model.unsetLocking("_isVisible");this.removeEventListeners()},printCertificate:function(e){var t=pipwerks.SCORM.data.get("cmi.learner_name");var i=pipwerks.SCORM.data.get("cmi.learner_id");var s=pipwerks.SCORM.data.get("cmi.score.raw");var n=document.getElementById("LearnerName");var r=document.getElementById("LearnerID");var o=document.getElementById("score");if(t=="undefined"||t==""){t=pipwerks.SCORM.data.get("cmi.core.student_name");if(t=="undefined"){t=" "}}if(i=="undefined"||i==""){i=pipwerks.SCORM.data.get("cmi.core.student_id");if(i=="undefined"){i=" "}}if(s=="undefined"||s==""){s=pipwerks.SCORM.data.get("cmi.core.score.raw");if(s=="undefined"){s=" "}}$("#LearnerName").html(t||"Student_Name");$("#LearnerID").html(i||"stud@name");$("#score").html(this.model.get("_state").scoreAsPercent+"%");this.populateDate();this.printDiv()},populateDate:function(){var e=new Date;var t=e.getDate();var i=Number(e.getMonth()+1);var s=e.getFullYear();var n=i+"/"+t+"/"+s;$("#dateBlock").html(n)},printDiv:function(){$("#wrapper").addClass("display-none");$(".navigation").addClass("display-none");$(".pDiv").show();window.print();var t=this;var i=$("html").hasClass("ipad")?1e3:200;setTimeout(function(){$("#wrapper").removeClass("display-none");$(".navigation").removeClass("display-none");e.navigateToElement("."+t.model.get("_id"),{duration:0});$(".pDiv").hide()},i)},openPopup:function(){var t={title:"",body:$(".pDiv").html()};e.trigger("notify:popup",t)}},{template:"assessmentResults"});e.register("assessmentResults",i);return i});define("components/adapt-contrib-blank/js/adapt-contrib-blank",["require","coreViews/componentView","coreJS/adapt"],function(e){var t=e("coreViews/componentView");var i=e("coreJS/adapt");var s=t.extend({preRender:function(){this.$el.addClass("no-state");this.checkIfResetOnRevisit()},postRender:function(){this.setReadyStatus();this.$(".component-inner").on("inview",_.bind(this.inview,this))},checkIfResetOnRevisit:function(){var e=this.model.get("_isResetOnRevisit");if(e){this.model.reset(e)}},inview:function(e,t,i,s){if(t){if(s==="top"){this._isVisibleTop=true}else if(s==="bottom"){this._isVisibleBottom=true}else{this._isVisibleTop=true;this._isVisibleBottom=true}if(this._isVisibleTop&&this._isVisibleBottom){this.$(".component-inner").off("inview");this.setCompletionStatus()}}}});i.register("blank",s);return s});define("components/adapt-contrib-clickAndLearn/js/adapt-contrib-clickAndLearn",["coreViews/componentView","coreJS/adapt"],function(e,t){var i=e.extend({events:{"click .clickAndLearn-indicator":"onClickDisplayItem","click .clickAndLearn-popup-close":"onClickCloseItem"},preRender:function(){this.listenTo(t,"device:resize",this.resizeControl,this);this.listenTo(t,"notify:closed",this.closeNotify,this);if(t.device.screenSize!=="large"){var e=this.model.get("mobileInstruction");this.model.set("instruction",e)}},resizeControl:function(){this.setDeviceSize();var e=this.$(".clickAndLearn-tabViewContainer");if(!this.model.get("_isDesktop")){e.hide()}else if(this.getVisitedItems().length>0){e.show()}},setDeviceSize:function(){if(t.device.screenSize==="large"){this.$el.addClass("desktop").removeClass("mobile");this.model.set("_isDesktop",true)}else{this.$el.addClass("mobile").removeClass("desktop");this.model.set("_isDesktop",false)}},postRender:function(){this.setDeviceSize();var e=this.model.get("_flag");if(e=="horizontal"){this.$(".clickAndLearn-container").addClass("clickAndLearn-horizontal");this.setHorizontalWidth()}else if(e=="vertical"){this.$(".clickAndLearn-container").addClass("clickAndLearn-vertical");this.setVerticalWidth()}this.$(".clickAndLearn-tabViewContainer").show();this.$(".clickAndLearn-widget").imageready(_.bind(function(){this.setReadyStatus()},this))},setHorizontalWidth:function(){this.$(".clickAndLearn-content").css("width",this.model.get("_itemWidth")+"%")},setVerticalWidth:function(){this.$(".clickAndLearn-navContainer").css("width",this.model.get("_itemWidth")+"%")},checkIfResetOnRevisit:function(){var e=this.model.get("_isResetOnRevisit");if(e){this.model.reset(e)}_.each(this.model.get("_items"),function(e){e._isVisited=false})},onClickDisplayItem:function(e){if(e&&e.preventDefault)e.preventDefault();var t=$(e.currentTarget);var i=this.$(".clickAndLearn-indicator").index(t);this.setDeviceSize();var s=this.$(".clickAndLearn-tabViewContainer");if(!this.model.get("_isDesktop")){s.hide()}else if(this.getVisitedItems().length>0){s.show()}else s.show();this.$(".clickAndLearn-navContainer .clickAndLearn-indicator").removeClass("clickAndLearn-indicatorActive");if(t.hasClass("clickAndLearn-indicator-img")){t.closest(".clickAndLearn-indicator").addClass("clickAndLearn-indicatorActive")}else{t.addClass("clickAndLearn-indicatorActive")}this.$(".clickAndLearn-tabViewContainer .clickAndLearn-tabItem:eq("+i+")").show();if(!this.model.get("_isDesktop")){this.openPopup(i)}console.log("indicatorIndex",i);this.$(".clickAndLearn-indicator").eq(i).addClass("visited");this.setVisited(i)},openPopup:function(e){var i=this.getCurrentItem(e);var s={title:i.title,body:i.body};i._isVisited=true;t.trigger("notify:popup",s)},closeNotify:function(){this.checkCompletionStatus()},onClickCloseItem:function(e){if(e&&e.preventDefault)e.preventDefault();this.$(".clickAndLearn-popup-close").blur();this.$(".clickAndLearn-popup").addClass("display-none")},setVisited:function(e){var t=this.model.get("_items")[e];t._isVisited=true;this.checkCompletionStatus()},getCurrentItem:function(e){return this.model.get("_items")[e]},getVisitedItems:function(){return _.filter(this.model.get("_items"),function(e){return e._isVisited})},checkCompletionStatus:function(){if(this.getVisitedItems().length===this.model.get("_items").length){this.setCompletionStatus()}}});t.register("clickAndLearn",i);return i});define("components/adapt-contrib-flipcard/js/adapt-contrib-flipcard",["coreViews/componentView","coreJS/adapt"],function(e,t){var i=e.extend({events:{"click .flipcard-item":"onClickFlipItem"},preRender:function(){this.listenTo(t,"device:resize",this.reRender,this);this.checkIfResetOnRevisit()},postRender:function(){if(!Modernizr.testProp("transformStyle","preserve-3d")){this.$(".flipcard-item-back").hide()}this.$(".flipcard-widget").imageready(_.bind(function(){this.setReadyStatus();this.reRender()},this))},checkIfResetOnRevisit:function(){var e=this.model.get("_isResetOnRevisit");if(e){this.model.reset(e)}_.each(this.model.get("_items"),function(e){e._isVisited=false})},reRender:function(){var e=this.$(".flipcard-item-frontImage").eq(0).height();if(e){this.$(".flipcard-item").height(e)}},onClickFlipItem:function(e){if(e&&e.target.tagName.toLowerCase()==="a"){return}else{e&&e.preventDefault()}var t=$(e.currentTarget);var i=this.model.get("_flipType");if(i==="allFlip"){this.performAllFlip(t)}else if(i==="singleFlip"){this.performSingleFlip(t)}},performAllFlip:function(e){if(!Modernizr.testProp("transformStyle","preserve-3d")){var t=e.find(".flipcard-item-front");var i=e.find(".flipcard-item-back");var s=this.model.get("_flipTime")||"fast";if(t.is(":visible")){t.fadeOut(s,function(){i.fadeIn(s)})}else if(i.is(":visible")){i.fadeOut(s,function(){t.fadeIn(s)})}}else{e.toggleClass("flipcard-flip")}var n=this.$(".flipcard-item").index(e);this.setVisited(n)},performSingleFlip:function(e){var t=e.closest(".flipcard-widget");if(!Modernizr.testProp("transformStyle","preserve-3d")){var i=e.find(".flipcard-item-front");var s=e.find(".flipcard-item-back");var n=this.model.get("_flipTime")||"fast";if(s.is(":visible")){s.fadeOut(n,function(){i.fadeIn(n)})}else{var r=t.find(".flipcard-item-back:visible");if(r.length>0){r.fadeOut(n,function(){t.find(".flipcard-item-front:hidden").fadeIn(n)})}i.fadeOut(n,function(){s.fadeIn(n)})}}else{if(e.hasClass("flipcard-flip")){e.removeClass("flipcard-flip")}else{t.find(".flipcard-item").removeClass("flipcard-flip");e.addClass("flipcard-flip")}}var o=this.$(".flipcard-item").index(e);this.setVisited(o)},setVisited:function(e){var t=this.model.get("_items")[e];t._isVisited=true;this.checkCompletionStatus()},getVisitedItems:function(){return _.filter(this.model.get("_items"),function(e){return e._isVisited})},checkCompletionStatus:function(){if(this.getVisitedItems().length===this.model.get("_items").length){this.setCompletionStatus()}}});t.register("flipcard",i);return i});define("components/adapt-contrib-mcq/js/mcqView",["core/js/views/questionView"],function(e){var t=e.extend({events:{"focus .mcq-item input":"onItemFocus","blur .mcq-item input":"onItemBlur","change .mcq-item input":"onItemSelected","keyup .mcq-item input":"onKeyPress"},resetQuestionOnRevisit:function(){this.setAllItemsEnabled(true);this.resetQuestion()},setupQuestion:function(){this.model.setupRandomisation()},disableQuestion:function(){this.setAllItemsEnabled(false)},enableQuestion:function(){this.setAllItemsEnabled(true)},setAllItemsEnabled:function(e){_.each(this.model.get("_items"),function(t,i){var s=this.$("label").eq(i);var n=this.$("input").eq(i);if(e){s.removeClass("disabled");n.prop("disabled",false)}else{s.addClass("disabled");n.prop("disabled",true)}},this)},onQuestionRendered:function(){this.setReadyStatus();if(!this.model.get("_isSubmitted"))return;this.showMarking()},onKeyPress:function(e){if(e.which===13){this.onItemSelected(e)}},onItemFocus:function(e){if(this.model.get("_isEnabled")&&!this.model.get("_isSubmitted")){$("label[for='"+$(e.currentTarget).attr("id")+"']").addClass("highlighted")}},onItemBlur:function(e){$("label[for='"+$(e.currentTarget).attr("id")+"']").removeClass("highlighted")},onItemSelected:function(e){if(this.model.get("_isEnabled")&&!this.model.get("_isSubmitted")){var t=this.model.get("_items")[$(e.currentTarget).parent(".component-item").index()];this.toggleItemSelected(t,e)}},toggleItemSelected:function(e,t){var i=this.model.get("_selectedItems");var s=_.indexOf(this.model.get("_items"),e),n=this.$("label").eq(s),r=this.$("input").eq(s),o=!n.hasClass("selected");if(o){if(this.model.get("_selectable")===1){this.$("label").removeClass("selected");this.$("input").prop("checked",false);this.deselectAllItems();i[0]=e}else if(i.length<this.model.get("_selectable")){i.push(e)}else{t.preventDefault();return}n.addClass("selected")}else{i.splice(_.indexOf(i,e),1);n.removeClass("selected")}r.prop("checked",o);e._isSelected=o;this.model.set("_selectedItems",i)},onCannotSubmit:function(){},showMarking:function(){if(!this.model.get("_canShowMarking"))return;_.each(this.model.get("_items"),function(e,t){var i=this.$(".component-item").eq(t);i.removeClass("correct incorrect").addClass(e._shouldBeSelected?"correct":"incorrect")},this)},resetQuestion:function(){this.deselectAllItems();this.resetItems()},deselectAllItems:function(){this.model.deselectAllItems()},resetItems:function(){this.$(".component-item label").removeClass("selected");this.$(".component-item").removeClass("correct incorrect");this.$("input").prop("checked",false);this.model.resetItems()},showCorrectAnswer:function(){_.each(this.model.get("_items"),function(e,t){this.setOptionSelected(t,e._shouldBeSelected)},this)},setOptionSelected:function(e,t){var i=this.$("label").eq(e);var s=this.$("input").eq(e);if(t){i.addClass("selected");s.prop("checked",true)}else{i.removeClass("selected");s.prop("checked",false)}},hideCorrectAnswer:function(){_.each(this.model.get("_items"),function(e,t){this.setOptionSelected(t,this.model.get("_userAnswer")[e._index])},this)}});return t});define("components/adapt-contrib-mcq/js/mcqModel",["core/js/models/questionModel"],function(e){var t=e.extend({init:function(){e.prototype.init.call(this);this.set("_isRadio",this.get("_selectable")==1);this.set("_selectedItems",[]);this.setupQuestionItemIndexes()},setupQuestionItemIndexes:function(){var e=this.get("_items");if(e&&e.length>0){for(var t=0,i=e.length;t<i;t++){if(e[t]._index===undefined)e[t]._index=t}}},restoreUserAnswers:function(){if(!this.get("_isSubmitted"))return;var e=[];var t=this.get("_items");var i=this.get("_userAnswer");_.each(t,function(t,s){t._isSelected=i[t._index];if(t._isSelected){e.push(t)}});this.set("_selectedItems",e);this.setQuestionAsSubmitted();this.markQuestion();this.setScore();this.setupFeedback()},setupRandomisation:function(){if(this.get("_isRandom")&&this.get("_isEnabled")){this.set("_items",_.shuffle(this.get("_items")))}},canSubmit:function(){var e=0;_.each(this.get("_items"),function(t){if(t._isSelected){e++}},this);return e>0?true:false},storeUserAnswer:function(){var e=[];var t=this.get("_items").slice(0);t.sort(function(e,t){return e._index-t._index});_.each(t,function(t,i){e.push(t._isSelected)},this);this.set("_userAnswer",e)},isCorrect:function(){var e=0;var t=0;var i=0;_.each(this.get("_items"),function(s,n){var r=s._isSelected||false;if(s._shouldBeSelected){e++;if(r){t++;s._isCorrect=true;this.set("_isAtLeastOneCorrectSelection",true)}}else if(!s._shouldBeSelected&&r){s._isCorrect=false;i++}},this);this.set("_numberOfCorrectAnswers",t);this.set("_numberOfRequiredAnswers",e);var s=t===e&&i===0;return s},setScore:function(){var e=this.get("_questionWeight");var t=this.get("_isCorrect");var i=t?e:0;this.set("_score",i)},setupFeedback:function(){if(this.get("_isCorrect")){this.setupCorrectFeedback()}else if(this.isPartlyCorrect()){this.setupPartlyCorrectFeedback()}else{if(this.get("_selectable")===1&&this.get("_selectedItems")[0].feedback){this.setupIndividualFeedback(this.get("_selectedItems")[0]);return}else{this.setupIncorrectFeedback()}}},setupIndividualFeedback:function(e){this.set({feedbackTitle:this.getFeedbackTitle(this.get("_feedback")),feedbackMessage:e.feedback})},isPartlyCorrect:function(){return this.get("_isAtLeastOneCorrectSelection")},resetUserAnswer:function(){this.set({_userAnswer:[]})},deselectAllItems:function(){_.each(this.get("_items"),function(e){e._isSelected=false},this)},resetItems:function(){this.set({_selectedItems:[],_isAtLeastOneCorrectSelection:false})},getInteractionObject:function(){var e={correctResponsesPattern:[],choices:[]};e.choices=this.get("_items").map(function(e){return{id:(e._index+1).toString(),description:e.text}});var t=_.filter(this.get("_items"),function(e){return e._shouldBeSelected});e.correctResponsesPattern=[_.pluck(t,"_index").map(function(e){return(e+1).toString()}).join("[,]")];return e},getResponse:function(){var e=_.where(this.get("_items"),{_isSelected:true});var t=_.pluck(e,"_index");for(var i=0,s=t.length;i<s;i++){t[i]++}return t.join(",")},getResponseType:function(){return"choice"}});return t});define("components/adapt-contrib-mcq/js/adapt-contrib-mcq",["core/js/adapt","./mcqView","./mcqModel"],function(e,t,i){return e.register("mcq",{view:t,model:i})});define("components/adapt-contrib-gmcq/js/adapt-contrib-gmcq",["coreJS/adapt","components/adapt-contrib-mcq/js/adapt-contrib-mcq"],function(e,t){var i=t.view.extend({events:{"focus .gmcq-item input":"onItemFocus","blur .gmcq-item input":"onItemBlur","change .gmcq-item input":"onItemSelected","keyup .gmcq-item input":"onKeyPress"},onItemSelected:function(e){var t=this.model.get("_items")[$(e.currentTarget).parent(".gmcq-item").index()];if(this.model.get("_isEnabled")&&!this.model.get("_isSubmitted")){this.toggleItemSelected(t,e)}},setupQuestion:function(){t.view.prototype.setupQuestion.call(this);this.listenTo(e,{"device:changed":this.resizeImage,"device:resize":this.onDeviceResize})},onQuestionRendered:function(){this.resizeImage(e.device.screenSize);this.setUpColumns();this.$("label").imageready(_.bind(function(){this.setReadyStatus()},this))},onDeviceResize:function(){this.setUpColumns()},resizeImage:function(e){var t=e==="medium"?"small":e;this.$("label").each(function(e){var i=$(this).find("img").attr("data-"+t);$(this).find("img").attr("src",i)})},setUpColumns:function(){var t=this.model.get("_columns");if(!t)return;if(e.device.screenSize==="large"){this.$el.addClass("gmcq-column-layout");this.$(".gmcq-item").css("width",100/t+"%")}else{this.$el.removeClass("gmcq-column-layout");this.$(".gmcq-item").css("width","")}}},{template:"gmcq"});return e.register("gmcq",{view:i,model:t.model.extend({})})});define("components/adapt-contrib-graphic/js/adapt-contrib-graphic",["require","coreViews/componentView","coreJS/adapt"],function(e){var t=e("coreViews/componentView");var i=e("coreJS/adapt");var s=t.extend({preRender:function(){this.listenTo(i,"device:changed",this.resizeImage);this.checkIfResetOnRevisit()},postRender:function(){this.resizeImage(i.device.screenSize,true)},checkIfResetOnRevisit:function(){var e=this.model.get("_isResetOnRevisit");if(e){this.model.reset(e)}},inview:function(e,t,i,s){if(t){if(s==="top"){this._isVisibleTop=true}else if(s==="bottom"){this._isVisibleBottom=true}else{this._isVisibleTop=true;this._isVisibleBottom=true}if(this._isVisibleTop&&this._isVisibleBottom){this.$(".component-widget").off("inview");this.setCompletionStatus()}}},remove:function(){this.$(".component-widget").off("inview");t.prototype.remove.apply(this,arguments)},resizeImage:function(e,t){var i=e==="medium"?"small":e;var s=this.model.get("_graphic")?this.model.get("_graphic")[i]:"";this.$(".graphic-widget img").attr("src",s);this.$(".graphic-widget").imageready(_.bind(function(){this.setReadyStatus();if(t){this.$(".component-widget").on("inview",_.bind(this.inview,this))}},this))}});i.register("graphic",s);return s});define("components/adapt-contrib-hotgraphic/js/adapt-contrib-hotgraphic",["require","coreViews/componentView","coreJS/adapt"],function(e){var t=e("coreViews/componentView");var i=e("coreJS/adapt");var s=t.extend({initialize:function(){this.listenTo(i,"remove",this.remove);this.listenTo(this.model,"change:_isVisible",this.toggleVisibility);this.model.set("_globals",i.course.get("_globals"));this.preRender();if(this.model.get("_canCycleThroughPagination")===undefined){this.model.set("_canCycleThroughPagination",false)}if(i.device.screenSize=="large"){this.render()}else{this.reRender()}},events:function(){return{"click .hotgraphic-graphic-pin":"openHotGraphic","click .hotgraphic-popup-done":"closeHotGraphic","click .hotgraphic-popup-nav .back":"previousHotGraphic","click .hotgraphic-popup-nav .next":"nextHotGraphic","click .image-zoomer":"onZoomClicked"}},preRender:function(){this.listenTo(i,"device:changed",this.reRender,this);this.checkIfResetOnRevisit()},postRender:function(){this.renderState();this.$(".hotgraphic-widget").imageready(_.bind(function(){this.setReadyStatus()},this));this.setupEventListeners()},checkIfResetOnRevisit:function(){var e=this.model.get("_isResetOnRevisit");if(e){this.model.reset(e);_.each(this.model.get("_items"),function(e){e._isVisited=false})}},reRender:function(){if(i.device.screenSize!="large"){this.replaceWithNarrative()}},inview:function(e,t,i,s){if(t){if(s==="top"){this._isVisibleTop=true}else if(s==="bottom"){this._isVisibleBottom=true}else{this._isVisibleTop=true;this._isVisibleBottom=true}if(this._isVisibleTop&&this._isVisibleBottom){this.$(".component-inner").off("inview");
this.setCompletionStatus()}}},replaceWithNarrative:function(){if(!i.componentStore.narrative)throw"Narrative not included in build";var e=i.componentStore.narrative;var t=this.prepareNarrativeModel();var s=new e({model:t});var n=$(".component-container",$("."+this.model.get("_parentId")));s.reRender();s.setupNarrative();n.append(s.$el);i.trigger("device:resize");_.defer(_.bind(function(){this.remove()},this))},prepareNarrativeModel:function(){var e=this.model;e.set("_component","narrative");e.set("_wasHotgraphic",true);e.set("originalBody",e.get("body"));e.set("originalInstruction",e.get("instruction"));if(e.get("mobileBody")){e.set("body",e.get("mobileBody"))}if(e.get("mobileInstruction")){e.set("instruction",e.get("mobileInstruction"))}return e},applyNavigationClasses:function(e){var t=this.$(".hotgraphic-popup-nav"),i=this.$(".hotgraphic-item").length;t.removeClass("first").removeClass("last");this.$(".hotgraphic-popup-done").a11y_cntrl_enabled(true);if(e<=0&&!this.model.get("_canCycleThroughPagination")){this.$(".hotgraphic-popup-nav").addClass("first");this.$(".hotgraphic-popup-controls.back").a11y_cntrl_enabled(false);this.$(".hotgraphic-popup-controls.next").a11y_cntrl_enabled(true)}else if(e>=i-1&&!this.model.get("_canCycleThroughPagination")){this.$(".hotgraphic-popup-nav").addClass("last");this.$(".hotgraphic-popup-controls.back").a11y_cntrl_enabled(true);this.$(".hotgraphic-popup-controls.next").a11y_cntrl_enabled(false)}else{this.$(".hotgraphic-popup-controls.back").a11y_cntrl_enabled(true);this.$(".hotgraphic-popup-controls.next").a11y_cntrl_enabled(true)}var s=this.model.get("_items")[e]._classes?this.model.get("_items")[e]._classes:"";this.$(".hotgraphic-popup").attr("class","hotgraphic-popup "+"item-"+e+" "+s)},openHotGraphic:function(e){e.preventDefault();this.$(".hotgraphic-graphic-pin-icon").removeClass("active");this.$(".hotgraphic-popup-inner").a11y_on(false);var t=$(e.currentTarget).data("id");this.$(".hotgraphic-item").hide().removeClass("active");this.$("."+t).show().addClass("active");var s=this.$(".hotgraphic-item.active").index();this.setVisited(s);this.$(".hotgraphic-popup-count .current").html(s+1);this.$(".hotgraphic-popup-count .total").html(this.$(".hotgraphic-item").length);this.$(".hotgraphic-popup").attr("class","hotgraphic-popup "+"item-"+s);this.$(".hotgraphic-popup").show();this.$(".hotgraphic-popup-inner .active").a11y_on(true);i.trigger("popup:opened",this.$(".hotgraphic-popup-inner"));this.$(".hotgraphic-popup-inner .active").a11y_focus();this.applyNavigationClasses(s)},closeHotGraphic:function(e){console.log("closeHotGraphic called");e.preventDefault();var t=this.$(".hotgraphic-item.active").index();this.$(".hotgraphic-popup").hide();i.trigger("popup:closed",this.$(".hotgraphic-popup-inner"));this.$("img").load()},previousHotGraphic:function(e){e.preventDefault();var t=this.$(".hotgraphic-item.active").index();if(t===0&&!this.model.get("_canCycleThroughPagination")){return}else if(t===0&&this.model.get("_canCycleThroughPagination")){t=this.model.get("_items").length}this.$(".hotgraphic-item.active").hide().removeClass("active");this.$(".hotgraphic-item").eq(t-1).show().addClass("active");this.setVisited(t-1);this.$(".hotgraphic-popup-count .current").html(t);this.$(".hotgraphic-popup-inner").a11y_on(false);this.applyNavigationClasses(t-1);this.$(".hotgraphic-popup-inner .active").a11y_on(true);this.$(".hotgraphic-popup-inner .active").a11y_focus()},nextHotGraphic:function(e){e.preventDefault();var t=this.$(".hotgraphic-item.active").index();if(t===this.model.get("_items").length-1&&!this.model.get("_canCycleThroughPagination")){return}else if(t===this.model.get("_items").length-1&&this.model.get("_canCycleThroughPagination")){t=-1}this.$(".hotgraphic-item.active").hide().removeClass("active");this.$(".hotgraphic-item").eq(t+1).show().addClass("active");this.setVisited(t+1);this.$(".hotgraphic-popup-count .current").html(t+2);this.$(".hotgraphic-popup-inner").a11y_on(false);this.applyNavigationClasses(t+1);this.$(".hotgraphic-popup-inner .active").a11y_on(true);this.$(".hotgraphic-popup-inner .active").a11y_focus()},onZoomClicked:function(e){e.preventDefault();var t=$(e.currentTarget).attr("id");this.openPopUp(t)},openPopUp:function(e){console.log("openPopUp called");var t=this.model.get("_items")[e]._graphic.src;this.model.set({feedbackTitle:"<img class='tab-content-item-title-image-zoom' src='"+t+"'/>"});i.trigger("questionView:showFeedback",this)},setVisited:function(e){var t=this.model.get("_items")[e];t._isVisited=true;var i=this.$(".hotgraphic-graphic-pin").eq(e);i.addClass("visited");var s=this.model.get("_globals")._accessibility._ariaLabels.visited+".";i.attr("aria-label",function(e,t){return t+" "+s});$.a11y_alert("visited");this.checkCompletionStatus()},getVisitedItems:function(){return _.filter(this.model.get("_items"),function(e){return e._isVisited})},checkCompletionStatus:function(){if(this.getVisitedItems().length==this.model.get("_items").length){this.trigger("allItems")}},onCompletion:function(){this.setCompletionStatus();if(this.completionEvent&&this.completionEvent!="inview"){this.off(this.completionEvent,this)}},setupEventListeners:function(){this.completionEvent=!this.model.get("_setCompletionOn")?"allItems":this.model.get("_setCompletionOn");if(this.completionEvent!=="inview"){this.on(this.completionEvent,_.bind(this.onCompletion,this))}else{this.$(".component-widget").on("inview",_.bind(this.inview,this))}}});i.register("hotgraphic",s);return s});define("components/adapt-contrib-matching/js/adapt-contrib-matching",["core/js/adapt","core/js/views/questionView","libraries/select2"],function(e,t){var i;jQuery.fn.select2.amd.require(["select2/utils","select2/dropdown","select2/dropdown/attachContainer","select2/dropdown/closeOnSelect"],function(e,t,s,n){i=e.Decorate(e.Decorate(t,s),n)});var s=t.extend({disableQuestion:function(){this.$("select").prop("disabled",true).select2()},setupSelect2:function(){this.enableQuestion();if(this.model.get("_isEnabled")!==true){this.disableQuestion()}},enableQuestion:function(){this.$("select").prop("disabled",false).select2({placeholder:this.model.get("placeholder"),minimumResultsForSearch:Infinity,dir:e.config.get("_defaultDirection"),dropdownAdapter:i})},resetQuestionOnRevisit:function(){this.resetQuestion()},setupQuestion:function(){this.listenToOnce(e,"preRemove",this.onPreRemove);this.setupItemIndexes();this.restoreUserAnswers();this.setupRandomisation()},onPreRemove:function(){this.$("select").select2("destroy")},setupItemIndexes:function(){_.each(this.model.get("_items"),function(e,t){if(e._index===undefined){e._index=t;e._selected=false}_.each(e._options,function(e,t){if(e._index===undefined){e._index=t;e._isSelected=false}})})},restoreUserAnswers:function(){if(!this.model.get("_isSubmitted"))return;var e=this.model.get("_userAnswer");_.each(this.model.get("_items"),function(t,i){_.each(t._options,function(i,s){if(i._index==e[t._index]){i._isSelected=true;t._selected=i}})});this.setQuestionAsSubmitted();this.markQuestion();this.setScore();this.showMarking();this.setupFeedback()},setupRandomisation:function(){if(this.model.get("_isRandom")&&this.model.get("_isEnabled")){_.each(this.model.get("_items"),function(e){e._options=_.shuffle(e._options)})}},onQuestionRendered:function(){this.setReadyStatus();this.setupSelect2()},canSubmit:function(){var e=true;this.$("select").each(function t(i,s){if(s.selectedIndex<1){e=false;return false}});return e},onCannotSubmit:function(){this.$("select").each(function e(t,i){if(i.selectedIndex<1){var s=$(i);var n=s.parents(".matching-select-container");n.addClass("error");var r="select2:select.errorclear";var o=s.parent();o.off(r);o.on(r,function(e){if(e.params.data.element.index>0){n.removeClass("error");o.off(r)}})}})},storeUserAnswer:function(){var e=new Array(this.model.get("_items").length);var t=new Array(this.model.get("_items").length);_.each(this.model.get("_items"),function(i,s){var n=this.$(".matching-select option:selected").eq(s);var r=n.index()-1;i._options[r]._isSelected=true;i._selected=i._options[r];t[i._index]=r;e[i._index]=i._options[r]._index},this);this.model.set("_userAnswer",e);this.model.set("_tempUserAnswer",t)},isCorrect:function(){var e=0;_.each(this.model.get("_items"),function(t,i){if(t._selected&&t._selected._isCorrect){e++;t._isCorrect=true;this.model.set("_numberOfCorrectAnswers",e);this.model.set("_isAtLeastOneCorrectSelection",true)}else{t._isCorrect=false}},this);this.model.set("_numberOfCorrectAnswers",e);if(e===this.model.get("_items").length){return true}else{return false}},setScore:function(){var e=this.model.get("_questionWeight");if(this.model.get("_isCorrect")){this.model.set("_score",e);return}var t=this.model.get("_numberOfCorrectAnswers");var i=this.model.get("_items").length;var s=e*t/i;this.model.set("_score",s)},showMarking:function(){if(!this.model.get("_canShowMarking"))return;_.each(this.model.get("_items"),function(e,t){var i=this.$(".matching-item").eq(t);i.removeClass("correct incorrect").addClass(e._isCorrect?"correct":"incorrect")},this)},isPartlyCorrect:function(){return this.model.get("_isAtLeastOneCorrectSelection")},resetUserAnswer:function(){this.model.set({_userAnswer:[]})},resetQuestion:function(){this.$(".matching-select option").prop("selected",false);this.$(".matching-item").removeClass("correct").removeClass("incorrect");this.model.set("_isAtLeastOneCorrectSelection",false);var e=this.model.get("placeholder");_.each(this.model.get("_items"),function(t,i){this.selectValue(i,e);_.each(t._options,function(e,t){e._isSelected=false})},this)},showCorrectAnswer:function(){var e=this.model.get("_items");for(var t=0;t<e.length;t++){var i=e[t];var s=_.findWhere(i._options,{_isCorrect:true});this.selectValue(t,s.text)}},hideCorrectAnswer:function(){var e=this.model.get("_items");for(var t=0,i=e.length;t<i;t++){var s=this.model.has("_tempUserAnswer")?this.model.get("_tempUserAnswer")[t]:this.model.get("_userAnswer")[t];var n=e[t];var r=n._options[s].text;this.selectValue(t,r)}},selectValue:function(e,t){t=$.trim(t);this.$("select").eq(e).val(t).trigger("change")},getResponse:function(){var e=this.model.get("_userAnswer");var t=[];for(var i=0,s=e.length;i<s;i++){t.push(i+1+"."+(e[i]+1))}return t.join("#")},getResponseType:function(){return"matching"}});e.register("matching",s);return s});define("components/adapt-contrib-media/js/adapt-contrib-media",["core/js/adapt","core/js/views/componentView","libraries/mediaelement-and-player","libraries/mediaelement-and-player-accessible-captions","libraries/mediaelement-fullscreen-hook"],function(e,t){var i=false;function s(e){var t=e.attributes,i,n,r;if(t){for(i=t.length-1;i>=0;i-=1){r=t[i].name;if(typeof e[r]==="function"){e[r]=null}}}t=e.childNodes;if(t){n=t.length;for(i=0;i<n;i+=1){s(e.childNodes[i])}}}var n=t.extend({events:{"click .media-inline-transcript-button":"onToggleInlineTranscript","click .media-external-transcript-button":"onExternalTranscriptClicked"},preRender:function(){this.listenTo(e,{"device:resize":this.onScreenSizeChanged,"device:changed":this.onDeviceChanged,"accessibility:toggle":this.onAccessibilityToggle,"media:stop":this.onMediaStop});_.bindAll(this,"onMediaElementPlay","onMediaElementPause","onMediaElementEnded","onMediaElementTimeUpdate","onMediaElementSeeking");this.model.set({_isMediaEnded:false,_isMediaPlaying:false});if(this.model.get("_media").source){var t=this.model.get("_media");if(window.location.protocol==="https:"&&t.source.indexOf("http:")===0){t.source=t.source.replace(/^http\:/,"https:")}this.model.set("_media",t)}this.checkIfResetOnRevisit()},postRender:function(){this.setupPlayer()},setupPlayer:function(){if(!this.model.get("_playerOptions"))this.model.set("_playerOptions",{});var t=this.model.get("_playerOptions");if(t.pluginPath===undefined)t.pluginPath="assets/";if(t.features===undefined){t.features=["playpause","progress","current","duration"];if(this.model.get("_useClosedCaptions")){t.features.unshift("tracks")}if(this.model.get("_allowFullScreen")){t.features.push("fullscreen")}if(this.model.get("_showVolumeControl")){t.features.push("volume")}}t.success=_.bind(this.onPlayerReady,this);if(this.model.get("_useClosedCaptions")){t.startLanguage=this.model.get("_startLanguage")===undefined?"en":this.model.get("_startLanguage")}var i=e.config.has("_accessibility")&&e.config.get("_accessibility")._isActive?true:false;if(i){t.alwaysShowControls=true;t.hideVideoControlsOnLoad=false}if(t.alwaysShowControls===undefined){t.alwaysShowControls=false}if(t.hideVideoControlsOnLoad===undefined){t.hideVideoControlsOnLoad=true}this.addMediaTypeClass();this.addThirdPartyFixes(t,_.bind(function s(){this.$("audio, video").mediaelementplayer(t);try{if(this.model.get("_media").source){this.$(".media-widget").addClass("external-source")}}catch(e){console.log("ERROR! No _media property found in components.json for component "+this.model.get("_id"))}finally{this.setReadyStatus()}},this))},addMediaTypeClass:function(){var e=this.model.get("_media");if(e&&e.type){var t=e.type.replace(/\//,"-");this.$(".media-widget").addClass(t)}},addThirdPartyFixes:function(e,t){var s=this.model.get("_media");if(!s)return t();switch(s.type){case"video/vimeo":e.alwaysShowControls=false;e.hideVideoControlsOnLoad=true;e.features=[];if(i)return t();$.getScript("assets/froogaloop.js").done(function(){i=true;t()}).fail(function(){i=false;console.log("Could not load froogaloop.js")});break;default:t()}},setupEventListeners:function(){this.completionEvent=!this.model.get("_setCompletionOn")?"play":this.model.get("_setCompletionOn");if(this.completionEvent==="inview"){this.$(".component-widget").on("inview",_.bind(this.inview,this))}if(this.model.get("_preventForwardScrubbing")&&!this.model.get("_isComplete")){$(this.mediaElement).on({seeking:this.onMediaElementSeeking,timeupdate:this.onMediaElementTimeUpdate})}$(this.mediaElement).on({play:this.onMediaElementPlay,pause:this.onMediaElementPause,ended:this.onMediaElementEnded})},onMediaElementPlay:function(t){e.trigger("media:stop",this);this.model.set({_isMediaPlaying:true,_isMediaEnded:false});if(this.completionEvent==="play"){this.setCompletionStatus()}},onMediaElementPause:function(e){this.model.set("_isMediaPlaying",false)},onMediaElementEnded:function(e){this.model.set("_isMediaEnded",true);if(this.completionEvent==="ended"){this.setCompletionStatus()}},onMediaElementSeeking:function(e){var t=this.model.get("_maxViewed");if(!t){t=0}if(e.target.currentTime>t){e.target.currentTime=t}},onMediaElementTimeUpdate:function(e){var t=this.model.get("_maxViewed");if(!t){t=0}if(e.target.currentTime>t){this.model.set("_maxViewed",e.target.currentTime)}},setupPlayPauseToggle:function(){var e=this.mediaElement.player;if(!e){console.log("Media.setupPlayPauseToggle: OOPS! there's no player reference.");return}e.options.clickToPlayPause=false;this.onOverlayClick=_.bind(this.onOverlayClick,this);this.onMediaElementClick=_.bind(this.onMediaElementClick,this);this.$(".mejs-overlay-button").on("click",this.onOverlayClick);this.$(".mejs-mediaelement").on("click",this.onMediaElementClick)},onMediaStop:function(e){if(e&&e.cid===this.cid)return;var t=this.mediaElement.player;if(!t)return;t.pause()},onOverlayClick:function(){var e=this.mediaElement.player;if(!e)return;e.play()},onMediaElementClick:function(e){var t=this.mediaElement.player;if(!t)return;var i=t.media.paused;if(!i)t.pause()},checkIfResetOnRevisit:function(){var e=this.model.get("_isResetOnRevisit");if(e){this.model.reset(e)}},inview:function(e,t,i,s){if(t){if(s==="top"){this._isVisibleTop=true}else if(s==="bottom"){this._isVisibleBottom=true}else{this._isVisibleTop=true;this._isVisibleBottom=true}if(this._isVisibleTop&&this._isVisibleBottom){this.$(".component-inner").off("inview");this.setCompletionStatus()}}},remove:function(){this.$(".mejs-overlay-button").off("click",this.onOverlayClick);this.$(".mejs-mediaelement").off("click",this.onMediaElementClick);var e=this.model.get("_playerOptions");delete e.success;var i=this.model.get("_media");if(i){switch(i.type){case"video/vimeo":this.$("iframe")[0].isRemoved=true}}if(this.mediaElement&&this.mediaElement.player){var n=this.mediaElement.player.id;s(this.$el[0]);this.mediaElement.player.remove();if(mejs.players[n]){delete mejs.players[n]}}if(this.mediaElement){$(this.mediaElement).off({play:this.onMediaElementPlay,pause:this.onMediaElementPause,ended:this.onMediaElementEnded,seeking:this.onMediaElementSeeking,timeupdate:this.onMediaElementTimeUpdate});this.mediaElement.src="";$(this.mediaElement.pluginElement).remove();delete this.mediaElement}t.prototype.remove.call(this)},onDeviceChanged:function(){if(this.model.get("_media").source){this.$(".mejs-container").width(this.$(".component-widget").width())}},onPlayerReady:function(e,t){this.mediaElement=e;if(!this.mediaElement.player){this.mediaElement.player=mejs.players[this.$(".mejs-container").attr("id")]}var i=mejs.MediaFeatures.hasTouch;if(i){this.setupPlayPauseToggle()}this.addThirdPartyAfterFixes();if(this.model.has("_startVolume")){this.mediaElement.player.setVolume(parseInt(this.model.get("_startVolume"))/100)}this.setReadyStatus();this.setupEventListeners()},addThirdPartyAfterFixes:function(){var e=this.model.get("_media");switch(e.type){case"video/vimeo":this.$(".mejs-container").attr("tabindex",0)}},onScreenSizeChanged:function(){this.$("audio, video").width(this.$(".component-widget").width())},onAccessibilityToggle:function(){this.showControls()},onToggleInlineTranscript:function(e){if(e)e.preventDefault();var t=this.$(".media-inline-transcript-body-container");var i=this.$(".media-inline-transcript-button");if(t.hasClass("inline-transcript-open")){t.stop(true,true).slideUp(function(){$(window).resize()});t.removeClass("inline-transcript-open");i.html(this.model.get("_transcript").inlineTranscriptButton)}else{t.stop(true,true).slideDown(function(){$(window).resize()}).a11y_focus();t.addClass("inline-transcript-open");i.html(this.model.get("_transcript").inlineTranscriptCloseButton);if(this.model.get("_transcript")._setCompletionOnView!==false){this.setCompletionStatus()}}},onExternalTranscriptClicked:function(e){if(this.model.get("_transcript")._setCompletionOnView!==false){this.setCompletionStatus()}},showControls:function(){var t=e.config.has("_accessibility")&&e.config.get("_accessibility")._isActive?true:false;if(t){if(!this.mediaElement.player)return;var i=this.mediaElement.player;i.options.alwaysShowControls=true;i.options.hideVideoControlsOnLoad=false;i.enableControls();i.showControls();this.$(".mejs-playpause-button button").attr({role:"button"});var s=$("<div role='region' aria-label='.'>");this.$(".mejs-playpause-button").prepend(s);this.$(".mejs-time, .mejs-time-rail").attr({"aria-hidden":"true"})}}});e.register("media",n);return n});define("components/adapt-contrib-narrative/js/adapt-contrib-narrative",["require","coreViews/componentView","coreJS/adapt"],function(e){var t=e("coreViews/componentView");var i=e("coreJS/adapt");var s=t.extend({events:{"click .narrative-strapline-title":"openPopup","click .narrative-controls":"onNavigationClicked","click .narrative-indicators .narrative-progress":"onProgressClicked"},preRender:function(){this.listenTo(i,"device:changed",this.reRender,this);this.listenTo(i,"device:resize",this.resizeControl,this);this.listenTo(i,"notify:closed",this.closeNotify,this);this.setDeviceSize();this.checkIfResetOnRevisit()},setDeviceSize:function(){if(i.device.screenSize==="large"){this.$el.addClass("desktop").removeClass("mobile");this.model.set("_isDesktop",true)}else{this.$el.addClass("mobile").removeClass("desktop");this.model.set("_isDesktop",false)}},postRender:function(){this.renderState();this.$(".narrative-slider").imageready(_.bind(function(){this.setReadyStatus()},this));this.setupNarrative()},checkIfResetOnRevisit:function(){var e=this.model.get("_isResetOnRevisit");if(e){this.model.reset(e);this.model.set({_stage:0});_.each(this.model.get("_items"),function(e){e._isVisited=false})}},setupNarrative:function(){this.setDeviceSize();if(!this.model.has("_items")||!this.model.get("_items").length)return;this.model.set("_marginDir","left");if(i.config.get("_defaultDirection")=="rtl"){this.model.set("_marginDir","right")}this.model.set("_itemCount",this.model.get("_items").length);this.model.set("_active",true);if(this.model.get("_stage")){this.setStage(this.model.get("_stage"),true)}else{this.setStage(0,true)}this.calculateWidths();if(i.device.screenSize!=="large"&&!this.model.get("_wasHotgraphic")){this.replaceInstructions()}this.setupEventListeners()},calculateWidths:function(){var e=this.$(".narrative-slide-container").width();var t=this.model.get("_itemCount");var i=this.$(".narrative-slider-graphic").css("margin-right");var s=i===""?0:parseInt(i);var n=(e+s)*t;this.$(".narrative-slider-graphic").width(e);this.$(".narrative-strapline-header").width(e);this.$(".narrative-strapline-title").width(e);this.$(".narrative-slider").width(n);this.$(".narrative-strapline-header-inner").width(n);var r=this.model.get("_stage");var o=-(r*e);this.$(".narrative-slider").css("margin-"+this.model.get("_marginDir"),o);this.$(".narrative-strapline-header-inner").css("margin-"+this.model.get("_marginDir"),o);this.model.set("_finalItemLeft",n-e)},resizeControl:function(){var e=this.model.get("_isDesktop");this.setDeviceSize();if(e!=this.model.get("_isDesktop"))this.replaceInstructions();this.calculateWidths();this.evaluateNavigation()},reRender:function(){if(this.model.get("_wasHotgraphic")&&i.device.screenSize=="large"){this.replaceWithHotgraphic()}else{this.resizeControl()}},closeNotify:function(){this.evaluateCompletion()},replaceInstructions:function(){if(i.device.screenSize==="large"){this.$(".narrative-instruction-inner").html(this.model.get("instruction")).a11y_text()}else if(this.model.get("mobileInstruction")&&!this.model.get("_wasHotgraphic")){this.$(".narrative-instruction-inner").html(this.model.get("mobileInstruction")).a11y_text()}},replaceWithHotgraphic:function(){if(!i.componentStore.hotgraphic)throw"Hotgraphic not included in build";var e=i.componentStore.hotgraphic;var t=this.prepareHotgraphicModel();var s=new e({model:t});var n=$(".component-container",$("."+this.model.get("_parentId")));n.append(s.$el);this.remove();$.a11y_update();_.defer(function(){i.trigger("device:resize")})},prepareHotgraphicModel:function(){var e=this.model;e.set("_component","hotgraphic");e.set("body",e.get("originalBody"));e.set("instruction",e.get("originalInstruction"));return e},moveSliderToIndex:function(e,t,s){var n=parseInt(this.$(".narrative-slider-graphic").css("margin-right"));var r=this.$(".narrative-slide-container").width()+n;var o={};if(t&&!i.config.get("_disableAnimation")){o["margin-"+this.model.get("_marginDir")]=-(r*e);this.$(".narrative-slider").velocity("stop",true).velocity(o);this.$(".narrative-strapline-header-inner").velocity("stop",true).velocity(o,{complete:s})}else{o["margin-"+this.model.get("_marginDir")]=-(r*e);this.$(".narrative-slider").css(o);this.$(".narrative-strapline-header-inner").css(o);s()}},setStage:function(e,t){this.model.set("_stage",e);if(this.model.get("_isDesktop")){var i=this.getCurrentItem(e);i._isVisited=true}this.$(".narrative-progress:visible").removeClass("selected").eq(e).addClass("selected");this.$(".narrative-slider-graphic").children(".controls").a11y_cntrl_enabled(false);this.$(".narrative-slider-graphic").eq(e).children(".controls").a11y_cntrl_enabled(true);this.$(".narrative-content-item").addClass("narrative-hidden").a11y_on(false).eq(e).removeClass("narrative-hidden").a11y_on(true);this.$(".narrative-strapline-title").a11y_cntrl_enabled(false).eq(e).a11y_cntrl_enabled(true);this.evaluateNavigation();this.evaluateCompletion();this.moveSliderToIndex(e,!t,_.bind(function(){if(this.model.get("_isDesktop")){if(!t)this.$(".narrative-content-item").eq(e).a11y_focus()}else{if(!t)this.$(".narrative-strapline-title").a11y_focus()}},this))},constrainStage:function(e){if(e>this.model.get("_items").length-1){e=this.model.get("_items").length-1}else if(e<0){e=0}return e},constrainXPosition:function(e,t,i){if(t>0&&i>0){t=e+i/(t*.1)}var s=this.model.get("_finalItemLeft");if(t<-s&&i<0){var n=Math.abs(t+s);t=e+i/(n*.1)}return t},evaluateNavigation:function(){var e=this.model.get("_stage");var t=this.model.get("_itemCount");if(e==0){this.$(".narrative-controls").addClass("narrative-hidden");if(t>1){this.$(".narrative-control-right").removeClass("narrative-hidden")}}else{this.$(".narrative-control-left").removeClass("narrative-hidden");if(e==t-1){this.$(".narrative-control-right").addClass("narrative-hidden")}else{this.$(".narrative-control-right").removeClass("narrative-hidden")}}},getNearestItemIndex:function(){var e=parseInt(this.$(".narrative-slider").css("margin-left"));var t=this.$(".narrative-slider-graphic").width();var i=e/t;var s=this.model.get("_stage");var n=s-Math.abs(i);if(n<-.3){s++}else if(n>.3){s--}return this.constrainStage(s)},getCurrentItem:function(e){return this.model.get("_items")[e]},getVisitedItems:function(){return _.filter(this.model.get("_items"),function(e){return e._isVisited})},evaluateCompletion:function(){if(this.getVisitedItems().length===this.model.get("_items").length){this.trigger("allItems")}},moveElement:function(e,t){var i=parseInt(e.css("margin-left"));var s=i+t;s=this.constrainXPosition(i,s,t);e.css("margin-"+this.model.get("_marginDir"),s+"px")},openPopup:function(e){e.preventDefault();var t=this.getCurrentItem(this.model.get("_stage"));var s={title:t.title,body:t.body};t._isVisited=true;i.trigger("notify:popup",s)},onNavigationClicked:function(e){if(!this.model.get("_active"))return;var t=this.model.get("_stage");var i=this.model.get("_itemCount");if($(e.currentTarget).hasClass("narrative-control-right")){t++}else if($(e.currentTarget).hasClass("narrative-control-left")){t--}t=(t+i)%i;this.setStage(t)},onProgressClicked:function(e){e.preventDefault();var t=$(e.target).index();this.setStage(t)},inview:function(e,t,i,s){if(t){if(s==="top"){this._isVisibleTop=true}else if(s==="bottom"){this._isVisibleBottom=true}else{this._isVisibleTop=true;this._isVisibleBottom=true}if(this._isVisibleTop&&this._isVisibleBottom){this.$(".component-inner").off("inview");this.setCompletionStatus()}}},onCompletion:function(){this.setCompletionStatus();if(this.completionEvent&&this.completionEvent!="inview"){this.off(this.completionEvent,this)}},setupEventListeners:function(){this.completionEvent=!this.model.get("_setCompletionOn")?"allItems":this.model.get("_setCompletionOn");if(this.completionEvent!=="inview"&&this.model.get("_items").length>1){this.on(this.completionEvent,_.bind(this.onCompletion,this))}else{this.$(".component-widget").on("inview",_.bind(this.inview,this))}}});i.register("narrative",s);return s});define("components/adapt-contrib-objectMatching/js/adapt-contrib-objectMatching",["coreJS/adapt","coreViews/questionView"],function(e,t){var i=t.extend({events:{"click .objectMatching-category-item":"onCategorySelected","click .objectMatching-option-item":"onOptionSelected"},resetQuestionOnRevisit:function(){this.setAllItemsEnabled(true);this.resetQuestion()},setupQuestion:function(){this.setupModel()},setupModel:function(){if(!this.model.get("_defaultAnswerBGColor")){this.model.set("_defaultAnswerBGColor","#C1D4EC")}this.model.set("_selectedCategoryId","");if(!this.model.get("_isSubmitted")){var e=[],t=[];_.each(this.model.get("_items"),function(i,s){i["id"]=s;e.push({id:s,category:i["question"],categoryColor:i["questionBGColor"]});t.push({id:s,option:i["answer"]})},this);if(this.model.get("_isRandom")&&this.model.get("_isEnabled")){e=_.shuffle(e);t=_.shuffle(t)}this.model.set("categoryItems",e);this.model.set("optionItems",t)}},disableQuestion:function(){this.setAllItemsEnabled(false)},enableQuestion:function(){this.setAllItemsEnabled(true)},setAllItemsEnabled:function(e){if(e){this.$(".objectMatching-widget").removeClass("disabled")}else{this.$(".objectMatching-widget").addClass("disabled")}},onQuestionRendered:function(){this.setReadyStatus()},onCategorySelected:function(e){e.preventDefault();if(!this.model.get("_isEnabled")||this.model.get("_isSubmitted"))return;this.$(".objectMatching-category-item-cotainer").removeClass("objectMatching-category-item-border");var t=$(e.currentTarget);if(this.model.get("_selectedCategoryId")===t.attr("data-id")){this.model.set("_selectedCategoryId","")}else{t.closest(".objectMatching-category-item-cotainer").addClass("objectMatching-category-item-border");this.model.set("_selectedCategoryId",t.attr("data-id"))}},onOptionSelected:function(e){e.preventDefault();if(!this.model.get("_isEnabled")||this.model.get("_isSubmitted")||!this.model.get("_selectedCategoryId"))return;var t=$(e.currentTarget);var i=parseInt(t.attr("data-id"));var s=this.getItemById(this.model.get("_selectedCategoryId"));if(s.selectedOptionId&&s.selectedOptionId===i){s.selectedOptionId="";s._isSelected=false;t.css("backgroundColor",this.model.get("_defaultAnswerBGColor"))}else{if(s.selectedOptionId){var n=this.getItemById(s.selectedOptionId);this.$(".objectMatching-option-item[data-id='"+n["id"]+"']").css("backgroundColor",this.model.get("_defaultAnswerBGColor"));n.selectedOptionId="";n._isSelected=false}s.selectedOptionId=i;s._isSelected=true;t.css("backgroundColor",s["questionBGColor"])}},getItemById:function(e){return _.filter(this.model.get("_items"),function(t){return e==t["id"]},this)[0]},getOptionItemById:function(e){return _.filter(this.model.get("optionItems"),function(t){return e==t["id"]},this)[0]},canSubmit:function(){return this.getNumberOfOptionsSelected()===this.model.get("_items").length},getNumberOfOptionsSelected:function(){return _.filter(this.model.get("_items"),function(e){return e._isSelected},this).length},onCannotSubmit:function(){},storeUserAnswer:function(){var e=[];_.each(this.model.get("_items"),function(t,i){e.push(_.extend({},t))},this);this.model.set("_userAnswer",e)},isCorrect:function(){var e=0;_.each(this.model.get("_userAnswer"),function(t,i){var s=t.id==t.selectedOptionId;if(t._isSelected&&s){e++;t._isCorrect=true;var n=this.getOptionItemById(t["id"]);n["_isCorrect"]=true;this.model.set("_numberOfCorrectAnswers",e);this.model.set("_isAtLeastOneCorrectSelection",true)}else{t._isCorrect=false;this.getOptionItemById(t["id"])["_isCorrect"]=false}},this);return e===this.model.get("_items").length},setScore:function(){var e=this.model.get("_numberOfCorrectAnswers");var t=this.model.get("_questionWeight");var i=this.model.get("_items").length;var s=t*e/i;this.model.set("_score",s)},showMarking:function(){this.$(".objectMatching-category-item-cotainer").removeClass("objectMatching-category-item-border");_.each(this.model.get("optionItems"),function(e,t){var i=this.$(".objectMatching-option-item-cotainer").eq(t);i.addClass(e._isCorrect?"correct":"incorrect")},this)},isPartlyCorrect:function(){return this.model.get("_isAtLeastOneCorrectSelection")},resetUserAnswer:function(){this.model.set({_selectedCategoryId:"",_userAnswer:[]})},resetQuestion:function(){this.$(".objectMatching-category-item-cotainer").removeClass("objectMatching-category-item-border");_.each(this.model.get("_items"),function(e){e.selectedOptionId="";e._isSelected=false;e._isCorrect=false},this);this.resetItems()},resetItems:function(){this.$(".objectMatching-category-item-cotainer").removeClass("objectMatching-category-item-border");this.$(".objectMatching-category-item").addClass("objectMatching-cursor-pointer");this.$(".objectMatching-option-item").addClass("objectMatching-cursor-pointer").css("backgroundColor",this.model.get("_defaultAnswerBGColor"))},showCorrectAnswer:function(){_.each(this.model.get("_items"),function(e){var t=this.$(".objectMatching-option-item[data-id="+e["id"]+"]");t.css("backgroundColor",e["questionBGColor"])},this)},hideCorrectAnswer:function(){_.each(this.model.get("_userAnswer"),function(e){var t=this.$(".objectMatching-option-item[data-id="+e["selectedOptionId"]+"]");
t.css("backgroundColor",e["questionBGColor"])},this)}});e.register("objectMatching",i);return i});define("components/adapt-contrib-reveal/js/adapt-contrib-reveal",["core/js/adapt","core/js/views/componentView","libraries/jquery.dotdotdot"],function(e,t,i){"use strict";var s=t.extend({events:function(){return e.device.touch==true?{"click .reveal-widget-control":"clickReveal",inview:"inview","click .reveal-popup-open":"openPopup","click .reveal-image":"openPopupToZoomImage","click .revel-close-button":"onClose"}:{"click .reveal-widget-control":"clickReveal",inview:"inview","click .reveal-popup-open":"openPopup","click .reveal-image":"openPopupToZoomImage","click .revel-close-button":"onClose"}},orientationStates:{Vertical:"vertical",Horizontal:"horizontal"},preRender:function(){var t;this.listenTo(e,"device:resize",this.resizeControl,this);switch(this.model.get("_direction")){case"left":case"right":t=this.orientationStates.Horizontal;break;case"top":case"bottom":t=this.orientationStates.Vertical}this.model.set("_orientation",t);var i=e.config.get("_defaultDirection");i=i==="rtl"?"right":"left";this.model.set("_defaultTextDirection",i);if(e.device.screenSize==="small"){this.model.set("small",true)}else{this.model.set("small",false)}this.checkIfResetOnRevisit()},checkIfResetOnRevisit:function(){var e=this.model.get("_isResetOnRevisit");if(e){this.model.reset(e)}},setupReveal:function(){var t=!this.model.get("_direction")?"left":this.model.get("_direction");var i=this.getIconDirection(t);this.$(".reveal-widget-item").addClass("reveal-"+this.model.get("_direction"));this.$(".reveal-widget-control").addClass("reveal-"+t);this.$(".reveal-image").addClass("reveal-"+t);this.$("div.reveal-widget-item-text").addClass("reveal-"+t);this.$("div.reveal-widget-item-text-body").addClass("reveal-"+t);this.$(".reveal-widget-icon").addClass("icon-controls-"+this.getIconDirection(i));this.$(".second .reveal-widget-item-text-body .accessible-text-block").attr("tabindex","-1");this.model.set("_direction",t);this.model.set("_active",true);this.model.set("_revealed",false);this.setControlText(false);if(t=="bottom"){this.$(".first-item").insertBefore(this.$(".second-item"))}if(this.model.get("_orientation")===this.orientationStates.Horizontal){this.calculateWidths()}else{this.calculateHeights()}this.$(".dot-ellipsis").each(function(){var e=$(this).hasClass("dot-resize-update");var t=$(this).hasClass("dot-timer-update");var i=0;var s=$(this).attr("class").split(/\s+/);$.each(s,function(e,t){var s=t.match(/^dot-height-(\d+)$/);if(s!==null)i=Number(s[1])});var n={};if(t)n.watch=true;if(e)n.watch="window";if(i>0)n.height=i;n.after="a.reveal-popup-open";$(this).dotdotdot(n)});if(e.device.screenSize!=="large"){this.replaceInstructions()}},replaceInstructions:function(){if(e.device.screenSize==="large"){this.$(".reveal-instruction-inner").html(this.model.get("instruction")).a11y_text()}else if(this.model.get("mobileInstruction")){this.$(".reveal-instruction-inner").html(this.model.get("mobileInstruction")).a11y_text()}},setControlText:function(e){if(this.model.get("_control")){if(!e&&this.model.get("control").showText){this.$(".reveal-widget-control").attr("title",this.model.get("control").showText)}if(e&&this.model.get("control").hideText){this.$(".reveal-widget-control").attr("title",this.model.get("control").hideText)}}},calculateWidths:function(){var e=this.model.get("_direction");var t=this.$(".reveal-widget");var i=this.$(".reveal-widget-slider");var s=this.$(".reveal-widget-control");var n=t.width();var r=s.width();var o=-n;i.css("width",n*2);if(this.model.get("_revealed")){s.css(this.model.get("_direction"),n-r)}i.css("margin-"+e,o);this.$("div.reveal-widget-item-text").css("width",$("img.reveal-image").width());this.model.set("_scrollSize",n);this.model.set("_controlWidth",r)},calculateHeights:function(){var e=this.model.get("_direction");var t=this.$(".reveal-widget");var i=this.$(".reveal-widget img");var s=this.$(".reveal-widget-slider");var n=this.$(".reveal-widget-control");var r=i.height();var o=n.height();var a=e=="top"?-r:r;t.css("height",r);s.css("height",r);if(this.model.get("_revealed")){n.css(this.model.get("_direction"),r-o)}if(e=="bottom"){s.css("margin-top",0)}else{s.css("margin-"+e,a)}this.$("div.reveal-widget-item-text").css("height",r);this.model.set("_scrollSize",r);this.model.set("_controlWidth",o)},getMarginType:function(){return this.model.get("_orientation")==this.orientationStates.Horizontal?"left":"top"},resizeControl:function(){var t=this.model.get("_direction");var i=this.getMarginType();var s=this.$(".reveal-widget");var n=this.$(".reveal-widget-slider");var r=this.$(".reveal-widget-item-text");var o;var a;if(this.model.get("_orientation")==this.orientationStates.Horizontal){var l=this.$(".reveal-inner").width();o=l!=s.width()?l:s.width();a=this.$(".reveal-widget-control").width();s.css("width",o);r.css("width",o);n.css("width",o*2)}else{o=this.$(".reveal-widget img").height();a=this.$(".reveal-widget-control").height();s.css("height",o);r.css("height",o);n.css("height",o)}if(t=="bottom"){n.css("margin-top",-o)}else{n.css("margin-"+t,-o)}var c={};if(this.model.get("_revealed")){n.css("margin-"+i,t==i?-o:0);c["margin-"+i]=t==i?0:-o;n.animate(c)}else{n.css("margin-"+i,t==i?-o:0)}if(e.device.screenSize==="small"){this.model.set("small",true)}else{this.model.set("small",false)}this.model.set("_scrollSize",o);this.model.set("_controlWidth",a)},postRender:function(){this.$(".reveal-widget").imageready(_.bind(function(){if($("html").hasClass("ie")){var e=this;_.delay(function(){e.setupReveal();e.setReadyStatus()},400)}else{this.setupReveal();this.setReadyStatus()}},this))},getOppositeDirection:function(e){var t={left:"right",right:"left",up:"down",down:"up"};return t[e]},getIconDirection:function(e){if(this.model.get("_orientation")==this.orientationStates.Vertical){return e=="top"?"up":"down"}else{return e}},clickReveal:function(e){e.preventDefault();var t=this.model.get("_direction");var i=this.getMarginType();var s=this.model.get("_scrollSize");var n=this.model.get("_controlWidth");var r=!this.model.get("_revealed")?s-n:s;var o=!this.model.get("_revealed")?"+=":"-=";var a=this.getIconDirection(t);var l=this.model.get("_defaultTextDirection");var c={};var d={};var u;var h;this.$(".reveal-widget-item-text-body").removeClass("a11y-ignore").removeAttr("aria-hidden").removeAttr("tab-index");if(l==="right"&&(t=="left"||t=="right")){i=this.getOppositeDirection(i)}if(!this.model.get("_revealed")){this.model.set("_revealed",true);this.$(".reveal-widget").addClass("reveal-showing");this.$(".first .reveal-widget-item-text-body").addClass("a11y-ignore").attr("aria-hidden","true").attr("tabindex","-1");this.$(".second .reveal-widget-item-text-body .accessible-text-block").attr("tabindex","0");this.$(".first .reveal-widget-item-text-body .accessible-text-block").attr("tabindex","-1");c[t]=o+r;u="icon-controls-"+this.getOppositeDirection(a);h="icon-controls-"+a;d["margin-"+i]=t==i?0:-s;this.setCompletionStatus()}else{this.model.set("_revealed",false);this.$(".reveal-widget").removeClass("reveal-showing");this.$(".second .reveal-widget-item-text-body").addClass("a11y-ignore").attr("aria-hidden","true").attr("tabindex","-1");this.$(".first .reveal-widget-item-text-body .accessible-text-block").attr("tabindex","0");this.$(".second .reveal-widget-item-text-body .accessible-text-block").attr("tabindex","-1");c[t]=0;u="icon-controls-"+a;h="icon-controls-"+this.getOppositeDirection(a);d["margin-"+i]=t==i?o+r:0}this.$(".reveal-widget-slider").animate(d);this.$(".reveal-widget-icon").removeClass(h).addClass(u);this.setControlText(this.model.get("_revealed"))},openPopupToZoomImage:function(e){e.preventDefault();var t=this.model.attributes[e.currentTarget.dataset.id];if(!t)return;if(!t.isZoomPopup)return;this.$(".shadow").removeClass("display-none");this.$(".image-zoom").removeClass("display-none");$("html").css("overflow","hidden")},onClose:function(e){this.$(".shadow").addClass("display-none");this.$(".image-zoom").addClass("display-none");$("html").css("overflow","")},openPopup:function(t){t.preventDefault();this.model.set("_active",false);var i=this.model.get("_revealed")?this.model.get("second").body:this.model.get("first").body;var s={title:"",body:i};e.trigger("notify:popup",s)}});e.register("reveal",s);return s});define("components/adapt-contrib-slider/js/adapt-contrib-slider",["core/js/views/questionView","core/js/adapt","libraries/rangeslider"],function(e,t,i){var s=e.extend({tempValue:true,events:{"click .slider-scale-number":"onNumberSelected",'focus input[type="range"]':"onHandleFocus",'blur input[type="range"]':"onHandleBlur"},resetQuestionOnRevisit:function(){this.setAllItemsEnabled();this.deselectAllItems();this.resetQuestion()},setupQuestion:function(){if(!this.model.get("_items")){this.setupModelItems()}this.restoreUserAnswers();if(this.model.get("_isSubmitted"))return;this.selectItem(0,true)},setupRangeslider:function(){this.$sliderScaleMarker=this.$(".slider-scale-marker");this.$slider=this.$('input[type="range"]');if(this.model.has("_scaleStep")){this.$slider.attr({step:this.model.get("_scaleStep")})}this.$slider.rangeslider({polyfill:false,onSlide:_.bind(this.handleSlide,this)});this.oldValue=0;if(this._deferEnable){this.setAllItemsEnabled()}},handleSlide:function(e,t){if(this.oldValue===t){return}var i=this.getIndexFromValue(t);var s=this.mapIndexToPixels(i);this.selectItem(i,false);this.animateToPosition(s);this.oldValue=t;this.tempValue=true},getDecimalPlaces:function(e){return(e.toString().split(".")[1]||[]).length},setupModelItems:function(){var e=[];var i=this.model.get("_correctAnswer");var s=this.model.get("_correctRange");var n=this.model.get("_scaleStart");var r=this.model.get("_scaleEnd");var o=this.model.get("_scaleStep")||1;var a=this.getDecimalPlaces(o);for(var l=n;l<=r;l+=o){if(a!==0){l=parseFloat(l.toFixed(a))}if(i){e.push({value:l,selected:false,correct:l==i})}else{e.push({value:l,selected:false,correct:l>=s._bottom&&l<=s._top})}}this.model.set("_items",e);this.model.set("_marginDir",t.config.get("_defaultDirection")==="rtl"?"right":"left")},restoreUserAnswers:function(){if(!this.model.get("_isSubmitted")){this.model.set({_selectedItem:{},_userAnswer:undefined});return}var e=this.model.get("_items");var t=this.model.get("_userAnswer");for(var i=0,s=e.length;i<s;i++){var n=e[i];if(n.value==t){this.model.set("_selectedItem",n);this.selectItem(this.getIndexFromValue(n.value),true);break}}this.setQuestionAsSubmitted();this.markQuestion();this.setScore();this.showMarking();this.setupFeedback()},disableQuestion:function(){this.setAllItemsEnabled()},enableQuestion:function(){this.setAllItemsEnabled()},setAllItemsEnabled:function(){var e=this.model.get("_isEnabled");if(this.$slider){if(e){this.$(".slider-widget").removeClass("disabled");this.$slider.prop("disabled",false);this.$slider.rangeslider("update",true)}else{this.$(".slider-widget").addClass("disabled");this.$slider.prop("disabled",true);this.$slider.rangeslider("update",true)}}else{this._deferEnable=true}},onQuestionRendered:function(){this.setupRangeslider();this.setScalePositions();this.onScreenSizeChanged();this.showScaleMarker(true);this.listenTo(t,"device:resize",this.onScreenSizeChanged);this.setAltText(this.model.get("_scaleStart"));this.setReadyStatus()},animateToPosition:function(e){if(!this.$sliderScaleMarker)return;this.$sliderScaleMarker.velocity("stop").velocity({left:e},{duration:200,easing:"linear",mobileHA:false})},getIndexFromValue:function(e){var t=this.model.get("_scaleStart"),i=this.model.get("_scaleEnd");return Math.round(this.mapValue(e,t,i,0,this.model.get("_items").length-1))},setAltText:function(e){this.$(".slider-handle").attr("aria-valuenow",e)},mapIndexToPixels:function(e,t){var i=this.model.get("_items").length,s=t?t.width():this.$(".slider-scaler").width();return Math.round(this.mapValue(e,0,i-1,0,s))},mapPixelsToIndex:function(e){var t=this.model.get("_items").length,i=this.$(".slider-sliderange").width();return Math.round(this.mapValue(e,0,i,0,t-1))},normalise:function(e,t,i){var s=i-t;return(e-t)/s},mapValue:function(e,t,i,s,n){var r=this.normalise(e,t,i);return r*(n-s)+s},onHandleFocus:function(e){e.preventDefault();this.$slider.on("keydown",_.bind(this.onKeyDown,this))},onHandleBlur:function(e){e.preventDefault();this.$slider.off("keydown")},onKeyDown:function(e){if(e.which==9)return;e.preventDefault();var t=this.getIndexFromValue(this.model.get("_selectedItem").value);switch(e.which){case 40:case 37:t=Math.max(t-1,0);break;case 38:case 39:t=Math.min(t+1,this.model.get("_items").length-1);break}this.selectItem(t);if(typeof t=="number")this.showScaleMarker(true);this.animateToPosition(this.mapIndexToPixels(t));this.setSliderValue(this.getValueFromIndex(t));this.setAltText(this.getValueFromIndex(t))},onNumberSelected:function(e){e.preventDefault();this.tempValue=false;if(this.model.get("_isInteractionComplete")){return}if(this.$slider.prop("disabled")){return}var t=parseFloat($(e.currentTarget).attr("data-id"));var i=this.getIndexFromValue(t);this.selectItem(i);this.animateToPosition(this.mapIndexToPixels(i));this.setAltText(t);this.setSliderValue(t)},getValueFromIndex:function(e){return this.model.get("_items")[e].value},resetControlStyles:function(){this.$(".slider-handle").empty();this.showScaleMarker(false);this.$(".slider-bar").animate({width:"0px"});this.setSliderValue(this.model.get("_items")[0].value)},canSubmit:function(){return true},onCannotSubmit:function(){},storeUserAnswer:function(){this.model.set("_userAnswer",this.model.get("_selectedItem").value)},isCorrect:function(){var e=0;_.each(this.model.get("_items"),function(t,i){if(t.selected&&t.correct){this.model.set("_isAtLeastOneCorrectSelection",true);e++}},this);this.model.set("_numberOfCorrectAnswers",e);return this.model.get("_isAtLeastOneCorrectSelection")?true:false},setScore:function(){var e=this.model.get("_numberOfCorrectAnswers");var t=this.model.get("_questionWeight");var i=t*e;this.model.set("_score",i)},setSliderValue:function(e){if(this.$slider){this.$slider.val(e).change()}},showMarking:function(){if(!this.model.get("_canShowMarking"))return;this.$(".slider-widget").removeClass("correct incorrect").addClass(this.model.get("_selectedItem").correct?"correct":"incorrect")},isPartlyCorrect:function(){return this.model.get("_isAtLeastOneCorrectSelection")},resetUserAnswer:function(){this.model.set({_isAtLeastOneCorrectSelection:false,_selectedItem:{},_userAnswer:undefined})},resetQuestion:function(){this.selectItem(0,true);this.animateToPosition(0);this.resetControlStyles();this.showScaleMarker(true);this.setAltText(this.model.get("_scaleStart"))},setScalePositions:function(){var e=this.model.get("_items").length;_.each(this.model.get("_items"),function(t,i){var s=this.normalise(i,0,e-1);this.$(".slider-scale-number").eq(i).data("normalisedPosition",s)},this)},showScale:function(){var e=this.$(".slider-markers").empty();if(this.model.get("_showScale")===false){e.eq(0).css({display:"none"});this.$(".slider-scale-numbers").eq(0).css(this.model.get("_showScaleIndicator")?{visibility:"hidden"}:{display:"none"})}else{var t=this.$(".slider-scaler");for(var i=0,s=this.model.get("_items").length;i<s;i++){e.append("<div class='slider-line component-item-color'>");e.find(".slider-line").eq(i).css({left:this.mapIndexToPixels(i,t)+"px"})}var n=t.width();var r=this.$(".slider-scale-number");for(var o=0,a=this.model.get("_items").length;o<a;o++){var l=r.eq(o);var c=Math.round(l.data("normalisedPosition")*n);l.css({left:c})}}},showLabels:function(){if(!this.model.get("labelStart")&&!this.model.get("labelEnd")){this.$(".slider-scale-labels").eq(0).css({display:"none"})}},remapSliderBar:function(){var e=this.$(".slider-scaler");var t=this.getIndexFromValue(this.model.get("_selectedItem").value);var i=this.mapIndexToPixels(t,e);this.$(".slider-handle").css({left:i+"px"});this.$(".slider-scale-marker").css({left:i+"px"});this.$(".slider-bar").width(i)},onScreenSizeChanged:function(){this.showScale();this.showLabels();this.remapSliderBar();if(this.$(".slider-widget").hasClass("show-user-answer")){this.hideCorrectAnswer()}else if(this.$(".slider-widget").hasClass("show-correct-answer")){this.showCorrectAnswer()}},showCorrectAnswer:function(){var e=[];if(this.model.has("_correctAnswer")){var t=this.model.get("_correctAnswer")}if(this.model.has("_correctRange")){var i=this.model.get("_correctRange")._bottom;var s=this.model.get("_correctRange")._top;var n=this.model.has("_scaleStep")?this.model.get("_scaleStep"):1}this.showScaleMarker(false);if(t){e.push(t)}else if(i!==undefined&&s!==undefined){var r=this.model.get("_correctRange")._bottom;var o=this.model.get("_correctRange")._top;while(r<=o){e.push(r);r+=n}}else{console.log("adapt-contrib-slider::WARNING: no correct answer or correct range set in JSON")}var a=e[Math.floor(e.length/2)];this.animateToPosition(this.mapIndexToPixels(this.getIndexFromValue(a)));this.showModelAnswers(e);this.setSliderValue(a)},showModelAnswers:function(e){var t=this.$(".slider-modelranges");_.each(e,function(e,i){t.append($("<div class='slider-model-answer component-item-color component-item-text-color'>"));var s=$(this.$(".slider-modelranges .slider-model-answer")[i]),n=this.mapIndexToPixels(this.getIndexFromValue(this.model.get("_selectedItem").value));if(this.model.get("_showNumber"))s.html(e);s.css({left:n}).fadeIn(0,_.bind(function(){s.animate({left:this.mapIndexToPixels(this.getIndexFromValue(e))})},this))},this)},hideCorrectAnswer:function(){var e=this.getIndexFromValue(this.model.get("_userAnswer"));this.$(".slider-modelranges").empty();this.showScaleMarker(true);this.selectItem(e,true);this.animateToPosition(this.mapIndexToPixels(e));this.setSliderValue(this.model.get("_userAnswer"))},selectItem:function(e,t){this.$el.a11y_selected(false);_.each(this.model.get("_items"),function(i,s){i.selected=s==e;if(i.selected){this.model.set("_selectedItem",i);this.$('.slider-scale-number[data-id="'+i.value+'"]').a11y_selected(true,t)}},this);this.showNumber(true)},deselectAllItems:function(){_.each(this.model.get("_items"),function(e){e.selected=false},this)},showScaleMarker:function(e){var t=this.$(".slider-scale-marker");if(this.model.get("_showScaleIndicator")){this.showNumber(e);if(e){t.addClass("display-block")}else{t.removeClass("display-block")}}},showNumber:function(e){var t=this.$(".slider-scale-marker");if(this.model.get("_showNumber")){if(e){t.html(this.model.get("_selectedItem").value)}else{t.html=""}}},getResponse:function(){return this.model.get("_userAnswer").toString()},getResponseType:function(){return"numeric"}});t.register("slider",s);return s});define("components/adapt-contrib-text/js/adapt-contrib-text",["require","coreViews/componentView","coreJS/adapt"],function(e){var t=e("coreViews/componentView");var i=e("coreJS/adapt");var s=t.extend({preRender:function(){this.checkIfResetOnRevisit()},postRender:function(){this.setReadyStatus();this.setupInview()},events:{"click .page-header-scroll-button":"onScrollButtonClicked"},onScrollButtonClicked:function(e){if(e)e.preventDefault();var t=$(".background-intro").height();$("html, body").velocity("scroll",{duration:800,offset:t+"px",mobileHA:false})},setupInview:function(){var e=this.getInviewElementSelector();if(!e){this.setCompletionStatus()}else{this.model.set("inviewElementSelector",e);this.$(e).on("inview",_.bind(this.inview,this))}},getInviewElementSelector:function(){if(this.model.get("body"))return".component-body";if(this.model.get("instruction"))return".component-instruction";if(this.model.get("displayTitle"))return".component-title";return null},checkIfResetOnRevisit:function(){var e=this.model.get("_isResetOnRevisit");if(e){this.model.reset(e)}},inview:function(e,t,i,s){if(t){if(s==="top"){this._isVisibleTop=true}else if(s==="bottom"){this._isVisibleBottom=true}else{this._isVisibleTop=true;this._isVisibleBottom=true}if(this._isVisibleTop&&this._isVisibleBottom){this.$(this.model.get("inviewElementSelector")).off("inview");this.setCompletionStatus()}}},remove:function(){if(this.model.has("inviewElementSelector")){this.$(this.model.get("inviewElementSelector")).off("inview")}t.prototype.remove.call(this)}},{template:"text"});i.register("text",s);return s});define("components/adapt-contrib-textInput/js/adapt-contrib-textInput",["require","coreViews/questionView","coreJS/adapt"],function(e){var t=e("coreViews/questionView");var i=e("coreJS/adapt");var s=65536;var n=t.extend({events:{"focus textarea":"clearValidationError"},resetQuestionOnRevisit:function(){this.setAllItemsEnabled(false);this.resetQuestion()},setupQuestion:function(){this.model.set("_genericAnswerIndexOffset",s);this.setupItemIndexes();this.restoreUserAnswer();this.setupRandomisation()},setupRandomisation:function(){if(this.model.get("_isRandom")&&this.model.get("_isEnabled")){this.model.set("_items",_.shuffle(this.model.get("_items")))}},setupItemIndexes:function(){_.each(this.model.get("_items"),function(e,t){if(e._index===undefined)e._index=t;if(e._answerIndex===undefined)e._answerIndex=-1})},restoreUserAnswer:function(){if(!this.model.get("_isSubmitted"))return;var e=this.model.get("_userAnswer");var t=this.model.get("_answers");_.each(this.model.get("_items"),function(i){var n=e[i._index];if(n>=s){i.userAnswer=t[n-s];i._answerIndex=n}else if(n>-1){i.userAnswer=i._answers[n];i._answerIndex=n}else{if(i.userAnswer===undefined)i.userAnswer="******";i._answerIndex=-1}if(i.userAnswer instanceof Array)i.userAnswer=i.userAnswer[0]});this.setQuestionAsSubmitted();this.markQuestion();this.setScore();this.showMarking();this.setupFeedback()},disableQuestion:function(){this.setAllItemsEnabled(false)},enableQuestion:function(){this.setAllItemsEnabled(true)},setAllItemsEnabled:function(e){_.each(this.model.get("_items"),function(t,i){var s=this.$("textarea").eq(i);if(e){s.prop("disabled",false)}else{s.prop("disabled",true)}},this)},onQuestionRendered:function(){this.setReadyStatus()},clearValidationError:function(){this.$(".textinput-item-textbox").removeClass("textinput-validation-error")},canSubmit:function(){var e=true;this.$(".textinput-item-textbox").each(function(){if($(this).val()==""){e=false}});return e},onCannotSubmit:function(){this.showValidationError()},showValidationError:function(){this.$(".textinput-item-textbox").addClass("textinput-validation-error")},storeUserAnswer:function(){var e=this.model.get("_items");_.each(e,function(e,t){e.userAnswer=this.$(".textinput-item-textbox").eq(t).val()},this);this.isCorrect();var t=new Array(e.length);_.each(e,function(e,i){t[e._index]=e._answerIndex});this.model.set("_userAnswer",t)},isCorrect:function(){if(this.model.get("_answers"))this.markGenericAnswers();else this.markSpecificAnswers();return!_.contains(_.pluck(this.model.get("_items"),"_isCorrect"),false)},markGenericAnswers:function(){var e=0;var t=this.model.get("_answers").slice();var i=[];_.each(this.model.get("_items"),function(n,r){_.each(t,function(t,r){if(this.checkAnswerIsCorrect(t,n.userAnswer)){if(_.indexOf(i,r)>-1)return;i.push(r);n._isCorrect=true;n._answerIndex=r+s;e++;this.model.set("_numberOfCorrectAnswers",e);this.model.set("_isAtLeastOneCorrectSelection",true)}},this);if(!n._isCorrect)n._isCorrect=false},this)},markSpecificAnswers:function(){var e=0;var t=0;_.each(this.model.get("_items"),function(i,s){if(!i._answers)return;var n=i.userAnswer||"";if(this.checkAnswerIsCorrect(i["_answers"],n)){e++;i._isCorrect=true;i._answerIndex=_.indexOf(i["_answers"],this.cleanupUserAnswer(n));this.model.set("_numberOfCorrectAnswers",e);this.model.set("_isAtLeastOneCorrectSelection",true)}else{i._isCorrect=false;i._answerIndex=-1}t++},this)},checkAnswerIsCorrect:function(e,t){var i=this.cleanupUserAnswer(t);var s=_.filter(e,function(e){return this.cleanupUserAnswer(e)==i},this);var n=s&&s.length>0;if(n)this.model.set("_hasAtLeastOneCorrectSelection",true);return n},cleanupUserAnswer:function(e){if(this.model.get("_allowsAnyCase")){e=e.toLowerCase()}if(this.model.get("_allowsPunctuation")){e=e.replace(/[\.,-\/#!$%\^&\*;:{}=\-_`~()]/g,"");e=e.replace(/(  +)+/g," ")}return $.trim(e)},setScore:function(){var e=this.model.get("_numberOfCorrectAnswers");var t=this.model.get("_questionWeight");var i=this.model.get("_items").length;var s=t*e/i;this.model.set("_score",s)},showMarking:function(){if(!this.model.get("_canShowMarking"))return;_.each(this.model.get("_items"),function(e,t){var i=this.$(".textinput-item").eq(t);i.removeClass("correct incorrect").addClass(e._isCorrect?"correct":"incorrect")},this)},isPartlyCorrect:function(){return this.model.get("_isAtLeastOneCorrectSelection")},resetUserAnswer:function(){_.each(this.model.get("_items"),function(e){e["_isCorrect"]=false;e["userAnswer"]=""},this)},resetQuestion:function(){this.$(".textinput-item-textbox").prop("disabled",!this.model.get("_isEnabled")).val("");this.model.set({_isAtLeastOneCorrectSelection:false,_isCorrect:undefined})},showCorrectAnswer:function(){if(this.model.get("_answers")){var e=this.model.get("_answers");_.each(this.model.get("_items"),function(t,i){this.$(".textinput-item-textbox").eq(i).val(e[i][0])},this)}else{_.each(this.model.get("_items"),function(e,t){this.$(".textinput-item-textbox").eq(t).val(e._answers[0])},this)}},hideCorrectAnswer:function(){_.each(this.model.get("_items"),function(e,t){this.$(".textinput-item-textbox").eq(t).val(e.userAnswer)},this)},getResponse:function(){return _.pluck(this.model.get("_items"),"userAnswer").join("[,]")},getResponseType:function(){return"fill-in"}});i.register("textinput",n);return n});define("components/adapt-expose/js/adapt-expose",["require","coreViews/componentView","coreJS/adapt"],function(e){function t(e){if(!e)return false;return e.replace(/([A-Z])/g,"-$1").toLowerCase()}var i=e("coreViews/componentView");var s=e("coreJS/adapt");var n=i.extend({events:{"click .expose-item-cover":"toggleItem","click .expose-item-content":"toggleItem","click .expose-item-button":"toggleItem"},onDeviceResize:function(){this.setupColumns();this.setEqualHeights()},preRender:function(){this.animationType=t(this.model.get("_animationType"))||"fade"},postRender:function(){this.$(".expose-item").children().addClass(this.animationType);this.setupColumns();this.setupEventListeners();this.$(".expose-item-img").imageready(_.bind(this.onImageReady,this))},onImageReady:function(){this.setEqualHeights();this.setReadyStatus()},setupColumns:function(){if(this.model.get("_columns")&&$(window).width()>760){var e=100/this.model.get("_columns")+"%";this.$(".expose-items").addClass("expose-columns");this.$(".expose-item").width(e).addClass("expose-column")}else{this.$(".expose-items").removeClass("expose-columns");this.$(".expose-item").width("auto").removeClass("expose-column")}},setEqualHeights:function(){if(this.model.get("_equalHeights")===false)return;var e=this.$(".expose-item-content");e.height("auto");var t=0;_.each(e,function(e){var i=$(e).outerHeight();if(i>t)t=i});e.height(t)},setupEventListeners:function(){this.listenTo(s,{"device:resize":this.onDeviceResize})},toggleItem:function(e){if(e.target.tagName==="A")return;var t=$(e.currentTarget).parent();var i=t.children(".expose-item-cover");i.toggleClass(this.animationType);if(!i.is(".visited")){i.addClass("visited");var s=i.parents(".expose-item").index();this.model.get("_items")[s]._isVisited=true;this.evaluateCompletion()}},evaluateCompletion:function(){var e=_.filter(this.model.get("_items"),function(e){return!e._isVisited});!e.length&&this.onComplete()},onComplete:function(){this.setCompletionStatus()}});s.register("expose",n);return n});(function(e){"use strict";if(typeof define==="function"&&define.amd){define("components/adapt-graphicSlider/js/rangeslider.js",["jquery"],e)}else if(typeof exports==="object"){module.exports=e(require("jquery"))}else{e(jQuery)}})(function(e){"use strict";Number.isNaN=Number.isNaN||function(e){return typeof e==="number"&&e!==e};function t(){var e=document.createElement("input");e.setAttribute("type","range");return e.type!=="text"}var i="rangeslider",s=0,n=t(),r={polyfill:true,orientation:"horizontal",rangeClass:"rangeslider",disabledClass:"rangeslider--disabled",horizontalClass:"rangeslider--horizontal",verticalClass:"rangeslider--vertical",fillClass:"rangeslider__fill",handleClass:"rangeslider__handle",startEvent:["mousedown","touchstart","pointerdown"],moveEvent:["mousemove","touchmove","pointermove"],endEvent:["mouseup","touchend","pointerup"]},o={orientation:{horizontal:{dimension:"width",direction:"left",directionStyle:"left",coordinate:"x"},vertical:{dimension:"height",direction:"top",directionStyle:"bottom",coordinate:"y"}}};function a(e,t){var i=Array.prototype.slice.call(arguments,2);return setTimeout(function(){return e.apply(null,i)},t)}function l(e,t){t=t||100;return function(){if(!e.debouncing){var i=Array.prototype.slice.apply(arguments);e.lastReturnVal=e.apply(window,i);e.debouncing=true}clearTimeout(e.debounceTimeout);e.debounceTimeout=setTimeout(function(){e.debouncing=false},t);return e.lastReturnVal}}function c(e){return e&&(e.offsetWidth===0||e.offsetHeight===0||e.open===false)}function d(e){var t=[],i=e.parentNode;while(c(i)){t.push(i);i=i.parentNode}return t}function u(e,t){var i=d(e),s=i.length,n=[],r=e[t];function o(e){if(typeof e.open!=="undefined"){e.open=e.open?false:true}}if(s){for(var a=0;a<s;a++){n[a]=i[a].style.cssText;if(i[a].style.setProperty){i[a].style.setProperty("display","block","important")}else{i[a].style.cssText+=";display: block !important"}i[a].style.height="0";i[a].style.overflow="hidden";i[a].style.visibility="hidden";o(i[a])}r=e[t];for(var l=0;l<s;l++){i[l].style.cssText=n[l];o(i[l])}}return r}function h(e,t){var i=parseFloat(e);return Number.isNaN(i)?t:i}function f(e){return e.charAt(0).toUpperCase()+e.substr(1)}function p(t,c){this.$window=e(window);this.$document=e(document);this.$element=e(t);this.options=e.extend({},r,c);this.polyfill=this.options.polyfill;this.orientation=this.$element[0].getAttribute("data-orientation")||this.options.orientation;this.onInit=this.options.onInit;this.onSlide=this.options.onSlide;this.onSlideEnd=this.options.onSlideEnd;this.DIMENSION=o.orientation[this.orientation].dimension;this.DIRECTION=o.orientation[this.orientation].direction;this.DIRECTION_STYLE=o.orientation[this.orientation].directionStyle;this.COORDINATE=o.orientation[this.orientation].coordinate;if(this.polyfill){if(n){return false}}this.identifier="js-"+i+"-"+s++;this.startEvent=this.options.startEvent.join("."+this.identifier+" ")+"."+this.identifier;this.moveEvent=this.options.moveEvent.join("."+this.identifier+" ")+"."+this.identifier;this.endEvent=this.options.endEvent.join("."+this.identifier+" ")+"."+this.identifier;this.toFixed=(this.step+"").replace(".","").length-1;this.$fill=e('<div class="'+this.options.fillClass+'" />');this.$handle=e('<div class="'+this.options.handleClass+'" />');this.$range=e('<div class="'+this.options.rangeClass+" "+this.options[this.orientation+"Class"]+'" id="'+this.identifier+'" />').insertAfter(this.$element).prepend(this.$fill,this.$handle);this.$element.css({position:"absolute",width:"1px",height:"1px",overflow:"hidden",opacity:"0"});this.handleDown=e.proxy(this.handleDown,this);this.handleMove=e.proxy(this.handleMove,this);this.handleEnd=e.proxy(this.handleEnd,this);this.init();var d=this;this.$window.on("resize."+this.identifier,l(function(){a(function(){d.update(false,false)},300)},20));this.$document.on(this.startEvent,"#"+this.identifier+":not(."+this.options.disabledClass+")",this.handleDown);this.$element.on("change."+this.identifier,function(e,t){if(t&&t.origin===d.identifier){return}var i=e.target.value,s=d.getPositionFromValue(i);d.setPosition(s)})}p.prototype.init=function(){this.update(true,false);if(this.onInit&&typeof this.onInit==="function"){this.onInit()}};p.prototype.update=function(e,t){e=e||false;if(e){this.min=h(this.$element[0].getAttribute("min"),0);this.max=h(this.$element[0].getAttribute("max"),100);
this.value=h(this.$element[0].value,Math.round(this.min+(this.max-this.min)/2));this.step=h(this.$element[0].getAttribute("step"),1)}this.handleDimension=u(this.$handle[0],"offset"+f(this.DIMENSION));this.rangeDimension=u(this.$range[0],"offset"+f(this.DIMENSION));this.maxHandlePos=this.rangeDimension-this.handleDimension;this.grabPos=this.handleDimension/2;this.position=this.getPositionFromValue(this.value);if(this.$element[0].disabled){this.$range.addClass(this.options.disabledClass)}else{this.$range.removeClass(this.options.disabledClass)}this.setPosition(this.position,t)};p.prototype.handleDown=function(e){this.$document.on(this.moveEvent,this.handleMove);this.$document.on(this.endEvent,this.handleEnd);if((" "+e.target.className+" ").replace(/[\n\t]/g," ").indexOf(this.options.handleClass)>-1){return}var t=this.getRelativePosition(e),i=this.$range[0].getBoundingClientRect()[this.DIRECTION],s=this.getPositionFromNode(this.$handle[0])-i,n=this.orientation==="vertical"?this.maxHandlePos-(t-this.grabPos):t-this.grabPos;this.setPosition(n);if(t>=s&&t<s+this.handleDimension){this.grabPos=t-s}};p.prototype.handleMove=function(e){e.preventDefault();var t=this.getRelativePosition(e);var i=this.orientation==="vertical"?this.maxHandlePos-(t-this.grabPos):t-this.grabPos;this.setPosition(i)};p.prototype.handleEnd=function(e){e.preventDefault();this.$document.off(this.moveEvent,this.handleMove);this.$document.off(this.endEvent,this.handleEnd);this.$element.trigger("change",{origin:this.identifier});if(this.onSlideEnd&&typeof this.onSlideEnd==="function"){this.onSlideEnd(this.position,this.value)}};p.prototype.cap=function(e,t,i){if(e<t){return t}if(e>i){return i}return e};p.prototype.setPosition=function(e,t){var i,s;if(t===undefined){t=true}i=this.getValueFromPosition(this.cap(e,0,this.maxHandlePos));s=this.getPositionFromValue(i);this.$fill[0].style[this.DIMENSION]=i==this.max?"100%":s+this.grabPos+"px";this.$handle[0].style[this.DIRECTION_STYLE]=s+"px";this.setValue(i);this.position=s;this.value=i;if(t&&this.onSlide&&typeof this.onSlide==="function"){this.onSlide(s,i)}};p.prototype.getPositionFromNode=function(e){var t=0;while(e!==null){t+=e.offsetLeft;e=e.offsetParent}return t};p.prototype.getRelativePosition=function(e){var t=f(this.COORDINATE),i=this.$range[0].getBoundingClientRect()[this.DIRECTION],s=0;if(typeof e["page"+t]!=="undefined"){s=e["client"+t]}else if(typeof e.originalEvent["client"+t]!=="undefined"){s=e.originalEvent["client"+t]}else if(e.originalEvent.touches&&e.originalEvent.touches[0]&&typeof e.originalEvent.touches[0]["client"+t]!=="undefined"){s=e.originalEvent.touches[0]["client"+t]}else if(e.currentPoint&&typeof e.currentPoint[this.COORDINATE]!=="undefined"){s=e.currentPoint[this.COORDINATE]}return s-i};p.prototype.getPositionFromValue=function(e){var t,i;t=(e-this.min)/(this.max-this.min);i=!Number.isNaN(t)?t*this.maxHandlePos:0;return i};p.prototype.getValueFromPosition=function(e){var t,i;t=e/(this.maxHandlePos||1);i=this.step*Math.round(t*(this.max-this.min)/this.step)+this.min;return Number(i.toFixed(this.toFixed))};p.prototype.setValue=function(e){if(e===this.value&&this.$element[0].value!==""){return}this.$element.val(e).trigger("input",{origin:this.identifier})};p.prototype.destroy=function(){this.$document.off("."+this.identifier);this.$window.off("."+this.identifier);this.$element.off("."+this.identifier).removeAttr("style").removeData("plugin_"+i);if(this.$range&&this.$range.length){this.$range[0].parentNode.removeChild(this.$range[0])}};e.fn[i]=function(t){var s=Array.prototype.slice.call(arguments,1);return this.each(function(){var n=e(this),r=n.data("plugin_"+i);if(!r){n.data("plugin_"+i,r=new p(this,t))}if(typeof t==="string"){r[t].apply(r,s)}})};return"rangeslider.js is available in jQuery context e.g $(selector).rangeslider(options);"});define("components/adapt-graphicSlider/js/adapt-graphicSlider",["coreViews/componentView","coreJS/adapt","./rangeslider.js"],function(e,t,i){var s=e.extend({events:{'focus input[type="range"]':"onHandleFocus",'blur input[type="range"]':"onHandleBlur"},preRender:function(){if(this.model.get("_items")){this.setupModelItems()}this.selectItem(0,true);this.$el.addClass("no-state");this.checkIfResetOnRevisit()},postRender:function(){this.setupRangeslider();this.setScalePositions();this.onScreenSizeChanged();this.showScaleMarker(true);this.listenTo(t,"device:resize",this.onScreenSizeChanged);this.setAltText(this.model.get("_scaleStart"));this.setReadyStatus();this.selectItem(0,true)},checkIfResetOnRevisit:function(){var e=this.model.get("_isResetOnRevisit");if(e){this.model.reset(e)}},animateToPosition:function(e){if(!this.$sliderScaleMarker)return;if(this.model.get("_marginDir")=="right"){this.$sliderScaleMarker.velocity("stop").velocity({left:e},{duration:200,easing:"linear"})}else{this.$sliderScaleMarker.velocity("stop").velocity({left:e},{duration:200,easing:"linear"})}},getIndexFromValue:function(e){var t=this.model.get("_scaleStart"),i=this.model.get("_scaleEnd");return Math.floor(this.mapValue(e,t,i,0,this.model.get("_items").length-1))},setAltText:function(e){this.$(".graphicSlider-handle").attr("aria-valuenow",e)},mapIndexToPixels:function(e,t){var i=this.model.get("_items").length,s=t?t.width():this.$(".graphicSlider-scaler").width();return Math.round(this.mapValue(e,0,i-1,0,s))},mapPixelsToIndex:function(e){var t=this.model.get("_items").length,i=this.$(".graphicSlider-sliderange").width();return Math.round(this.mapValue(e,0,i,0,t-1))},normalise:function(e,t,i){var s=i-t;return(e-t)/s},mapValue:function(e,t,i,s,n){var r=this.normalise(e,t,i);return r*(n-s)+s},onHandleFocus:function(e){e.preventDefault();this.$infoSlider.on("keydown",_.bind(this.onKeyDown,this))},onHandleBlur:function(e){e.preventDefault();this.$infoSlider.off("keydown")},onKeyDown:function(e){if(e.which==9)return;e.preventDefault();var t=this.getIndexFromValue(this.model.get("_selectedItem").value);switch(e.which){case 40:case 37:t=Math.max(t-1,0);break;case 38:case 39:t=Math.min(t+1,this.model.get("_items").length-1);break}this.selectItem(t);if(typeof t=="number")this.showScaleMarker(true);this.animateToPosition(this.mapIndexToPixels(t));this.setSliderValue(this.getValueFromIndex(t));this.setAltText(this.getValueFromIndex(t))},onNumberSelected:function(e){e.preventDefault();this.tempValue=false;if(this.model.get("_isInteractionComplete")){return}if(this.$infoSlider.prop("disabled")){return}var t=parseInt($(e.currentTarget).attr("data-id"));var i=this.getIndexFromValue(t);this.selectItem(i);this.animateToPosition(this.mapIndexToPixels(i));this.setAltText(t);this.setSliderValue(t)},getValueFromIndex:function(e){return this.model.get("_items")[e].value},setupRangeslider:function(){this.$sliderScaleMarker=this.$(".graphicSlider-scale-marker");this.$infoSlider=this.$('input[type="range"]');if(this.model.has("_scaleStep")){this.$infoSlider.attr({step:this.model.get("_scaleStep")})}this.$infoSlider.rangeslider({polyfill:false,onSlide:_.bind(this.handleSlide,this)});this.oldValue=0;if(this._deferEnable){this.setAllItemsEnabled()}},handleSlide:function(e,t){if(this.oldValue===t){return}if(this.model.get("_marginDir")=="right"){console.log("marginDir");if(this.tempValue&&this.model.get("_userAnswer")==undefined){t=this.model.get("_items").length-t+1;this.tempValue=false;var i=this.mapIndexToPixels(t);var s=this.$(".rangeslider").width();var n=parseInt(this.$(".rangeslider__handle").css("left"));var r=this.$(".rangeslider__fill").width();n=s-n-this.$(".rangeslider__handle").width();this.$(".rangeslider__handle").css("right",n);this.$(".rangeslider__fill").width(r)}}var o=this.getIndexFromValue(t);var a=this.mapIndexToPixels(o);this.selectItem(o,false);this.animateToPosition(a);this.oldValue=t;this.tempValue=true},setupModelItems:function(){var e=this.model.get("_items");var i=this.model.get("_correctAnswer")||1;var s=this.model.get("_correctRange")||1;if(!this.model.get("_scaleStart"))this.model.set("_scaleStart",1);if(!this.model.get("_scaleEnd"))this.model.set("_scaleEnd",e.length);var n=this.model.get("_scaleStart");var r=this.model.get("_scaleEnd");var o=this.model.get("_scaleStep")||1;for(var a=n,l=0;a<=r;a+=o,l++){if(i){if(this.verifyBrowser("IE")){$.extend(e[l],{value:a,selected:false,correct:a==i})}else{Object.assign(e[l],{value:a,selected:false,correct:a==i})}}else{if(this.verifyBrowser("IE")){$.extend(e[l],{value:a,selected:false,correct:a>=s._bottom&&a<=s._top})}else{Object.assign(e[l],{value:a,selected:false,correct:a>=s._bottom&&a<=s._top})}}}this.model.set("_items",e);this.model.set("_marginDir",t.config.get("_defaultDirection")==="rtl"?"right":"left")},verifyBrowser:function(e){var t=false;switch(e){case"OPERA":t=!!window.opr&&!!opr.addons||!!window.opera||navigator.userAgent.indexOf(" OPR/")>=0;break;case"FIREFOX":t=typeof InstallTrigger!=="undefined";break;case"SAFARI":t=/constructor/i.test(window.HTMLElement)||function(e){return e.toString()==="[object SafariRemoteNotification]"}(!window["safari"]||safari.pushNotification);break;case"IE":t=false||!!document.documentMode;break;case"EDGE":t=!isIE&&!!window.StyleMedia;break;case"CHROME":t=!!window.chrome&&!!window.chrome.webstore;break;case"BLINK":t=(isChrome||isOpera)&&!!window.CSS;break}return t},setAllItemsEnabled:function(){var e=this.model.get("_isEnabled");if(this.$infoSlider){if(e){this.$(".graphicSlider-widget").removeClass("disabled");this.$infoSlider.prop("disabled",false);this.$infoSlider.rangeslider("update",true)}else{this.$(".graphicSlider-widget").addClass("disabled");this.$infoSlider.prop("disabled",true);this.$infoSlider.rangeslider("update",true)}}else{this._deferEnable=true}},setScalePositions:function(){var e=this.model.get("_items").length;_.each(this.model.get("_items"),function(t,i){var s=this.normalise(i,0,e-1);this.$(".graphicSlider-scale-number").eq(i).data("normalisedPosition",s)},this)},showScale:function(){this.$(".graphicSlider-markers").empty();if(this.model.get("_showScale")===false){this.$(".graphicSlider-markers").eq(0).css({display:"none"});this.model.get("_showScaleIndicator")?this.$(".graphicSlider-scale-numbers").eq(0).css({visibility:"hidden"}):this.$(".graphicSlider-scale-numbers").eq(0).css({display:"none"})}else{var e=this.$(".graphicSlider-scaler");var t=this.$(".graphicSlider-markers");for(var i=0,s=this.model.get("_items").length;i<s;i++){t.append("<div class='graphicSlider-line component-item-color'>");$(".graphicSlider-line",t).eq(i).css({left:this.mapIndexToPixels(i,e)+"px"})}var n=e.width(),r=this.$(".graphicSlider-scale-number");for(var i=0,s=this.model.get("_items").length;i<s;i++){var o=r.eq(i),a=Math.round(o.data("normalisedPosition")*n);if($("html").hasClass("ie9")&&this.model.get("_marginDir")=="right"){o.css({right:a})}else{o.css({left:a})}}}},showLabels:function(){if(!this.model.get("labelStart")&&!this.model.get("labelEnd")){this.$(".graphicSlider-scale-labels").eq(0).css({display:"none"})}},remapSliderBar:function(){var e=this.$(".graphicSlider-scaler");var t=this.getIndexFromValue(this.model.get("_selectedItem").value);var i=this.mapIndexToPixels(t,e);this.$(".graphicSlider-handle").css({left:i+"px"});this.$(".graphicSlider-scale-marker").css({left:i+"px"});this.$(".graphicSlider-bar").width(i)},onScreenSizeChanged:function(){this.showScale();this.showLabels();this.remapSliderBar();if(this.$(".graphicSlider-widget").hasClass("show-user-answer")){this.hideCorrectAnswer()}else if(this.$(".graphicSlider-widget").hasClass("show-correct-answer")){this.showCorrectAnswer()}},selectItem:function(e,t){this.$el.a11y_selected(false);this.$(".graphicSlider-info").addClass("display-none");_.each(this.model.get("_items"),function(i,s){i.selected=s==e;if(i.selected){this.model.set("_selectedItem",i);this.$('.graphicSlider-scale-number[data-id="'+i.value+'"]').a11y_selected(true,t);this.$("#info-"+s).removeClass("display-none");i._isVisited=true}},this);this.showNumber(true);this.checkCompletionStatus()},deselectAllItems:function(){_.each(this.model.get("_items"),function(e){e.selected=false},this)},showScaleMarker:function(e){var t=this.$(".graphicSlider-scale-marker");if(this.model.get("_showScaleIndicator")){this.showNumber(e);if(e){t.addClass("display-block")}else{t.removeClass("display-block")}}},showNumber:function(e){var t=this.$(".graphicSlider-scale-marker");if(this.model.get("_showNumber")){if(e){t.html(this.model.get("_selectedItem").value)}else{t.html=""}}},getVisitedItems:function(){return _.filter(this.model.get("_items"),function(e){return e._isVisited})},checkCompletionStatus:function(){if(this.getVisitedItems().length==this.model.get("_items").length){this.setCompletionStatus()}},inview:function(e,t,i,s){if(t){if(s==="top"){this._isVisibleTop=true}else if(s==="bottom"){this._isVisibleBottom=true}else{this._isVisibleTop=true;this._isVisibleBottom=true}if(this._isVisibleTop&&this._isVisibleBottom){this.$(".component-inner").off("inview");this.setCompletionStatus()}}}});t.register("graphicSlider",s);return s});define("components/adapt-likert/js/adapt-likert",["require","coreViews/questionView","coreJS/adapt"],function(e){var t=e("coreViews/questionView");var i=e("coreJS/adapt");var s=t.extend({events:{"focus .likert-item input":"onItemFocus","blur .likert-item input":"onItemBlur","click .likert-item":"onItemSelected","change .select":"onSelectItem","keyup .likert-radio-row input":"onKeyPress"},resetQuestionOnRevisit:function(){this.setAllItemsEnabled(true);this.resetQuestion()},setupQuestion:function(){this.model.set("_isRadio",this.model.get("_selectable")==1);this.model.set("_selectedItems",[]);this.model.set("_selectedOptions",[]);this.setupQuestionItemIndexes();this.setupRandomisation();this.restoreUserAnswers();if(i.device.screenSize=="large"||i.device.screenSize=="medium"){this.model.set("_desktop",true)}else{this.model.set("_desktop",false);this.model.set("instruction",this.model.get("mobileInstruction"))}if(i.device.screenSize=="medium"){this.model.set("instruction",this.model.get("tabInstruction"))}},setupQuestionItemIndexes:function(){var e=this.model.get("_items");for(var t=0,i=e.length;t<i;t++){if(e[t]._index===undefined)e[t]._index=t}},setupRandomisation:function(){if(this.model.get("_isRandom")&&this.model.get("_isEnabled")){this.model.set("_items",_.shuffle(this.model.get("_items")))}},restoreUserAnswers:function(){if(!this.model.get("_isSubmitted"))return;var e=[];var t=this.model.get("_items");var i=this.model.get("_userAnswer");_.each(t,function(t,s){t._isSelected=i[t._index];if(t._isSelected){e.push(t)}});this.model.set("_selectedItems",e);this.setQuestionAsSubmitted();this.markQuestion();this.setScore();this.showMarking();this.setupFeedback()},disableQuestion:function(){this.setAllItemsEnabled(false)},enableQuestion:function(){this.setAllItemsEnabled(true)},setAllItemsEnabled:function(e){_.each(this.model.get("_items"),function(t,i){var s=this.$(".likert-radio-row").eq(i);if(e){s.prop("disabled",false)}else{s.prop("disabled",true)}},this)},onQuestionRendered:function(){this.setReadyStatus()},onKeyPress:function(e){if(e.which===13){this.onItemSelected(e)}},onItemFocus:function(e){if(this.model.get("_isEnabled")&&!this.model.get("_isSubmitted")){$("div[for='"+$(e.currentTarget).attr("id")+"']").addClass("highlighted")}},onItemBlur:function(e){$("div[for='"+$(e.currentTarget).attr("id")+"']").removeClass("highlighted")},onSelectItem:function(e){if(this.model.get("_isEnabled")&&!this.model.get("_isSubmitted")){var t=this.model.get("_items")[$(e.currentTarget).parent().parent().parent().index()];t._optionSelected=$(e.currentTarget)[0].selectedIndex;this.markSelected(t)}},markSelected:function(e){var t=this.model.get("_selectedItems");var i=_.indexOf(this.model.get("_items"),e),s=this.$(".likert-answer-option").eq(i);if(!e._optionSelected){s.find(".likert-item-state").removeClass("selected");s.find(".likert-select-item").removeClass("selected");e._isSelected=false}else{s.find(".likert-item-state").addClass("selected");s.find(".likert-select-item").addClass("selected");s.a11y_selected(true);e._isSelected=true}t.push(e);this.model.set("_selectedItems",t)},onItemSelected:function(e){if(this.model.get("_isEnabled")&&!this.model.get("_isSubmitted")){var t=this.model.get("_items")[$(e.currentTarget).parent().parent().index()];t._optionSelected=parseInt($(e.currentTarget).attr("id"))*-1+1;this.toggleItemSelected(t,e)}},toggleItemSelected:function(e,t){var i=this.model.get("_selectedItems");var s=_.indexOf(this.model.get("_items"),e),n=e._optionSelected-1,r=this.$(".likert-answer-option").eq(s).find(".likert-item-state").eq(n),o=this.$(".likert-answer-option").eq(s).find("input").eq(n);this.$(".likert-answer-option").eq(s).find(".likert-item-state").removeClass("selected");this.$(".likert-answer-option").eq(s).find("input").prop("checked",false);this.$(".likert-answer-option").eq(s).find(".likert-item").removeClass("selected");r.addClass("selected");r.parent().addClass("selected");r.a11y_selected(true);o.prop("checked",true);e._isSelected=true;i.push(e);this.model.set("_selectedItems",i)},canSubmit:function(){var e=0;_.each(this.model.get("_items"),function(t,i){if(t._isSelected){e++}},this);return e==this.model.get("_items").length?true:false},storeUserAnswer:function(){var e=[];var t=this.model.get("_items").slice(0);t.sort(function(e,t){return e._index-t._index});_.each(t,function(t,i){e.push(t._optionSelected)},this);this.model.set("_userAnswer",e);this.$("select").attr("disabled","disabled")},isCorrect:function(){var e=0;var t=0;var i=0;_.each(this.model.get("_items"),function(s,n){var r=s._isSelected||false;var o=s._optionSelected;if(s._shouldBeSelected){e++;if(o==s._shouldBeSelected){t++;s._isCorrect=true;this.model.set("_isAtLeastOneCorrectSelection",true)}}else if(!s._shouldBeSelected&&r){i++}},this);this.model.set("_numberOfCorrectAnswers",t);this.model.set("_numberOfRequiredAnswers",e);var s=t===e&&i===0;return s},setScore:function(){var e=this.model.get("_questionWeight");var t=this.model.get("_isCorrect");var i=t?e:0;this.model.set("_score",i)},setupFeedback:function(){if(this.model.get("_isCorrect")){this.setupCorrectFeedback()}else if(this.isPartlyCorrect()){this.setupPartlyCorrectFeedback()}else{if(this.model.get("_selectable")===1&&this.model.get("_selectedItems")[0].feedback){this.setupIndividualFeedback(this.model.get("_selectedItems")[0]);return}else{this.setupIncorrectFeedback()}}},setupIndividualFeedback:function(e){this.model.set({feedbackTitle:this.model.get("title"),feedbackMessage:e.feedback})},showMarking:function(){_.each(this.model.get("_items"),function(e,t){var i=this.$(".likert-answer-option").eq(t);i.removeClass("correct incorrect").addClass(e._isCorrect?"correct":"incorrect")},this)},isPartlyCorrect:function(){return this.model.get("_isAtLeastOneCorrectSelection")},resetUserAnswer:function(){this.model.set({_userAnswer:[]})},resetQuestion:function(){this.deselectAllItems();this.resetItems()},deselectAllItems:function(){this.$el.a11y_selected(false);_.each(this.model.get("_items"),function(e){e._isSelected=false},this);if(this.model.get("_desktop")){this.$(".likert-item-state").removeClass("selected");this.$("input").prop("checked",false);this.$(".likert-item").removeClass("selected")}else{this.$(".likert-item-state").removeClass("selected");this.$(".likert-select-item").removeClass("selected")}},resetItems:function(){_.each(this.model.get("_items"),function(e){e._isCorrect=false},this);this.model.set({_selectedItems:[],_isAtLeastOneCorrectSelection:false})},showCorrectAnswer:function(){this.deselectAllItems();_.each(this.model.get("_items"),function(e,t){this.setOptionSelected(t,e._shouldBeSelected)},this)},setOptionSelected:function(e,t){if(this.model.get("_desktop")){var i=t-1,s=this.$(".likert-answer-option").eq(e).find(".likert-item-state").eq(i),n=this.$(".likert-answer-option").eq(e).find("input").eq(i);if(t){s.addClass("selected");n.prop("checked",true);s.parent().addClass("selected")}else{s.removeClass("selected");n.prop("checked",false);s.parent().removeClass("selected")}}else{var s=this.$(".likert-answer-option").eq(e).find(".likert-item-state"),n=this.$(".likert-answer-option").eq(e).find("select");if(t){s.addClass("selected");n.find("option").eq(t)[0].selected=true;s.parent().addClass("selected")}}},hideCorrectAnswer:function(){this.deselectAllItems();if(this.model.get("_desktop")){_.each(this.model.get("_items"),function(e,t){this.setOptionSelected(t,this.model.get("_userAnswer")[e._index])},this)}else{_.each(this.model.get("_items"),function(e,t){this.setOptionSelected(t,e._optionSelected)},this)}},getResponse:function(){var e=_.where(this.model.get("_items"),{_isSelected:true});var t=[];if(this.model.get("_desktop")){t=_.pluck(e,"_index");for(var i=0,s=t.length;i<s;i++){t[i]++}}else{t=_.pluck(e,"_optionSelected")}return t.join(",")},getResponseType:function(){return"choice"}});i.register("likert",s);return s});define("components/adapt-textPlus/js/adapt-textPlus",["require","coreViews/componentView","coreJS/adapt"],function(e){var t=e("coreViews/componentView");var i=e("coreJS/adapt");var s=t.extend({events:function(){return i.device.touch==true?{"touchstart .textPlus-popup-open":"openPopup","click .textPlus-popup-open":"openPopup","touchstart .textPlus-popup-close":"closePopup","click .textPlus-popup-close":"closePopup"}:{"click .textPlus-popup-open":"openPopup","click .textPlus-popup-close":"closePopup"}},preRender:function(){this.listenTo(i,"device:changed",this.setDeviceSize,this);this.listenTo(i,"device:changed",this.resizeImage);this.listenTo(i,"device:resize",this.setDeviceSize,this);this.checkIfResetOnRevisit();this.setDeviceSize()},checkIfResetOnRevisit:function(){var e=this.model.get("_isResetOnRevisit");if(e){this.model.set({_isEnabled:true,_isComplete:false})}},setDeviceSize:function(){if(i.device.screenSize==="small"){var e=100;var t;if(this.model.get("_maxBodyCharacters")==undefined){t=e}else{t=this.model.get("_maxBodyCharacters")}console.log("firstCharLimit ",t);if(t==0)t=e;var s=this.model.get("body")&&this.model.get("body").length>t;if(s){if(t>0){this.model.set("body-short",this.model.get("body").substring(0,t)+"...")}}this.model.set("_displayShortText",s);if(s){this.$(".textPlus-short").removeClass("textPlus-hidden");this.$(".textPlus-long").addClass("textPlus-hidden")}return}this.model.set("_displayShortText",false);this.$(".textPlus-short").addClass("textPlus-hidden");this.$(".textPlus-long").removeClass("textPlus-hidden")},postRender:function(){if(this.model.has("_graphic")){this.resizeImage(i.device.screenSize)}else{this.setReadyStatus()}if(this.model.get("_displayShortText")===false){var e=this.$(".component-instruction").length>0?".component-instruction":this.$(".component-body").length>0?".component-body":null;if(!e){this.setCompletionStatus()}else{this.model.set("cssSelector",e);this.$(e).on("inview",_.bind(this.inview,this));this.listenTo(this.model,"change:_isComplete",this.removeInviewListener)}if(this.$(".textPlus-long").find("div")){this.$(".textPlus-long").find("div").removeClass("prevent-default accessible-text-block")}}},resizeImage:function(e){var t=this.$(".textPlus-graphic-inner img").attr("data-"+e);this.$(".textPlus-graphic-inner img").attr("src",t);this.$(".textPlus-graphic-inner").imageready(_.bind(function(){this.setReadyStatus()},this))},openPopup:function(e){e.preventDefault();var t={title:this.model.get("title"),body:this.model.get("body")};this.model._isVisited=true;i.trigger("notify:popup",t)},closePopup:function(e){e.preventDefault();this.$(".textPlus-popup-close").blur();this.$(".textPlus-popup-content").addClass("textPlus-hidden");this.$(".textPlus-popup").addClass("textPlus-hidden");i.trigger("popup:closed")},inview:function(e,t,i,s){if(t){if(s==="top"){this._isVisibleTop=true}else if(s==="bottom"){this._isVisibleBottom=true}else{this._isVisibleTop=true;this._isVisibleBottom=true}if(this._isVisibleTop&&this._isVisibleBottom){this.$(this.model.get("cssSelector")).off("inview");this.setCompletionStatus()}}},removeInviewListener:function(e,t){if(t){this.$(this.model.get("cssSelector")).off("inview")}},remove:function(){this.$(this.model.get("cssSelector")).off("inview");Backbone.View.prototype.remove.apply(this,arguments)}});i.register("textPlus",s);return s});define("components/adapt-multiColTextPlus/js/adapt-multiColTextPlus",["require","coreViews/componentView","coreJS/adapt","bowser","components/adapt-textPlus/js/adapt-textPlus"],function(e){var t=e("coreViews/componentView");var i=e("coreJS/adapt");var s=e("bowser");var n=e("components/adapt-textPlus/js/adapt-textPlus");var r=Backbone.Collection.extend({model:n});var o=new r;var a=t.extend({preRender:function(){this.checkIfResetOnRevisit();this.setDeviceSize()},checkIfResetOnRevisit:function(){var e=this.model.get("_isResetOnRevisit");if(e){this.model.set({_isEnabled:true,_isComplete:false})}},setDeviceSize:function(){if(s.mobile){this.model.set("_isDesktop",false);return}if(s.tablet&&window.innerHeight>window.innerWidth){this.model.set("_isDesktop",true);return}if(i.device.screenSize==="large"){this.model.set("_isDesktop",true);return}if(i.device.screenSize==="medium"&&!(s.tablet===true)){this.model.set("_isDesktop",true);return}if(i.device.screenSize==="small"){this.model.set("_isDesktop",false)}},postRender:function(){this.buildColumns();this.formatColumns();this.setReadyStatus();this.listenTo(i,"device:changed",this.resizeControl,this);this.listenTo(i,"device:resize",this.resizeControl,this);this.$(".component-inner").on("inview",_.bind(this.onInview,this));if(this.model.get("_columnCount")>0){return}},notifyComplete:function(e){var t=this.model.get("_columnCount");var i=0;o.forEach(function(e){if(e.get("_isComplete")){i++}});if(i===t){this.setCompletionStatus()}},buildColumns:function(){this.model.set("_columnCount",this.model.get("_items").length);if(this.model.get("_columnCount")===0){return}var e=0;var t=[];_.each(this.model.get("_items"),function(i,s){if(!i._maxBodyCharacters){i._maxBodyCharacters=0;e=this.model.get("_maxBodyCharacters")}else{e=i._maxBodyCharacters}var r=new Backbone.Model(i);r.set("_id","mct-"+(s+1)).set("_component","textPlus").set("_layout","full").set("_isVisible",true).set("_maxBodyCharacters",e);o.add(r);r.on("change",function(e){this.notifyComplete(e,this)},this);var a=new n({model:r});a.$el.wrapAll('<div class="textPlus-component" />');a.setElement(a.$el.parent());a.$el.addClass(r.get("_id")).removeClass("nth-child-undefined").addClass("nth-child-"+(s+1)).css("margin-left",r.get("_colMarginLeft")).css("width",r.get("_colWidth")).css("margin-right",r.get("_colMarginRight"));t.push(a.render().el)},this);this.$(".multiColTextPlus-widget").append(t)},resizeControl:function(){this.setDeviceSize();this.revertColWidths();this.formatColumns()},revertColWidths:function(){var e=this.$(".textPlus-component");_.each(this.model.get("_items"),function(t,i){e.eq(i).css("margin-left",t._colMarginLeft+"px");e.eq(i).css("width",t._colWidth+"px");e.eq(i).css("margin-right",t._colMarginRight+"px")})},formatColumns:function(){if(this.model.get("_columnCount")===0){return}if(parseInt(this.sumModelWidths())>parseInt($(".component-container").outerWidth())){if(!this.model.get("_maxBodyCharacters")){this.model.set("_maxBodyCharacters",0)}var e=this.$(".textPlus-component");_.each(this.model.get("_items"),function(t,i){if(i<e.length-1){e.eq(i).css("margin-bottom","30px")}},this)}if(this.model.get("_isDesktop")===true){if(this.model.get("_equalizeColWidths")===true&&this.model.get("_equalizeGutters")===true){this.equalizeGutters();this.equalizeColumnWidths();return}if(this.model.get("_equalizeColWidths")===true){this.equalizeColumnWidths();return}if(this.model.get("_equalizeGutters")===true){this.equalizeGutters();return}}if(this.model.get("_isDesktop")===false){console.log("bodyCharacters ",this.model.get("_maxBodyCharacters"));if(!this.model.get("_maxBodyCharacters")){this.model.set("_maxBodyCharacters",0)}console.log("bodyCharacters ",this.model.get("_maxBodyCharacters"));var e=this.$(".textPlus-component");var t=this.$(".multiColTextPlus-widget").width();_.each(this.model.get("_items"),function(i,s){if(i._colWidth>t){e.eq(s).css("margin-left","0").css("width","auto").css("margin-right","0")}var n;if(e.length){n=e.eq(s).offset()}var r=$(".multiColTextPlus-widget").eq(0).offset();var o=e.eq(s).position();if(n.left!==r.left&&o.left===0){e.eq(s).css("margin-left","0")}},this)}},equalizeColumnWidths:function(){var e=this.$(".multiColTextPlus-widget").width();var t=this.model.get("_columnCount");var i=0;_.each(this.model.get("_items"),function(e){i+=e._colMarginLeft+e._colMarginRight});this.$(".textPlus-component").width(parseInt((e-i)/t))},equalizeGutters:function(){var e=0;_.each(this.model.get("_items"),function(t){e+=t._colWidth});var t=this.$(".multiColTextPlus-widget").width();var i=this.model.get("_columnCount");var s=(t-e)/(i-1)<0?0:(t-e)/(i-1);var n=this.$(".textPlus-component");n.css("margin-left",parseInt(s/2)).css("margin-right",parseInt(s/2));n.first().css("margin-left",0);n.last().css("margin-right",0)},sumModelWidths:function(){var e=0;_.each(this.model.get("_items"),function(t){e+=t._colMarginLeft+t._colWidth+t._colMarginRight});return e},onInview:function(e,t,i,s){if(t){if(s==="top"){this._isVisibleTop=true}else if(s==="bottom"){this._isVisibleBottom=true}else{this._isVisibleTop=true;this._isVisibleBottom=true}if(this._isVisibleTop&&this._isVisibleBottom){this.$(".component-inner").off("inview");this.setCompletionStatus();if(this.model.get("_isInview"))this.$(".component-inner").addClass(this.model.get("_isInview"))}}if(t===undefined){this.setCompletionStatus()}}});i.register("multiColTextPlus",a);return a});define("components/adapt-multipleSelect-likert/js/adapt-multipleSelect-likert",["require","coreViews/questionView","coreJS/adapt"],function(e){var t=e("coreViews/questionView");var i=e("coreJS/adapt");var s=t.extend({events:{"focus .multipleSelect-likert-item input":"onItemFocus","blur .multipleSelect-likert-item input":"onItemBlur","click .multipleSelect-likert-item":"onItemSelected","keyup .multipleSelect-likert-radio-row input":"onKeyPress"},init:function(){this.model.set("_selectedItems",[])},resetQuestionOnRevisit:function(){this.setAllItemsEnabled(true);this.resetQuestion()},setupQuestion:function(){this.model.set("_isRadio",this.model.get("_selectable")==1);this.setupRandomisation();this.restoreUserAnswers();this.setupQuestionItemIndexes();if(i.device.screenSize=="large"||i.device.screenSize=="medium"){this.model.set("_desktop",true)}else{this.model.set("_desktop",false);this.model.set("instruction",this.model.get("mobileInstruction"))}if(i.device.screenSize=="medium"){this.model.set("instruction",this.model.get("tabInstruction"))}},setupQuestionItemIndexes:function(){var e=this.model.get("_items");for(var t=0,i=e.length;t<i;t++){if(e[t]._index===undefined)e[t]._index=t;if(e[t]._optionSelected===undefined)e[t]._optionSelected=[]}},setupRandomisation:function(){if(this.model.get("_isRandom")&&this.model.get("_isEnabled")){this.model.set("_items",_.shuffle(this.model.get("_items")))}},restoreUserAnswers:function(){if(!this.model.get("_isSubmitted"))return;var e=[];var t=this.model.get("_items");var i=this.model.get("_userAnswer");_.each(t,function(t,s){t._isSelected=i[s];t._optionSelected=i[s];if(t._isSelected){e.push(t)}});this.model.set("_selectedItems",[new Set(e)]);this.setQuestionAsSubmitted();this.markQuestion();this.setScore();this.showMarking();this.setupFeedback()},disableQuestion:function(){this.setAllItemsEnabled(false)},enableQuestion:function(){this.setAllItemsEnabled(true)},setAllItemsEnabled:function(e){_.each(this.model.get("_items"),function(t,i){var s=this.$(".multipleSelect-likert-radio-row").eq(i);if(e){s.prop("disabled",false)}else{s.prop("disabled",true)}},this)},onQuestionRendered:function(){this.setReadyStatus();if(this.model.get("_isSubmitted")){var e=this.model.get("_userAnswer");_.each(e,function(e,t){for(var i=0;i<e.length;i++){
this.setOptionSelected(t,e[i])}},this)}},onKeyPress:function(e){if(e.which===13){this.onItemSelected(e)}},onItemFocus:function(e){if(this.model.get("_isEnabled")&&!this.model.get("_isSubmitted")){$("div[for='"+$(e.currentTarget).attr("id")+"']").addClass("highlighted")}},onItemBlur:function(e){$("div[for='"+$(e.currentTarget).attr("id")+"']").removeClass("highlighted")},onItemSelected:function(e){if(this.model.get("_isEnabled")&&!this.model.get("_isSubmitted")){var t=this.model.get("_items")[$(e.currentTarget).parent().parent().index()];this.toggleItemSelected(t,e)}},toggleItemSelected:function(e,t){var i=this.model.get("_selectedItems");var s=_.indexOf(this.model.get("_items"),e),n=parseInt($(t.currentTarget).attr("id"))*-1;$itemLabel=this.$(".multipleSelect-likert-answer-option").eq(s).find(".multipleSelect-likert-item-state").eq(n),$itemInput=this.$(".multipleSelect-likert-answer-option").eq(s).find("input").eq(n);selected=$itemLabel.hasClass("selected");if(!selected){$itemLabel.addClass("selected");$itemLabel.parent().addClass("selected");$itemLabel.a11y_selected(true);e._optionSelected.push(n+1)}else{$itemLabel.removeClass("selected");$itemLabel.parent().removeClass("selected");$itemLabel.a11y_selected(false);e._optionSelected.pop(n+1)}this.$(".multipleSelect-likert-answer-option").eq(s).find("input").prop("checked",false);if(this.model.get("_isRadio")){this.$(".multipleSelect-likert-answer-option").eq(s).find(".multipleSelect-likert-item-state").removeClass("selected");this.$(".multipleSelect-likert-answer-option").eq(s).find(".multipleSelect-likert-item").removeClass("selected");$itemLabel.addClass("selected");$itemLabel.parent().addClass("selected")}$itemInput.prop("checked",true);e._isSelected=true;i.push(e);this.model.set("_selectedItems",[new Set(i)])},canSubmit:function(){var e=0;_.each(this.model.get("_items"),function(t,i){if(t._isSelected){e++}},this);return e==this.model.get("_items").length?true:false},storeUserAnswer:function(){var e=[];var t=this.model.get("_items").slice(0);t.sort(function(e,t){return e._index-t._index});_.each(t,function(t,i){e.push(t._optionSelected)},this);this.model.set("_userAnswer",e);this.$("select").attr("disabled","disabled")},isCorrect:function(){var e=0;var t=0;var i=0;_.each(this.model.get("_items"),function(s,n){var r=s._isSelected||false;if(s._shouldBeSelected){e++;if(this.isCurrectanswer(s._shouldBeSelected,s._optionSelected,n)){t++;s._isCorrect=true;this.model.set("_isAtLeastOneCorrectSelection",true)}}else if(!s._shouldBeSelected&&r){i++}},this);this.model.set("_numberOfCorrectAnswers",t);this.model.set("_numberOfRequiredAnswers",e);var s=t===e&&i===0;return s},isCurrectanswer:function(e,t,i){if(e.length!=t.length){for(var s=0;s<t.length;s++){if(_.contains(e,t[s])){this.$(".multipleSelect-likert-answer-option").eq(i).find(".multipleSelect-likert-item-state").eq(t[s]-1).addClass("icon icon-tick").css("color","#82ca9c");continue}else{this.$(".multipleSelect-likert-answer-option").eq(i).find(".multipleSelect-likert-item-state").eq(t[s]-1).addClass("icon icon-cross")}}return false}for(var s=0;s<t.length;s++){if(_.contains(e,t[s])){this.$(".multipleSelect-likert-answer-option").eq(i).find(".multipleSelect-likert-item-state").eq(t[s]-1).addClass("icon icon-tick").css("color","#82ca9c");continue}else{this.$(".multipleSelect-likert-answer-option").eq(i).find(".multipleSelect-likert-item-state").eq(t[s]-1).addClass("icon icon-cross");return false}}return true},setScore:function(){var e=this.model.get("_questionWeight");var t=this.model.get("_isCorrect");var i=t?e:0;this.model.set("_score",i)},setupFeedback:function(){if(this.model.get("_isCorrect")){this.setupCorrectFeedback()}else if(this.isPartlyCorrect()){this.setupPartlyCorrectFeedback()}else{if(this.model.get("_selectable")===1&&this.model.get("_selectedItems")[0].feedback){this.setupIndividualFeedback(this.model.get("_selectedItems")[0]);return}else{this.setupIncorrectFeedback()}}},setupIndividualFeedback:function(e){this.model.set({feedbackTitle:this.model.get("title"),feedbackMessage:e.feedback})},showMarking:function(){_.each(this.model.get("_items"),function(e,t){var i=this.$(".multipleSelect-likert-answer-option").eq(t);i.removeClass("correct incorrect").addClass(e._isCorrect?"correct":"incorrect")},this)},isPartlyCorrect:function(){return this.model.get("_isAtLeastOneCorrectSelection")},resetUserAnswer:function(){this.model.set({_userAnswer:[]})},resetQuestion:function(){this.deselectAllItems();this.resetItems()},deselectAllItems:function(){this.$el.a11y_selected(false);_.each(this.model.get("_items"),function(e){e._isSelected=false},this);this.$(".multipleSelect-likert-item-state").removeClass("selected icon-tick icon-cross");this.$("input").prop("checked",false);this.$(".multipleSelect-likert-item").removeClass("selected")},resetItems:function(){_.each(this.model.get("_items"),function(e){e._isCorrect=false;e._optionSelected=[]},this);this.model.set({_selectedItems:[],_isAtLeastOneCorrectSelection:false})},showCorrectAnswer:function(){this.deselectAllItems();_.each(this.model.get("_items"),function(e,t){for(var i=0;i<e._shouldBeSelected.length;i++){this.setOptionSelected(t,e._shouldBeSelected[i])}},this)},setOptionSelected:function(e,t){var i=t-1,s=this.$(".multipleSelect-likert-answer-option").eq(e).find(".multipleSelect-likert-item-state").eq(i),n=this.$(".multipleSelect-likert-answer-option").eq(e).find("input").eq(i);if(t){s.addClass("selected");n.prop("checked",true);s.parent().addClass("selected")}else{s.removeClass("selected");n.prop("checked",false);s.parent().removeClass("selected")}},hideCorrectAnswer:function(){this.deselectAllItems();_.each(this.model.get("_items"),function(e,t){var i=this.model.get("_userAnswer")[e._index];for(var s=0;s<i.length;s++){if(_.contains(e._shouldBeSelected,i[s])){this.$(".multipleSelect-likert-answer-option").eq(t).find(".multipleSelect-likert-item-state").eq(i[s]-1).addClass("icon icon-tick").css("color","#82ca9c")}else this.$(".multipleSelect-likert-answer-option").eq(t).find(".multipleSelect-likert-item-state").eq(i[s]-1).addClass("icon icon-cross")}},this)},getResponse:function(){var e=_.where(this.model.get("_items"),{_isSelected:true});var t=[];var i="";t=_.pluck(e,"_optionSelected");_.each(t,function(e,t){i+="Statement"+t+":"+e.join(",")});return i},getResponseType:function(){return"choice"}});i.register("multipleSelect-likert",s);return s});define("components/adapt-multipleTextInput/js/adapt-multipleTextInput",["require","coreViews/questionView","coreJS/adapt"],function(e){var t=e("coreViews/questionView");var i=e("coreJS/adapt");var s=65536;var n=t.extend({events:{"focus input":"clearValidationError"},resetQuestionOnRevisit:function(){this.setAllItemsEnabled(false);this.resetQuestion()},setupQuestion:function(){this.model.set("_genericAnswerIndexOffset",s);this.setupItemIndexes();this.restoreUserAnswer();this.setupRandomisation()},setupRandomisation:function(){if(this.model.get("_isRandom")&&this.model.get("_isEnabled")){this.model.set("_items",_.shuffle(this.model.get("_items")))}},setupItemIndexes:function(){_.each(this.model.get("_items"),function(e,t){if(e._index===undefined)e._index=t;if(e._answerIndex===undefined)e._answerIndex=-1})},restoreUserAnswer:function(){if(!this.model.get("_isSubmitted"))return;var e=i.offlineStorage.get(this.model.get("_id")+"-ip");var t=this.model.get("_answers");_.each(this.model.get("_items"),function(t,i){t.userAnswer=e[i]});this.setQuestionAsSubmitted();this.markQuestion();this.setScore();this.showMarking();this.setupFeedback()},disableQuestion:function(){this.setAllItemsEnabled(false)},enableQuestion:function(){this.setAllItemsEnabled(true)},setAllItemsEnabled:function(e){_.each(this.model.get("_items"),function(t,i){var s=this.$("input").eq(i);if(e){s.prop("disabled",false)}else{s.prop("disabled",true)}},this)},onQuestionRendered:function(){this.setReadyStatus();this.setUserAnswer()},setUserAnswer:function(){if(!this.model.get("_isSubmitted"))return;_.each(this.model.get("_items"),function(e,t){this.$(".textinput-item-textbox").eq(t).val(e.userAnswer)},this)},clearValidationError:function(){this.$(".multipleTextInput-item-textbox").removeClass("multipleTextInput-validation-error")},canSubmit:function(){var e=true;this.$(".multipleTextInput-item-textbox").each(function(){if($(this).val()==""){e=false}});return e},onCannotSubmit:function(){this.showValidationError()},showValidationError:function(){this.$(".multipleTextInput-item-textbox").addClass("multipleTextInput-validation-error")},storeUserAnswer:function(){var e=this.model.get("_items");var t=[];var s=this.$(".multipleTextInput-item-textbox");_.each(e,function(e,i){var n=s.eq(i).val();e.userAnswer=n;t.push(n)},this);this.isCorrect();i.offlineStorage.set(this.model.get("_id")+"-ip",t);this.model.set("_userAnswer",[1,2,3,4])},isCorrect:function(){if(this.model.get("_answers"))this.markGenericAnswers();else this.markSpecificAnswers();return!_.contains(_.pluck(this.model.get("_items"),"_isCorrect"),false)},markGenericAnswers:function(){var e=0;var t=this.model.get("_answers").slice();var i=[];_.each(this.model.get("_items"),function(n,r){_.each(t,function(t,r){if(this.checkAnswerIsCorrect(t,n.userAnswer)){if(_.indexOf(i,r)>-1)return;i.push(r);n._isCorrect=true;n._answerIndex=r+s;e++;this.model.set("_numberOfCorrectAnswers",e);this.model.set("_isAtLeastOneCorrectSelection",true)}},this);if(!n._isCorrect)n._isCorrect=false},this)},markSpecificAnswers:function(){var e=0;var t=0;_.each(this.model.get("_items"),function(i,s){if(!i._answers)return;var n=i.userAnswer||"";if(this.checkAnswerIsCorrect(i["_answers"],n)){e++;i._isCorrect=true;i._answerIndex=_.indexOf(i["_answers"],this.cleanupUserAnswer(n));this.model.set("_numberOfCorrectAnswers",e);this.model.set("_isAtLeastOneCorrectSelection",true)}else{i._isCorrect=false;i._answerIndex=-1}t++},this)},checkAnswerIsCorrect:function(e,t){var i=this.cleanupUserAnswer(t);var s=_.filter(e,function(e){return this.cleanupUserAnswer(e)==i},this);var n=s&&s.length>0;if(n)this.model.set("_hasAtLeastOneCorrectSelection",true);return n},cleanupUserAnswer:function(e){if(this.model.get("_allowsAnyCase")){e=e.toLowerCase()}if(this.model.get("_allowsPunctuation")){e=e.replace(/[\.,-\/#!$%\^&\*;:{}=\-_`~()]/g,"");e=e.replace(/(  +)+/g," ")}return $.trim(e)},setScore:function(){var e=this.model.get("_numberOfCorrectAnswers");var t=this.model.get("_questionWeight");var i=this.model.get("_items").length;var s=t*e/i;this.model.set("_score",s)},showMarking:function(){if(!this.model.get("_canShowMarking"))return;_.each(this.model.get("_items"),function(e,t){var i=this.$(".multipleTextInput-item").eq(t);i.removeClass("correct incorrect").addClass(e._isCorrect?"correct":"incorrect")},this)},isPartlyCorrect:function(){return this.model.get("_isAtLeastOneCorrectSelection")},resetUserAnswer:function(){_.each(this.model.get("_items"),function(e){e["_isCorrect"]=false;e["userAnswer"]=""},this);i.offlineStorage.set(this.model.get("_id")+"-ip","")},resetQuestion:function(){this.model.set({_isAtLeastOneCorrectSelection:false,_isCorrect:undefined})},showCorrectAnswer:function(){if(this.model.get("_answers")){var e=this.model.get("_answers");_.each(this.model.get("_items"),function(t,i){this.$(".multipleTextInput-item-textbox").eq(i).val(e[i][0])},this)}else{_.each(this.model.get("_items"),function(e,t){this.$(".multipleTextInput-item-textbox").eq(t).val(e._answers[0])},this)}},hideCorrectAnswer:function(){_.each(this.model.get("_items"),function(e,t){this.$(".multipleTextInput-item-textbox").eq(t).val(e.userAnswer)},this)},setupFeedback:function(){if(this.model.get("_isCorrect")){this.setupCorrectFeedback()}else if(this.isPartlyCorrect()){this.setupPartlyCorrectFeedback()}else{this.setupIncorrectFeedback()}},getResponse:function(){return _.pluck(this.model.get("_items"),"userAnswer").join("[,]")},getResponseType:function(){return"fill-in"}});i.register("multipleTextInput",n);return n});define("components/adapt-objectMachingNumber/js/adapt-objectMachingNumber",["require","coreViews/questionView","coreJS/adapt"],function(e){var t=e("coreViews/questionView");var i=e("coreJS/adapt");var s=t.extend({events:{"click .draggable-item":"onClickDragItem","click .droppable-item":"onClickDropItem"},resetQuestionOnRevisit:function(){this.resetQuestion()},setupQuestion:function(){this.listenTo(i,"device:changed",this.reRender,this);this.model.set("_currentlySelectedItemId","");this.setupRandomisation();_.each(this.model.get("_draggableItems"),function(e,t){e._index=e._index||t+1})},setupRandomisation:function(){if(this.model.get("_isRandom")&&this.model.get("_isEnabled")){this.model.set("_draggableItems",_.shuffle(this.model.get("_draggableItems")))}if(!this.model.get("_isSubmitted")){this.model.set("_droppableItems",_.shuffle(this.model.get("_droppableItems")))}},onQuestionRendered:function(){if(this.$(".objectMachingNumber-widget").find("img").length>0){this.$(".objectMachingNumber-widget").imageready(_.bind(function(){this.setReadyStatus()},this))}else{this.setReadyStatus()}this.model.set("_initialobjectMachingNumberWidgetView",this.$(".objectMachingNumber-widget").html())},setupobjectMachingNumber:function(){var e=this.model.get("_draggableItems");_.each(this.$(".draggable-item-index"),function(t,i){$(t).html(e[i]._index)});if(this.model.get("_isSubmitted")){this.showMarking()}},reRender:function(){if(this.model.get("_wasDragAndDrop")&&i.device.screenSize=="large"){this.replaceWithDragAndDrop()}},replaceWithDragAndDrop:function(){if(!i.componentStore.dragAndDrop)throw"Drag And Drop not included in build";var e=i.componentStore.dragAndDrop;var t=this.prepareDragAndDropModel();var s=new e({model:t});var n=$(".component-container",$("."+this.model.get("_parentId")));if(t.get("_initialDragAndDropWidgetView")){s.$el.find(".dragAndDrop-widget").html(t.get("_initialDragAndDropWidgetView"))}if(t.get("_isSubmitted")){s.showMarking()}n.append(s.$el);this.remove();_.defer(function(){i.trigger("device:resize")})},prepareDragAndDropModel:function(){var e=this.model;e.set("_component","dragAndDrop");return e},onClickDragItem:function(e){if(e&&e.preventDefault)e.preventDefault();if(!this.model.get("_isEnabled")){return false}var t=this.$(e.currentTarget);var i=t.closest(".objectMachingNumber-item-wrapper");var s=t.attr("data-id");var n=_.where(this.model.get("_draggableItems"),{id:s})[0];if(s==this.model.get("_currentlySelectedItemId")){i.removeClass("selected");this.$(".droppable-item").removeClass("cursor-pointer");this.model.set("_currentlySelectedItemId","")}else{i.addClass("selected").siblings("div").removeClass("selected");this.$(".droppable-item").addClass("cursor-pointer");this.model.set("_currentlySelectedItemId",n.id)}},onClickDropItem:function(e){if(e&&e.preventDefault)e.preventDefault();var t=this.model.get("_currentlySelectedItemId");if(!this.model.get("_isEnabled")||!t)return false;var i=this.$(e.currentTarget);var s=this.$(e.currentTarget).closest(".objectMachingNumber-item-wrapper");var n=i.attr("data-id");var r=this.model.get("_draggableItems");var o=this.model.get("_droppableItems");var a=_.where(o,{id:n})[0];if(a._selectedItemId&&a._selectedItemId==t){s.find(".droppable-item-index").html("");s.removeClass("selected");a._selectedItemId=null}else{var l=_.where(o,{_selectedItemId:t})[0];if(l){this.$("[data-id="+l.id+"]").find(".droppable-item-index").html("");s.removeClass("selected");l._selectedItemId=null}s.addClass("selected").siblings("div").removeClass("selected");s.find(".droppable-item-index").html(_.where(r,{id:t})[0]._index);a._selectedItemId=t}},canSubmit:function(){var e=0;_.each(this.model.get("_droppableItems"),function(t){if(t._selectedItemId){e++}});var t=e==this.model.get("_droppableItems").length;if(t){this.$(".objectMachingNumber-item-wrapper").removeClass("selected");this.$(".droppable-item").removeClass("selected")}return t},onCannotSubmit:function(){},storeUserAnswer:function(){var e=[];_.each(this.model.get("_droppableItems"),function(t,i){e.push(t._selectedItemId)},this);this.model.set("_userAnswer",e)},isCorrect:function(){var e=this.model.get("_droppableItems").length;var t=0;var i=0;_.each(this.model.get("_droppableItems"),function(e,i){var s=e.correctItemId===e._selectedItemId;if(s){t++;e._isCorrect=true;this.model.set("_isAtLeastOneCorrectSelection",true)}},this);this.model.set("_numberOfCorrectAnswers",t);var s=t===e&&i===0;return s},setScore:function(){var e=this.model.get("_questionWeight");var t=this.model.get("_isCorrect");var i=t?e:0;this.model.set("_score",i)},showMarking:function(){_.each(this.model.get("_droppableItems"),function(e,t){var i=this.$(".droppable-item-wrapper").eq(t);i.addClass(e._isCorrect?"correct":"incorrect")},this)},isPartlyCorrect:function(){return this.model.get("_isAtLeastOneCorrectSelection")},resetUserAnswer:function(){this.model.set("_userAnswer",[])},resetQuestion:function(){_.each(this.model.get("_droppableItems"),function(e){delete e._selectedItemId});this.$(".objectMachingNumber-widget").html(this.model.get("_initialobjectMachingNumberWidgetView"));this.model.set({_currentlySelectedItemId:"",_isAtLeastOneCorrectSelection:false})},showCorrectAnswer:function(){_.each(this.model.get("_droppableItems"),function(e,t){this.setdroppableItems(t,e.correctItemId)},this)},setdroppableItems:function(e,t){var i=this.$(".droppable-item").eq(e);var s=_.where(this.model.get("_draggableItems"),{id:t})[0];i.find(".droppable-item-index").html(this.$(".draggable-item").index(this.$("[data-id="+s.id+"]"))+1)},hideCorrectAnswer:function(){_.each(this.model.get("_droppableItems"),function(e,t){this.setdroppableItems(t,this.model.get("_userAnswer")[t])},this)},getResponse:function(){var e=_.where(this.model.get("_items"),{_isSelected:true});var t=_.pluck(e,"_index");console.log("selected",e);console.log("selectedIndexes",t);for(var i=0,s=t.length;i<s;i++){t[i]++}return t.join(",")},getResponseType:function(){return"choice"}});i.register("objectMachingNumber",s);return s});define("components/adapt-questionSlider/js/questionSliderView",["core/js/views/questionView"],function(e){var t=e.extend({events:{"click .next":"onNextClick","click .previous":"onPreviousClick","click .progress":"onProgressClick","change .question-slide input":"onItemSelected"},onNextClick:function(e){if(this._activeIndex+1>=this.itemCount){return}if(this.isLocked(this._activeIndex))return;this._activeIndex++;this.moveSlide();this.lockedStep()},onPreviousClick:function(e){if(this._activeIndex-1<0){return}this._activeIndex--;this.moveSlide()},isLocked:function(e){return!this.$("[data-slideindex="+e+"]").hasClass("completed")},onProgressClick:function(e){var t=$(e.currentTarget).attr("data-index");if(this._activeIndex<=+t){if(this.isLocked(this._activeIndex))return}this._activeIndex=parseInt(t);this.moveSlide()},onItemSelected:function(e){var t=this.$(e.currentTarget).closest(".slide-item");var i=this.$(e.currentTarget).closest(".sub-item-row").data("rbtnid");var s=+t.data("slideindex");this.model.get("_items")[s]._subItems[i]._isSelected=true;this.model.get("_items")[s]._subItems[i]._selectedAnswer=e.currentTarget.value;this.model.get("_items")[s]._subItems[i]._selectedId=+e.currentTarget.dataset.inputid;if(this.checkIfAllOptionsSelected(s)){t.addClass("completed");this.unLockedStep()}},checkIfAllOptionsSelected:function(e){var t=this.model.get("_items")[e]._subItems;return _.every(t,function(e){return e._isSelected})},moveSlide:function(){var e=100/this.itemCount*this._activeIndex*-1;var t="translateX("+e+"%)";this.prefixHelper(this.imageSliderElm,"Transform",t);this.prefixHelper(this.titleSliderElm,"Transform",t);this.imageSliderElm.style.transform=t;this.titleSliderElm.style.transform=t;this.$(".numeric-progress .current-slide").html(this._activeIndex+1);this.controllButtons();this.controllIndicators()},controllButtons:function(){var e=true;var t=true;if(this._activeIndex===0){e=false}if(this._activeIndex>=this.itemCount-1){t=false}this.$el.toggleClass("show-next",t);this.$el.toggleClass("show-prev",e)},controllIndicators:function(){this.$(".indicator").find(".progress").removeClass("selected");this.$(".indicator").find('[data-index="'+this._activeIndex+'"]').addClass("selected")},lockedStep:function(){if(this.model.get("_isLockedStep")){this.$(".slider-button.next").addClass("lockedStep")}},unLockedStep:function(){var e=this.$(".slider-button.next");if(e.hasClass("lockedStep")){e.removeClass("lockedStep")}},prefixHelper:function(e,t,i){e.style["webkit"+t]=i;e.style["moz"+t]=i;e.style["ms"+t]=i;e.style["o"+t]=i},disableQuestion:function(){this.$(".questionSlider input").attr("disabled",true)},enableQuestion:function(){},resetQuestionOnRevisit:function(e){},setAllItemsEnabled:function(e){},setupQuestion:function(){this.registerPartialHelper();this._activeIndex=0;this.itemCount=this.model.get("_items").length;this.model.set("_totalWidth",100*this.itemCount);this.model.set("_itemWidth",100/this.itemCount)},onQuestionRendered:function(){this.imageSliderElm=this.$(".questionSlider")[0];this.titleSliderElm=this.$(".title-slider")[0];this.controllButtons();this.controllIndicators();if(this.model.get("_isSubmitted")){this.disableQuestion()}this.lockedStep();this.moveSlide();this.setReadyStatus()},onCannotSubmit:function(){},showMarking:function(){},resetQuestion:function(){},showCorrectAnswer:function(){},hideCorrectAnswer:function(){},registerPartialHelper:function(){var e=Handlebars.templates["questionSlide"];Handlebars.registerPartial("slide",e)},getResponse:function(){var e=_.map(this.model.get("_items"),function(e,t){return _.map(e._subItems,function(e){return t+"."+e._selectedId})});return _.map(e,function(e){return e.join(",")}).join("#")},getResponseType:function(){return"matching"}});return t});define("components/adapt-questionSlider/js/questionSliderModel",["core/js/models/questionModel"],function(e){var t=e.extend({restoreUserAnswers:function(){if(!this.get("_isSubmitted")){return}var e=this.get("_userAnswer");this.updateSubItemState(e);this.setQuestionAsSubmitted();this.markQuestion();this.setScore();this.setupFeedback()},updateSubItemState:function(e){var t=this.get("_items");_.each(t,function(t,i){_.each(t._subItems,function(t,i){t._selectedId=e.pop()},this)},this)},canSubmit:function(){var e=this.get("_items");var t=[];_.each(e,function(e,i){t.push(_.every(e._subItems,function(e){return e._isSelected}))},this);var i=_.without(t,false);return i.length!==0&&i.length==e.length},storeUserAnswer:function(){var e=[];_.each(this.get("_items"),function(t,i){_.each(t._subItems,function(t){e.push(t._selectedId)},this)},this);this.set("_userAnswer",e)},getSelectedAnswer:function(){var e=this.get("_items");var t=[];_.each(e,function(e,i){_.each(e._subItems,function(e){t.push(e._selectedAnswer==="true"?1:0)},this)},this);return t},isCorrect:function(){var e=this.getSelectedAnswer();var t=0;var i=_.filter(e,function(e){return e===1}).length;var s=_.filter(e,function(e){return e===0}).length;this.set("_numberOfCorrectAnswers",i);this.set("_numberOfIncorrectAnswers",s);var n=i>s;return n},setScore:function(){var e=this.get("_questionWeight");var t=this.get("_isCorrect")?e:0;this.set("_score",t)},setupFeedback:function(){if(this.get("_isCorrect")){this.setupCorrectFeedback()}else if(this.isPartlyCorrect()){this.setupPartlyCorrectFeedback()}else{this.setupIncorrectFeedback()}},isPartlyCorrect:function(){return this.get("_numberOfCorrectAnswers")===this.get("_numberOfIncorrectAnswers")},resetUserAnswer:function(){this.set({_userAnswer:[]})}});return t});define("components/adapt-questionSlider/js/adapt-questionSlider",["core/js/adapt","./questionSliderView","./questionSliderModel"],function(e,t,i){return e.register("questionSlider",{view:t,model:i})});define("components/adapt-questionSliderDropDown/js/questionSliderDropDownView",["core/js/views/questionView"],function(e){var t=e.extend({events:{"click .next":"onNextClick","click .previous":"onPreviousClick","click .progress":"onProgressClick","change .question-slide select":"onItemSelected"},onNextClick:function(e){if(this._activeIndex+1>=this.itemCount){return}if(this.isLocked(this._activeIndex))return;this._activeIndex++;this.moveSlide();this.lockedStep()},onPreviousClick:function(e){if(this._activeIndex-1<0){return}this._activeIndex--;this.moveSlide()},isLocked:function(e){return!this.$("[data-slideindex="+e+"]").hasClass("completed")},onProgressClick:function(e){var t=$(e.currentTarget).attr("data-index");if(this._activeIndex<=+t){if(this.isLocked(this._activeIndex))return}this._activeIndex=parseInt(t);this.moveSlide()},onItemSelected:function(e){var t=this.$(e.currentTarget);var i=t.closest(".slide-item");var s=t.closest(".sub-item-row").data("rbtnid");var n=+i.data("slideindex");this.model.get("_items")[n]._subItems[s]._isSelected=true;this.model.get("_items")[n]._subItems[s]._selectedAnswer=t.val();this.model.get("_items")[n]._subItems[s]._selectedId=+t.data("inputid");this.model.get("_items")[n]._subItems[s]._selectedOptionIndex=+t.find("option:selected").data("optionid");if(this.checkIfAllOptionsSelected(n)){i.addClass("completed");this.unLockedStep()}},checkIfAllOptionsSelected:function(e){var t=this.model.get("_items")[e]._subItems;return _.every(t,function(e){return e._isSelected})},moveSlide:function(){var e=100/this.itemCount*this._activeIndex*-1;var t="translateX("+e+"%)";this.$(".numeric-progress .current-slide").html(this._activeIndex+1);this.prefixHelper(this.imageSliderElm,"Transform",t);this.prefixHelper(this.titleSliderElm,"Transform",t);this.imageSliderElm.style.transform=t;this.titleSliderElm.style.transform=t;this.controllButtons();this.controllIndicators()},controllButtons:function(){var e=true;var t=true;if(this._activeIndex===0){e=false}if(this._activeIndex>=this.itemCount-1){t=false}this.$el.toggleClass("show-next",t);this.$el.toggleClass("show-prev",e)},controllIndicators:function(){this.$(".indicator").find(".progress").removeClass("selected");this.$(".indicator").find('[data-index="'+this._activeIndex+'"]').addClass("selected")},lockedStep:function(){if(this.model.get("_isLockedStep")){this.$(".slider-button.next").addClass("lockedStep")}},unLockedStep:function(){var e=this.$(".slider-button.next");if(e.hasClass("lockedStep")){e.removeClass("lockedStep")}},prefixHelper:function(e,t,i){e.style["webkit"+t]=i;e.style["moz"+t]=i;e.style["ms"+t]=i;e.style["o"+t]=i},disableQuestion:function(){this.$(".questionSliderDropDown select").attr("disabled",true)},enableQuestion:function(){},resetQuestionOnRevisit:function(e){},setAllItemsEnabled:function(e){},setupQuestion:function(){this.registerPartialHelper();this._activeIndex=0;this.itemCount=this.model.get("_items").length;this.model.set("_totalWidth",100*this.itemCount);this.model.set("_itemWidth",100/this.itemCount)},onQuestionRendered:function(){this.imageSliderElm=this.$(".questionSliderDropDown")[0];this.titleSliderElm=this.$(".title-slider")[0];this.controllButtons();this.controllIndicators();if(this.model.get("_isSubmitted")){this.disableQuestion()}this.lockedStep();this.moveSlide();this.setReadyStatus()},onCannotSubmit:function(){},showMarking:function(){},resetQuestion:function(){},showCorrectAnswer:function(){},hideCorrectAnswer:function(){},registerPartialHelper:function(){var e=Handlebars.templates["questionSlideDropDown"];Handlebars.registerPartial("slide",e)},getResponse:function(){var e=_.map(this.model.get("_items"),function(e,t){return _.map(e._subItems,function(e){return t+"."+e._selectedId})});return _.map(e,function(e){return e.join(",")}).join("#")},getResponseType:function(){return"matching"}});return t});define("components/adapt-questionSliderDropDown/js/questionSliderDropDownModel",["core/js/models/questionModel"],function(e){var t=e.extend({restoreUserAnswers:function(){if(!this.get("_isSubmitted")){return}var e=this.get("_userAnswer");this.updateSubItemState(e);this.setQuestionAsSubmitted();this.markQuestion();this.setScore();this.setupFeedback()},updateSubItemState:function(e){var t=this.get("_items");_.each(t,function(t,i){_.each(t._subItems,function(t,i){t._selectedOptionIndex=e.pop()},this)},this)},canSubmit:function(){var e=this.get("_items");var t=[];_.each(e,function(e,i){t.push(_.every(e._subItems,function(e){return e._isSelected}))},this);var i=_.without(t,false);return i.length!==0&&i.length==e.length},storeUserAnswer:function(){var e=[];_.each(this.get("_items"),function(t,i){_.each(t._subItems,function(t){e.push(t._selectedOptionIndex)},this)},this);this.set("_userAnswer",e)},getSelectedAnswer:function(){var e=this.get("_items");var t=[];_.each(e,function(e,i){_.each(e._subItems,function(e){t.push(e._selectedAnswer==="true"?1:0)},this)},this);return t},isCorrect:function(){var e=this.getSelectedAnswer();var t=0;var i=_.filter(e,function(e){return e===1}).length;var s=_.filter(e,function(e){return e===0}).length;this.set("_numberOfCorrectAnswers",i);this.set("_numberOfIncorrectAnswers",s);var n=i>s;return n},setScore:function(){var e=this.get("_questionWeight");var t=this.get("_isCorrect")?e:0;this.set("_score",t)},setupFeedback:function(){this.updateFeedback();if(this.get("_isCorrect")){this.setupCorrectFeedback()}else if(this.isPartlyCorrect()){this.setupPartlyCorrectFeedback()}else{this.setupIncorrectFeedback()}},updateFeedback:function(){var e=this.get("_feedback");var t=_.pairs(this.calculatePoints());_.each(t,function(t){var i=new RegExp("{{"+t[0]+"}}");e.correct=e.correct.replace(i,t[1][0]);e._incorrect["final"]=e._incorrect["final"].replace(i,t[1][0]);e._partlyCorrect["final"]=e._partlyCorrect["final"].replace(i,t[1][0])})},calculatePoints:function(){var e=this.get("_items");var t=_.chain(this.get("_items")).map(function(e){return e._subItems}).flatten().value();var i={};_.each(t,function(e){if(!i[e.type]){i[e.type]=[]}i[e.type].push(+e._selectedAnswer);i[e.type]=[_.reduce(i[e.type],function(e,t){return e+t},0)]});return i},isPartlyCorrect:function(){return this.get("_numberOfCorrectAnswers")===this.get("_numberOfIncorrectAnswers")},resetUserAnswer:function(){this.set({_userAnswer:[]})}});return t});define("components/adapt-questionSliderDropDown/js/adapt-questionSliderDropDown",["core/js/adapt","./questionSliderDropDownView","./questionSliderDropDownModel"],function(e,t,i){return e.register("questionSliderDropDown",{view:t,model:i})});define("components/adapt-sentenceOrdering/js/sentenceOrderingModel",["require","core/js/models/questionModel"],function(e){var t=e("core/js/models/questionModel");var i=t.extend({init:function(){t.prototype.init.call(this)},restoreUserAnswers:function(){if(!this.get("_isSubmitted"))return;var e=this.get("_userAnswer");var t=[];var i=_.sortBy(this.get("_items"));_.each(e,function(e,s){t[s]=i[e-1]},this);this.set("_items",t);this.setPrefixTitle();this.setQuestionAsSubmitted();this.markQuestion();this.setScore();this.setupFeedback()},setupRandomisation:function(){this.setPrefixTitle();if(this.get("_isRandom")&&this.get("_isEnabled")){this.set("_items",_.shuffle(this.get("_items")))}},setPrefixTitle:function(){if(!this.get("_isPrefixTitle"))return;var e=_.sortBy(this.get("_items"),"id");this.set("_prefixTitles",_.pluck(e,"prefixTitle"))},canSubmit:function(){return true},storeUserAnswer:function(){var e=[];var t=[];var i=_.sortBy(this.get("_items"),"id");var s=this.get("_sentenceListJqueryObject").children();this.set("userSortedList",s);_.each(s,function(s,n){e.push(parseInt(s.dataset.itemid));t.push(i[parseInt(s.dataset.itemid)-1])});this.set({_items:t,_userAnswer:e})},isCorrect:function(){var e=this.get("_userAnswer"),t=_.sortBy(this.get("_items"),"id"),i=this.get("_items"),s=0,n=0,r=[];_.each(e,function(e,i){if(_.contains(t[i].position,e)){s++;r.push(true)}else{n++;r.push(false)}},this);this.set("isItemOnCorrectPlace",r);this.set("_numberOfCorrectAnswers",s);this.set("_numberOfIncorrectAnswers",n);var o=s===i.length&&n===0;return o},setScore:function(){var e=this.get("_questionWeight");var t=this.get("_isCorrect");var i=t?e:0;this.set("_score",i);
},isPartlyCorrect:function(){return this.get("_numberOfCorrectAnswers")>=this.get("_items").length/2},resetUserAnswer:function(){this.set({_userAnswer:[]})}});return i});(function(e){var t="mousedown touchstart MSPointerDown pointerdown",i="mouseup touchend MSPointerUp pointerup",s="mousemove touchmove MSPointerMove pointermove scroll";function n(e,t,i){l("transform",e,"translate("+t+"px, "+i+"px)")}function r(e,t){l("transition",e,t)}function o(e){e=e.originalEvent||e;return window.event&&window.event.changedTouches&&event.changedTouches[0].pageX||e.pageX}function a(e){e=e.originalEvent||e;return window.event&&window.event.changedTouches&&event.changedTouches[0].pageY||e.pageY}function l(e,t,i){e=e.toLowerCase();var s=e.charAt(0).toUpperCase()+e.substr(1);var n=["webkit","Moz","ms","O"];var r=n.map(function(e){return e+s}).concat("transform");for(var o=0,a=r.length;o<a;++o){if(r[o]in t.style){if(i!==undefined)t.style[r[o]]=i;else return t.style[r[o]];break}}}var c=["altKey","bubbles","button","cancelable","charCode","clientX","clientY","ctrlKey","currentTarget","data","detail","eventPhase","metaKey","offsetX","offsetY","originalTarget","pageX","pageY","relatedTarget","screenX","screenY","shiftKey","target","view","which"];function d(e,t,i,s){if(!e[0])return;i=i.originalEvent||i;var n={};c.forEach(function(e){n[e]=i[e]});n.currentTarget=n.target=e[0];var r=e[0].ownerDocument.defaultView||e[0].ownerDocument.parentWindow;var o=r.$.Event(t,n);r.$(e[0]).trigger(o,s);return o}var u=0;var h=function(){this.eventHandler=e("<div />");this.parent=this.el=this.handle=null;this.origin={x:0,y:0,transition:null,translate:null,offset:{x:0,y:0}};this.lastEntered=this.currentTarget=null;this.lastX=this.lastY=this.lastDirection=null;this.originalCss={};this.windows=[window];var t;Object.defineProperty(this,"placeholder",{get:function(){return t},set:function(e){if(t===e)return;if(t)t.remove();t=e}})};h.prototype.on=function(){this.eventHandler.on.apply(this.eventHandler,Array.prototype.slice.call(arguments));return this};h.prototype.off=function(){this.eventHandler.off.apply(this.eventHandler,Array.prototype.slice.call(arguments));return this};h.prototype.start=function(t,n,c,u){this.parent=t;this.el=n;this.handle=u;var n=this.handle||this.el;this.origin.x=o(c);this.origin.y=a(c);this.origin.transform=l("transform",this.el[0]);this.origin.transition=l("transition",this.el[0]);var h=this.el[0].getBoundingClientRect();this.origin.offset.x=h.left+(window.scrollX||window.pageXOffset)-this.origin.x;this.origin.offset.y=h.top+(window.scrollY||window.pageYOffset)-this.origin.y;this.origin.scrollX=window.scrollX||window.pageXOffset;this.origin.scrollY=window.scrollY||window.pageYOffset;n[0].style.pointerEvents="none";this.windows.forEach(function(t){e(t).on(s,e.proxy(this.move,this));e(t).on(i,e.proxy(this.stop,this))},this);r(n[0],"");d(this.eventHandler,"dragging:start",c);return this.el};h.prototype.stop=function(t){var n=null;var o=true;if(this.last){var a=this.last;this.last=null;n=d(e(a),"dragging:drop",t);o=!n.isDefaultPrevented()}if(!this.el){return}for(var c in this.originalCss){this.el.css(c,this.originalCss[c]);delete this.originalCss[c]}d(this.eventHandler,"dragging:stop",t,this.el);this.placeholder=null;if(!this.handle){this.adjustPlacement(t)}var u=this.el;if(this.handle){this.handle.remove()}setTimeout(function(e,t){r(e[0],"all 0.25s ease-in-out 0s");l("transform",e[0],t.transform||"");setTimeout(r.bind(null,e[0],t.transition||""),250);e[0].style.pointerEvents=""}.bind(null,u,this.origin));this.windows.forEach(function(t){e(t).off(s,this.move);e(t).off(i,this.stop)},this);this.parent=this.el=this.handle=null};h.prototype.move=function(t){if(!this.el)return;var i=this.el[0].ownerDocument;var s=i.defaultView||i.parentWindow;if(t.type!=="scroll"){var r=o(t);var l=a(t);if(t.view!==s&&t.view.frameElement){r+=t.view.frameElement.offsetLeft;l+=t.view.frameElement.offsetTop}var c=t.clientX||t.originalEvent&&t.originalEvent.clientX||window.event&&window.event.touches&&window.event.touches[0].clientX||0,u=t.clientY||t.originalEvent&&t.originalEvent.clientY||window.event&&window.event.touches&&window.event.touches[0].clientY||0;var i=this.el[0].ownerDocument;var h;if(!_){h=t.view.document.elementFromPoint(c,u)}else{h=t.view.document.msElementsFromPoint(c,u);h=h[0]===this.el[0]?h[1]:h[0]}var p=this.lastX-r;var m=this.lastY-l;var g=m>0&&"up"||m<0&&"down"||p>0&&"up"||p<0&&"down"||this.lastDirection;if(!f.currentTarget){this.setCurrent(h)}if(this.currentTarget){if(h!==this.last&&this.lastEntered!==this.currentTarget){d(e(this.lastEntered),"dragging:leave",t);d(e(this.currentTarget),"dragging:enter",t);this.lastEntered=this.currentTarget}else if(g!==this.lastDirection){d(e(this.currentTarget),"dragging:diverted",t)}}this.last=h;this.currentTarget=null;this.lastDirection=g;this.lastX=r;this.lastY=l;this.origin.scrollX=window.scrollX||window.pageXOffset;this.origin.scrollY=window.scrollY||window.pageYOffset}else{var r=this.lastX+((window.scrollX||window.pageXOffset)-this.origin.scrollX),l=this.lastY+((window.scrollY||window.pageYOffset)-this.origin.scrollY)}if(t.view!==s&&t.view&&t.view.frameElement){var v=(l-(window.scrollY||window.pageYOffset)-window.innerHeight)*-1;var b=document.documentElement.offsetHeight<(window.scrollY||window.pageYOffset)+window.innerHeight;if(v<=10&&!b){setTimeout(function(){window.scrollBy(0,5)},50)}var w=l-(window.scrollY||window.pageYOffset);var y=(window.scrollY||window.pageYOffset)<=0;if(w<=10&&!y){setTimeout(function(){window.scrollBy(0,-5)},50)}}var p=r-this.origin.x,m=l-this.origin.y;var C=this.handle||this.el;var k=parseFloat(document.querySelector('[data-id="innerWrapper"]').getAttribute("zoom"))||1;n(C[0],p/k,m/k)};h.prototype.setCurrent=function(e){this.currentTarget=e};h.prototype.css=function(e,t){if(!this.el)return;this.originalCss[e]=this.el.css(e);this.el.css(e,t)};h.prototype.adjustPlacement=function(e){var t=this.handle&&this.handle[0]||this.el[0];n(t,0,0);var i=t.getBoundingClientRect();this.origin.x=i.left+(window.scrollX||window.pageXOffset)-this.origin.offset.x;this.origin.y=i.top+(window.scrollY||window.pageYOffset)-this.origin.offset.y;var s=o(e)||this.lastX,r=a(e)||this.lastY,l=s-this.origin.x,c=r-this.origin.y;n(t,l,c)};var f;try{if(parent.$&&parent.$.dragging){f=parent.$.dragging;f.windows.push(window)}}catch(p){}f=e.dragging=f||new h;var m=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;function g(e,t){var i=e.matches||e.matchesSelector||e.msMatchesSelector||e.mozMatchesSelector||e.webkitMatchesSelector||e.oMatchesSelector;return i?i.call(e,t):false}function v(e){return Array.prototype.slice.call(e)}var _=false;if(typeof m==="undefined"){m=function(e){this.targets=[];this.onAdded=function(t){e([{addedNodes:[t.target],removedNodes:[]}])};this.onRemoved=function(t){e([{addedNodes:[],removedNodes:[t.target]}])}};m.prototype.observe=function(e){e.addEventListener("DOMNodeInserted",this.onAdded);e.addEventListener("DOMNodeRemoved",this.onRemoved);this.targets.push(e)};m.prototype.disconnect=function(){var e;while(e=this.targets.shift()){e.removeEventListener("DOMNodeInserted",this.onAdded);e.removeEventListener("DOMNodeRemoved",this.onRemoved)}};_=!!~navigator.appName.indexOf("Internet Explorer")}var b=function(e,t,i,s){var n=this;this.targets=e instanceof NodeList?Array.prototype.slice.call(e):[e];var r=t[0]===">";var o=r?t.substr(1):t;var a=false;function l(e,i){var s=[];v(e).forEach(function(e){if(e.nodeType!==1)return;if(r&&n.targets.indexOf(e.parentNode)===-1){return}if(g(e,o)){s.push(e)}if(r||!i){return}v(e.querySelectorAll(t)).forEach(function(e){s.push(e)})});return s}function c(e,t,i){if(!i){return}l(e,t).filter(function(e,t,i){return i.indexOf(e)===t}).forEach(function(e){i.call(e)})}var d=null;var u=[];var h=[];function f(){n.disconnect();for(var e=0,t=h.length;e<t;++e){var r=u.indexOf(h[e]);if(r>-1){u.splice(r,1);h.splice(e--,1)}}c(u,!(a&&_),i);c(h,true,s);u.length=0;h.length=0;n.observe()}this.observer=new m(function(e){e.forEach(function(e){u.push.apply(u,e.addedNodes);h.push.apply(h,e.removedNodes)});if(d){clearTimeout(d)}d=setTimeout(f)});if(i){this.targets.forEach(function(e){c(e.children,true,i)})}a=true;this.observe()};b.prototype.disconnect=function(){this.observer.disconnect()};b.prototype.observe=function(){var e=this;this.targets.forEach(function(t){e.observer.observe(t,{childList:true,subtree:true})})};var w=function(t,i){this.id=u++;this.el=e(t);this.opts=i;this.cancel=i.handle!==false};w.prototype.create=function(){this.el.on(t,e.proxy(this.start,this)).css("touch-action","double-tap-zoom").css("-ms-touch-action","double-tap-zoom");f.on("dragging:stop",e.proxy(this.reset,this));var i=this;setTimeout(function(){i.el.trigger("draggable:create",i)})};w.prototype.destroy=function(){this.el.off(t,this.start);f.off("dragging:stop",this.reset)};w.prototype.enable=function(){this.opts.disabled=false};w.prototype.disable=function(){this.opts.disabled=true};w.prototype.start=function(t){if(this.opts.disabled){return false}if(t.type==="mousedown"&&t.which!==1){return false}t=t.originalEvent||t;if(this.opts.cancel){var i=e(t.target);while(i[0]!==this.el[0]){if(i.is(this.opts.cancel))return;i=i.parent()}}if(this.opts.handle){var i=e(t.target),s=false;while(i[0]!==this.el[0]){if(i.is(this.opts.handle)){s=true;break}i=i.parent()}if(!s)return}t.preventDefault();var n=this.el,r;if(this.opts.clone){if(typeof this.opts.clone==="function"){r=this.opts.clone.call(this.el)}else{r=this.el.clone();if(this.opts.cloneClass){r.addClass(this.opts.cloneClass)}}var o=this.el.position();r.css("position","absolute").css("left",o.left).css("top",o.top).width(this.el.width()).height(this.el.height());r.insertAfter(this.el)}f.start(this,this.el,t,r);d(this.el,"draggable:start",t,{item:f.el})};w.prototype.reset=function(e,t){if(t===this.el[0]){d(this.el,"draggable:stop",e,{item:f.el})}};var y=function(t,i){this.id=u++;this.el=e(t);this.opts=i;this.accept=false};y.prototype.create=function(){this.el.on("dragging:enter",e.proxy(this.enter,this)).on("dragging:leave",e.proxy(this.leave,this)).on("dragging:drop",e.proxy(this.drop,this));f.on("dragging:start",e.proxy(this.activate,this)).on("dragging:stop",e.proxy(this.reset,this));var t=this;setTimeout(function(){t.el.trigger("droppable:create",t)})};y.prototype.destroy=function(){this.el.off("dragging:enter",this.enter).off("dragging:leave",this.leave).off("dragging:drop",this.drop)};y.prototype.enable=function(){this.opts.disabled=false};y.prototype.disable=function(){this.opts.disabled=true};y.prototype.activate=function(e){this.accept=f.parent.opts.connectWith&&this.el.is(f.parent.opts.connectWith);if(!this.accept){var t=this.opts.accept==="*"||(typeof this.opts.accept==="function"?this.opts.accept.call(this.el[0],f.el):f.el.is(this.opts.accept));if(this.opts.scope!=="default"){this.accept=f.parent.opts.scope===this.opts.scope;if(!this.accept&&this.opts.accept!=="*")this.accept=t}else this.accept=t}if(!this.accept)return;if(this.opts.activeClass)this.el.addClass(this.opts.activeClass);d(this.el,"droppable:activate",e,{item:f.el})};y.prototype.reset=function(e){if(!this.accept)return;if(this.opts.activeClass)this.el.removeClass(this.opts.activeClass);if(this.opts.hoverClass)this.el.removeClass(this.opts.hoverClass);d(this.el,"droppable:deactivate",e,{item:f.el})};y.prototype.enter=function(e){if(this.opts.disabled)return false;e.stopPropagation();if(f.placeholder)f.placeholder.hide();if(!this.accept)return;if(this.opts.hoverClass){this.el.addClass(this.opts.hoverClass)}d(this.el,"droppable:over",e,{item:f.el})};y.prototype.leave=function(e){if(this.opts.disabled)return false;if(this.opts.hoverClass&&this.accept){this.el.removeClass(this.opts.hoverClass)}d(this.el,"droppable:out",e,{item:f.el})};y.prototype.drop=function(t){if(this.opts.disabled||!this.accept)return false;if(!f.el)return;var i=f.el;var s=typeof s==="function"&&this.opts.receiveHandler;var n={item:i};var r=null;if(f.handle){n.helper=f.handle;if(!s){r=n.clone=f.el.clone()}}var o=d(this.el,"droppable:drop",t,n);if(!o.isDefaultPrevented()){if(s){s.call(this.el,n)}else{e(this.el).append(r||f.el)}}};var C=function(t,i){this.id=u++;this.el=t;this.opts=i;var s=this.opts.placeholderTag;if(!s){try{s=this.el.find(this.opts.items)[0].tagName}catch(n){s=/^ul|ol$/i.test(this.el[0].tagName)?"li":"div"}}this.placeholder=e("<"+s+' id="__ph'+this.id+'" class="'+this.opts.placeholder+'" />');this.accept=this.index=this.direction=null};C.prototype.create=function(){this.el.on(t,this.opts.items,e.proxy(this.start,this)).on("dragging:enter",this.opts.items,e.proxy(this.enter,this)).on("dragging:diverted",this.opts.items,e.proxy(this.diverted,this)).on("dragging:drop",this.opts.items,e.proxy(this.drop,this));e(this.el).find(this.opts.items).css("touch-action","double-tap-zoom").css("-ms-touch-action","double-tap-zoom");this.el.on("dragging:enter",e.proxy(this.enter,this)).on("dragging:diverted",e.proxy(this.diverted,this)).on("dragging:drop",e.proxy(this.drop,this));f.on("dragging:start",e.proxy(this.activate,this)).on("dragging:stop",e.proxy(this.reset,this));var i=this;setTimeout(function(){i.el.trigger("sortable:create",i)});this.observer=new b(this.el[0],this.opts.items,function(){},function(){if(this===i.placeholder[0]||f.el&&this===f.el[0]){return}var t=e(this);t.css("touch-action","double-tap-zoom").css("-ms-touch-action","double-tap-zoom");i.el.trigger("sortable:change",{item:t});i.el.trigger("sortable:update",{item:t,index:-1})})};C.prototype.destroy=function(){this.el.off(t,this.opts.items,this.start).off("dragging:enter",this.opts.items,this.enter).off("dragging:diverted",this.opts.items,this.diverted).off("dragging:drop",this.opts.items,this.drop);this.el.off("dragging:enter",this.enter).off("dragging:diverted",this.diverted).off("dragging:drop",this.drop);this.observer.disconnect()};C.prototype.enable=function(){this.opts.disabled=false};C.prototype.disable=function(){this.opts.disabled=true};C.prototype.activate=function(e){this.isEmpty=this.el.find(this.opts.items).length===0;this.accept=f.parent.id===this.id;if(!this.accept&&f.parent.opts.connectWith){this.accept=this.el.is(f.parent.opts.connectWith)}if(!this.accept)return;this.accept=f.parent.id===this.id||this.opts.accept==="*"||(typeof this.opts.accept==="function"?this.opts.accept.call(this.el[0],f.el):f.el.is(this.opts.accept));if(!this.accept)return;if(this.opts.activeClass)this.el.addClass(this.opts.activeClass);d(this.el,"sortable:activate",e,{item:f.el})};C.prototype.reset=function(e){if(!this.accept)return;if(this.opts.activeClass){this.el.removeClass(this.opts.activeClass)}d(this.el,"sortable:deactivate",e,{item:f.el});if(this.index!==null){d(this.el,"sortable:beforeStop",e,{item:f.el});d(this.el,"sortable:stop",e,{item:f.el});this.index=null}};C.prototype.indexOf=function(e){return this.el.find(this.opts.items+", #"+this.placeholder.attr("id")).index(e)};C.prototype.start=function(t){if(this.opts.disabled||f.el){return}if(t.type==="mousedown"&&t.which!==1){return false}if(this.opts.cancel){var i=e(t.target);while(i[0]!==this.el[0]){if(i.is(this.opts.cancel))return;i=i.parent()}}if(this.opts.handle){var i=e(t.target),s=false;while(i[0]!==this.el[0]){if(i.is(this.opts.handle)){s=true;break}i=i.parent()}if(!s)return}t.stopPropagation();t.preventDefault();f.start(this,e(t.currentTarget),t);this.index=this.indexOf(f.el);f.el.before(f.placeholder=this.placeholder.show());if(this.index!==null){var n=f.el.outerHeight?f.el.outerHeight():f.el.height();f.css("margin-bottom",-n)}if(this.opts.forcePlaceholderSize){this.placeholder.height(parseFloat(f.el.css("height")));this.placeholder.width(parseFloat(f.el.css("width")))}f.adjustPlacement(t);d(this.el,"sortable:start",t,{item:f.el})};C.prototype.enter=function(t){if(!this.accept||this.opts.disabled)return;t.stopPropagation();var i=t.currentTarget,s=i===this.el[0];if(i===this.placeholder[0])return;i=e(i);if(s&&!this.isEmpty&&this.placeholder.parent().length){return}f.placeholder=this.placeholder;if(this.opts.forcePlaceholderSize){this.placeholder.height(parseFloat(f.el.css("height")));this.placeholder.width(parseFloat(f.el.css("width")))}if(!s){this.diverted(t)}else{this.el.append(this.placeholder);this.el.trigger("sortable:change",{item:f.el})}};C.prototype.diverted=function(t){if(!this.accept||this.opts.disabled)return;t.stopPropagation();var i=e(t.currentTarget),s=i[0]===this.el[0];if(s)return;f.placeholder=this.placeholder;this.direction=this.indexOf(this.placeholder.show())<this.indexOf(i)?"down":"up";i[this.direction==="down"?"after":"before"](this.placeholder);f.adjustPlacement(t);this.el.trigger("sortable:change",{item:f.el})};C.prototype.drop=function(e){if(!this.accept||this.opts.disabled)return;e.stopPropagation();e.preventDefault();if(!f.el)return;if(!this.placeholder.parent().length)return;d(this.el,"sortable:beforeStop",e,{item:f.el});this.observer.disconnect();var t=this.indexOf(this.placeholder);if(t>this.index){t--}var i;if(this.index===null){i=this.opts.receiveHandler}else{i=this.opts.updateHandler||this.opts.updatePosition}var s=f.el;if(typeof i==="function"){i.call(this.el,{item:f.el,index:t})}else{if(f.handle){s=f.el.clone()}s.insertBefore(this.placeholder)}if(this.index===null){d(this.el,"sortable:receive",e,{item:s})}if(t!==this.index){this.el.trigger("sortable:update",{item:s,index:t})}d(this.el,"sortable:stop",e,{item:s});this.index=null;this.observer.observe();f.stop(e)};C.prototype.toArray=function(t){if(!t)t={};var i=t.attribute||"id",s=[];this.el.find(this.opts.items).each(function(){s.push(e(this).prop(i))});return s};function k(t,i,s){return function(n,r,o){var a=[];this.each(function(){var l=e(this).data(i);if(typeof n==="string"){if(typeof l==="undefined")throw new Error(i+" not defined");switch(n){case"enable":l.enable();break;case"disable":l.disable();break;case"destroy":l.destroy();e(this).removeData(i);break;case"option":if(o!==undefined)l.opts[r]=o;else if(typeof r==="object")l.opts=e.extend(l.opts,r);else if(r)a.push(l.opts[r]);else a.push(l.opts);break;case"toArray":if(i!=="sortable")return;a.push(l.toArray(r));break}}else{if(l){e.extend(l.opts,n);return this}l=new t(e(this),e.extend({},s,n));l.create();e(this).data(i,l)}});if(a.length)return a.length===1?a[0]:a;else return this}}e.fn.draggable=k(w,"draggable",{cancel:"input, textarea, button, select, option",connectWith:false,cursor:"auto",disabled:false,handle:false,initialized:false,clone:false,cloneClass:"",scope:"default"});e.fn.droppable=k(y,"droppable",{accept:"*",activeClass:"",disabled:false,hoverClass:"",initialized:false,scope:"default",receiveHandler:null});e.fn.sortable=k(C,"sortable",{accept:"*",activeClass:"",cancel:"input, textarea, button, select, option",connectWith:false,disabled:false,forcePlaceholderSize:false,handle:false,initialized:false,items:"li, div",placeholder:"placeholder",placeholderTag:null,updateHandler:null,receiveHandler:null})})(window.Zepto||window.jQuery);define("components/adapt-sentenceOrdering/libraries/sortable",function(){});define("components/adapt-sentenceOrdering/js/sentenceOrderingView",["require","core/js/views/questionView","core/js/adapt","../libraries/sortable"],function(e){var t=e("core/js/views/questionView"),i=e("core/js/adapt"),s=e("../libraries/sortable");var n=t.extend({setupQuestion:function(){this.listenTo(i,"device:resize",this.resizeItems,200);this.model.setupRandomisation()},onQuestionRendered:function(){this.setReadyStatus();this.setHeight();this.resizeItems();this.showMarking();if(!this.model.get("_isPrefixTitle"))this.$(".sentence-container").width("100%");this.model.set("_sentenceListHtml",this.$("ul[data-id='sortable']").html());this.model.set("_sentenceListJqueryObject",this.$("ul[data-id='sortable']"));this.sortSentenceInitialize()},sortSentenceInitialize:function(e){if(this.model.get("_isSubmitted"))return;var t=this;if(e&&e.preventDefault){e.preventDefault()}this.model.get("_sentenceListJqueryObject").sortable().on("sortable:activate",function(e,t){$(t.item).css({"z-index":"1000"});if(i.device.screenSize=="small"){$("html").css("overflow","hidden")}}).on("sortable:deactivate",function(e,s){$(s.item).css({"z-index":"0"});if(i.device.screenSize=="small"){$("html").css("overflow","")}t.setDefaultHeight()}).on("sortable:change",function(e,t){$("li.placeholder").css("height",t.item.height()+"px")})},setDefaultHeight:function(){var e=this.$(".prefixTitle ,.sentenceSequence");e.css({height:"auto"});this.setHeight()},setHeight:function(){var e=this.$(".prefixTitle"),t=this.$(".sentenceSequence"),i,s;for(var n=0,r=e.length;n<r;n++){i=e.eq(n).height();s=t.eq(n).height();if(!(i===s)){if(i>s){t.eq(n).css({height:i})}else{e.eq(n).css({height:s})}}}},resizeItems:function(){if(this.model.get("_shouldScale")){var e=this.$("div[data-id='innerWrapper']"),t=e.outerHeight(),i=e.outerWidth(),s=this.$("div[data-id='scaleableWrapper']");function n(s,n){var r,o;r=Math.min(n.size.width/i,n.size.height/t);if(r>1){r=1}e.css({"-ms-transform":"scale("+r+")","-moz-transform":"scale("+r+")","-webkit-transform":"scale("+r+")","-webkit-transform-style":"preserve-3d","-webkit-transform":"scale3d("+r+","+r+","+r+")",transform:"scale("+r+")"}).attr("zoom",r);e.height(this.$(".sentence-container").height()*r)}var r={size:{width:s.width(),height:s.height()}};n(null,r)}else{this.setDefaultHeight()}},disableQuestion:function(){this.model.get("_sentenceListJqueryObject").sortable("disable")},enableQuestion:function(){this.model.get("_sentenceListJqueryObject").sortable("enable")},onCannotSubmit:function(){},onSubmitted:function(){var e=this.model.get("_numberOfIncorrectAnswers");var t=this.model.get("_attemptsLeft");if(t!==0&&e>0)this.model.get("_sentenceListJqueryObject").children("li").removeClass("correct incorrect").addClass("incorrect-resettable")},showMarking:function(){if(!this.model.get("_canShowMarking")||!this.model.get("_isSubmitted"))return;var e=this.$(".sentenceSequence");_.each(this.model.get("isItemOnCorrectPlace"),function(t,i){var s=e.eq(i);s.removeClass("correct incorrect").addClass(t?"correct":"incorrect")},this)},showCorrectAnswer:function(){var e=[],t=this.model.get("_sentenceListJqueryObject").children().clone();t.sort(function(e,t){return parseInt(e.dataset.itemid)-parseInt(t.dataset.itemid)}).each(function(){e.push(this)});this.model.get("_sentenceListJqueryObject").html(e);this.setDefaultHeight()},hideCorrectAnswer:function(){this.model.get("_sentenceListJqueryObject").html(this.model.get("userSortedList")||this.model.get("_sentenceListHtml"));this.setDefaultHeight()},resetQuestion:function(){if(this.model.get("_sentenceListHtml"))this.model.get("_sentenceListJqueryObject").html(this.model.get("_sentenceListHtml"))},getResponse:function(){var e=this.model.get("_userAnswer");var t=[];for(var i=0,s=e.length;i<s;i++){t.push(i+1+"."+e[i])}return t.join("#")},getResponseType:function(){return"matching"}});return n});define("components/adapt-sentenceOrdering/js/adapt-sentenceOrdering",["require","core/js/adapt","./sentenceOrderingModel","./sentenceOrderingView"],function(e){var t=e("core/js/adapt");var i=e("./sentenceOrderingModel");var s=e("./sentenceOrderingView");return t.register("sentenceOrdering",{view:s,model:i})});define("components/adapt-stacklist/js/adapt-stacklist",["require","coreViews/componentView","coreJS/adapt"],function(e){var t=e("coreViews/componentView");var i=e("coreJS/adapt");var s=t.extend({TRANSITION_TIME:250,events:{"click .stacklist-next":"nextItem"},preRender:function(){this.model.set("_globals",i.course.get("_globals"));this.model.set("_stage",-1);this.setupButton()},postRender:function(){if(!this.model.get("_isComplete")||this.model.get("_isResetOnRevisit"))this.setupListItems();this.setReadyStatus()},setupButton:function(){var e=this.model.get("_button")||{};var t=this.model.get("_globals")._components._stacklist.ariaButtonLabel||this.model.get("_globals")._accessibility._ariaLabels.next;this.model.set({buttonAriaLabel:t});if(!e.startText)e.startText="Click here to begin";if(!e.continueText)e.continueText="Next";if(!e.ariaLabel)e.ariaLabel=t;this.model.set("_button",e)},setupListItems:function(){var e=$(window).width();var t=this.$(".stacklist-item");t.addClass("visibility-hidden");t.each(function(i){var s=t.eq(i);var n=i%2===0;var r=s.offset();r.left=n?-(s.outerWidth()+10):e+10;s.offset(r)});this.$(".stacklist-button").show()},nextItem:function(){var e=this.model.get("_stage")+1;this.setStage(e)},setStage:function(e){this.model.set("_stage",e);var t=this.model.get("_items")[e].next||this.model.get("_button").continueText;var i=this.model.get("_button").ariaLabel;var s=this.model.get("_items").length-1===e;if(!s){this.$(".stacklist-next").attr("aria-label",t+", "+i).html(t)}var n=this.$(".stacklist-item").eq(e);n.removeClass("visibility-hidden");var r=n.outerHeight(true);this.$(".stacklist-button").velocity({top:"+="+r},this.TRANSITION_TIME);n.velocity({left:0},{delay:this.TRANSITION_TIME,duration:this.TRANSITION_TIME,complete:function(){n.addClass("show").a11y_focus()}});if(s){this.onComplete()}},onComplete:function(){var e=this.$(".stacklist-button");e.velocity({opacity:0},{duration:this.TRANSITION_TIME,queue:false,complete:function(){e.remove()}});this.$(".textSourceContent-inner").removeClass("display-none");this.setCompletionStatus()}});i.register("stacklist",s);return s});define("components/adapt-tabs/js/adapt-tabs",["require","coreViews/componentView","coreJS/adapt"],function(e){var t=e("coreViews/componentView");var i=e("coreJS/adapt");var s=t.extend({events:{"click .tab-item":"onTabItemClicked","click .image-zoomer":"onZoomClicked","click .tabs-body-audio-sound":"onClickAudioButton"},preRender:function(){if(this.model.get("_isZoomAllowed")==undefined){this.model.set("_isZoomAllowed",false)}if(i.device.screenSize=="large")this.model.set("_isDesktop",true);else this.model.set("_isDesktop",false)},postRender:function(){this.setReadyStatus();this.setLayout();this.listenTo(i,"device:resize",this.setLayout);this.showContentItemAtIndex(0);this.setTabSelectedAtIndex(0)},setLayout:function(){this.$el.removeClass("tab-layout-left tab-layout-top");if(i.device.screenSize=="medium"){this.$el.addClass("tab-layout-left");this.setTabLayoutLeft()}else{var e=this.model.get("_tabLayout");this.$el.addClass("tab-layout-"+e);if(e==="top"){this.setTabLayoutTop()}else if(e==="left"){this.setTabLayoutLeft()}}if(i.device.screenSize=="large")this.model.set("_isDesktop",true);else this.model.set("_isDesktop",false)},setTabLayoutTop:function(){var e=this.model.get("_items").length;var t=100/e;this.$(".tab-item").css({width:t+"%"});this.$(".tabs-content-items").css({height:"auto"})},setTabLayoutLeft:function(){var e=this.$(".tabs-tab-items").height();this.$(".tabs-content-items").css({height:e+"px"});this.$(".tab-item").css({width:"99%"})},onTabItemClicked:function(e){e.preventDefault();var t=$(e.currentTarget).index();this.showContentItemAtIndex(t);this.setTabSelectedAtIndex(t);this.stopAllAudio(this.model.get("_items").length)},onAudioEnded:function(e){var t=this.findAudioParent(e);var i=this.model.get("_stage");this.$(".tabs-content-item").eq(i).find(".tabs-"+t+"-audio-icon").removeClass("icon-sound").addClass("icon-sound-mute")},onClickAudioButton:function(e){if(e&&e.preventDefault)e.preventDefault();var t=this.findAudioParent(e);var i=$(e.currentTarget).closest(".tabs-content-item");var s=i.index();this.stopAllAudio(s);var n=i.find("audio")[0];if(n.paused){console.log(t," if ",s);n.play();console.log("ifffff ",this.$(".tabs-content-item").eq(s).find(".tabs-"+t+"-audio-icon"));this.$(".tabs-content-item").eq(s).find(".tabs-"+t+"-audio-icon").removeClass("icon-sound-mute").addClass("icon-sound");var r=this.model.get("_items")[s];r.audioVisited=true;this.setItemVisited(s)}else{console.log("else");n.pause();this.$(".tabs-content-item").eq(s).find(".tabs-"+t+"-audio-icon").removeClass("icon-sound").addClass("icon-sound-mute")}},stopAllAudio:function(e){var t=0;t+=this.$(".tabs-title-audio-icon").length;t+=this.$(".tabs-body-audio-icon").length;var i=this.$("audio").length-t;_.each($("audio"),function(t,s){console.log(s," index ",s!==e+i);if($(t).data("index")!==e){if(!t.paused)t.pause();$(".audio").eq(s).removeClass("icon-sound").addClass("icon-sound-mute")}},this)},onZoomClicked:function(e){e.preventDefault();var t=$(e.currentTarget).attr("id");this.openPopUp(t)},openPopUp:function(e){var t=this.model.get("_items")[e].graphic;this.model.set({feedbackTitle:"<img class='tab-content-item-title-image-zoom' src='"+t+"'/>"});i.trigger("questionView:showFeedback",this)},showContentItemAtIndex:function(e){this.$(".tab-content").velocity({opacity:0,translateY:"20px"},{duration:200,display:"none"});this.$(".tab-content-item-title-image").velocity({scaleX:.9,scaleY:.9},{duration:200});var t=this.$(".tab-content").eq(e);var i=$(t);i.velocity({opacity:1,translateY:"0"},{duration:400,display:"block"});i.find(".tab-content-item-title-image").velocity({scaleX:1,scaleY:1},{duration:800})},itemHasAudio:function(e){var t=this.model.get("_items")[e];if(t._audio&&t._audio.src){if(t.audioVisited)return true;else return false}else{return true}},setTabSelectedAtIndex:function(e){this.$(".tab-item").removeClass("selected");this.$(".tab-item").eq(e).addClass("selected");this.$(".tab-item").eq(e).addClass("visited");this.$(".tab-item").attr("aria-expanded",false);this.$(".tab-item").eq(e).attr("aria-expanded",true);if(this.itemHasAudio(e)){this.setItemVisited(e)}},setItemVisited:function(e){var t=this.model.get("_items")[e];t._isVisited=true;this.checkCompletionStatus()},getVisitedItems:function(){return _.filter(this.model.get("_items"),function(e){return e._isVisited})},checkCompletionStatus:function(){if(!this.model.get("_isComplete")){if(this.getVisitedItems().length==this.model.get("_items").length){this.setCompletionStatus()}}}});i.register("tabs",s)});define("extensions/adapt-certificate/js/adapt-certificate",["core/js/adapt"],function(e){$("body").on("click",".print-button",function(){var i=e.course.get("_certificate");var s=e.course.get("displayTitle");var n=e.offlineStorage.get("learnerinfo").name;var r=(new Date).toLocaleDateString("en-GB");var o=t();var a=document.location.origin;var l=window.open("course/en/document/certificate.html","bob");var c=_.extend(i,{course:s,name:o.learnerName||n,id:o.learnerID||"",score:score,date:r});window.addEventListener("message",function(){var e=JSON.parse(JSON.stringify(c));l.postMessage(e,a)})});function t(){var e={};var t=pipwerks.SCORM.version=="1.2";e.learnerName=t?pipwerks.SCORM.data.get("cmi.core.student_name"):pipwerks.SCORM.data.get("cmi.learner_name");e.learnerID=t?pipwerks.SCORM.data.get("cmi.core.student_id"):pipwerks.SCORM.data.get("cmi.learner_id");e.score=t?pipwerks.SCORM.data.get("cmi.core.score.raw"):pipwerks.SCORM.data.get("cmi.score.raw");return e}});define("extensions/adapt-contrib-assessment/js/adapt-assessmentArticleView",["core/js/adapt","core/js/views/articleView"],function(e,t){var i={postRender:function(){t.prototype.postRender.call(this);if(this.model.isAssessmentEnabled()){this._setupEventListeners();var e=this.model.getConfig();if(e&&e._questions&&e._questions._canShowMarking===false){this.$el.addClass("no-marking")}}this.$el.addClass("assessment")},_setupEventListeners:function(){this.listenTo(e,"assessments:complete",this._onAssessmentComplete);this.listenTo(e,"assessments:reset",this._onAssessmentReset);this.listenTo(e,"remove",this._onRemove)},_removeEventListeners:function(){this.stopListening(e,"assessments:complete",this._onAssessmentComplete);this.stopListening(e,"assessments:reset",this._onAssessmentReset)},_onAssessmentComplete:function(e,t){if(e.id!=this.model.get("_assessment")._id)return;console.log("assessment complete",e,t)},_onAssessmentReset:function(e,t){if(e.id!=this.model.get("_assessment")._id)return;console.log("assessment reset",e,t)},_onRemove:function(){this._removeEventListeners()}};return i});define("extensions/adapt-contrib-assessment/js/adapt-assessmentQuestionBank",["require"],function(e){
var t=function(e,t,i,s){this._id=e;this._articleId=t;this._numQuestionBlocks=i;this._uniqueQuestions=s;this.questionBlocks=[];this.unUsedQuestionBlocks=undefined;this.usedQuestionBlocks=[]};t.prototype={getID:function(){return this._id},addBlock:function(e){this.questionBlocks.push(e)},getRandomQuestionBlocks:function(){this.checkResetUnunsedBlocks();var e=[];var t=this.usedQuestionBlocks.slice(0);for(var i=0;i<this._numQuestionBlocks;i++){var s=this.getRandomQuestion();if(s!==undefined){e.push(s)}else{if(t.length===0)break;var n=Math.floor(Math.random()*(t.length-1));s=t.splice(n,1)[0];e.push(s)}}return e},checkResetUnunsedBlocks:function(){if(this.unUsedQuestionBlocks!==undefined&&this._uniqueQuestions)return;this.unUsedQuestionBlocks=this.questionBlocks.slice(0)},getRandomQuestion:function(){if(this.unUsedQuestionBlocks!==undefined&&this.unUsedQuestionBlocks.length<1){console.warn("assessment:"+this._articleId+" No more unique questions for _assessment._quizBankID "+this._id);return undefined}var e=Math.round(Math.random()*(this.unUsedQuestionBlocks.length-1));var t=this.unUsedQuestionBlocks[e];this.usedQuestionBlocks.push(t);this.unUsedQuestionBlocks.splice(e,1);return t}};return t});define("extensions/adapt-contrib-assessment/js/adapt-assessmentArticleModel",["core/js/adapt","./adapt-assessmentQuestionBank"],function(e,t){var i=0;var s={_isEnabled:true,_questions:{_resetType:"soft",_canShowFeedback:false,_canShowMarking:false,_canShowModelAnswer:false},_suppressMarking:false,_isPercentageBased:true,_scoreToPass:100,_includeInTotalScore:true,_assessmentWeight:1,_isResetOnRevisit:true,_reloadPageOnReset:true,_attempts:"infinite",_allowResetIfPassed:false};var n={_postInitialize:function(){if(!this.isAssessmentEnabled())return;var t=this.getConfig();_.extend(this,{_currentQuestionComponents:null,_originalChildModels:null,_questionBanks:null,_forceResetOnRevisit:false});var i;switch(t._attempts){case"infinite":case 0:case undefined:case-1:case null:i="infinite";break;default:i=t._attempts;break}this.set({_currentQuestionComponentIds:[],_assessmentCompleteInSession:false,_attemptInProgress:false,_isAssessmentComplete:false,_numberOfQuestionsAnswered:0,_lastAttemptScoreAsPercent:0,_attempts:i,_attemptsLeft:i,_attemptsSpent:0});this.listenToOnce(e,"app:dataReady",this._onDataReady);this.listenTo(e,"remove",this._onRemove)},init:function(){this._originalChildModels=this.getChildren().models;this._currentQuestionComponents=_.filter(this.findDescendantModels("components"),function(e){return e.get("_isQuestionType")===true});this.set("_currentQuestionComponentIds",_.map(this._currentQuestionComponents,function(e){return e.get("_id")}));this._setAssessmentOwnershipOnChildrenModels()},_setAssessmentOwnershipOnChildrenModels:function(){for(var e=0,t=this._originalChildModels.length;e<t;e++){var i=this._originalChildModels[e];i.set({_isPartOfAssessment:true});i.setOnChildren({_isPartOfAssessment:true})}},_onDataReady:function(){e.assessment.register(this)},_setupAssessmentData:function(t,i){var s=this.getConfig();var n=this.getState();var r=!this.get("_attemptInProgress")&&!n.isPass||t===true;var o=s._isResetOnRevisit!==false&&!n.isPass||t===true;if(r||o){e.trigger("assessments:preReset",this.getState(),this)}var a;if(r){this.set("_numberOfQuestionsAnswered",0);this.set("_isAssessmentComplete",false);this.set("_assessmentCompleteInSession",false);this.set("_score",0);this.getChildren().models=this._originalChildModels;if(s._banks&&s._banks._isEnabled&&s._banks._split.length>1){a=this._setupBankedAssessment()}else if(s._randomisation&&s._randomisation._isEnabled){a=this._setupRandomisedAssessment()}}if(!a){a=this.getChildren().models}else if(a.length===0){a=this.getChildren().models;console.warn("assessment: Not enough unique questions to create a fresh assessment, using last selection")}this.getChildren().models=a;this._currentQuestionComponents=_.filter(this.findDescendantModels("components"),function(e){return e.get("_isQuestionType")===true});this.set("_currentQuestionComponentIds",_.map(this._currentQuestionComponents,function(e){return e.get("_id")}));if(r||o){this._resetQuestions(_.bind(function(){this.set("_attemptInProgress",true);e.trigger("assessments:reset",this.getState(),this);l.apply(this)},this))}else{l.apply(this)}function l(){if(!n.isComplete){this.set("_attemptInProgress",true)}this._overrideQuestionComponentSettings();this._setupQuestionListeners();this._checkNumberOfQuestionsAnswered();this._updateQuestionsState();e.assessment.saveState();if(typeof i=="function")i.apply(this);if(r||o){e.trigger("assessments:postReset",this.getState(),this)}}},_setupBankedAssessment:function(){var e=this.getConfig();this._setupBanks();var t=[];for(var i in this._questionBanks){if(this._questionBanks.hasOwnProperty(i)){var s=this._questionBanks[i];var n=s.getRandomQuestionBlocks();t=t.concat(n)}}if(e._banks._randomisation){t=_.shuffle(t)}return t},_setupBanks:function(){var e=this.getConfig();var i=e._banks._split.split(",");var s;this._questionBanks=[];for(var n=0,r=i.length;n<r;n++){var o=i[n];s=n+1;var a=new t(s,this.get("_id"),o,true);this._questionBanks[s]=a}var l=this.getChildren().models;for(var c=0,d=l.length;c<d;c++){var u=l[c];var h=u.get("_assessment");s=h._quizBankID;this._questionBanks[s].addBlock(u)}},_setupRandomisedAssessment:function(){var e=this.getConfig();var t=e._randomisation;var i=this.getChildren().models;var s=_.shuffle(i);if(t._blockCount>0){s=s.slice(0,t._blockCount)}return s},_overrideQuestionComponentSettings:function(){var e=this._getMarkingSettings();var t=this.getConfig()._questions;if(t.hasOwnProperty("_canShowFeedback")){e._canShowFeedback=t._canShowFeedback}if(!_.isEmpty(e)){for(var i=0,s=this._currentQuestionComponents.length;i<s;i++){this._currentQuestionComponents[i].set(e,{pluginName:"_assessment"})}}},_setupQuestionListeners:function(){var e=this._currentQuestionComponents;for(var t=0,i=e.length;t<i;t++){var s=e[t];if(s.get("_isInteractionComplete"))continue;this.listenTo(s,"change:_isInteractionComplete",this._onQuestionCompleted)}},_checkNumberOfQuestionsAnswered:function(){var e=this._currentQuestionComponents;var t=0;for(var i=0,s=e.length;i<s;i++){var n=e[i];if(n.get("_isInteractionComplete")){t++}}this.set("_numberOfQuestionsAnswered",t)},_removeQuestionListeners:function(){var e=this._currentQuestionComponents;for(var t=0,i=e.length;t<i;t++){var s=e[t];this.stopListening(s,"change:_isInteractionComplete",this._onQuestionCompleted)}},_onQuestionCompleted:function(t,i){if(i===false)return;if(!t.get("_isInteractionComplete"))return;var s=this.get("_numberOfQuestionsAnswered");s++;this.set("_numberOfQuestionsAnswered",s);this._updateQuestionsState();e.assessment.saveState();this._checkAssessmentComplete()},_checkAssessmentComplete:function(){var e=this.get("_numberOfQuestionsAnswered");var t=e>=this._currentQuestionComponents.length;if(!t)return;this._onAssessmentComplete()},_onAssessmentComplete:function(){var t=this.getConfig();this.set("_attemptInProgress",false);this._spendAttempt();var i=this._getScoreAsPercent();var s=this._getScore();var n=this._getMaxScore();this.set({_scoreAsPercent:i,_score:s,_maxScore:n,_lastAttemptScoreAsPercent:i,_assessmentCompleteInSession:true,_isAssessmentComplete:true});this._updateQuestionsState();this._checkIsPass();this._removeQuestionListeners();if(this._isMarkingSuppressionEnabled()&&!this._isAttemptsLeft()){_.defer(_.bind(function(){this._overrideMarkingSettings();this._refreshQuestions()},this))}e.trigger("assessments:complete",this.getState(),this)},_updateQuestionsState:function(){var e=[];var t=this._currentQuestionComponents;for(var i=0,s=t.length;i<s;i++){var n=t[i];var r={_id:n.get("_id"),_isCorrect:n.get("_isCorrect")===undefined?null:n.get("_isCorrect")};e.push(r)}this.set({_questions:e})},_checkIsPass:function(){var e=this.getConfig();var t=e._isPercentageBased;var i=e._scoreToPass;var s=this.get("_scoreAsPercent");var n=this.get("_score");var r=t?s>=i:n>=i;this.set("_isPass",r)},_getMarkingSettings:function(){var e={};if(this._shouldSuppressMarking()){e={_canShowMarking:false,_canShowModelAnswer:false}}else{var t=this.getConfig()._questions;if(t.hasOwnProperty("_canShowModelAnswer")){e._canShowModelAnswer=t._canShowModelAnswer}if(t.hasOwnProperty("_canShowMarking")){e._canShowMarking=t._canShowMarking}}return e},_overrideMarkingSettings:function(){var e=this._getMarkingSettings();for(var t=0,i=this._currentQuestionComponents.length;t<i;t++){this._currentQuestionComponents[t].set(e,{pluginName:"_assessment"})}},_refreshQuestions:function(){for(var e=0,t=this._currentQuestionComponents.length;e<t;e++){var i=this._currentQuestionComponents[e];i.refresh()}},_shouldSuppressMarking:function(){return this._isMarkingSuppressionEnabled()&&this._isAttemptsLeft()},_isMarkingSuppressionEnabled:function(){var e=this.getConfig();return e._suppressMarking},_isAttemptsLeft:function(){if(this.get("_isAssessmentComplete")&&this.get("_isPass"))return false;if(this.get("_attemptsLeft")===0)return false;return true},_spendAttempt:function(){if(!this._isAttemptsLeft())return false;var e=this.get("_attemptsSpent");e++;this.set("_attemptsSpent",e);if(this.get("_attempts")=="infinite")return true;var t=this.get("_attemptsLeft");t--;this.set("_attemptsLeft",t);return true},_getScore:function(){var e=0;var t=this._currentQuestionComponents;for(var i=0,s=t.length;i<s;i++){var n=t[i];if(n.get("_isCorrect")&&n.get("_questionWeight")){e+=n.get("_questionWeight")}}return e},_getMaxScore:function(){var e=0;var t=this._currentQuestionComponents;for(var i=0,s=t.length;i<s;i++){var n=t[i];if(n.get("_questionWeight")){e+=n.get("_questionWeight")}}return e},_getScoreAsPercent:function(){if(this._getMaxScore()===0)return 0;return Math.round(this._getScore()/this._getMaxScore()*100)},_getLastAttemptScoreAsPercent:function(){return this.get("_lastAttemptScoreAsPercent")},_checkReloadPage:function(){if(!this.canResetInPage())return false;var t=this.getParent().get("_id");var i=e.location._currentId;if(i!=t)return false;if(!this.get("_isReady"))return false;return true},_reloadPage:function(){this._forceResetOnRevisit=true;_.delay(function(){Backbone.history.navigate("#/id/"+e.location._currentId,{replace:true,trigger:true})},250)},_resetQuestions:function(e){var t=this.getConfig();var i=1;var s=0,n=this._currentQuestionComponents,r=n.length;function o(){for(var a=0,l=Math.min(i,r-s);a<l;s++,a++){var c=n[s];c.reset(t._questions._resetType,true)}s==r?e():setTimeout(o)}o()},_onRemove:function(){this._removeQuestionListeners()},_setCompletionStatus:function(){this.set({_isComplete:true,_isInteractionComplete:true})},_checkIfQuestionsWereRestored:function(){if(this.get("_assessmentCompleteInSession"))return;if(!this.get("_isAssessmentComplete"))return;var t=true;var i=this.get("_questions");for(var s=0,n=i.length;s<n;s++){var r=i[s];var o=e.findById(r._id);if(!o.get("_isSubmitted")){t=false;break}}if(!t){this.set("_assessmentCompleteInSession",true);return true}return false},isAssessmentEnabled:function(){if(this.get("_assessment")&&this.get("_assessment")._isEnabled)return true;return false},canResetInPage:function(){var e=this.getConfig();if(e._reloadPageOnReset===false)return false;return true},reset:function(e,t){if(this._isResetInProgress){this.once("reset",function(){this._isResetInProgress=false;if(typeof t=="function"){t(true)}});return}var i=this.getConfig();e=this._forceResetOnRevisit||e===true;this._forceResetOnRevisit=false;var s=this._checkReloadPage();if(this.get("_assessmentCompleteInSession")&&!i._isResetOnRevisit&&!s&&!e){if(typeof t=="function"){t(false)}return false}var n=this._checkIfQuestionsWereRestored();e=e||n;if(n&&!this._isAttemptsLeft()){this.set({_attemptsLeft:this.get("_attempts")});this.set({_attemptsSpent:0})}var r=this.get("_assessment")._allowResetIfPassed;if(!this._isAttemptsLeft()&&!e&&!r){if(typeof t=="function")t(false);return false}if(!s){this.once("reset",function(){this._isResetInProgress=false;if(typeof t=="function"){t(true)}});this._isResetInProgress=true;this._setupAssessmentData(e,function(){this.trigger("reset")})}else{this._reloadPage();if(typeof t=="function"){t(true)}}return true},getSaveState:function(){var e=this.getState();var t=[];var i=this.getConfig();var s=i._banks&&i._banks._isEnabled&&i._banks._split.length>1;var n=i._randomisation&&i._randomisation._isEnabled;if(!s&&!n){_.each(this.findDescendantModels("components"),function(e){var i={_id:e.get("_id"),_isCorrect:e.get("_isCorrect")===undefined?null:e.get("_isCorrect")};t.push(i)});t=_.indexBy(t,"_id")}else{t=_.indexBy(e.questions,"_id")}for(var r in t){if(t.hasOwnProperty(r)){t[r]=t[r]._isCorrect}}var o=[e.isComplete?1:0,e.attemptsSpent,e.maxScore,e.score,e.attemptInProgress?1:0,t];return o},setRestoreState:function(t){var i;var s=t[0]==1?true:false;var n=this.get("_attempts");var r=t[1];var o=t[2];var a=t[3];var l=t[4]==1?true:false;var c;var d=t[5];var u={};for(i in d){if(d.hasOwnProperty(i)){var h=e.findById(i).get("_parentId");u[h]=e.findById(h)}}var f=_.values(u);if(d)this.getChildren().models=f;this.set("_isAssessmentComplete",s);this.set("_assessmentCompleteInSession",false);this.set("_attemptsSpent",r);this.set("_attemptInProgress",l);this.set("_attemptsLeft",n==="infinite"?n:n-r);this.set("_maxScore",o||this._getMaxScore());this.set("_score",a||0);if(a){c=Math.round(a/o*100)}else{c=0}this.set("_scoreAsPercent",c);this.set("_lastAttemptScoreAsPercent",c);var p=[];for(i in d){if(d.hasOwnProperty(i)&&e.findById(i).get("_isQuestionType")){p.push({_id:i,_isCorrect:d[i]})}}this.set("_questions",p);if(s)this._checkIsPass();e.trigger("assessments:restored",this.getState(),this)},getState:function(){var e=this.getConfig();var t={id:e._id,type:"article-assessment",pageId:this.getParent().get("_id"),articleId:this.get("_id"),isEnabled:e._isEnabled,isComplete:this.get("_isAssessmentComplete"),isPercentageBased:e._isPercentageBased,scoreToPass:e._scoreToPass,score:this.get("_score"),scoreAsPercent:this.get("_scoreAsPercent"),maxScore:this.get("_maxScore"),isPass:this.get("_isPass"),includeInTotalScore:e._includeInTotalScore,assessmentWeight:e._assessmentWeight,attempts:this.get("_attempts"),attemptsSpent:this.get("_attemptsSpent"),attemptsLeft:this.get("_attemptsLeft"),attemptInProgress:this.get("_attemptInProgress"),lastAttemptScoreAsPercent:this.get("_lastAttemptScoreAsPercent"),questions:this.get("_questions"),allowResetIfPassed:e._allowResetIfPassed,questionModels:new Backbone.Collection(this._currentQuestionComponents)};return t},getConfig:function(){var e=this.get("_assessment");if(!e){e=$.extend(true,{},s)}else{e=$.extend(true,{},s,e)}if(e._id===undefined){e._id="givenId"+i++}this.set("_assessment",e);return e}};return n});define("extensions/adapt-contrib-assessment/js/assessment",["core/js/adapt"],function(e){var t={_postTotalScoreToLms:true,_isPercentageBased:true,_scoreToPass:100,_isDefaultsLoaded:true};e.assessment=_.extend({_assessments:_.extend([],{_byPageId:{},_byAssessmentId:{}}),initialize:function(){this.listenTo(e,"assessments:complete",this._onAssessmentsComplete);this.listenTo(e,"router:location",this._checkResetAssessmentsOnRevisit);this.listenTo(e,"router:plugin",this._handleRoute);this.listenTo(e,"app:dataReady",this._onDataReady)},_onAssessmentsComplete:function(t){var i=t.id;t.isComplete=true;if(i===undefined)return;if(!this._getStateByAssessmentId(i)){e.log.warn("assessments: state was not registered when assessment was created")}this.saveState();this._setPageProgress();this._checkAssessmentsComplete()},_restoreModelState:function(t){if(!this._saveStateModel){this._saveStateModel=e.offlineStorage.get("assessment")}if(this._saveStateModel){var i=t.getState();if(this._saveStateModel[i.id]){t.setRestoreState(this._saveStateModel[i.id])}}},_handleRoute:function(t,i){if(t!=="assessment"&&t!=="article-assessment"||i===undefined){return}if(!e.findById(i)){var s=e.assessment._assessments._byAssessmentId[i];if(s){i=s.get("_id")}else{e.log.warn("Assessment not found with _id: "+i);return}}_.defer(function(){Backbone.history.navigate("#/id/"+i,{trigger:true,replace:true})})},_checkResetAssessmentsOnRevisit:function(t){if(t._contentType!=="page")return;var i=this._getAssessmentByPageId(t._currentId);if(i===undefined)return;e.trigger("plugin:beginWait");for(var s=0,n=i.length;s<n;s++){var r=i[s];r.reset(false,function(){if(s>=n-1)e.trigger("plugin:endWait")})}this._setPageProgress()},_onDataReady:function(){this._assessments=_.extend([],{_byPageId:{},_byAssessmentId:{}})},_checkAssessmentsComplete:function(){var e=true;var t=0;var i=this._getStatesByAssessmentId();var s=[];for(var n in i){var r=i[n];if(!r.includeInTotalScore)continue;if(!r.isComplete){e=false;break}t++;s.push(r)}if(!e||t===0)return false;if(t===1){this._setupSingleAssessmentConfiguration(s[0])}this._postScoreToLms();return true},_setupSingleAssessmentConfiguration:function(t){var i=e.course.get("_assessment");$.extend(true,i,{_postTotalScoreToLms:t.includeInTotalScore,_isPercentageBased:t.isPercentageBased,_scoreToPass:t.scoreToPass});e.course.set("_assessment",i)},_postScoreToLms:function(){var t=this.getConfig();if(t._postTotalScoreToLms===false)return;var i=this.getState();_.defer(function(){e.trigger("assessment:complete",i)})},_getAssessmentByPageId:function(e){return this._assessments._byPageId[e]},_getStateByAssessmentId:function(e){if(e===undefined){return null}return this._assessments._byAssessmentId[e].getState()},_getStatesByAssessmentId:function(){var e={};for(var t=0,i=this._assessments.length;t<i;t++){var s=this._assessments[t];var n=s.getState();e[n.id]=n}return e},_setPageProgress:function(){for(var t in this._assessments._byPageId){var i=this._assessments._byPageId[t];var s=i.length;var n=0;for(var r=0,o=i.length;r<o;r++){var a=i[r].getState();if(a.includeInTotalScore&&!a.isPass)continue;if(a.isComplete){n++}}try{var l=e.findById(t);l.set("_subProgressTotal",s);l.set("_subProgressComplete",n)}catch(c){}}},_addToAssessmentIdMap:function(t,i){if(t===undefined){e.log.warn("An assessment has been registered with an undefined value for '_id'");return}if(t===""){e.log.warn("An assessment has been registered with an empty value for '_id'")}if(!this._assessments._byAssessmentId[t]){this._assessments._byAssessmentId[t]=i}else{e.log.warn("An assessment with an _id of '"+t+"' already exists!")}},register:function(t){var i=t.getState();var s=i.id;var n=i.pageId;if(this._assessments._byPageId[n]===undefined){this._assessments._byPageId[n]=[]}this._assessments._byPageId[n].push(t);this._addToAssessmentIdMap(s,t);this._assessments.push(t);this._restoreModelState(t);e.trigger("assessments:register",i,t);this._setPageProgress()},get:function(e){if(e===undefined){return this._assessments.slice(0)}else{return this._assessments._byAssessmentId[e]}},saveState:function(){this._saveStateModel={};for(var t=0,i;i=this._assessments[t++];){var s=i.getState();this._saveStateModel[s.id]=i.getSaveState()}e.offlineStorage.set("assessment",this._saveStateModel)},getConfig:function(){var i=e.course.get("_assessment");if(i&&i._isDefaultsLoaded){return i}if(i===undefined){i=$.extend(true,{},t)}else{i=$.extend(true,{},t,i)}e.course.set("_assessment",i);return i},getState:function(){var e=this.getConfig();var t=0;var i=0;var s=false;var n=0;var r=this._getStatesByAssessmentId();var o=0;for(var a in r){var l=r[a];if(!l.includeInTotalScore)continue;if(l.isComplete)o++;n++;i+=l.maxScore/l.assessmentWeight;t+=l.score/l.assessmentWeight}var c=o==n;var d=Math.round(t/i*100);if((e._scoreToPass||100)&&c){if(e._isPercentageBased!==false){if(d>=e._scoreToPass)s=true}else{if(t>=e._scoreToPass)s=true}}return{isComplete:c,isPercentageBased:e._isPercentageBased,isPass:s,scoreAsPercent:d,maxScore:i,score:t,assessmentsComplete:o,assessments:n}}},Backbone.Events);e.assessment.initialize()});define("extensions/adapt-contrib-assessment/js/adapt-assessmentArticleExtension",["core/js/adapt","core/js/views/articleView","core/js/models/articleModel","./adapt-assessmentArticleView","./adapt-assessmentArticleModel","./assessment"],function(e,t,i,s,n){var r=t.prototype.initialize;t.prototype.initialize=function(e){if(this.model.get("_assessment")&&this.model.get("_assessment")._isEnabled===true){_.extend(this,s)}return r.apply(this,arguments)};var o=i.prototype.initialize;i.prototype.initialize=function(e){if(this.get("_assessment")&&this.get("_assessment")._isEnabled===true){_.extend(this,n);var t=o.apply(this,arguments);this._postInitialize();return t}return o.apply(this,arguments)}});define("extensions/adapt-contrib-bookmarking/js/adapt-contrib-bookmarking",["core/js/adapt"],function(e){var t=Backbone.Controller.extend({bookmarkLevel:null,watchViewIds:null,watchViews:[],restoredLocationID:null,currentLocationID:null,initialize:function(){this.listenToOnce(e,"router:location",this.onAdaptInitialize)},onAdaptInitialize:function(){if(!this.checkIsEnabled())return;this.setupEventListeners();this.checkRestoreLocation()},checkIsEnabled:function(){var t=e.course.get("_bookmarking");if(!t||!t._isEnabled)return false;if(!e.offlineStorage)return false;return true},setupEventListeners:function(){this._onScroll=_.debounce(_.bind(this.checkLocation,this),1e3);this.listenTo(e,"menuView:ready",this.setupMenu);this.listenTo(e,"pageView:preRender",this.setupPage)},checkRestoreLocation:function(){this.restoredLocationID=e.offlineStorage.get("location");if(!this.restoredLocationID||this.restoredLocationID==="undefined")return;this.listenToOnce(e,"pageView:ready menuView:ready",this.restoreLocation)},restoreLocation:function(){_.defer(_.bind(function(){this.stopListening(e,"pageView:ready menuView:ready",this.restoreLocation);if(this.restoredLocationID==e.location._currentId)return;try{var t=e.findById(this.restoredLocationID)}catch(i){return}if(!t)return;var s=$("."+this.restoredLocationID).onscreen();var n=s&&s.percentInview>0;var r=s&&s.percentInview===100;if(n&&r)return;if(e.course.get("_bookmarking")._showPrompt===false){this.navigateToPrevious()}else{this.showPrompt()}},this))},showPrompt:function(){var t=e.course.get("_bookmarking");if(!t._buttons){t._buttons={yes:"Yes",no:"No"}}if(!t._buttons.yes)t._buttons.yes="Yes";if(!t._buttons.no)t._buttons.no="No";this.listenToOnce(e,"bookmarking:continue",this.navigateToPrevious);this.listenToOnce(e,"bookmarking:cancel",this.navigateCancel);var i={title:t.title,body:t.body,_prompts:[{promptText:t._buttons.yes,_callbackEvent:"bookmarking:continue"},{promptText:t._buttons.no,_callbackEvent:"bookmarking:cancel"}],_showIcon:true};if(e.config.get("_accessibility")&&e.config.get("_accessibility")._isActive){$(".loading").show();$("#a11y-focuser").focus();$("body").attr("aria-hidden",true);_.delay(function(){$(".loading").hide();$("body").removeAttr("aria-hidden");e.trigger("notify:prompt",i)},3e3)}else{e.trigger("notify:prompt",i)}},navigateToPrevious:function(){_.defer(_.bind(function(){var t=e.contentObjects.models.length==1;Backbone.history.navigate("#/id/"+this.restoredLocationID,{trigger:true,replace:t})},this));this.stopListening(e,"bookmarking:cancel")},navigateCancel:function(){this.stopListening(e,"bookmarking:continue")},resetLocationID:function(){this.setLocationID("")},setupMenu:function(e){var t=e.model;if(t.get("_parentId"))return this.setLocationID(t.get("_id"));else this.resetLocationID()},setupPage:function(t){var i=t.model.has("_bookmarking");var s=i?t.model.get("_bookmarking"):e.course.get("_bookmarking");this.bookmarkLevel=s._level;if(!s._isEnabled){this.resetLocationID();return}else{this.setLocationID(t.model.get("_id"));this.watchViewIds=_.map(t.model.findDescendantModels(this.bookmarkLevel+"s"),function(e){return e.get("_id")});this.listenTo(e,this.bookmarkLevel+"View:postRender",this.captureViews);this.listenToOnce(e,"remove",this.releaseViews);$(window).on("scroll",this._onScroll)}},captureViews:function(e){this.watchViews.push(e)},setLocationID:function(t){if(!e.offlineStorage)return;if(this.currentLocationID==t)return;e.offlineStorage.set("location",t);this.currentLocationID=t},releaseViews:function(){this.watchViews.length=0;this.watchViewIds.length=0;this.stopListening(e,"remove",this.releaseViews);this.stopListening(e,this.bookmarkLevel+"View:postRender",this.captureViews);$(window).off("scroll",this._onScroll)},checkLocation:function(){var e=0;var t="";var i=[];for(var s=0,n=this.watchViews.length;s<n;s++){var r=this.watchViews[s];var o=_.indexOf(this.watchViewIds,r.model.get("_id"))>-1;if(!o)continue;var a=$("."+r.model.get("_id"));var l=a.onscreen();if(!l.onscreen)continue;if(l.percentInview>e){e=l.percentInview;t=r.model.get("_id")}}if(t)this.setLocationID(t)}});return new t});define("extensions/adapt-contrib-languagePicker/js/accessibilityView",["core/js/adapt"],function(e){var t=Backbone.View.extend({el:"#accessibility-toggle",events:{click:"toggleAccessibility"},initialize:function(){this.setupUsageInstructions();if(e.offlineStorage.ready){this.onOfflineStorageReady()}else{e.once("offlineStorage:ready",_.bind(this.onOfflineStorageReady,this))}},onOfflineStorageReady:function(){e.config.get("_accessibility")._isActive=e.offlineStorage.get("a11y")||false;this.configureAccessibility();this.render()},render:function(){var t=e.config.has("_accessibility")&&e.config.get("_accessibility")._isEnabled;if(!t){return}else{var i=e.config.get("_accessibility")._isActive;var s=this.model.get("_accessibility")&&this.model.get("_accessibility").accessibilityToggleTextOff;var n=this.model.get("_accessibility")&&this.model.get("_accessibility").accessibilityToggleTextOn;var r=i?s:n;this.$el.attr("aria-label",$.a11y_normalize(r));if(i){$("html").addClass("accessibility");$("#accessibility-instructions").a11y_focus()}else{$("html").removeClass("accessibility")}}},toggleAccessibility:function(t){if(t)t.preventDefault();var i=e.config.get("_accessibility")._isActive;var s=i?false:true;e.config.get("_accessibility")._isActive=s;this.configureAccessibility();this.setupUsageInstructions();this.render();this.trigger("accessibility:toggle")},configureAccessibility:function(){var t=e.config.get("_accessibility")._isActive;if(!Modernizr.touch&&e.offlineStorage.get("a11y")!==t){e.offlineStorage.set("a11y",t)}if(t){_.extend($.a11y.options,{isTabbableTextEnabled:true,isUserInputControlEnabled:true,isFocusControlEnabled:true,isFocusLimited:true,isRemoveNotAccessiblesEnabled:true,isAriaLabelFixEnabled:true,isFocusWrapEnabled:true,isScrollDisableEnabled:true,isScrollDisabledOnPopupEnabled:false,isSelectedAlertsEnabled:true,isAlertsEnabled:true})}else{_.extend($.a11y.options,{isTabbableTextEnabled:false,isUserInputControlEnabled:true,isFocusControlEnabled:true,isFocusLimited:false,isRemoveNotAccessiblesEnabled:true,isAriaLabelFixEnabled:true,isFocusWrapEnabled:true,isScrollDisableEnabled:true,isScrollDisabledOnPopupEnabled:false,isSelectedAlertsEnabled:false,isAlertsEnabled:false})}$.a11y.ready()},setupUsageInstructions:function(){if(!this.model.get("_accessibility")||!this.model.get("_accessibility")._accessibilityInstructions){$("#accessibility-instructions").remove();return}var t=this.model.get("_accessibility")._accessibilityInstructions;var i;if(t[e.device.browser]){i=t[e.device.browser]}else if(Modernizr.touch){i=t.touch||""}else{i=t.notouch||""}$("#accessibility-instructions").html(i)}});return t});define("extensions/adapt-contrib-languagePicker/js/languagePickerNavigationView",["core/js/adapt","./accessibilityView"],function(e,t){var i=Backbone.View.extend({className:"navigation",initialize:function(){this.listenToOnce(e,"accessibility:toggle",this.onA11yToggle);this.template="languagePickerNavigation";this.setupHelpers();this.preRender()},preRender:function(){e.trigger("navigationView:preRender",this);this.render()},render:function(){var t=Handlebars.templates[this.template];this.$el.html(t({_config:this.model.get("_accessibility"),_accessibility:e.config.get("_accessibility")})).insertBefore("#wrapper");_.defer(_.bind(function(){e.trigger("navigationView:postRender",this)},this));this.setupA11yButton();if(e.accessibility.isActive()){this.setupUsageInstructions()}return this},setupHelpers:function(){var t=e.config.get("_accessibility");Handlebars.registerHelper("a11y_text",function(e){if(t&&t._isTextProcessorEnabled===false){return e}else{return $.a11y_text(e)}});Handlebars.registerHelper("a11y_aria_label",function(e){return'<div class="aria-label prevent-default" tabindex="0" role="region">'+e+"</div>"})},setupA11yButton:function(){new t({model:this.model})},setupUsageInstructions:function(){var t=this.model.get("_accessibility");if(!t||!t._accessibilityInstructions){this.$("#accessibility-instructions").remove();return}var i=t._accessibilityInstructions;var s;if(i[e.device.browser]){s=i[e.device.browser]}else if(Modernizr.touch){s=i.touch||""}else{s=i.notouch||""}this.$("#accessibility-instructions").html(s)},onA11yToggle:function(){if(e.accessibility.isActive()){this.setupUsageInstructions()}}});return i});define("extensions/adapt-contrib-languagePicker/js/languagePickerView",["core/js/adapt","./languagePickerNavigationView"],function(e,t){var i=Backbone.View.extend({events:{"click .languagepicker-languages button":"onLanguageClick"},className:"languagepicker",initialize:function(){this.initializeAccessibility();$("html").addClass("in-languagepicker");this.listenTo(e,"remove",this.remove);this.render()},render:function(){var e=this.model.toJSON();var t=Handlebars.templates[this.constructor.template];this.$el.html(t(e));this.$el.addClass(e._classes);document.title=this.model.get("title")||"";_.defer(_.bind(function(){this.postRender()},this))},postRender:function(){$(".loading").hide()},onLanguageClick:function(e){this.destroyAccessibility();this.model.setLanguage($(e.target).val())},initializeAccessibility:function(){this.navigationView=new t({model:this.model});this.listenTo(e,"accessibility:toggle",this.render)},destroyAccessibility:function(){this.navigationView.remove()},remove:function(){$("html").removeClass("in-languagepicker");Backbone.View.prototype.remove.apply(this,arguments)}},{template:"languagePickerView"});return i});define("extensions/adapt-contrib-languagePicker/js/languagePickerDrawerView",["core/js/adapt","backbone"],function(e,t){var i=t.View.extend({events:{"click button":"onButtonClick"},initialize:function(){this.listenTo(e,"remove",this.remove);this.listenTo(e,"languagepicker:changelanguage:yes",this.onDoChangeLanguage);this.listenTo(e,"languagepicker:changelanguage:no",this.onDontChangeLanguage);this.render()},render:function(){var e=this.model.toJSON();var t=Handlebars.templates[this.constructor.template];this.$el.html(t(e))},onButtonClick:function(t){var i=$(t.target).attr("data-language");this.model.set("newLanguage",i);var s=this.model.getLanguageDetails(i);var n={_classes:"dir-ltr",title:s.warningTitle,body:s.warningMessage,_prompts:[{promptText:s._buttons.yes,_callbackEvent:"languagepicker:changelanguage:yes"},{promptText:s._buttons.no,_callbackEvent:"languagepicker:changelanguage:no"}],_showIcon:true};if(s._direction==="rtl"){n._classes="dir-rtl"}this.$finishFocus=$.a11y.state.focusStack.pop();$.a11y.state.focusStack.push($("#focuser"));e.once("drawer:closed",function(){_.delay(function(){e.once("popup:opened",function(){$.a11y.state.focusStack.pop();$.a11y.state.focusStack.push($("#focuser"))});e.trigger("notify:prompt",n)},250)});e.trigger("drawer:closeDrawer")},onDoChangeLanguage:function(){var e=this.model.get("newLanguage");this.model.setLanguage(e);this.remove()},onDontChangeLanguage:function(){this.remove();_.delay(_.bind(function(){this.$finishFocus.a11y_focus()},this),500)}},{template:"languagePickerDrawerView"});return i});define("extensions/adapt-contrib-languagePicker/js/languagePickerNavView",["core/js/adapt","backbone","./languagePickerDrawerView"],function(e,t,i){var s=t.View.extend({tagName:"button",className:function(){var e="languagepicker-icon base icon";var t=this.model.get("_languagePickerIconClass")||"icon-language-2";
return e+" "+t},events:{click:"onClick"},initialize:function(){this.listenTo(e,"remove",this.remove)},onClick:function(t){e.drawer.triggerCustomView(new i({model:this.model}).$el,false)}});return s});define("extensions/adapt-contrib-languagePicker/js/languagePickerModel",["core/js/adapt","backbone"],function(e,t){var i=t.Model.extend({defaults:{_isEnabled:false,displayTitle:"",body:"",_languages:[]},initialize:function(){this.listenTo(e.config,"change:_activeLanguage",this.onConfigChange)},getLanguageDetails:function(e){var t=this.get("_languages");return _.find(t,function(t){return t._language==e})},setLanguage:function(t){e.config.set({_activeLanguage:t,_defaultDirection:this.getLanguageDetails(t)._direction})},onConfigChange:function(e,t,i){this.markLanguageAsSelected(t)},markLanguageAsSelected:function(e){var t=this.get("_languages");for(var i=0;i<t.length;i++){if(t[i]._language===e){t[i]._isSelected=true}else{t[i]._isSelected=false}}this.set("_languages",t)}});return i});define("extensions/adapt-contrib-languagePicker/js/adapt-languagePicker",["core/js/adapt","backbone","./languagePickerView","./languagePickerNavView","./languagePickerModel"],function(e,t,i,s,n){var r;e.once("configModel:dataLoaded",o);function o(){if(!e.config.has("_languagePicker"))return;if(!e.config.get("_languagePicker")._isEnabled)return;e.config.set("_canLoadData",false);r=new n(e.config.get("_languagePicker"));e.on("router:page",c);e.on("router:menu",c);if(e.offlineStorage.ready){a()}else{e.once("offlineStorage:ready",a)}}function a(){var t=e.offlineStorage.get("lang");if(t){r.setLanguage(t)}else if(r.get("_showOnCourseLoad")===false){r.setLanguage(e.config.get("_defaultLanguage"))}else{l()}}function l(){var e=new i({model:r});e.$el.appendTo("#wrapper")}function c(){var t=e.course.get("_globals")._extensions;var i="";if(t._languagePicker){i=t._languagePicker.navigationBarLabel}var n=new s({model:r,attributes:{"aria-label":i}});n.$el.appendTo(".navigation-inner")}});define("extensions/adapt-contrib-pageLevelProgress/js/completionCalculations",["coreJS/adapt"],function(e){function t(a){var c=a.get("_type"),d=0,u=0,h=0,f=0,p=0,m=0,g=a.get("_isComplete")?1:0;if(c=="page"){var v=_.filter(a.findDescendantModels("components"),function(e){return e.get("_isAvailable")===true&&e.get("_isOptional")===false});var b=l(v);var w=o(b);var y=i(w);d=y.length|0,u=n(y).length;var C=s(w);h=C.length|0,f=r(C).length;p=a.get("_subProgressComplete")||0;m=a.get("_subProgressTotal")||0;var k={subProgressCompleted:p,subProgressTotal:m,nonAssessmentCompleted:u,nonAssessmentTotal:d,assessmentCompleted:f,assessmentTotal:h};if(a.get("_pageLevelProgress")&&a.get("_pageLevelProgress")._showPageCompletion!==false&&e.course.get("_pageLevelProgress")&&e.course.get("_pageLevelProgress")._showPageCompletion!==false){k.nonAssessmentCompleted+=g;k.nonAssessmentTotal+=1}return k}else if(c=="menu"){_.each(a.get("_children").models,function(e){var i=t(e);p+=a.subProgressCompleted||0;m+=a.subProgressTotal||0;d+=i.nonAssessmentTotal;u+=i.nonAssessmentCompleted;h+=i.assessmentTotal;f+=i.assessmentCompleted});return{subProgressCompleted:p,subProgressTotal:m,nonAssessmentCompleted:u,nonAssessmentTotal:d,assessmentCompleted:f,assessmentTotal:h}}}function i(e){return _.filter(e,function(e){return!e.get("_isPartOfAssessment")})}function s(e){return _.filter(e,function(e){return e.get("_isPartOfAssessment")})}function n(e){return _.filter(e,function(e){return e.get("_isComplete")})}function r(e){return _.filter(e,function(e){return e.get("_isComplete")})}function o(e){return _.filter(e,function(e){if(e.get("_pageLevelProgress")){return e.get("_pageLevelProgress")._isEnabled}})}function a(e){if(e.length>0){var t=_.map(e,function(e){return e.get("_isAvailable")});return _.indexOf(t,false)>-1}else{return}}function l(e){var t=[];for(var i=0;i<e.length;i++){var s=e[i].getAncestorModels();if(!a(s)){t.push(e[i])}}return t}return{calculateCompletion:t,getPageLevelProgressEnabledModels:o,filterAvailableChildren:l}});define("extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressMenuView",["require","coreJS/adapt","backbone"],function(e){var t=e("coreJS/adapt");var i=e("backbone");var s=i.View.extend({className:"page-level-progress-menu-item",initialize:function(){this.listenTo(t,"remove",this.remove);this.ariaText="";if(t.course.get("_globals")._extensions&&t.course.get("_globals")._extensions._pageLevelProgress&&t.course.get("_globals")._extensions._pageLevelProgress.pageLevelProgressMenuBar){this.ariaText=t.course.get("_globals")._extensions._pageLevelProgress.pageLevelProgressMenuBar+" "}this.render();_.defer(_.bind(function(){this.updateProgressBar()},this))},events:{},render:function(){var e=this.model.toJSON();_.extend(e,{_globals:t.course.get("_globals")});var i=Handlebars.templates["pageLevelProgressMenu"];this.$el.html(i(e));return this},updateProgressBar:function(){if(this.model.get("completedChildrenAsPercentage")){var e=this.model.get("completedChildrenAsPercentage")}else{var e=0}this.$(".page-level-progress-menu-item-indicator-bar .aria-label").html(this.ariaText+Math.floor(e)+"%")}});return s});define("extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressView",["require","coreJS/adapt","backbone"],function(e){var t=e("coreJS/adapt");var i=e("backbone");var s=i.View.extend({className:"page-level-progress",initialize:function(){this.listenTo(t,"remove",this.remove);this.render()},events:{"click .page-level-progress-item button":"scrollToPageElement"},scrollToPageElement:function(e){if(e&&e.preventDefault)e.preventDefault();var i="."+$(e.currentTarget).attr("data-page-level-progress-id");var s=$(i);t.once("drawer:closed",function(){t.scrollTo(s,{duration:400})});t.trigger("drawer:closeDrawer")},render:function(){var e=this.collection.toJSON();var i={components:e,_globals:t.course.get("_globals")};var s=Handlebars.templates["pageLevelProgress"];this.$el.html(s(i));this.$el.a11y_aria_label(true);return this}});return s});define("extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressNavigationView",["require","coreJS/adapt","backbone","./completionCalculations","extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressView"],function(e){var t=e("coreJS/adapt");var i=e("backbone");var s=e("./completionCalculations");var n=e("extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressView");var r=i.View.extend({tagName:"button",className:"base page-level-progress-navigation",initialize:function(){this.listenTo(t,"remove",this.remove);this.listenTo(t,"router:location",this.updateProgressBar);this.listenTo(t,"pageLevelProgress:update",this.refreshProgressBar);this.listenTo(this.collection,"change:_isComplete",this.updateProgressBar);this.listenTo(this.model,"change:_isComplete",this.updateProgressBar);this.$el.attr("role","button");this.ariaText="";if(t.course.has("_globals")&&t.course.get("_globals")._extensions&&t.course.get("_globals")._extensions._pageLevelProgress&&t.course.get("_globals")._extensions._pageLevelProgress.pageLevelProgressIndicatorBar){this.ariaText=t.course.get("_globals")._extensions._pageLevelProgress.pageLevelProgressIndicatorBar+" "}this.render();_.defer(_.bind(function(){this.updateProgressBar()},this))},events:{click:"onProgressClicked"},render:function(){var e=this.collection.toJSON();var i={components:e,_globals:t.course.get("_globals")};var s=Handlebars.templates["pageLevelProgressNavigation"];$(".navigation-drawer-toggle-button").before(this.$el.html(s(i)));return this},refreshProgressBar:function(){var e=_.filter(this.model.findDescendantModels("components"),function(e){return e.get("_isAvailable")===true});var t=s.filterAvailableChildren(e);var i=s.getPageLevelProgressEnabledModels(t);this.collection.reset(i);this.updateProgressBar()},updateProgressBar:function(){var e=s.calculateCompletion(this.model);var t=e.nonAssessmentCompleted+e.assessmentCompleted+e.subProgressCompleted;var i=e.nonAssessmentTotal+e.assessmentTotal+e.subProgressTotal;var n=Math.floor(t/i*100);this.$(".page-level-progress-navigation-bar").css("width",n+"%");this.$el.attr("aria-label",this.ariaText+n+"%");this.model.set("completedChildrenAsPercentage",n)},onProgressClicked:function(e){if(e&&e.preventDefault)e.preventDefault();t.drawer.triggerCustomView(new n({collection:this.collection}).$el,false)}});return r});define("extensions/adapt-contrib-pageLevelProgress/js/adapt-contrib-pageLevelProgress",["require","coreJS/adapt","backbone","./completionCalculations","extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressMenuView","extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressNavigationView"],function(e){var t=e("coreJS/adapt");var i=e("backbone");var s=e("./completionCalculations");var n=e("extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressMenuView");var r=e("extensions/adapt-contrib-pageLevelProgress/js/PageLevelProgressNavigationView");function o(e,t){new r({model:e,collection:new i.Collection(t)})}t.on("menuView:postRender",function(e){if(e.model.get("_id")==t.location._currentId)return;var i=t.course.get("_pageLevelProgress");if(!i||!i._isEnabled){return}var r=e.model.get("_pageLevelProgress");var o=e.model.get("_type");if(o=="course")return;if(r&&r._isEnabled){var a=s.calculateCompletion(e.model);var l=a.nonAssessmentCompleted+a.subProgressCompleted;var c=a.nonAssessmentTotal+a.subProgressTotal;var d=Math.floor(l/c*100);e.model.set("completedChildrenAsPercentage",d);e.$el.find(".menu-item-inner").append(new n({model:e.model}).$el)}});t.on("router:page",function(e){var i=t.course.get("_pageLevelProgress");var n=e.get("_pageLevelProgress");if(!i||!i._isEnabled||!n||!n._isEnabled){return}var r=_.filter(e.findDescendantModels("components"),function(e){return e.get("_isAvailable")===true});var a=s.filterAvailableChildren(r);var l=s.getPageLevelProgressEnabledModels(a);if(l.length>0){o(e,l)}})});define("extensions/adapt-contrib-resources/js/adapt-contrib-resourcesView",["core/js/adapt"],function(e){var t=Backbone.View.extend({className:"resources",initialize:function(){this.listenTo(e,"remove",this.remove);this.render()},events:{"click .resources-filter button":"onFilterClicked","click .resources-item-container button":"onResourceClicked"},render:function(){var t=this.collection.toJSON();var i=this.model.toJSON();var s=Handlebars.templates["resources"];this.$el.html(s({model:i,resources:t,_globals:e.course.get("_globals")}));_.defer(_.bind(this.postRender,this));return this},postRender:function(){this.listenTo(e,"drawer:triggerCustomView",this.remove)},onFilterClicked:function(e){e.preventDefault();var t=$(e.currentTarget);this.$(".resources-filter button").removeClass("selected");var i=t.addClass("selected").attr("data-filter");var s=[];if(i==="all"){s=this.$(".resources-item").removeClass("display-none")}else{this.$(".resources-item").removeClass("display-none").not("."+i).addClass("display-none");s=this.$(".resources-item."+i)}if(s.length===0)return;$(s[0]).a11y_focus()},onResourceClicked:function(t){var i=$(t.currentTarget).data();if(!i.forceDownload||e.device.OS==="ios"){window.top.open(i.href);return}var s=document.createElement("a");if(e.device.browser==="internet explorer"){s.target="_blank"}else{s.download=i.filename}s.href=i.href;document.body.appendChild(s);s.click();document.body.removeChild(s);delete s}});return t});define("extensions/adapt-contrib-resources/js/adapt-contrib-resourcesHelpers",["require","handlebars"],function(e){var t=e("handlebars");t.registerHelper("if_collection_contains",function(e,t,i,s){var n=false;_.each(e,function(e){if(e[t]===i){n=true}});if(n){return s.fn(this)}else{return s.inverse()}});t.registerHelper("if_collection_contains_only_one_item",function(e,t,i){var s=[];_.each(e,function(e){var i=e[t];if(_.indexOf(s,i)===-1){s.push(i)}});if(s.length<=1){return i.fn(this)}else{return i.inverse(this)}});t.registerHelper("return_column_layout_from_collection_length",function(e,t){var i=[];_.each(e,function(e){var s=e[t];if(_.indexOf(i,s)===-1){i.push(s)}});return i.length+1})});define("extensions/adapt-contrib-resources/js/adapt-contrib-resources",["backbone","core/js/adapt","./adapt-contrib-resourcesView","./adapt-contrib-resourcesHelpers"],function(e,t,i,s){function n(s){var n=new e.Model(s);var r=new e.Collection(n.get("_resourcesItems"));t.on("resources:showResources",function(){t.drawer.triggerCustomView(new i({model:n,collection:r}).$el)})}function r(){var e=t.course.get("_resources");if(!e||e._isEnabled===false)return;var i={title:e.title,description:e.description,className:"resources-drawer",drawerOrder:e._drawerOrder||0};t.drawer.addItem(i,"resources:showResources");n(e)}t.on("adapt:start",r)});var pipwerks={};pipwerks.UTILS={};pipwerks.debug={isActive:true};pipwerks.SCORM={version:null,handleCompletionStatus:true,handleExitMode:true,API:{handle:null,isFound:false},connection:{isActive:false},data:{completionStatus:null,exitStatus:null},debug:{}};pipwerks.SCORM.isAvailable=function(){return true};pipwerks.SCORM.API.find=function(e){var t=null,i=0,s=500,n="SCORM.API.find",r=pipwerks.UTILS.trace,o=pipwerks.SCORM;while(!e.API&&!e.API_1484_11&&e.parent&&e.parent!=e&&i<=s){i++;e=e.parent}if(o.version){switch(o.version){case"2004":if(e.API_1484_11){t=e.API_1484_11}else{r(n+": SCORM version 2004 was specified by user, but API_1484_11 cannot be found.")}break;case"1.2":if(e.API){t=e.API}else{r(n+": SCORM version 1.2 was specified by user, but API cannot be found.")}break}}else{if(e.API_1484_11){o.version="2004";t=e.API_1484_11}else if(e.API){o.version="1.2";t=e.API}}if(t){r(n+": API found. Version: "+o.version);r("API: "+t)}else{r(n+": Error finding API. \nFind attempts: "+i+". \nFind attempt limit: "+s)}return t};pipwerks.SCORM.API.get=function(){var e=null,t=window,i=pipwerks.SCORM,s=i.API.find,n=pipwerks.UTILS.trace;e=s(t);if(!e&&t.parent&&t.parent!=t){e=s(t.parent)}if(!e&&t.top&&t.top.opener){e=s(t.top.opener)}if(!e&&t.top&&t.top.opener&&t.top.opener.document){e=s(t.top.opener.document)}if(e){i.API.isFound=true}else{n("API.get failed: Can't find the API!")}return e};pipwerks.SCORM.API.getHandle=function(){var e=pipwerks.SCORM.API;if(!e.handle&&!e.isFound){e.handle=e.get()}return e.handle};pipwerks.SCORM.connection.initialize=function(){var e=false,t=pipwerks.SCORM,i=t.data.completionStatus,s=pipwerks.UTILS.trace,n=pipwerks.UTILS.StringToBoolean,r=t.debug,o="SCORM.connection.initialize ";s("connection.initialize called.");if(!t.connection.isActive){var a=t.API.getHandle(),l=0;if(a){switch(t.version){case"1.2":e=n(a.LMSInitialize(""));break;case"2004":e=n(a.Initialize(""));break}if(e){l=r.getCode();if(l!==null&&l===0){t.connection.isActive=true;if(t.handleCompletionStatus){i=t.status("get");if(i){switch(i){case"not attempted":t.status("set","incomplete");break;case"unknown":t.status("set","incomplete");break}t.save()}}}else{e=false;s(o+"failed. \nError code: "+l+" \nError info: "+r.getInfo(l))}}else{l=r.getCode();if(l!==null&&l!==0){s(o+"failed. \nError code: "+l+" \nError info: "+r.getInfo(l))}else{s(o+"failed: No response from server.")}}}else{s(o+"failed: API is null.")}}else{s(o+"aborted: Connection already active.")}return e};pipwerks.SCORM.connection.terminate=function(){var e=false,t=pipwerks.SCORM,i=t.data.exitStatus,s=t.data.completionStatus,n=pipwerks.UTILS.trace,r=pipwerks.UTILS.StringToBoolean,o=t.debug,a="SCORM.connection.terminate ";if(t.connection.isActive){var l=t.API.getHandle(),c=0;if(l){if(t.handleExitMode&&!i){if(s!=="completed"&&s!=="passed"){switch(t.version){case"1.2":e=t.set("cmi.core.exit","suspend");break;case"2004":e=t.set("cmi.exit","suspend");break}}else{switch(t.version){case"1.2":e=t.set("cmi.core.exit","logout");break;case"2004":e=t.set("cmi.exit","normal");break}}}e=t.save();if(e){switch(t.version){case"1.2":e=r(l.LMSFinish(""));break;case"2004":e=r(l.Terminate(""));break}if(e){t.connection.isActive=false}else{c=o.getCode();n(a+"failed. \nError code: "+c+" \nError info: "+o.getInfo(c))}}}else{n(a+"failed: API is null.")}}else{n(a+"aborted: Connection already terminated.")}return e};pipwerks.SCORM.data.get=function(e){var t=null,i=pipwerks.SCORM,s=pipwerks.UTILS.trace,n=i.debug,r="SCORM.data.get('"+e+"') ";if(i.connection.isActive){var o=i.API.getHandle(),a=0;if(o){switch(i.version){case"1.2":t=o.LMSGetValue(e);break;case"2004":t=o.GetValue(e);break}a=n.getCode();if(t!==""||a===0){switch(e){case"cmi.core.lesson_status":case"cmi.completion_status":i.data.completionStatus=t;break;case"cmi.core.exit":case"cmi.exit":i.data.exitStatus=t;break}}else{s(r+"failed. \nError code: "+a+"\nError info: "+n.getInfo(a))}}else{s(r+"failed: API is null.")}}else{s(r+"failed: API connection is inactive.")}s(r+" value: "+t);return String(t)};pipwerks.SCORM.data.set=function(e,t){var i=false,s=pipwerks.SCORM,n=pipwerks.UTILS.trace,r=pipwerks.UTILS.StringToBoolean,o=s.debug,a="SCORM.data.set('"+e+"') ";if(s.connection.isActive){var l=s.API.getHandle(),c=0;if(l){switch(s.version){case"1.2":i=r(l.LMSSetValue(e,t));break;case"2004":i=r(l.SetValue(e,t));break}if(i){if(e==="cmi.core.lesson_status"||e==="cmi.completion_status"){s.data.completionStatus=t}}else{c=o.getCode();n(a+"failed. \nError code: "+c+". \nError info: "+o.getInfo(c))}}else{n(a+"failed: API is null.")}}else{n(a+"failed: API connection is inactive.")}n(a+" value: "+t);return i};pipwerks.SCORM.data.save=function(){var e=false,t=pipwerks.SCORM,i=pipwerks.UTILS.trace,s=pipwerks.UTILS.StringToBoolean,n="SCORM.data.save failed";if(t.connection.isActive){var r=t.API.getHandle();if(r){switch(t.version){case"1.2":e=s(r.LMSCommit(""));break;case"2004":e=s(r.Commit(""));break}}else{i(n+": API is null.")}}else{i(n+": API connection is inactive.")}return e};pipwerks.SCORM.status=function(e,t){var i=false,s=pipwerks.SCORM,n=pipwerks.UTILS.trace,r="SCORM.getStatus failed",o="";if(e!==null){switch(s.version){case"1.2":o="cmi.core.lesson_status";break;case"2004":o="cmi.completion_status";break}switch(e){case"get":i=s.data.get(o);break;case"set":if(t!==null){i=s.data.set(o,t)}else{i=false;n(r+": status was not specified.")}break;default:i=false;n(r+": no valid action was specified.")}}else{n(r+": action was not specified.")}return i};pipwerks.SCORM.debug.getCode=function(){var e=pipwerks.SCORM,t=e.API.getHandle(),i=pipwerks.UTILS.trace,s=0;if(t){switch(e.version){case"1.2":s=parseInt(t.LMSGetLastError(),10);break;case"2004":s=parseInt(t.GetLastError(),10);break}}else{i("SCORM.debug.getCode failed: API is null.")}return s};pipwerks.SCORM.debug.getInfo=function(e){var t=pipwerks.SCORM,i=t.API.getHandle(),s=pipwerks.UTILS.trace,n="";if(i){switch(t.version){case"1.2":n=i.LMSGetErrorString(e.toString());break;case"2004":n=i.GetErrorString(e.toString());break}}else{s("SCORM.debug.getInfo failed: API is null.")}return String(n)};pipwerks.SCORM.debug.getDiagnosticInfo=function(e){var t=pipwerks.SCORM,i=t.API.getHandle(),s=pipwerks.UTILS.trace,n="";if(i){switch(t.version){case"1.2":n=i.LMSGetDiagnostic(e);break;case"2004":n=i.GetDiagnostic(e);break}}else{s("SCORM.debug.getDiagnosticInfo failed: API is null.")}return String(n)};pipwerks.SCORM.init=pipwerks.SCORM.connection.initialize;pipwerks.SCORM.get=pipwerks.SCORM.data.get;pipwerks.SCORM.set=pipwerks.SCORM.data.set;pipwerks.SCORM.save=pipwerks.SCORM.data.save;pipwerks.SCORM.quit=pipwerks.SCORM.connection.terminate;pipwerks.UTILS.StringToBoolean=function(e){var t=typeof e;switch(t){case"object":case"string":return/(true|1)/i.test(e);case"number":return!!e;case"boolean":return e;case"undefined":return null;default:return false}};pipwerks.UTILS.trace=function(e){if(pipwerks.debug.isActive){if(window.console&&window.console.log){window.console.log(e)}else{}}};define("extensions/adapt-contrib-spoor/js/scorm/API",function(){});define("extensions/adapt-contrib-spoor/js/scorm/wrapper",["require"],function(e){var t=function(){this.setCompletedWhenFailed=true;this.commitOnStatusChange=true;this.timedCommitFrequency=10;this.maxCommitRetries=5;this.commitRetryDelay=1e3;this.commitRetryPending=false;this.commitRetries=0;this.lastCommitSuccessTime=null;this.timedCommitIntervalID=null;this.retryCommitTimeoutID=null;this.logOutputWin=null;this.startTime=null;this.endTime=null;this.lmsConnected=false;this.finishCalled=false;this.logger=Logger.getInstance();this.scorm=pipwerks.SCORM;this.suppressErrors=false;if(window.__debug)this.showDebugWindow();if(window.API&&window.API.__offlineAPIWrapper||window.API_1484_11&&window.API_1484_11.__offlineAPIWrapper)this.logger.error("Offline SCORM API is being used. No data will be reported to the LMS!")};t.instance=null;t.getInstance=function(){if(t.instance===null)t.instance=new t;return t.instance};t.prototype.getVersion=function(){return this.scorm.version};t.prototype.setVersion=function(e){this.logger.debug("ScormWrapper::setVersion: "+e);this.scorm.version=e;this.scorm.handleExitMode=this.isSCORM2004()};t.prototype.initialize=function(){this.logger.debug("ScormWrapper::initialize");this.lmsConnected=this.scorm.init();if(this.lmsConnected){this.startTime=new Date;this.initTimedCommit()}else{this.handleError("Course could not connect to the LMS")}return this.lmsConnected};t.prototype.isFirstSession=function(){return this.getValue(this.isSCORM2004()?"cmi.entry":"cmi.core.entry")==="ab-initio"};t.prototype.setIncomplete=function(){this.setValue(this.isSCORM2004()?"cmi.completion_status":"cmi.core.lesson_status","incomplete");if(this.commitOnStatusChange)this.commit()};t.prototype.setCompleted=function(){this.setValue(this.isSCORM2004()?"cmi.completion_status":"cmi.core.lesson_status","completed");if(this.commitOnStatusChange)this.commit()};t.prototype.setPassed=function(){if(this.isSCORM2004()){this.setValue("cmi.completion_status","completed");this.setValue("cmi.success_status","passed")}else{this.setValue("cmi.core.lesson_status","passed")}if(this.commitOnStatusChange)this.commit()};t.prototype.setFailed=function(){if(this.isSCORM2004()){this.setValue("cmi.success_status","failed");if(this.setCompletedWhenFailed){this.setValue("cmi.completion_status","completed")}}else{this.setValue("cmi.core.lesson_status","failed")}if(this.commitOnStatusChange)this.commit()};t.prototype.getStatus=function(){var e=this.getValue(this.isSCORM2004()?"cmi.completion_status":"cmi.core.lesson_status");switch(e.toLowerCase()){case"passed":case"completed":case"incomplete":case"failed":case"browsed":case"not attempted":case"not_attempted":case"unknown":return e;default:this.handleError("ScormWrapper::getStatus: invalid lesson status '"+e+"' received from LMS");return null}};t.prototype.setStatus=function(e){switch(e.toLowerCase()){case"incomplete":this.setIncomplete();break;case"completed":this.setCompleted();break;case"passed":this.setPassed();break;case"failed":this.setFailed();break;default:this.handleError("ScormWrapper::setStatus: the status '"+e+"' is not supported.")}};t.prototype.getScore=function(){return this.getValue(this.isSCORM2004()?"cmi.score.raw":"cmi.core.score.raw")};t.prototype.setScore=function(e,t,i){if(this.isSCORM2004()){this.setValue("cmi.score.raw",e);this.setValue("cmi.score.min",t);this.setValue("cmi.score.max",i);var s=i-t;var n=((e-t)/s).toFixed(7);this.setValue("cmi.score.scaled",n)}else{this.setValue("cmi.core.score.raw",e);if(this.isSupported("cmi.core.score.min"))this.setValue("cmi.core.score.min",t);if(this.isSupported("cmi.core.score.max"))this.setValue("cmi.core.score.max",i)}};t.prototype.getLessonLocation=function(){return this.getValue(this.isSCORM2004()?"cmi.location":"cmi.core.lesson_location")};t.prototype.setLessonLocation=function(e){this.setValue(this.isSCORM2004()?"cmi.location":"cmi.core.lesson_location",e)};t.prototype.getSuspendData=function(){return this.getValue("cmi.suspend_data")};t.prototype.setSuspendData=function(e){this.setValue("cmi.suspend_data",e)};t.prototype.getStudentName=function(){return this.getValue(this.isSCORM2004()?"cmi.learner_name":"cmi.core.student_name")};t.prototype.getStudentId=function(){return this.getValue(this.isSCORM2004()?"cmi.learner_id":"cmi.core.student_id")};t.prototype.setLanguage=function(e){if(this.isSCORM2004()){this.setValue("cmi.learner_preference.language",e)}else{if(this.isSupported("cmi.student_preference.language")){this.setValue("cmi.student_preference.language",e)}}};t.prototype.commit=function(){this.logger.debug("ScormWrapper::commit");if(this.lmsConnected){if(this.commitRetryPending){this.logger.debug("ScormWrapper::commit: skipping this commit call as one is already pending.")}else{if(this.scorm.save()){this.commitRetries=0;this.lastCommitSuccessTime=new Date}else{if(this.commitRetries<this.maxCommitRetries&&!this.finishCalled){this.commitRetries++;this.initRetryCommit()}else{var e=this.scorm.debug.getCode();var t="Course could not commit data to the LMS";t+="\nError "+e+": "+this.scorm.debug.getInfo(e);t+="\nLMS Error Info: "+this.scorm.debug.getDiagnosticInfo(e);this.handleError(t)}}}}else{this.handleError("Course is not connected to the LMS")}};t.prototype.finish=function(){this.logger.debug("ScormWrapper::finish");if(this.lmsConnected&&!this.finishCalled){this.finishCalled=true;if(this.timedCommitIntervalID!==null){window.clearInterval(this.timedCommitIntervalID)}if(this.commitRetryPending){window.clearTimeout(this.retryCommitTimeoutID);this.commitRetryPending=false}if(this.logOutputWin&&!this.logOutputWin.closed){this.logOutputWin.close()}this.endTime=new Date;if(this.isSCORM2004()){this.scorm.set("cmi.session_time",this.convertToSCORM2004Time(this.endTime.getTime()-this.startTime.getTime()))}else{this.scorm.set("cmi.core.session_time",this.convertToSCORM12Time(this.endTime.getTime()-this.startTime.getTime()));this.scorm.set("cmi.core.exit","")}this.lmsConnected=false;if(!this.scorm.quit()){this.handleError("Course could not finish")}}else{this.handleError("Course is not connected to the LMS")}};t.prototype.recordInteraction=function(e,t,i,s,n){if(this.isSupported("cmi.interactions._count")){switch(n){case"choice":this.recordInteractionMultipleChoice.apply(this,arguments);break;case"matching":this.recordInteractionMatching.apply(this,arguments);break;case"numeric":this.isSCORM2004()?this.recordInteractionScorm2004.apply(this,arguments):this.recordInteractionScorm12.apply(this,arguments);break;case"fill-in":this.recordInteractionFillIn.apply(this,arguments);break;default:console.error("ScormWrapper.recordInteraction: unknown interaction type of '"+n+"' encountered...")}}else{this.logger.info("ScormWrapper::recordInteraction: cmi.interactions are not supported by this LMS...")}};t.prototype.getValue=function(e){this.logger.debug("ScormWrapper::getValue: _property="+e);if(this.finishCalled){this.logger.debug("ScormWrapper::getValue: ignoring request as 'finish' has been called");return}if(this.lmsConnected){var t=this.scorm.get(e);var i=this.scorm.debug.getCode();var s="";if(i!==0){if(i===403){this.logger.warn("ScormWrapper::getValue: data model element not initialized")}else{s+="Course could not get "+e;s+="\nError Info: "+this.scorm.debug.getInfo(i);s+="\nLMS Error Info: "+this.scorm.debug.getDiagnosticInfo(i);this.handleError(s)}}this.logger.debug("ScormWrapper::getValue: returning "+t);return t+""}else{this.handleError("Course is not connected to the LMS")}};t.prototype.setValue=function(e,t){this.logger.debug("ScormWrapper::setValue: _property="+e+" _value="+t);if(this.finishCalled){this.logger.debug("ScormWrapper::setValue: ignoring request as 'finish' has been called");return}if(this.lmsConnected){var i=this.scorm.set(e,t);var s=this.scorm.debug.getCode();var n="";if(!i){if(s!==0){n+="Course could not set "+e+" to "+t;n+="\nError Info: "+this.scorm.debug.getInfo(s);n+="\nLMS Error Info: "+this.scorm.debug.getDiagnosticInfo(s);this.handleError(n)}else{this.logger.warn("ScormWrapper::setValue: LMS reported that the 'set' call failed but then said there was no error!")}}return i}else{this.handleError("Course is not connected to the LMS")}};t.prototype.isSupported=function(e){this.logger.debug("ScormWrapper::isSupported: _property="+e);if(this.finishCalled){this.logger.debug("ScormWrapper::isSupported: ignoring request as 'finish' has been called");return}if(this.lmsConnected){var t=this.scorm.get(e);var i=this.scorm.debug.getCode();return i===401?false:true}else{this.handleError("Course is not connected to the LMS");return false}};t.prototype.initTimedCommit=function(){this.logger.debug("ScormWrapper::initTimedCommit");if(this.timedCommitFrequency>0){var e=this.timedCommitFrequency*(60*1e3);this.timedCommitIntervalID=window.setInterval(_.bind(this.commit,this),e)}};t.prototype.initRetryCommit=function(){this.logger.debug("ScormWrapper::initRetryCommit "+this.commitRetries+" out of "+this.maxCommitRetries);this.commitRetryPending=true;this.retryCommitTimeoutID=window.setTimeout(_.bind(this.doRetryCommit,this),this.commitRetryDelay)};t.prototype.doRetryCommit=function(){this.logger.debug("ScormWrapper::doRetryCommit");this.commitRetryPending=false;this.commit()};t.prototype.handleError=function(e){this.logger.error(e);if(!this.suppressErrors&&(!this.logOutputWin||this.logOutputWin.closed)&&confirm("An error has occured:\n\n"+e+"\n\nPress 'OK' to view debug information to send to technical support."))this.showDebugWindow()};t.prototype.getInteractionCount=function(){var e=this.getValue("cmi.interactions._count");return e===""?0:e};t.prototype.recordInteractionScorm12=function(e,t,i,s,n){e=this.trim(e);var r="cmi.interactions."+this.getInteractionCount();this.setValue(r+".id",e);this.setValue(r+".type",n);this.setValue(r+".student_response",t);this.setValue(r+".result",i?"correct":"wrong");if(s!==null&&s!==undefined)this.setValue(r+".latency",this.convertToSCORM12Time(s));this.setValue(r+".time",this.getCMITime())};t.prototype.recordInteractionScorm2004=function(e,t,i,s,n){e=this.trim(e);var r="cmi.interactions."+this.getInteractionCount();this.setValue(r+".id",e);this.setValue(r+".type",n);this.setValue(r+".learner_response",t);this.setValue(r+".result",i?"correct":"incorrect");if(s!==null&&s!==undefined)this.setValue(r+".latency",this.convertToSCORM2004Time(s));this.setValue(r+".timestamp",this.getISO8601Timestamp())};t.prototype.recordInteractionMultipleChoice=function(e,t,i,s,n){if(this.isSCORM2004()){t=t.replace(/,|#/g,"[,]")}else{t=t.replace(/#/g,",")}var r=this.isSCORM2004()?this.recordInteractionScorm2004:this.recordInteractionScorm12;r.call(this,e,t,i,s,n)};t.prototype.recordInteractionMatching=function(e,t,i,s,n){t=t.replace(/#/g,",");if(this.isSCORM2004()){t=t.replace(/,/g,"[,]");t=t.replace(/\./g,"[.]")}var r=this.isSCORM2004()?this.recordInteractionScorm2004:this.recordInteractionScorm12;r.call(this,e,t,i,s,n)};t.prototype.recordInteractionFillIn=function(e,t,i,s,n){var r=this.isSCORM2004()?250:255;if(t.length>r){t=t.substr(0,r);this.logger.warn("ScormWrapper::recordInteractionFillIn: response data for "+e+" is longer than the maximum allowed length of "+r+" characters; data will be truncated to avoid an error.")}var o=this.isSCORM2004()?this.recordInteractionScorm2004:this.recordInteractionScorm12;o.call(this,e,t,i,s,n)};t.prototype.showDebugWindow=function(){if(this.logOutputWin&&!this.logOutputWin.closed){this.logOutputWin.close()}this.logOutputWin=window.open("log_output.html","Log","width=600,height=300,status=no,scrollbars=yes,resizable=yes,menubar=yes,toolbar=yes,location=yes,top=0,left=0");if(this.logOutputWin)this.logOutputWin.focus();return};t.prototype.convertToSCORM12Time=function(e){var t=1e3;var i=t*60;var s=i*60;var n=e%t;e=e-n;var r=e%i;e=e-r;r=r/t;var o=e%s;e=e-o;o=o/i;var a=e/s;if(a>9999){return"9999:99:99.99"}else{var l=[this.padWithZeroes(a,4),this.padWithZeroes(o,2),this.padWithZeroes(r,2)].join(":");return l+"."+Math.floor(n/10)}};t.prototype.convertToSCORM2004Time=function(e){var t=Math.floor(e/10);var i=100;var s=i*60;var n=s*60;var r=n*24;var o=Math.floor(t/r);t-=o*r;o=o?o+"D":"";var a=Math.floor(t/n);t-=a*n;a=a?a+"H":"";var l=Math.floor(t/s);t-=l*s;l=l?l+"M":"";var c=Math.floor(t/i);t-=c*i;c=c?c:"0";var d=t;d=d?"."+d:"";
var u=c+d+"S";var h=[a,l,u].join("");return"P"+o+"T"+h};t.prototype.getCMITime=function(){var e=new Date;var t=this.padWithZeroes(e.getHours(),2);var i=this.padWithZeroes(e.getMinutes(),2);var s=this.padWithZeroes(e.getSeconds(),2);return[t,i,s].join(":")};t.prototype.getISO8601Timestamp=function(){var e=(new Date).toISOString();return e.replace(/.\d\d\dZ/,"")};t.prototype.padWithZeroes=function(e,t){var i=t;while(--i){e="0"+e}return e.slice(-t)};t.prototype.trim=function(e){return e.replace(/^\s*|\s*$/g,"")};t.prototype.isSCORM2004=function(){return this.scorm.version==="2004"};return t});Logger=function(){this.logArr=new Array;this.registeredViews=new Array};if(!Date.now){Date.now=function(){return(new Date).getTime()}}Logger.instance=null;Logger.LOG_TYPE_INFO=0;Logger.LOG_TYPE_WARN=1;Logger.LOG_TYPE_ERROR=2;Logger.LOG_TYPE_DEBUG=3;Logger.getInstance=function(){if(Logger.instance==null)Logger.instance=new Logger;return Logger.instance};Logger.prototype.getEntries=function(){return this.logArr};Logger.prototype.getLastEntry=function(){return this.logArr[this.logArr.length-1]};Logger.prototype.info=function(e){this.logArr[this.logArr.length]={str:e,type:Logger.LOG_TYPE_INFO,time:Date.now()};this.updateViews()};Logger.prototype.warn=function(e){this.logArr[this.logArr.length]={str:e,type:Logger.LOG_TYPE_WARN,time:Date.now()};this.updateViews()};Logger.prototype.error=function(e){this.logArr[this.logArr.length]={str:e,type:Logger.LOG_TYPE_ERROR,time:Date.now()};this.updateViews()};Logger.prototype.debug=function(e){this.logArr[this.logArr.length]={str:e,type:Logger.LOG_TYPE_DEBUG,time:Date.now()};this.updateViews()};Logger.prototype.registerView=function(e){this.registeredViews[this.registeredViews.length]=e};Logger.prototype.unregisterView=function(e){for(var t=0;t<this.registeredViews.length;t++)if(this.registeredViews[t]==e){this.registeredViews.splice(t,1);t--}};Logger.prototype.updateViews=function(){for(var e=0;e<this.registeredViews.length;e++){if(this.registeredViews[e])this.registeredViews[e].update(this)}};define("extensions/adapt-contrib-spoor/js/scorm/logger",function(){});define("extensions/adapt-contrib-spoor/js/scorm",["./scorm/API","./scorm/wrapper","./scorm/logger"],function(e,t,i){return t.getInstance()});define("extensions/adapt-contrib-spoor/js/serializers/default",["core/js/adapt"],function(e){var t={serialize:function(){return this.serializeSaveState("_isComplete")},serializeSaveState:function(t){if(e.course.get("_latestTrackingId")===undefined){var i="This course is missing a latestTrackingID.\n\nPlease run the grunt process prior to deploying this module on LMS.\n\nScorm tracking will not work correctly until this is done.";console.error(i)}var s=e.config.get("_spoor")&&e.config.get("_spoor")._tracking&&e.config.get("_spoor")._tracking._excludeAssessments;var n=[];var r=e.course.get("_latestTrackingId")+1;for(var o=0;o<r;o++){n[o]="-"}_.each(e.blocks.models,function(e,i){var r=e.get("_trackingId"),o=e.getParent().get("_assessment"),a=e.get(t)?1:0;if(s&&o){a=0}if(r===undefined){var l="Block '"+e.get("_id")+"' doesn't have a tracking ID assigned.\n\nPlease run the grunt process prior to deploying this module on LMS.\n\nScorm tracking will not work correctly until this is done.";console.error(l)}else{n[r]=a}},this);return n.join("")},deserialize:function(t,i){var s=1;var n=0,r=this.deserializeSaveState(t),o=r.length;function a(){var t;for(var c=0,d=Math.min(s,o-n);c<d;n++,c++){t=r[n];if(t===1){l(e.blocks.findWhere({_trackingId:n}))}}n==o?i():setTimeout(a)}function l(e){if(!e){return}e.getChildren().each(function(e){e.set("_isComplete",true)})}a()},deserializeSaveState:function(e){var t=e.split("");for(var i=0;i<t.length;i++){if(t[i]==="-"){t[i]=-1}else{t[i]=parseInt(t[i],10)}}return t}};return t});(function(e){function t(e,t){if(t===undefined)t=2;var i=1*Math.pow(10,t);return Math.round(e*i)/i}function i(e,t){return parseInt(e.substr(0,t),2)}function s(e,t){return n.fillLeft(e.toString(2),t)}var n={addLeft:function l(e,t,i){i=i||"0";return new Array(t+1).join(i)+e},addRight:function c(e,t,i){i=i||"0";return e+new Array(t+1).join(i)},fillLeft:function d(e,t,i){if(e.length<t){var s=t-e.length;return n.addLeft(e,s,i)}return e},fillRight:function u(e,t,i){if(e.length<t){var s=t-e.length;return n.addRight(e,s,i)}return e},fillBlockLeft:function h(e,t,i){if(e.length%t){var s=t-e.length%t;return n.addLeft(e,s,i)}return e},fillBlockRight:function f(e,t,i){if(e.length%t){var s=t-e.length%t;return n.addRight(e,s,i)}return e}};function r(){switch(arguments.length){case 1:var e=typeof arguments[0];switch(e){case"number":return r._indexes[arguments[0]];case"string":return r._chars[arguments[0]];default:throw"Invalid arguments type"}case 2:var t=arguments[0];var i=arguments[1];r._chars[t]=i;r._indexes[i]=t;return;default:throw"Invalid number of arguments"}}r._chars={};r._indexes={};(function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-/";for(var t=0,i=e.length;t<i;t++){r(e[t],t)}})();function o(){switch(arguments.length){case 1:switch(typeof arguments[0]){case"object":var e=arguments[0];if(o._types[e.type]===undefined)o._types[e.type]=[];o._types[e.type].push(e);e.index=o._indexes.length;o._indexes.push(e);o[e.name]=e;return;case"string":return o.getName(arguments[0]);case"number":return o.getIndex(arguments[0]);default:throw"Argument type not allowed"}default:throw"Too many arguments"}}o.VARIABLELENGTHDESCRIPTORSIZE=8;o._types={};o._indexes=[];o.getName=function p(e){if(o[e])return o[e];throw"Type name not found '"+e+"'"};o.getIndex=function m(e){if(o._indexes[e])return o._indexes[e];throw"Type index not found '"+e+"'"};o.getTypes=function g(e){if(o._types[e])return o._types[e];throw"Type not found '"+e+"'"};o.checkBounds=function v(e,t){var i=o(e);if(t>i.max)throw e+" value is larger than "+i.max;if(t<i.min)throw e+" value is smaller than "+i.min};o.getNumberType=function _(e){var t=e-Math.floor(e)!==0;var i=o.getTypes("number");for(var s=0,n;n=i[s++];){if(e<=n.max&&e>=n.min&&(!t||t==n.decimal)){return n}}};o.getVariableType=function b(e){var t=e instanceof Array?"array":typeof e;var i;switch(t){case"number":i=o.getNumberType(e);break;case"string":i=o.getName("string");break;default:var s=o.getTypes(t);switch(s.length){case 1:i=s[0];break;default:throw"Type not found '"+t+"'"}}if(!i)throw"Cannot assess type '"+t+"'";return i};o.getArrayType=function w(t){var i=[];for(var s=0,n=t.length;s<n;s++){var r=t[s];var a=o.getVariableType(r);if(e.findWhere(i,{name:a.name}))continue;i.push(a)}switch(i.length){case 0:throw"Cannot determine array data types";case 1:return i[0];default:var l=e.pluck(i,"type");var c=e.uniq(l);var d=c.length>1;if(d)return o("variable");switch(c[0]){case"number":var u=e.findWhere(i,{decimal:true});if(u)return u;return e.max(i,function(e){return e.max})}throw"Unsupported data types"}};(function(){var e=[{size:"fixed",length:1,name:"boolean",type:"boolean"},{max:15,min:0,decimal:false,size:"fixed",length:4,name:"half",type:"number"},{max:255,min:0,decimal:false,size:"fixed",length:8,name:"byte",type:"number"},{max:65535,min:0,decimal:false,size:"fixed",length:16,name:"short",type:"number"},{max:4294967295,min:0,decimal:false,size:"fixed",length:32,name:"long",type:"number"},{max:4294967295,min:-4294967295,decimal:true,precision:2,size:"variable",name:"double",type:"number"},{name:"base16",size:"variable",type:"string"},{name:"base64",size:"variable",type:"string"},{name:"array",size:"variable",type:"array"},{name:"variable",size:"variable",type:"variable"},{name:"string",size:"variable",type:"string"}];for(var t=0,i;i=e[t++];){o(i)}})();function a(e,t){e=a.translateTypeAlias(e);t=a.translateTypeAlias(t);var i=[].slice.call(arguments,2);if(e!="binary"&&t!="binary"){if(!a._converters[e])throw"Type not found '"+e+"'";if(!a._converters[e]["binary"])throw"Type not found 'binary'";var s=a._converters[e]["binary"].call(this,i[0],a.WRAPOUTPUT);if(!a._converters["binary"][t])throw"Type not found '"+t+"'";return a._converters["binary"][t].call(this,s,a.WRAPOUTPUT)}if(!a._converters[e])throw"Type not found '"+e+"'";if(!a._converters[e][t])throw"Type not found '"+t+"'";return a._converters[e][t].call(this,i[0],a.WRAPOUTPUT)}a.WRAPOUTPUT=false;a.translateTypeAlias=function y(e){e=e.toLowerCase();for(var t in a._typeAliases){if(t==e||(" "+a._typeAliases[t].join(" ")+" ").indexOf(" "+e+" ")>=0)return t}throw"Type not found '"+e+"'"};a._typeAliases={base64:["b64"],base16:["hex","b16"],"double":["dbl","decimal","d"],"long":["lng","l"],"short":["s"],"byte":["b"],half:["h"],number:["num","n"],binary:["bin"],"boolean":["bool"],array:["arr"]};a._variableWrapLength=function C(e){var t=e.length;var i=s(t,o.VARIABLELENGTHDESCRIPTORSIZE);return i+e};a._variableLength=function k(e){var t=o.VARIABLELENGTHDESCRIPTORSIZE;var s=i(e,t);return s};a._variableUnwrapLength=function S(e){var t=o.VARIABLELENGTHDESCRIPTORSIZE;var s=i(e,t);return e.substr(t,s)};a._converters={base64:{binary:function x(e){var t=r(e.substr(0,1));var o=s(t,6);var a=i(o,6);var l="";for(var c=0,d;d=e[c++];){var u=r(d).toString(2);u=n.fillLeft(u,6);l+=u}l=l.substr(6+a);return l}},base16:{binary:function I(e){var t=r(base64.substr(0,1));var o=s(t,4);var a=i(o,4);var l="";for(var c=0,d;d=e[c++];){var u=parseInt(d,16).toString(2);u=n.fillLeft(u,4);l+=u}l=l.substr(6+a);return l}},"double":{binary:function A(e,i){var s=o("double");o.checkBounds("double",e);e=t(e,s.precision);var r=e.toString(10);var l=e<0;var c,d,u,h,f,p;var m=r.indexOf("e");if(m>-1){c=r.substr(0,m);d=Math.abs(r.substr(m+1));if(l)c=c.substr(1);f=c.indexOf(".");p=f>-1;if(p){u=c.substr(0,f);h=c.substr(f+1);d=Math.abs(d)+h.length;c=u+h}}else{c=r;d="0";if(l)r=r.substr(1);f=r.indexOf(".");p=f>-1;if(p){u=r.substr(0,f);h=r.substr(f+1);d=h.length;if(u=="0"){c=parseInt(h,10).toString(10)}else{c=u+h}}else{c=r}}var g=[];var v=n.fillBlockLeft(parseInt(c,10).toString(2),4);var _=l?"1":"0";var b=n.fillLeft(parseInt(d,10).toString(2),7);g.push(_);g.push(b);g.push(v);if(i===false){return g.join("")}else{return a._variableWrapLength(g.join(""))}}},"long":{binary:function T(e){var i=o("long");o.checkBounds("long",e);e=t(e,0);return n.fillLeft(e.toString(2),i.length)}},"short":{binary:function E(e){var i=o("short");o.checkBounds("short",e);e=t(e,0);return n.fillLeft(e.toString(2),i.length)}},"byte":{binary:function R(e){var i=o("byte");o.checkBounds("byte",e);e=t(e,0);return n.fillLeft(e.toString(2),i.length)}},half:{binary:function $(e){var i=o("half");o.checkBounds("half",e);e=t(e,0);return n.fillLeft(e.toString(2),i.length)}},"boolean":{binary:function O(e){return e?"1":"0"}},array:{binary:function L(e,t){var i=o("array");var n=o.getArrayType(e);var r=n.name=="vairable";if(r){var l=half2bin(15);return l}else{var c=a._converters["half"]["binary"](n.index);var d=[];for(var u=0,h=e.length;u<h;u++){var f=e[u];var p=a._converters[n.name]["binary"](f);d.push(p)}var m=d.join("");var g=0;if(m.length%4)g=4-m.length%4;var v=s(g,2);var _=new Array(g+1).join("0");var l=[];l.push(c);l.push(v);l.push(_);l.push(m);var b=l.join("");if(t===false)return b;var w=a._variableWrapLength(b);return w}}},binary:{array:function P(e,t){var s=o("array");if(t!==false)e=a._variableUnwrapLength(e);var n=e.substr(0,4);var r=e.substr(4,2);var l=a._converters["binary"]["half"](n);var c=i(r,2);var d=4+2+c;var u=e.length-d;var h=e.substr(d,u);var f=o(l);var p=f.name=="variable";var m=[];if(p){}else{var g=f.size=="variable";if(g){var v=o.VARIABLELENGTHDESCRIPTORSIZE;while(h!=""){var _=a._variableLength(h);var b=h.substr(0,v+_);h=h.substr(v+_);m.push(a._converters["binary"][f.name](b))}}else{while(h!=""){var b=h.substr(0,f.length);h=h.substr(f.length);m.push(a._converters["binary"][f.name](b))}}}return m},base64:function D(e){var t=0;if(e.length%6)t=6-e.length%6;binPaddingLen=s(t,6);binPadding=n.addLeft("",t);e=binPaddingLen+binPadding+e;var i=e.length;var o="";for(var a=0;a<1e4;a++){if(a*6>=i)break;var l=e.substr(a*6,6);o+=r(parseInt(l,2))}return o},base16:function M(e){var t=0;if(e.length%4)t=4-e.length%4;binPaddingLen=s(t,4);binPadding=n.addLeft("",t);e=binPaddingLen+binPadding+e;var i=e.length;var r="";for(var o=0;o<1e4;o++){if(o*4>=i)break;var a=e.substr(o*4,4);r+=parseInt(a,2).toString(16)}return r},"double":function V(e,t){var i=o("double");if(t!==false)e=a._variableUnwrapLength(e);var s=e.substr(0,1)==1;var n=parseInt("0"+e.substr(1,7),2);var r=parseInt(e.substr(8,e.length),2);var l=parseFloat(r+"E-"+n,10);if(s)l=l*-1;return l},"long":function N(e){return parseInt(e.substr(0,32),2)},"short":function z(e){return parseInt(e.substr(0,16),2)},"byte":function B(e){return parseInt(e.substr(0,8),2)},half:function j(e){return parseInt(e.substr(0,4),2)},"boolean":function F(e){return e.substr(0,1)=="1"?true:false},number:function q(e){return parseInt(e,2)}}};window.SCORMSuspendData={serialize:function U(e){return a("array","base64",e)},deserialize:function H(e){return a("base64","array",e)},Base64:r,Converter:a,DataType:o}})(_);define("extensions/adapt-contrib-spoor/js/serializers/scormSuspendDataSerializer",function(){});define("extensions/adapt-contrib-spoor/js/serializers/questions",["core/js/adapt","./scormSuspendDataSerializer"],function(e){var t={_isQuestionType:true,_isResetOnRevisit:false};var i={serialize:function(){return this.serializeSaveState()},serializeSaveState:function(){if(e.course.get("_latestTrackingId")===undefined){var t="This course is missing a latestTrackingID.\n\nPlease run the grunt process prior to deploying this module on LMS.\n\nScorm tracking will not work correctly until this is done.";console.error(t);return""}var i="";try{var s=this.captureData();if(s.length===0)return"";i=SCORMSuspendData.serialize(s)}catch(n){console.error(n)}return i},captureData:function(){var i=[];var s=e.blocks.pluck("_trackingId");var n={};var r={};for(var o=0,a=s.length;o<a;o++){var l=s[o];var c=e.blocks.findWhere({_trackingId:l});var d=c.getChildren().where(t);for(var u=0,h=d.length;u<h;u++){var f=d[u].toJSON();var p=f._parentId;if(!n[p]){n[p]=c.toJSON()}var m=n[p];if(r[p]===undefined)r[p]=-1;r[p]++;var g=r[p];if(f["_isInteractionComplete"]===false||f["_isComplete"]===false){continue}var v=f["_userAnswer"]!==undefined;var _=f["_userAnswer"]instanceof Array;if(v&&_&&f["_userAnswer"].length===0){v=false;_=false}var b=[g,m["_trackingId"],f["_score"]||0,f["_attemptsLeft"]||0];var w=[v,_,f["_isInteractionComplete"],f["_isSubmitted"],f["_isCorrect"]||false];var y=[b,w];if(v){var C=_?f["_userAnswer"]:[f["_userAnswer"]];var k=SCORMSuspendData.DataType.getArrayType(C);switch(k.name){case"string":case"variable":console.log("Cannot store _userAnswers from component "+f._id+" as array is of variable or string type.");continue}y.push(C)}i.push(y)}}return i},deserialize:function(e){try{var t=SCORMSuspendData.deserialize(e);this.releaseData(t)}catch(i){console.error(i)}},releaseData:function(i){for(var s=0,n=i.length;s<n;s++){var r=i[s];var o=r[0];var a=r[1];var l=o[0];var c=o[1];var d=o[2];var u=o[3]||0;var h=a[0];var f=a[1];var p=a[2];var m=a[3];var g=a[4];var v=e.blocks.findWhere({_trackingId:c});var _=v.getChildren();_=_.where(t);var b=_[l];b.set("_isComplete",true);b.set("_isInteractionComplete",p);b.set("_isSubmitted",m);b.set("_score",d);b.set("_isCorrect",g);b.set("_attemptsLeft",u);if(h){var w=r[2];if(!f)w=w[0];b.set("_userAnswer",w)}}}};return i});define("extensions/adapt-contrib-spoor/js/adapt-stateful-session",["core/js/adapt","./serializers/default","./serializers/questions","core/js/enums/completionStateEnum"],function(e,t,i,s){var n=_.extend({_config:null,_shouldStoreResponses:true,_shouldRecordInteractions:true,initialize:function(e){this._onWindowUnload=_.bind(this.onWindowUnload,this);this.getConfig();this.getLearnerInfo();this.restoreSessionState(_.bind(function(){_.defer(_.bind(this.setupEventListeners,this));e()},this))},getConfig:function(){this._config=e.config.has("_spoor")?e.config.get("_spoor"):false;this._shouldStoreResponses=this._config&&this._config._tracking&&this._config._tracking._shouldStoreResponses;if(this._config&&this._config._tracking&&this._config._tracking._shouldRecordInteractions===false){this._shouldRecordInteractions=false}},getLearnerInfo:function(){var t=e.course.get("_globals");if(!t._learnerInfo){t._learnerInfo={}}_.extend(t._learnerInfo,e.offlineStorage.get("learnerinfo"))},saveSessionState:function(){var t=this.getSessionState();e.offlineStorage.set(t)},restoreSessionState:function(s){var n=e.offlineStorage.get();var r=_.keys(n).length===0;var o=_.bind(function(){if(n.questions&&this._shouldStoreResponses)i.deserialize(n.questions);if(n._isCourseComplete)e.course.set("_isComplete",n._isCourseComplete);if(n._isAssessmentPassed)e.course.set("_isAssessmentPassed",n._isAssessmentPassed);s()},this);if(r)return s();if(n.completion){t.deserialize(n.completion,o)}else{o()}},getSessionState:function(){var s={completion:t.serialize(),questions:this._shouldStoreResponses===true?i.serialize():"",_isCourseComplete:e.course.get("_isComplete")||false,_isAssessmentPassed:e.course.get("_isAssessmentPassed")||false};return s},setupEventListeners:function(){$(window).on("beforeunload unload",this._onWindowUnload);if(this._shouldStoreResponses){this.listenTo(e.components,"change:_isInteractionComplete",this.onQuestionComponentComplete)}if(this._shouldRecordInteractions){this.listenTo(e,"questionView:recordInteraction",this.onQuestionRecordInteraction)}this.listenTo(e.blocks,"change:_isComplete",this.onBlockComplete);this.listenTo(e,{"assessment:complete":this.onAssessmentComplete,"app:languageChanged":this.onLanguageChanged,"tracking:complete":this.onTrackingComplete})},removeEventListeners:function(){$(window).off("beforeunload unload",this._onWindowUnload);this.stopListening()},reattachEventListeners:function(){this.removeEventListeners();this.setupEventListeners()},onBlockComplete:function(e){this.saveSessionState()},onQuestionComponentComplete:function(e){if(!e.get("_isQuestionType"))return;this.saveSessionState()},onTrackingComplete:function(t){this.saveSessionState();var i=t.status.asLowerCase;switch(t.status){case s.COMPLETED:case s.PASSED:{if(!this._config._reporting._onTrackingCriteriaMet){e.log.warn("No value defined for '_onTrackingCriteriaMet', so defaulting to '"+i+"'")}else{i=this._config._reporting._onTrackingCriteriaMet}break}case s.FAILED:{if(!this._config._reporting._onAssessmentFailure){e.log.warn("No value defined for '_onAssessmentFailure', so defaulting to '"+i+"'")}else{i=this._config._reporting._onAssessmentFailure}}}e.offlineStorage.set("status",i)},onAssessmentComplete:function(t){e.course.set("_isAssessmentPassed",t.isPass);this.saveSessionState();this.submitScore(t)},onQuestionRecordInteraction:function(t){var i=typeof t.model.getResponseType==="function"?t.model.getResponseType():t.getResponseType();if(_.isEmpty(i))return;var s=t.model.get("_id");var n=typeof t.model.getResponse==="function"?t.model.getResponse():t.getResponse();var r=typeof t.model.isCorrect==="function"?t.model.isCorrect():t.isCorrect();var o=t.getLatency();e.offlineStorage.set("interaction",s,n,r,o,i)},onLanguageChanged:function(){this.reattachEventListeners();this.saveSessionState();if(this._config._reporting&&this._config._reporting._resetStatusOnLanguageChange===true){e.offlineStorage.set("status","incomplete")}},submitScore:function(t){if(this._config&&!this._config._tracking._shouldSubmitScore)return;if(t.isPercentageBased){e.offlineStorage.set("score",t.scoreAsPercent,0,100)}else{e.offlineStorage.set("score",t.score,0,t.maxScore)}},onWindowUnload:function(){this.removeEventListeners()}},Backbone.Events);return n});define("extensions/adapt-contrib-spoor/js/adapt-offlineStorage-scorm",["core/js/adapt","./scorm","core/js/offlineStorage"],function(e,t){var i={};var s={};var n=false;e.offlineStorage.initialize({get:function(e){if(e===undefined){if(this.useTemporaryStore())return i;s=this.getCustomStates();var r=_.extend(_.clone(s),{location:t.getLessonLocation(),score:t.getScore(),status:t.getStatus(),student:t.getStudentName(),learnerInfo:this.getLearnerInfo()});n=true;return r}if(this.useTemporaryStore())return i[e];switch(e.toLowerCase()){case"location":return t.getLessonLocation();case"score":return t.getScore();case"status":return t.getStatus();case"student":return t.getStudentName();case"learnerinfo":return this.getLearnerInfo();default:return this.getCustomState(e)}},set:function(e,r){var o=[].slice.call(arguments,1);var a=typeof e=="object";if(a){r=e;e="suspendData"}if(this.useTemporaryStore()){if(a){i=_.extend(i,r)}else{i[e]=r}return true}switch(e.toLowerCase()){case"interaction":return t.recordInteraction.apply(t,o);case"location":return t.setLessonLocation.apply(t,o);case"score":return t.setScore.apply(t,o);case"status":return t.setStatus.apply(t,o);case"student":case"learnerinfo":return false;case"lang":t.setLanguage(r);case"suspenddata":default:if(a){s=_.extend(s,r)}else{s[e]=r}var l=JSON.stringify(s);return n?t.setSuspendData(l):false}},getCustomStates:function(){var e=_.isEmpty(s);if(!e&&n)return _.clone(s);var i=t.getSuspendData();if(i===""||i===" "||i===undefined)return{};var r=JSON.parse(i);if(!e&&!n)r=_.extend(r,s);return r},getCustomState:function(e){var t=this.getCustomStates();return t[e]},useTemporaryStore:function(){var i=e.config.get("_spoor");if(!t.lmsConnected||i&&i._isEnabled===false)return true;return false},getLearnerInfo:function(){var e=t.getStudentName();var i="",s="";if(e&&e!=="undefined"&&e.indexOf(",")>-1){var n=e.split(",");s=$.trim(n[0]);i=$.trim(n[1]);e=i+" "+s}else{console.log("SPOOR: LMS learner_name not in 'lastname, firstname' format")}return{name:e,lastname:s,firstname:i,id:t.getStudentId()}}})});define("extensions/adapt-contrib-spoor/js/adapt-contrib-spoor",["core/js/adapt","./scorm","./adapt-stateful-session","./adapt-offlineStorage-scorm"],function(e,t,i){var s=_.extend({_config:null,initialize:function(){this.listenToOnce(e,{"offlineStorage:prepare":this.onPrepareOfflineStorage,"app:dataReady":function(){e.wait.for(i.initialize.bind(i))}})},onPrepareOfflineStorage:function(){if(!this.checkConfig()){e.offlineStorage.setReadyStatus();return}this.configureAdvancedSettings();t.initialize();e.offlineStorage.get();e.offlineStorage.setReadyStatus();this.setupEventListeners()},checkConfig:function(){this._config=e.config.get("_spoor")||false;if(this._config&&this._config._isEnabled!==false)return true;return false},configureAdvancedSettings:function(){if(this._config._advancedSettings){var e=this._config._advancedSettings;if(e._showDebugWindow)t.showDebugWindow();t.setVersion(e._scormVersion||"1.2");if(e.hasOwnProperty("_suppressErrors")){t.suppressErrors=e._suppressErrors}if(e.hasOwnProperty("_commitOnStatusChange")){t.commitOnStatusChange=e._commitOnStatusChange}if(e.hasOwnProperty("_timedCommitFrequency")){t.timedCommitFrequency=e._timedCommitFrequency}if(e.hasOwnProperty("_maxCommitRetries")){t.maxCommitRetries=e._maxCommitRetries}if(e.hasOwnProperty("_commitRetryDelay")){t.commitRetryDelay=e._commitRetryDelay}}else{t.setVersion("1.2")}if(window.location.search.indexOf("nolmserrors")!=-1)t.suppressErrors=true},setupEventListeners:function(){var e=this._config._advancedSettings;var i=(!e||e._commitOnVisibilityChangeHidden!==false)&&document.addEventListener;this._onWindowUnload=_.bind(this.onWindowUnload,this);$(window).on("beforeunload unload",this._onWindowUnload);if(i){document.addEventListener("visibilitychange",this.onVisibilityChange)}require(["libraries/jquery.keycombo"],function(){$.onKeyCombo([68,69,86],function(){t.showDebugWindow()})})},removeEventListeners:function(){$(window).off("beforeunload unload",this._onWindowUnload);document.removeEventListener("visibilitychange",this.onVisibilityChange)},onVisibilityChange:function(){if(document.visibilityState==="hidden")t.commit()},onWindowUnload:function(){this.removeEventListeners();if(!t.finishCalled){t.finish()}}},Backbone.Events);s.initialize()});define("extensions/adapt-contrib-trickle/js/trickleView",["core/js/adapt"],function(e){var t=Backbone.View.extend({isSteplocked:false,completionAttribute:null,initialize:function(e){this.setupEventListeners()},setupEventListeners:function(){var t={"trickle:kill":this.onKill,remove:this.onRemove};this.onPreRender(this);t[this.model.get("_type")+"View:postRender"]=this.onPostRender;this.listenTo(e,t);this.on("steplock",this.onStepLock);this.on("stepunlock",this.onStepUnlock)},onPreRender:function(t){this.completionAttribute=e.trickle.getCompletionAttribute();if(!this.isElementEnabled())return;e.trigger("trickle:preRender",this)},onPostRender:function(t){if(t.model.get("_id")!==this.model.get("_id"))return;if(!this.isElementEnabled())return;e.trigger("trickle:postRender",this)},isElementEnabled:function(){var t=e.trickle.getModelConfig(this.model);if(!t)return false;if(this.model.get(this.completionAttribute))return false;var i=this.model.get("_type")==="article"&&t._onChildren;if(i){return false}if(t._isEnabled===true)return true;return false},onStepLock:function(){if(!this.isElementEnabled()){this.continueToNext();return}var t=e.trickle.getModelConfig(this.model);var i=t._stepLocking&&t._stepLocking._isEnabled;if(!i){this.continueToNext();return}e.trigger("trickle:steplock",this);this.isSteplocked=true},continueToNext:function(){_.defer(_.bind(function(){e.trigger("trickle:continue",this)},this))},onStepUnlock:function(){if(!this.isSteplocked)return;this.isSteplocked=false;e.trigger("trickle:stepunlock",this)},onKill:function(){this.detachFromElement()},onRemove:function(){this.detachFromElement()},detachFromElement:function(){this.undelegateEvents();this.stopListening();this.model=null;this.articleModel=null;this.$el=null;this.el=null}});return t});define("extensions/adapt-contrib-trickle/js/pageView",["core/js/adapt","./trickleView"],function(e,t){var i=Backbone.View.extend({currentDescendantIndex:0,currentLocksOnDescendant:0,currentDescendant:null,initialize:function(e){if(!this.isPageEnabled()){return this.detachFromPage()}this.setupDescendants();if(!this.haveDescendantsGotTrickle()){return this.detachFromPage()}this.addClassToHtml();this.setupEventListeners()},isPageEnabled:function(){var t=e.trickle.getModelConfig(this.model);if(t&&t._isEnabled===false)return false;return true},setupDescendants:function(){this.currentDescendant=null;this.descendantViews={};this.getDescendants();e.trigger("trickle:descendants",this)},descendantsChildFirst:null,descendantsParentFirst:null,descendantViews:null,getDescendants:function(){this.descendantsChildFirst=this.model.getDescendants();this.descendantsParentFirst=this.model.getDescendants(true);this.setDescendantsTrickleDefaults();this.descendantsChildFirst=this.filterComponents(this.descendantsChildFirst);this.descendantsParentFirst=this.filterComponents(this.descendantsParentFirst)},filterComponents:function(e){return _.filter(e,function(e){if(e.get("_type")==="component")return false;if(!e.get("_isAvailable"))return false;return true})},setDescendantsTrickleDefaults:function(){_.each(this.descendantsParentFirst,_.bind(function(t){var i=e.trickle.getModelConfig(t);if(!i){return}i._stepLocking=_.extend({_isEnabled:true,_isCompletionRequired:true,_isLockedOnRevisit:false},i._stepLocking);i=_.extend({_isEnabled:true,_autoScroll:true,_scrollDuration:500,_onChildren:true,_scrollTo:"@block +1"},i);e.trickle.setModelConfig(t,i);if(i._onChildren&&t.get("_type")==="article"){this.setupArticleOnChildren(t,i)}t.set("_isTrickleConfigured",true)},this))},setupArticleOnChildren:function(t,i){var s=t.getChildren();s.each(function(t,n){var r=e.trickle.getModelConfig(t);for(var o in r){if(typeof r[o]==="object"){r[o]=_.extend({},i[o],r[o])}}r=_.extend({},i,r);if(s.length===n+1){r._isFinal=true}if(n===0){r._isStart=true}e.trickle.setModelConfig(t,r)})},haveDescendantsGotTrickle:function(){return _.some(this.descendantsChildFirst,function(t){var i=e.trickle.getModelConfig(t);if(!i)return false;if(i._isEnabled===true){return true}return false})},addClassToHtml:function(){$("html").addClass("trickle")},setupEventListeners:function(){this.listenTo(e,{remove:this.onRemove,"articleView:preRender":this.onDescendantPreRender,"blockView:preRender":this.onDescendantPreRender,"trickle:unwait":this.onUnwait,"trickle:wait":this.onWait,"trickle:continue":this.onContinue,"trickle:skip":this.onSkip,"trickle:kill":this.onKill});this.listenToOnce(this.model,"change:_isReady",this.onPageReady)},onDescendantPreRender:function(e){if(e.model.get("_type")==="component")return;var i=new t({model:e.model,el:e.el});this.descendantViews[e.model.get("_id")]=i},onPageReady:function(t,i){if(!i)return;this.currentDescendant=null;e.trigger("trickle:started");this.gotoNextDescendant()},gotoNextDescendant:function(){this.getDescendants();if(this.currentDescendant){this.currentDescendant.trigger("stepunlock");this.currentDescendant=null}for(var e=this.currentDescendantIndex||0,t=this.descendantsChildFirst.length;e<t;e++){var i=this.descendantsChildFirst[e];switch(i.get("_type")){case"block":case"article":this.currentLocksOnDescendant=0;this.currentDescendantIndex=e;var s=i.get("_id");this.currentDescendant=this.descendantViews[s];this.currentDescendant.trigger("steplock");return}}this.finished()},onContinue:function(e){if(!this.currentDescendant)return;if(e.model.get("_id")!==this.currentDescendant.model.get("_id"))return;this.onSkip()},onWait:function(){this.currentLocksOnDescendant++},onUnwait:function(){this.currentLocksOnDescendant--;if(this.currentLocksOnDescendant>0)return;var t=this.currentDescendant.model;this.currentDescendantIndex++;this.gotoNextDescendant();e.trickle.scroll(t)},onSkip:function(){_.defer(_.bind(function(){this.currentDescendantIndex++;this.gotoNextDescendant()},this))},onKill:function(){this.finished();this.detachFromPage()},finished:function(){e.trigger("trickle:finished");this.detachFromPage()},onRemove:function(){this.finished()},detachFromPage:function(){this.removeClassFromHtml();this.undelegateEvents();this.stopListening();this.model=null;this.$el=null;this.el=null;this.currentDescendant=null;this.descendantViews=null;this.descendantsChildFirst=null;this.descendantsParentFirst=null;e.trickle.pageView=null},removeClassFromHtml:function(){$("html").removeClass("trickle")}});return i});define("extensions/adapt-contrib-trickle/js/lib/adaptModelExtension",["coreJS/adapt","coreModels/adaptModel"],function(e,t){_.extend(t.prototype,{getDescendants:function(e){var t=[];if(this.get("_type")==="component"){t.push(this);return t}var i=this.getChildren().models;for(var s=0,n=i.length;s<n;s++){var r=i[s];if(r.get("_type")==="component"){t.push(r)}else{var o=r.getDescendants(e);if(e==true)t.push(r);t=t.concat(o);if(e!=true)t.push(r)}}return t},findRelative:function(t,s){var n=["menu","page","article","block","component"];s=s||{};var r=this.get("_id");var o=this.get("_type");var a=e.course;if(s.limitParentId){a=e.findById(s.limitParentId)}var l=i(t);var c=_.indexOf(n,o)>_.indexOf(n,l.type);var d=o===l.type;var u=false;var h=0;var f=a.getDescendants();if(d||c){u=l.offset<=0}else{if(l.offset<1){u=true}else{h=1;u=false}}if(s.filterNotVisible){f=_.filter(f,function(e){return e.get("_isVisible")})}if(s.filterNotAvailable){f=_.filter(f,function(e){return e.get("_isAvailable")})}var p=_.findIndex(f,function(e){if(e.get("_id")===r){return true}return false});if(u){for(var m=p,g=-1;m>g;m--){var v=f[m];if(v.get("_type")===l.type){if(-h===l.offset){return e.findById(v.get("_id"))}h++}}}else{for(var m=p,g=f.length;m<g;m++){var v=f[m];if(v.get("_type")===l.type){if(h===l.offset){return e.findById(v.get("_id"))}h++}}}return undefined}});function i(e){var t=e.substr(0,_.indexOf(e," "));var i=parseInt(e.substr(t.length));t=t.substr(1);return{type:t,offset:i}}});define("extensions/adapt-contrib-trickle/js/handlers/buttonView",["core/js/adapt","core/js/views/componentView"],function(e,t){var i="_isComplete";var s=Backbone.View.extend({isStepLocking:false,hasStepLocked:false,isStepLocked:false,isStepLockFinished:false,hasStepPreCompleted:false,
isWaitingForClick:false,allowVisible:false,allowEnabled:true,overlayShownCount:0,el:function(){this.setupPreRender();return Handlebars.templates["trickle-button"](this.model.toJSON())},setupPreRender:function(){this.setupButtonVisible();this.setupButtonEnabled()},setupButtonVisible:function(){var t=e.trickle.getModelConfig(this.model);this.allowVisible=false;t._button._isVisible=false;if(t._button._styleBeforeCompletion==="visible"){this.allowVisible=true;if(t._button._autoHide&&t._button._isFullWidth){t._button._isVisible=false}else{t._button._isVisible=true}}},setupButtonEnabled:function(){var t=e.trickle.getModelConfig(this.model);if(t._stepLocking._isCompletionRequired===false){this.allowEnabled=true;t._button._isDisabled=false}else if(t._button._styleBeforeCompletion==="visible"){this.allowEnabled=false;t._button._isDisabled=true}else{t._button._isDisabled=false;this.allowEnabled=true}},events:{"click button":"onButtonClick"},initialize:function(e){this.getCompletionAttribute();this.debounceCheckAutoHide();this.setupStepLocking();this.setupEventListeners()},getCompletionAttribute:function(){var t=e.trickle.getModelConfig(e.config);if(!t)return;if(t._completionAttribute){i=t._completionAttribute}},setupStepLocking:function(){var t=e.trickle.getModelConfig(this.model);if(t._stepLocking._isEnabled){this.isStepLocked=true}else{this.isStepLocked=false}},setupEventListeners:function(){this.listenTo(e,{"trickle:overlay":this.onOverlay,"trickle:unoverlay":this.onUnoverlay,"trickle:steplock":this.onStepLock,"trickle:stepunlock":this.onStepUnlock,"trickle:skip":this.onSkip,"trickle:kill":this.onKill,"trickle:update":this.onUpdate,remove:this.onRemove});this.listenTo(this.model,"change:"+i,this.onCompletion)},debounceCheckAutoHide:function(){this.checkButtonAutoHideSync=_.bind(this.checkButtonAutoHide,this);this.checkButtonAutoHide=_.debounce(this.checkButtonAutoHideSync,100)},checkButtonAutoHide:function(){if(!this.allowVisible){this.setButtonVisible(false);return}var t=e.trickle.getModelConfig(this.model);if(!t._button._autoHide){this.setButtonVisible(true);return}else if(this.overlayShownCount>0){this.setButtonVisible(false);return}var i=this.$el.onscreen();var s=i.bottom>-100;if(i.onscreen||s){this.setButtonVisible(true)}else{this.setButtonVisible(false)}},setButtonVisible:function(t){var i=e.trickle.getModelConfig(this.model);if(!t){this.$(".component-inner").addClass("display-none");i._button._isVisible=false}else{this.$(".component-inner").removeClass("display-none");i._button._isVisible=true}},checkButtonEnabled:function(e){if(!this.allowEnabled){this.setButtonEnabled(false)}else{this.setButtonEnabled(true)}},setButtonEnabled:function(t){var i=e.trickle.getModelConfig(this.model);if(t){this.$("button").removeClass("disabled").removeAttr("disabled");i._button._isDisabled=true;this.$(".aria-label").a11y_cntrl(false)}else{this.$("button").addClass("disabled").attr("disabled","disabled");i._button._isDisabled=false}},onStepLock:function(t){if(!this.isViewMatch(t))return;this.hasStepLocked=true;this.isStepLocking=true;this.overlayShownCount=0;var s=e.trickle.getModelConfig(this.model);if(this.isButtonEnabled()){var n=s._stepLocking._isLockedOnRevisit&&this.model.get(i);if(n){this.isStepLocked=true;this.model.set("_isTrickleAutoScrollComplete",false);e.trigger("trickle:wait");this.allowVisible=true;this.checkButtonAutoHide()}else if(this.hasStepPreCompleted){this.isStepLocked=true;this.model.set("_isTrickleAutoScrollComplete",false);this.allowVisible=true;this.stepCompleted()}this.setupOnScreenListener()}},onOverlay:function(){this.overlayShownCount++},onUnoverlay:function(){this.overlayShownCount--;this.checkButtonAutoHide()},setupOnScreenListener:function(){var t=e.trickle.getModelConfig(this.model);if(t._button._autoHide){this.$el.on("onscreen",this.checkButtonAutoHideSync)}},isViewMatch:function(e){return e.model.get("_id")===this.model.get("_id")},isButtonEnabled:function(){var t=e.trickle.getModelConfig(this.model);if(!t._isEnabled||!t._button._isEnabled)return false;return true},onCompletion:function(e,t){if(t===false)return;this.hasStepPreCompleted=true;if(!this.hasStepLocked)return;var i=this;_.delay(function(){_.defer(_.bind(function(){i.stepCompleted()},i))},1e3)},stepCompleted:function(){if(this.isStepLockFinished)return;this.isStepLocked=false;this.allowVisible=false;this.allowEnabled=false;if(this.isButtonEnabled()){if(this.isStepLocking){this.isStepLocked=true;this.isWaitingForClick=true;e.trigger("trickle:wait")}else{this.isStepLockFinished=true}this.allowVisible=true;this.allowEnabled=true}this.model.set("_isTrickleAutoScrollComplete",false);this.checkButtonAutoHide();this.checkButtonEnabled()},onButtonClick:function(){if(this.isStepLocked){e.trigger("trickle:unwait");this.isStepLocked=false;this.isStepLockFinished=true}else{this.model.set("_isTrickleAutoScrollComplete",false);_.defer(_.bind(function(){e.trickle.scroll(this.model)},this))}var t=this.model.get("_trickle");switch(t._button._styleAfterClick){case"hidden":this.allowVisible=false;this.checkButtonAutoHideSync();break;case"disabled":this.allowEnabled=false;this.checkButtonAutoHideSync()}},onUpdate:function(){var t=e.trickle.getModelConfig(this.model);if(t._button._autoHide&&this.isStepLocking){this.$el.off("onscreen",this.checkButtonAutoHideSync)}var i=this.$el;var s=$(Handlebars.templates["trickle-button"](this.model.toJSON()));i.replaceWith(s);this.setElement(s);if(t._button._autoHide&&this.isStepLocking){this.$el.on("onscreen",this.checkButtonAutoHideSync)}},onStepUnlock:function(e){if(!this.isViewMatch(e))return;this.$el.off("onscreen",this.checkButtonAutoHideSync);this.isStepLocking=false;this.overlayShownCount=0},onSkip:function(){if(!this.isStepLocking)return;this.onKill()},onKill:function(){this.$el.off("onscreen",this.checkButtonAutoHideSync);if(this.isWaitingForClick){this.model.set("_isTrickleAutoScrollComplete",true)}this.isWaitingForClick=false;this.isStepLocked=false;this.isStepLocking=false;this.allowVisible=false;this.allowEnabled=false;this.isStepLockFinished=true;this.model.set("_isTrickleAutoScrollComplete",false);this.checkButtonAutoHide();this.checkButtonEnabled()},onRemove:function(){if(this.isWaitingForClick){this.model.set("_isTrickleAutoScrollComplete",true)}this.isWaitingForClick=false;this.$el.off("onscreen",this.checkButtonAutoHideSync);this.isStepLocking=true;this.remove()}});return s});define("extensions/adapt-contrib-trickle/js/handlers/button",["core/js/adapt","./buttonView"],function(e,t){var i=_.extend({buttonViews:null,initialize:function(){this.listenToOnce(e,{"app:dataReady":this.onAppDataReady,remove:this.onRemove})},onAppDataReady:function(){this.buttonViews={};this.setupEventListeners()},setupEventListeners:function(){this.listenTo(e,{"trickle:preRender":this.onPreRender,"trickle:postRender":this.onPostRender})},onPreRender:function(e){if(!this.isTrickleEnabled(e.model))return;this.setupConfigDefaults(e.model);this.buttonViews[e.model.get("_id")]=new t({model:e.model})},onPostRender:function(e){if(!this.isTrickleEnabled(e.model))return;e.$el.append(this.buttonViews[e.model.get("_id")].$el)},isTrickleEnabled:function(t){var i=e.trickle.getModelConfig(t);if(!i||!i._isEnabled)return false;if(i._onChildren&&t.get("_type")==="article")return false;return true},setupConfigDefaults:function(t){if(t.get("_isTrickleButtonConfigured"))return;var i=e.trickle.getModelConfig(t);i._button=_.extend({_isEnabled:true,_styleBeforeCompletion:"hidden",_styleAfterClick:"hidden",_isFullWidth:true,_autoHide:true,_className:"",text:"Continue",startText:"Begin",finalText:"Finish",_component:"trickle-button",_isLocking:true,_isVisible:false,_isDisabled:false},i._button);if(i._button._isFullWidth){i._stepLocking._isEnabled=true;i._button._styleAfterClick="hidden"}else{i._button._autoHide=false}e.trickle.setModelConfig(t,i);t.set("_isTrickleButtonConfigured",true)},onRemove:function(){this.buttonViews={}}},Backbone.Events);i.initialize();return i});define("extensions/adapt-contrib-trickle/js/handlers/completion",["core/js/adapt"],function(e){var t="_isComplete";var i=_.extend({isStepLocking:false,isCompleted:false,stepModel:null,initialize:function(){this.listenToOnce(e,"app:dataReady",this.onAppDataReady)},onAppDataReady:function(){this.getCompletionAttribute();this.setupEventListeners()},getCompletionAttribute:function(){var i=e.trickle.getModelConfig(e.config);if(!i)return;if(i._completionAttribute){t=i._completionAttribute}},setupEventListeners:function(){this.listenTo(e,{"trickle:descendants":this.onDescendants,"trickle:steplock":this.onStepLock,"trickle:stepunlock":this.onStepUnlock,"trickle:kill":this.onKill,remove:this.onRemove})},onDescendants:function(i){_.each(i.descendantsParentFirst,_.bind(function(i){var s=e.trickle.getModelConfig(i);if(!s)return;s._wasCompletedPreRender=i.get(t)},this))},onStepLock:function(i){var s=i.model.get(t);var n=e.trickle.getModelConfig(i.model);if(!n._stepLocking._isCompletionRequired&&!n._stepLocking._isLockedOnRevisit){if(s){e.trigger("trickle:continue",i)}return}if(n._stepLocking._isCompletionRequired&&s&&n._wasCompletedPreRender){e.trigger("trickle:continue",i);return}e.trigger("trickle:wait");if(s){_.defer(function(){e.trigger("trickle:unwait")});return}i.model.set("_isTrickleAutoScrollComplete",false);this.isCompleted=false;this.isStepLocking=true;this.stepModel=i.model;this.listenTo(this.stepModel,"change:"+t,this.onCompletion)},onCompletion:function(e,t){if(t===false)return;var i=this;_.delay(function(){_.defer(_.bind(function(){i.stepCompleted()},i))},1e3)},stepCompleted:function(){if(!this.isStepLocking)return;if(this.isCompleted)return;this.isCompleted=true;this.stopListening(this.stepModel,"change:"+t,this.onCompletion);_.defer(function(){e.trigger("trickle:unwait")})},onKill:function(){this.onStepUnlock()},onRemove:function(){this.onStepUnlock()},onStepUnlock:function(){this.stopListening(this.stepModel,"change:"+t,this.onCompletion);this.isStepLocking=false;this.stepModel=null;this.isCompleted=false}},Backbone.Events);i.initialize();return i});define("extensions/adapt-contrib-trickle/js/handlers/notify",["core/js/adapt"],function(e){var t=_.extend({isStepLocking:false,isNotifyOpen:false,initialize:function(){this.listenToOnce(e,"app:dataReady",this.onAppDataReady)},onAppDataReady:function(){this.setupEventListeners()},setupEventListeners:function(){this.listenTo(e,{"trickle:steplock":this.onStepLock,"notify:opened":this.onNotifyOpened,"notify:closed":this.onNotifyClosed,"trickle:stepunlock":this.onStepUnlock,remove:this.onRemove})},onStepLock:function(e){this.isStepLocking=true},onNotifyOpened:function(){if(!this.isStepLocking)return;this.isNotifyOpen=true;e.trigger("trickle:overlay");e.trigger("trickle:wait")},onNotifyClosed:function(){if(!this.isStepLocking)return;if(!this.isNotifyOpen)return;this.isNotifyOpen=false;e.trigger("trickle:unoverlay");e.trigger("trickle:unwait")},onStepUnlock:function(){this.isStepLocking=false},onRemove:function(){this.onStepUnlock()}},Backbone.Events);t.initialize();return t});define("extensions/adapt-contrib-trickle/js/handlers/resize",["core/js/adapt"],function(e){var t=_.extend({isStepLocking:false,stepView:null,initialize:function(){this.listenToOnce(e,"app:dataReady",this.onAppDataReady)},onAppDataReady:function(){this.debounceOnResize();this.setupEventListeners()},debounceOnResize:function(){this.onResize=_.debounce(_.bind(this.onResize,this),10)},setupEventListeners:function(){this.listenTo(e,{"trickle:steplock":this.onStepLock,"trickle:resize":this.onTrickleResize,"trickle:stepunlock":this.onStepUnlock,"trickle:kill":this.onKill,"trickle:finished":this.onFinished,remove:this.onRemove})},onStepLock:function(t){this.isStepLocking=true;this.stepView=t;$(window).on("resize",this.onResize);$(".page").on("resize",this.onResize);_.defer(function(){e.trigger("trickle:resize")})},onResize:function(){if(!this.isStepLocking)return;e.trigger("trickle:resize")},onTrickleResize:function(){if(!this.isStepLocking)return;var e=this.stepView.$el.offset();var t=this.stepView.$el.height();var i=parseInt($("#wrapper").css("padding-top")||"0");var s=e["top"]-i+t;$("#wrapper").css("height",s)},onStepUnlock:function(e){this.isStepLocking=false;this.stepView=null;$(window).off("resize",this.onResize);$(".page").off("resize",this.onResize)},onKill:function(){this.onFinished();this.onStepUnlock()},onFinished:function(){$("#wrapper").css("height","")},onRemove:function(){this.onStepUnlock();this.stepView=null}},Backbone.Events);t.initialize();return t});define("extensions/adapt-contrib-trickle/js/handlers/tutor",["core/js/adapt"],function(e){var t=_.extend({stepLockedId:null,isStepLocking:false,isTutorOpen:false,initialize:function(){this.listenToOnce(e,"app:dataReady",this.onAppDataReady)},onAppDataReady:function(){this.setupEventListeners()},setupEventListeners:function(){this.listenTo(e,{"trickle:steplock":this.onStepLock,"tutor:opened":this.onTutorOpened,"tutor:closed":this.onTutorClosed,"trickle:stepunlock":this.onStepUnlock,remove:this.onRemove})},onStepLock:function(e){if(e){this.stepLockedId=e.model.get("_id")}this.isStepLocking=true},onTutorOpened:function(t,i){if(!this.isStepLocking)return;if(!this.isOriginStepLocked(t))return;this.isTutorOpen=true;e.trigger("trickle:overlay");e.trigger("trickle:wait")},isOriginStepLocked:function(e){if(!e||!this.stepLockedId)return true;var t=e.model.getAncestorModels();var i=_.find(t,function(e){return e.get("_id")===this.stepLockedId},this);if(!i)return false;return true},onTutorClosed:function(t,i){if(!this.isStepLocking)return;if(!this.isTutorOpen)return;if(!this.isOriginStepLocked(t))return;this.isTutorOpen=false;e.trigger("trickle:unoverlay");e.trigger("trickle:unwait")},onStepUnlock:function(){this.isStepLocking=false;this.stepLockedId=null},onRemove:function(){this.onStepUnlock()}},Backbone.Events);t.initialize();return t});define("extensions/adapt-contrib-trickle/js/handlers/visibility",["core/js/adapt"],function(e){var t=_.extend({isStepLocking:false,trickleModel:null,initialize:function(){this.listenToOnce(e,"app:dataReady",this.onAppDataReady)},onAppDataReady:function(){this.setupEventListeners()},setupEventListeners:function(){this.listenTo(e,{"trickle:steplock":this.onStepLock,"trickle:visibility":this.onVisibility,"trickle:stepunlock":this.onStepUnlock,"trickle:kill":this.onKill,"trickle:finished":this.onFinished,remove:this.onRemove})},onStepLock:function(t){this.isStepLocking=true;this.trickleModel=t.model;e.trigger("trickle:visibility")},onVisibility:function(){if(!this.isStepLocking)return;if(!e.trickle.pageView)return;var t=e.trickle.pageView.descendantsParentFirst;var i=this.trickleModel.get("_id");var s=this.trickleModel.get("_type");var n=_.findIndex(t,function(e){if(e.get("_id")===i)return true});_.each(t,function(e,t){var r=e.findDescendantModels("components");if(t<=n){e.set("_isVisible",true,{pluginName:"trickle"});_.each(r,function(e){e.set("_isVisible",true,{pluginName:"trickle"})})}else{if(s==="article"&&e.get("_type")==="block"){if(e.get("_parentId")===i){e.set("_isVisible",true,{pluginName:"trickle"});_.each(r,function(e){e.set("_isVisible",true,{pluginName:"trickle"})});return}}e.set("_isVisible",false,{pluginName:"trickle"});_.each(r,function(e){e.set("_isVisible",false,{pluginName:"trickle"})})}})},onStepUnlock:function(e){this.isStepLocking=false;this.trickleModel=null},onKill:function(){this.onFinished();this.onStepUnlock()},onFinished:function(){var t=e.trickle.pageView.descendantsParentFirst;_.each(t,function(e){e.set("_isVisible",true,{pluginName:"trickle"});var t=e.findDescendantModels("components");_.each(t,function(e){e.set("_isVisible",true,{pluginName:"trickle"})})})},onRemove:function(){this.onStepUnlock()}},Backbone.Events);t.initialize();return t});define("extensions/adapt-contrib-trickle/js/handlers/done",["core/js/adapt"],function(e){var t=_.extend({initialize:function(){this.listenToOnce(e,"app:dataReady",this.onAppDataReady)},onAppDataReady:function(){this.setupEventListeners()},setupEventListeners:function(){this.onDone=_.debounce(_.bind(this.onDone),50);this.listenTo(e,{"trickle:steplock":this.onDone,"trickle:stepunlock":this.onDone,"trickle:continue":this.onDone,"trickle:finished":this.onDone})},onDone:function(){e.trigger("trickle:done")}},Backbone.Events);t.initialize();return t});define("extensions/adapt-contrib-trickle/js/adapt-contrib-trickle",["coreJS/adapt","./pageView","libraries/jquery.resize","./lib/adaptModelExtension","./handlers/button","./handlers/completion","./handlers/notify","./handlers/resize","./handlers/tutor","./handlers/visibility","./handlers/done"],function(e,t){e.trickle=_.extend({model:null,pageView:null,initialize:function(){this.listenToOnce(e,{"app:dataReady":this.onAppDataReady})},onAppDataReady:function(){this.getCourseModel();if(!this.isCourseEnabled())return;this.setupListeners()},getCourseModel:function(){this.model=e.course},isCourseEnabled:function(){var e=this.getModelConfig(this.model);if(e&&e._isEnabled===false)return false;return true},getModelConfig:function(e){return e.get("_trickle")},setModelConfig:function(e,t){return e.set("_trickle",t)},setupListeners:function(){this.listenTo(e,{"pageView:preRender":this.onPagePreRender,remove:this.onRemove})},onPagePreRender:function(e){this.pageView=new t({model:e.model,el:e.el})},getCompletionAttribute:function(){var t=this.getModelConfig(e.config);if(!t)return"_isComplete";return t._completionAttribute||"_isComplete"},scroll:function(t){_.delay(_.bind(function(){if(!this.shouldScrollPage(t))return;var i=e.trickle.getModelConfig(t);var s=i._scrollTo;if(s===undefined)s="@block +1";t.set("_isTrickleAutoScrollComplete",true);var n="";switch(s.substr(0,1)){case"@":var r=t.findRelative(s,{filterNotAvailable:true});if(r===undefined)return;n=r.get("_id");break;case".":n=s.substr(1,s.length-1);break;default:n=s}if(n=="")return;var o=t.get("_trickle")._scrollDuration||500;e.scrollTo("."+n,{duration:o})},this),250)},shouldScrollPage:function(t){var i=e.trickle.getModelConfig(t);if(!i||!i._isEnabled)return false;var s=t.get("_isTrickleAutoScrollComplete");if(s)return false;var n=!i._autoScroll;if(n)return false;var r=t.get("_type")==="article"&&i._onChildren;if(r)return false;return true},onRemove:function(){}},Backbone.Events);e.trickle.initialize();return e.trickle});define("extensions/adapt-contrib-tutor/js/adapt-contrib-tutor",["coreJS/adapt"],function(e){e.on("questionView:showFeedback",function(t){var i={title:t.model.get("feedbackTitle"),body:t.model.get("feedbackMessage")+'<button class="cust-close-btn">Close</button>'};var s={};var n=[];if(t.model.has("_isCorrect")){if(t.model.get("_isCorrect")){n.push("correct")}else{if(t.model.has("_isAtLeastOneCorrectSelection")){if(t.model.get("_isAtLeastOneCorrectSelection")){n.push("partially-correct")}else{n.push("incorrect")}}else{n.push("incorrect")}}}if(t.model.has("_component")){n.push("component-"+t.model.get("_component"))}else if(t.model.has("_extension")){n.push("extension-"+t.model.get("_extension"))}s["data-adapt-id"]=t.model.get("_id");i._classes=n.join(" ");i._attributes=s;e.once("notify:closed",function(){e.trigger("tutor:closed",t,i)});e.trigger("notify:popup",i);e.trigger("tutor:opened",t,i);this.listenToOnce(e,"popup:opened",function(e){$(".notify-type-popup").scrollTo(0);e.parent().addClass(t.model.get("_id"));e.find(".cust-close-btn").on("click",function(){$(".notify-popup-done").click()})});t.model.trigger("questionView:showFeedback",t.model)})});(function(e){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=e()}else if(typeof define==="function"&&define.amd){define("extensions/adapt-exportFeedback/library/docxtemplater/docxtemplater",[],e)}else{var t;if(typeof window!=="undefined"){t=window}else if(typeof global!=="undefined"){t=global}else if(typeof self!=="undefined"){t=self}else{t=this}t.Docxtemplater=e()}})(function(){var e,t,i;return function s(e,t,i){function n(o,a){if(!t[o]){if(!e[o]){var l=typeof require=="function"&&require;if(!a&&l)return l(o,!0);if(r)return r(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var d=t[o]={exports:{}};e[o][0].call(d.exports,function(t){var i=e[o][1][t];return n(i?i:t)},d,d.exports,s,e,t,i)}return t[o].exports}var r=typeof require=="function"&&require;for(var o=0;o<i.length;o++)n(i[o]);return n}({1:[function(e,t,i){"use strict";function s(e,t,i){if(t in e){Object.defineProperty(e,t,{value:i,enumerable:true,configurable:true,writable:true})}else{e[t]=i}return e}var n=e("xmldom").DOMParser;var r=e("xmldom").XMLSerializer;var o=e("./errors"),a=o.throwXmlTagNotFound,l=o.throwDecodeUTF8Error;var c={};function d(e){return s({},"get",function t(i){if(e==="."){return i}return i[e]})}c.defaults={nullGetter:function f(e){if(!e.module){return"undefined"}if(e.module==="rawxml"){return""}return""},parser:d,delimiters:{start:"{",end:"}"}};c.mergeObjects=function(){var e={};var t=void 0,i=void 0;for(var s=0;s<arguments.length;s+=1){t=arguments[s];i=Object.keys(t);for(var n=0;n<i.length;n+=1){e[i[n]]=t[i[n]]}}return e};c.xml2str=function(e){var t=new r;return t.serializeToString(e)};c.decodeUtf8=function(e){try{if(e===undefined){return undefined}return decodeURIComponent(escape(c.convertSpaces(e)))}catch(t){l(e)}};c.encodeUtf8=function(e){return unescape(encodeURIComponent(e))};c.str2xml=function(e,t){var i=new n({errorHandler:t});return i.parseFromString(e,"text/xml")};c.charMap={"&":"&amp;","'":"&apos;","<":"&lt;",">":"&gt;"};var u=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g;c.escapeRegExp=function(e){return e.replace(u,"\\$&")};c.charMapRegexes=Object.keys(c.charMap).map(function(e){var t=c.charMap[e];return{rstart:new RegExp(c.escapeRegExp(t),"g"),rend:new RegExp(c.escapeRegExp(e),"g"),start:t,end:e}});c.wordToUtf8=function(e){var t=void 0;for(var i=0,s=c.charMapRegexes.length;i<s;i++){t=c.charMapRegexes[i];e=e.replace(t.rstart,t.end)}return e};c.utf8ToWord=function(e){if(typeof e!=="string"){e=e.toString()}var t=void 0;for(var i=0,s=c.charMapRegexes.length;i<s;i++){t=c.charMapRegexes[i];e=e.replace(t.rend,t.start)}return e};c.cloneDeep=function(e){return JSON.parse(JSON.stringify(e))};c.concatArrays=function(e){var t=[];for(var i=0;i<e.length;i++){var s=e[i];for(var n=0,r=s.length;n<r;n++){t.push(s[n])}}return t};var h=new RegExp(String.fromCharCode(160),"g");c.convertSpaces=function(e){return e.replace(h," ")};c.pregMatchAll=function(e,t){var i=[];var s=void 0;while((s=e.exec(t))!=null){i.push({array:s,offset:s.index})}return i};c.sizeOfObject=function(e){return Object.keys(e).length};c.getRight=function(e,t,i){for(var s=i,n=e.length;s<n;s++){var r=e[s];if(r.value==="</"+t+">"){return s}}a({position:"right",element:t,parsed:e,index:i})};c.getLeft=function(e,t,i){for(var s=i;s>=0;s--){var n=e[s];if(n.value.indexOf("<"+t)===0&&[">"," "].indexOf(n.value[t.length+1])!==-1){return s}}a({position:"left",element:t,parsed:e,index:i})};t.exports=c},{"./errors":2,xmldom:18}],2:[function(e,t,i){"use strict";function s(e){return e[0]}function n(e){return e[e.length-1]}function r(e){this.name="GenericError";this.message=e;this.stack=new Error(e).stack}r.prototype=Error.prototype;function o(e){this.name="TemplateError";this.message=e;this.stack=new Error(e).stack}o.prototype=new r;function a(e){this.name="ScopeParserError";this.message=e;this.stack=new Error(e).stack}a.prototype=new r;function l(e){this.name="InternalError";this.properties={explanation:"InternalError"};this.message=e;this.stack=new Error(e).stack}l.prototype=new r;function c(e){var t=new o("Multi error");t.properties={errors:e,id:"multi_error",explanation:"The template has multiple errors"};throw t}function d(e){var t=new o("Unopened tag");t.properties={xtag:n(e.xtag.split(" ")),id:"unopened_tag",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag beginning with "'+e.xtag.substr(0,10)+'" is unopened'};return t}function u(e){var t=new o("Unclosed tag");t.properties={xtag:s(e.xtag.split(" ")).substr(1),id:"unclosed_tag",context:e.xtag,offset:e.offset,lIndex:e.lIndex,explanation:'The tag beginning with "'+e.xtag.substr(0,10)+'" is unclosed'};return t}function h(e){var t=new o('No tag "'+e.element+'" was found at the '+e.position);t.properties={id:"no_xml_tag_found_at_"+e.position,explanation:'No tag "'+e.element+'" was found at the '+e.position,parsed:e.parsed,index:e.index,element:e.element};throw t}function f(e){var t=new l("End");t.properties={id:"utf8_decode",data:e,explanation:"Could not decode string to UTF8"};throw t}function p(e){var t=new l("Content must be a string");t.properties.id="xmltemplater_content_must_be_string";t.properties.type=e;throw t}function m(e){var t=new o("Raw tag not in paragraph");var i=e.part.value;var s=e.part.offset;t.properties={id:"raw_tag_outerxml_invalid",explanation:'The tag "'+i+'" is not inside a paragraph',rootError:e.rootError,xtag:i,offset:s,postparsed:e.postparsed,expandTo:e.expandTo,index:e.index};throw t}function g(e){var t=new o("Raw tag should be the only text in paragraph");var i=e.part.value;t.properties={id:"raw_xml_tag_should_be_only_text_in_paragraph",explanation:'The tag "'+i+'" should be the only text in this paragraph',xtag:e.part.value,offset:e.part.offset,paragraphParts:e.paragraphParts};throw t}function v(e){var t=e.location;var i=t==="start"?"unclosed":"unopened";var s=t==="start"?"Unclosed":"Unopened";var n=new o(s+" loop");var r=e.part.value;n.properties={id:i+"_loop",explanation:'The loop with tag "'+r+'" is '+i,xtag:r};return n}function _(e){var t=e.tags;var i=new o("Closing tag does not match opening tag");i.properties={id:"closing_tag_does_not_match_opening_tag",explanation:'The tag "'+t[0].value+'" is closed by the tag "'+t[1].value+'"',openingtag:t[0].value,offset:[t[0].offset,t[1].offset],closingtag:t[1].value};return i}function b(e){var t=e.tag,i=e.rootError;var s=new a("Scope parser compilation failed");s.properties={id:"scopeparser_compilation_failed",tag:t,explanation:'The scope parser for the tag "'+t+'" failed to compile',rootError:i};return s}function w(e){var t=new o('Unimplemented tag type "'+e.type+'"');t.properties={part:e,id:"unimplemented_tag_type"};throw t}function y(e){var t=new l("Malformed xml");t.properties={part:e,id:"malformed_xml"};throw t}function C(e){throw new l('Location should be one of "start" or "end" (given : '+e.location+")")}function k(e){var t=new l("The filetype for this file could not be identified, is this file corrupted ?");t.properties={part:e,id:"malformed_xml"};throw t}t.exports={XTError:r,XTTemplateError:o,XTInternalError:l,XTScopeParserError:a,throwMultiError:c,throwXmlTagNotFound:h,throwDecodeUTF8Error:f,throwContentMustBeString:p,getUnmatchedLoopException:v,throwRawTagShouldBeOnlyTextInParagraph:g,throwRawTagNotInParagraph:m,getClosingTagNotMatchOpeningTag:_,throwUnimplementedTagType:w,getScopeCompilationError:b,getUnopenedTagException:d,getUnclosedTagException:u,throwMalformedXml:y,throwFileTypeNotIdentified:k,throwLocationInvalid:C}},{}],3:[function(e,t,i){"use strict";var s=e("./modules/loop");var n=e("./modules/space-preserve");var r=e("./modules/rawxml");var o=e("./modules/expand-pair-trait");var a=e("./modules/render");var l={getTemplatedFiles:function d(e){var t=e.file(/ppt\/(slides|slideMasters)\/(slide|slideMaster)\d+\.xml/).map(function(e){return e.name});return t.concat(["ppt/presentation.xml"])},textPath:"ppt/slides/slide1.xml",tagsXmlTextArray:["a:t","m:t"],tagsXmlLexedArray:["p:sp","a:tc","a:tr","a:table","a:p","a:r"],tagRawXml:"p:sp",tagTextXml:"a:t",baseModules:[s,o,r,a]};var c={getTemplatedFiles:function u(e){var t=e.file(/word\/(header|footer)\d+\.xml/).map(function(e){return e.name});return t.concat(["word/document.xml"])},textPath:"word/document.xml",tagsXmlTextArray:["w:t","m:t"],tagsXmlLexedArray:["w:tc","w:tr","w:table","w:p","w:r"],tagRawXml:"w:p",tagTextXml:"w:t",baseModules:[s,n,o,r,a]};t.exports={docx:c,pptx:l}},{"./modules/expand-pair-trait":7,"./modules/loop":8,"./modules/rawxml":9,"./modules/render":10,"./modules/space-preserve":11}],4:[function(e,t,i){"use strict";var s=e("./errors"),n=s.getUnclosedTagException,r=s.getUnopenedTagException,o=s.throwMalformedXml;var a=e("./doc-utils"),l=a.concatArrays;function c(e,t){return e[0]<=t.offset&&t.offset<e[1]}function d(e,t){if(e.type==="tag"&&e.position==="start"&&e.text){if(t){o(e)}return true}if(e.type==="tag"&&e.position==="end"&&e.text){if(!t){o(e)}return false}return t}function u(e,t){return e.offset-t.offset}function h(e){var t="start";var i=1;if(e[e.length-2]==="/"){t="selfclosing"}if(e[1]==="/"){i=2;t="end"}var s=e.indexOf(" ");var n=s===-1?e.length-1:s;return{tag:e.slice(i,n),position:t}}function f(e,t,i){var s=0;var n=e.length;var r=l([t.map(function(e){return{tag:e,text:true}}),i.map(function(e){return{tag:e,text:false}})]).reduce(function(e,t){e[t.tag]=t.text;return e},{});var o=[];while(s<n){s=e.indexOf("<",s);if(s===-1){break}var a=s;s=e.indexOf(">",s);var c=e.slice(a,s+1);var d=h(c),u=d.tag,f=d.position;var p=r[u];if(p==null){continue}o.push({type:"tag",position:f,text:p,offset:a,value:c})}return o}function p(e,t,i){if(e.length===0){return[]}var s=[];var o=false;var a={offset:0};var l=void 0;var c=0;e.forEach(function(e){while(i[c+1]){if(i[c+1].offset>e.offset){break}c++}l=t.substr(a.offset,e.offset-a.offset);if(e.position==="start"&&o||e.position==="end"&&!o){if(e.position==="start"){s.push(n({xtag:l,offset:a.offset}));e.error=true}else{s.push(r({xtag:l,offset:e.offset}));e.error=true}}else{o=!o}a=e});var d={offset:t.length};l=t.substr(a.offset,d.offset-a.offset);if(o){s.push(n({xtag:l,offset:a.offset}));d.error=true}return s}function m(e,t,i){var s=[];var n=-1;do{n=e.indexOf(t,n+1);if(n!==-1){s.push({offset:n,position:i})}}while(n!==-1);return s}function g(e){var t=this;this.innerContentParts=e;this.full="";this.parseDelimiters=function(e){t.full=t.innerContentParts.map(function(e){return e.value}).join("");var i=l([m(t.full,e.start,"start"),m(t.full,e.end,"end")]).sort(u);var s=0;var n=t.innerContentParts.map(function(e){s+=e.value.length;return{offset:s-e.value.length,lIndex:e.lIndex}});var r=p(i,t.full,n);var o={start:e.start.length,end:e.end.length};var a=0;var d=0;t.parsed=n.map(function(e,t){var s=e.offset;var n=[s,s+this.innerContentParts[t].value.length];var r=this.innerContentParts[t].value;var l=[];while(d<i.length&&c(n,i[d])){l.push(i[d]);d++}var u=[];var h=0;if(a>0){h=a;a=0}l.forEach(function(e){var t=r.substr(h,e.offset-s-h);if(t.length>0){u.push({type:"content",value:t,offset:h+s});h+=t.length}var i={type:"delimiter",position:e.position,offset:h+s};if(e.error){i.error=e.error}u.push(i);h=e.offset-s+o[e.position]});a=h-r.length;var f=r.substr(h);if(f.length>0){u.push({type:"content",value:f,offset:s})}return u},t);t.errors=r}}t.exports={parse:function v(e,t){var i=false;var s=[];e.forEach(function(e){i=d(e,i);if(i&&e.type==="content"){s.push(e)}});var n=new g(s);n.parseDelimiters(t);var r=[];var o=0;e.forEach(function(e){i=d(e,i);if(e.type==="content"){e.position=i?"insidetag":"outsidetag"}if(i&&e.type==="content"){Array.prototype.push.apply(r,n.parsed[o].map(function(e){if(e.type==="content"){e.position="insidetag"}return e}));o++}else{r.push(e)}});return{errors:n.errors,lexed:r}},xmlparse:function _(e,t){var i=f(e,t.text,t.other);var s=0;var n=i.reduce(function(t,i){var n=e.substr(s,i.offset-s);if(n.length>0){t.push({type:"content",value:n})}s=i.offset+i.value.length;delete i.offset;if(i.value.length>0){t.push(i)}return t},[]).map(function(e,t){e.lIndex=t;return e});var r=e.substr(s);if(r.length>0){n.push({type:"content",value:r})}return n}}},{"./doc-utils":1,"./errors":2}],5:[function(e,t,i){"use strict";function s(e,t){var i=-1;for(var s=0,n=e.length;s<n;s++){if(t[s]>=e[s].length){continue}if(i===-1||e[s][t[s]].offset<e[i][t[i]].offset){i=s}}if(i===-1){throw new Error("minIndex negative")}return i}t.exports=function(e){var t=e.reduce(function(e,t){return e+t.length},0);e=e.filter(function(e){return e.length>0});var i=new Array(t);
var n=e.map(function(){return 0});var r=0;while(r<=t-1){var o=s(e,n);i[r]=e[o][n[o]];n[o]++;r++}return i}},{}],6:[function(e,t,i){"use strict";function s(){}function n(e){return e}t.exports=function(e){var t={set:s,parse:s,render:s,getTraits:s,optionsTransformer:n,errorsTransformer:n,getRenderedMap:n,postparse:n};if(Object.keys(t).every(function(t){return!e[t]})){throw new Error("This module cannot be wrapped, because it doesn't define any of the necessary functions")}Object.keys(t).forEach(function(i){e[i]=e[i]||t[i]});return e}},{}],7:[function(e,t,i){"use strict";var s="expandPair";var n=e("../mergesort");var r=e("../doc-utils");var o=e("../module-wrapper");var a=e("../traits"),l=a.getExpandToDefault;var c=e("../errors"),d=c.getUnmatchedLoopException,u=c.getClosingTagNotMatchOpeningTag,h=c.throwLocationInvalid;function f(e){switch(e.location){case"start":return 1;case"end":return-1;default:h(e)}}function p(e){var t=[];var i=[];if(e.length===0){return{pairs:i,errors:t}}var s=1;var n=e[0];if(n.part.location==="start"){for(var r=1;r<e.length;r++){var o=e[r];s+=f(o.part);if(s===0){var a=p(e.slice(r+1));if(o.part.value!==n.part.value&&o.part.value!==""){t.push(u({tags:[n.part,o.part]}))}else{i=[[n,o]]}return{pairs:i.concat(a.pairs),errors:t.concat(a.errors)}}}}var l=n.part;t.push(d({part:l,location:l.location}));var c=p(e.slice(1));return{pairs:c.pairs,errors:t.concat(c.errors)}}var m={name:"ExpandPairTrait",postparse:function g(e,t){var i=t.getTraits,o=t.postparse;var a=i(s,e);a=a.map(function(e){return e||[]});a=n(a);var c=p(a),d=c.pairs,u=c.errors;var h=d.map(function(t){var i=t[0].part.expandTo;if(i==="auto"){i=l(e.slice(t[0].offset,t[1].offset))}if(!i){return[t[0].offset,t[1].offset]}var s=r.getLeft(e,i,t[0].offset);var n=r.getRight(e,i,t[1].offset);return[s,n]});var f=0;var m=void 0;var g=e.reduce(function(t,i,s){var n=f<d.length&&h[f][0]<=s;var r=d[f];var a=h[f];if(!n){t.push(i);return t}if(a[0]===s){m=[]}if(r[0].offset!==s&&r[1].offset!==s){m.push(i)}if(a[1]===s){var l=e[r[0].offset];delete l.location;delete l.expandTo;l.subparsed=o(m);t.push(l);f++}return t},[]);return{postparsed:g,errors:u}}};t.exports=function(){return o(m)}},{"../doc-utils":1,"../errors":2,"../mergesort":5,"../module-wrapper":6,"../traits":15}],8:[function(e,t,i){"use strict";var s=e("../doc-utils");var n=/^-([^\s]+)\s(.+)$/;var r=e("../module-wrapper");var o="loop";var a={name:"LoopModule",parse:function l(e){var t=o;var i="placeholder";if(e[0]==="#"){return{type:i,value:e.substr(1),expandTo:"auto",module:t,location:"start",inverted:false}}if(e[0]==="^"){return{type:i,value:e.substr(1),expandTo:"auto",module:t,location:"start",inverted:true}}if(e[0]==="/"){return{type:i,value:e.substr(1),module:t,location:"end"}}if(e[0]==="-"){var s=e.replace(n,"$2");var r=e.replace(n,"$1");return{type:i,value:s,expandTo:r,module:t,location:"start",inverted:false}}return null},getTraits:function c(e,t){if(e!=="expandPair"){return}return t.reduce(function(e,t,i){if(t.type==="placeholder"&&t.module===o){e.push({part:t,offset:i})}return e},[])},render:function d(e,t){if(!e.type==="placeholder"||e.module!==o){return null}var i=[];function n(n){var r=t.scopeManager.createSubScopeManager(n,e.value);i.push(t.render(s.mergeObjects({},t,{compiled:e.subparsed,tags:{},scopeManager:r})))}t.scopeManager.loopOver(e.value,n,e.inverted);return{value:i.join("")}}};t.exports=function(){return r(a)}},{"../doc-utils":1,"../module-wrapper":6}],9:[function(e,t,i){"use strict";var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||false;s.configurable=true;if("value"in s)s.writable=true;Object.defineProperty(e,s.key,s)}}return function(t,i,s){if(i)e(t.prototype,i);if(s)e(t,s);return t}}();function n(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var r=e("../doc-utils");var o=e("../errors"),a=o.throwRawTagShouldBeOnlyTextInParagraph;var l="rawxml";var c=e("../module-wrapper");function d(e){var t=e.part,i=e.left,s=e.right,n=e.postparsed,r=e.index;var o=n.slice(i+1,s);o.forEach(function(e,s){if(s===r-i-1){return}if(e.type==="placeholder"||e.type==="content"&&e.position==="insidetag"){a({paragraphParts:o,part:t})}});return t}var u=function(){function e(){n(this,e);this.name="RawXmlModule"}s(e,[{key:"optionsTransformer",value:function t(e,i){this.fileTypeConfig=i.fileTypeConfig;return e}},{key:"parse",value:function i(e){var t="placeholder";if(e[0]!=="@"){return null}return{type:t,value:e.substr(1),module:l}}},{key:"postparse",value:function o(e){return r.traits.expandToOne(e,{moduleName:l,getInner:d,expandTo:this.fileTypeConfig.tagRawXml})}},{key:"render",value:function a(e,t){if(e.module!==l){return null}var i=t.scopeManager.getValue(e.value);if(i==null){i=t.nullGetter(e)}return{value:i}}}]);return e}();t.exports=function(){return c(new u)}},{"../doc-utils":1,"../errors":2,"../module-wrapper":6}],10:[function(e,t,i){"use strict";var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||false;s.configurable=true;if("value"in s)s.writable=true;Object.defineProperty(e,s.key,s)}}return function(t,i,s){if(i)e(t.prototype,i);if(s)e(t,s);return t}}();function n(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var r=e("../module-wrapper");var o=e("../errors"),a=o.getScopeCompilationError;var l=function(){function e(){n(this,e);this.name="Render"}s(e,[{key:"set",value:function t(e){if(e.compiled){this.compiled=e.compiled}if(e.data!=null){this.data=e.data}}},{key:"getRenderedMap",value:function i(e){var t=this;return Object.keys(this.compiled).reduce(function(e,i){e[i]={from:i,data:t.data};return e},e)}},{key:"optionsTransformer",value:function r(e,t){this.parser=t.parser;return e}},{key:"postparse",value:function o(e){var t=this;var i=[];e.map(function(e){if(e.type==="placeholder"){var s=e.value;try{t.parser(s)}catch(n){i.push(a({tag:s,rootError:n}))}}});return{postparsed:e,errors:i}}}]);return e}();t.exports=function(){return r(new l)}},{"../errors":2,"../module-wrapper":6}],11:[function(e,t,i){"use strict";var s=e("../module-wrapper");var n={name:"SpacePreserveModule",postparse:function r(e){var t=[];var i=false;var s=e.reduce(function(e,s){if(s.type==="tag"&&s.position==="start"&&s.text&&s.value==="<w:t>"){i=true}if(i){if(s.type==="placeholder"&&!s.module){t[0].value='<w:t xml:space="preserve">'}t.push(s)}else{e.push(s)}if(s.type==="tag"&&s.position==="end"&&s.text&&s.value==="</w:t>"){Array.prototype.push.apply(e,t);i=false;t=[]}return e},[]);Array.prototype.push.apply(s,t);return s}};t.exports=function(){return s(n)}},{"../module-wrapper":6}],12:[function(e,t,i){"use strict";var s=e("./doc-utils"),n=s.wordToUtf8,r=s.concatArrays;function o(e,t,i,s){var n=void 0;for(var r=0,o=e.length;r<o;r++){var a=e[r];n=a.parse(t);if(n){n.offset=s;i.push(n);return i}}i.push({type:"placeholder",value:t,offset:s});return i}var a={postparse:function l(e,t){function i(e,i){return t.map(function(t){return t.getTraits(e,i)})}var s=[];function l(e){return t.reduce(function(e,t){var n=t.postparse(e,{postparse:l,getTraits:i});if(n.errors){s=r([s,n.errors]);return n.postparsed}return n},e)}return{postparsed:l(e),errors:s}},parse:function c(e,t){var i=false;var s="";var r=void 0;var a=[];return e.filter(function(e){return!e.error}).reduce(function l(e,c){if(c.type==="delimiter"){i=c.position==="start";if(c.position==="end"){s=n(s);e=o(t,s,e,r);r=null;Array.prototype.push.apply(e,a);a=[]}else{r=c.offset}s="";return e}if(!i){e.push(c);return e}if(c.type!=="content"||c.position!=="insidetag"){a.push(c);return e}s+=c.value;return e},[])}};t.exports=a},{"./doc-utils":1}],13:[function(e,t,i){"use strict";var s=e("./scope-manager");var n=e("./doc-utils");var r=e("./errors"),o=r.throwUnimplementedTagType;function a(e,t){var i=void 0;for(var s=0,n=t.modules.length;s<n;s++){var r=t.modules[s];i=r.render(e,t);if(i){return i}}return false}function l(e){e.render=l;e.modules=e.modules;if(!e.scopeManager){e.scopeManager=s.createBaseScopeManager(e)}return e.compiled.map(function(t){var i=a(t,e);if(i){return i.value}if(t.type==="placeholder"){var s=e.scopeManager.getValue(t.value);if(s==null){s=e.nullGetter(t)}return n.utf8ToWord(s)}if(t.type==="content"||t.type==="tag"){return t.value}o(t)}).join("")}t.exports=l},{"./doc-utils":1,"./errors":2,"./scope-manager":14}],14:[function(e,t,i){"use strict";var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||false;s.configurable=true;if("value"in s)s.writable=true;Object.defineProperty(e,s.key,s)}}return function(t,i,s){if(i)e(t.prototype,i);if(s)e(t,s);return t}}();function n(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var r=e("./errors"),o=r.XTScopeParserError;var a=function(){function e(t){n(this,e);this.scopePath=t.scopePath;this.scopeList=t.scopeList;this.parser=t.parser}s(e,[{key:"loopOver",value:function t(e,i,s){s=s||false;return this.loopOverValue(this.getValue(e),i,s)}},{key:"functorIfInverted",value:function i(e,t,s){if(e){t(s)}}},{key:"isValueFalsy",value:function r(e,t){return e==null||!e||t==="[object Array]"&&e.length===0}},{key:"loopOverValue",value:function a(e,t,i){var s=Object.prototype.toString.call(e);var n=this.scopeList[this.num];if(this.isValueFalsy(e,s)){return this.functorIfInverted(i,t,n)}if(s==="[object Array]"){for(var r=0,o;r<e.length;r++){o=e[r];this.functorIfInverted(!i,t,o)}return}if(s==="[object Object]"){return this.functorIfInverted(!i,t,e)}return this.functorIfInverted(!i,t,n)}},{key:"getValue",value:function l(e,t){this.num=t==null?this.scopeList.length-1:t;var i=void 0;var s=void 0;var n=this.scopeList[this.num];var r=this.parser(e,{scopePath:this.scopePath});try{s=r.get(n,{num:this.num,scopeList:this.scopeList})}catch(a){i=new o("Scope parser execution failed");i.properties={id:"scopeparser_execution_failed",explanation:"The scope parser for the tag "+e+" failed to execute",scope:n,tag:e,rootError:a};throw i}if(s==null&&this.num>0){return this.getValue(e,this.num-1)}return s}},{key:"createSubScopeManager",value:function c(t,i){var s={scopePath:this.scopePath.slice(0),scopeList:this.scopeList.slice(0)};s.parser=this.parser;s.scopeList=this.scopeList.concat(t);s.scopePath=this.scopePath.concat(i);return new e(s)}}]);return e}();a.createBaseScopeManager=function(e){var t=e.parser,i=e.tags;var s={parser:t,tags:i};s.scopePath=[];s.scopeList=[i];return new a(s)};t.exports=a},{"./errors":2}],15:[function(e,t,i){"use strict";var s=e("./doc-utils"),n=s.getRight,r=s.getLeft,o=s.concatArrays;var a=e("./errors"),l=a.XTTemplateError,c=a.throwRawTagNotInParagraph;function d(e,t){if(e.length===0){return false}var i=e[e.length-1];var s=i.tag.substr(1);var n=t.substr(2,t.length-3);return s.indexOf(n)===0}function u(e,t){e.push({tag:t});return e}function h(e){var t=e.filter(function(e){return e.type==="tag"}).map(function(e){return e.value});var i=[];for(var s=0,n;s<t.length;s++){n=t[s];if(n[1]==="/"){if(d(i,n)){i.pop()}else{i=u(i,n)}}else if(n[n.length-1]!=="/"){i=u(i,n)}}return i}function f(e){var t=h(e);for(var i=0;i<t.length;i++){var s=t[i];if(s.tag.indexOf("<w:tc")===0){return"w:tr"}if(s.tag.indexOf("<a:tc")===0){return"a:tr"}}return false}function p(e,t,i){var s=e.expandTo||i.expandTo;var a=t.indexOf(e);if(!s){return t}var d=void 0,u=void 0;try{d=n(t,s,a);u=r(t,s,a)}catch(h){if(h instanceof l){c({part:e,rootError:h,postparsed:t,expandTo:s,index:a})}throw h}var f=t.slice(u,a);var p=t.slice(a+1,d+1);var m=i.getInner({index:a,part:e,leftParts:f,rightParts:p,left:u,right:d,postparsed:t});if(!m.length){m.expanded=[f,p];m=[m]}return o([t.slice(0,u),m,t.slice(d+1)])}function m(e,t){var i=[];if(e.errors){i=e.errors;e=e.postparsed}var s=e.reduce(function(e,i){if(i.type==="placeholder"&&i.module===t.moduleName){e.push(i)}return e},[]);s.forEach(function(s){try{e=p(s,e,t)}catch(n){if(n instanceof l){i.push(n)}else{throw n}}});return{postparsed:e,errors:i}}t.exports={expandToOne:m,getExpandToDefault:f}},{"./doc-utils":1,"./errors":2}],16:[function(e,t,i){"use strict";var s=e("./doc-utils");function n(e){function t(){var t={array:Array.prototype.slice.call(arguments)};t.array.shift();var i=t.array[0]+t.array[1];t.array.unshift(i);t.array.pop();var s=t.array.pop();t.offset=s;t.first=true;e.matches.unshift(t)}if(e.content.indexOf("<")===-1&&e.content.indexOf(">")===-1){e.content.replace(/^()([^<>]*)$/,t)}var i=new RegExp("^()([^<]+)</(?:"+e.tagsXmlArrayJoined+")>");e.content.replace(i,t);function s(){var t={array:Array.prototype.slice.call(arguments)};t.array.pop();var i=t.array.pop();t.offset=i;t.last=true;e.matches.push(t)}i=new RegExp("(<(?:"+e.tagsXmlArrayJoined+")[^>]*>)([^>]+)$");e.content.replace(i,s);return e}function r(e,t){var i={};i.content=e;i.tagsXmlArray=t;i.tagsXmlArrayJoined=i.tagsXmlArray.join("|");var r=new RegExp("(<(?:"+i.tagsXmlArrayJoined+")[^>]*>)([^<>]*)</(?:"+i.tagsXmlArrayJoined+")>","g");i.matches=s.pregMatchAll(r,i.content);return n(i)}t.exports=function(e,t){return r(e,t)}},{"./doc-utils":1}],17:[function(e,t,i){"use strict";var s=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol==="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||false;s.configurable=true;if("value"in s)s.writable=true;Object.defineProperty(e,s.key,s)}}return function(t,i,s){if(i)e(t.prototype,i);if(s)e(t,s);return t}}();function r(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var o=e("./doc-utils"),a=o.wordToUtf8,l=o.convertSpaces,c=o.defaults;var d=e("./scope-manager");var u=e("./xml-matcher");var h=e("./errors"),f=h.throwMultiError,p=h.throwContentMustBeString;var m=e("./lexer");var g=e("./parser.js");var v=e("./render.js");function _(e,t){var i=u(e,t);var s=i.matches.map(function(e){return e.array[2]});return a(l(s.join("")))}t.exports=function(){function e(t,i){r(this,e);this.fromJson(i);this.setModules({inspect:{filePath:this.filePath}});this.load(t)}n(e,[{key:"load",value:function t(e){if(typeof e!=="string"){p(typeof e==="undefined"?"undefined":s(e))}this.content=e}},{key:"setTags",value:function i(e){this.tags=e!=null?e:{};this.scopeManager=d.createBaseScopeManager({tags:this.tags,parser:this.parser});return this}},{key:"fromJson",value:function o(e){this.filePath=e.filePath;this.modules=e.modules;this.fileTypeConfig=e.fileTypeConfig;Object.keys(c).map(function(t){this[t]=e[t]!=null?e[t]:c[t]},this)}},{key:"getFullText",value:function a(){return _(this.content,this.fileTypeConfig.tagsXmlTextArray)}},{key:"setModules",value:function l(e){this.modules.forEach(function(t){t.set(e)})}},{key:"parse",value:function u(){var e=this;var t=[];this.xmllexed=m.xmlparse(this.content,{text:this.fileTypeConfig.tagsXmlTextArray,other:this.fileTypeConfig.tagsXmlLexedArray});this.setModules({inspect:{xmllexed:this.xmllexed}});var i=m.parse(this.xmllexed,this.delimiters),s=i.lexed,n=i.errors;t=t.concat(n);this.lexed=s;this.setModules({inspect:{lexed:this.lexed}});this.parsed=g.parse(this.lexed,this.modules);this.setModules({inspect:{parsed:this.parsed}});var r=g.postparse(this.parsed,this.modules),o=r.postparsed,a=r.errors;this.postparsed=o;t=t.concat(a);if(t.length){this.modules.forEach(function(e){t=e.errorsTransformer(t)});t.forEach(function(t){t.properties.file=e.filePath});f(t)}return this}},{key:"render",value:function h(e){this.filePath=e;this.setModules({inspect:{postparsed:this.postparsed}});var t={compiled:this.postparsed,tags:this.tags,modules:this.modules,parser:this.parser,nullGetter:this.nullGetter,filePath:this.filePath};this.content=v(t);this.setModules({inspect:{content:this.content}});return this}}]);return e}()},{"./doc-utils":1,"./errors":2,"./lexer":4,"./parser.js":12,"./render.js":13,"./scope-manager":14,"./xml-matcher":16}],18:[function(e,t,i){function s(e){this.options=e||{locator:{}}}s.prototype.parseFromString=function(e,t){var i=this.options;var s=new d;var o=i.domBuilder||new r;var a=i.errorHandler;var l=i.locator;var c=i.xmlns||{};var u={lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};if(l){o.setDocumentLocator(l)}s.errorHandler=n(a,o,l);s.domBuilder=i.domBuilder||o;if(/\/x?html?$/.test(t)){u.nbsp="";u.copy="";c[""]="http://www.w3.org/1999/xhtml"}c.xml=c.xml||"http://www.w3.org/XML/1998/namespace";if(e){s.parse(e,c,u)}else{s.errorHandler.error("invalid doc source")}return o.doc};function n(e,t,i){if(!e){if(t instanceof r){return t}e=t}var s={};var n=e instanceof Function;i=i||{};function o(t){var r=e[t];if(!r&&n){r=e.length==2?function(i){e(t,i)}:e}s[t]=r&&function(e){r("[xmldom "+t+"]	"+e+a(i))}||function(){}}o("warning");o("error");o("fatalError");return s}function r(){this.cdata=false}function o(e,t){t.lineNumber=e.lineNumber;t.columnNumber=e.columnNumber}r.prototype={startDocument:function(){this.doc=(new u).createDocument(null,null,null);if(this.locator){this.doc.documentURI=this.locator.systemId}},startElement:function(e,t,i,s){var n=this.doc;var r=n.createElementNS(e,i||t);var a=s.length;c(this,r);this.currentElement=r;this.locator&&o(this.locator,r);for(var l=0;l<a;l++){var e=s.getURI(l);var d=s.getValue(l);var i=s.getQName(l);var u=n.createAttributeNS(e,i);this.locator&&o(s.getLocator(l),u);u.value=u.nodeValue=d;r.setAttributeNode(u)}},endElement:function(e,t,i){var s=this.currentElement;var n=s.tagName;this.currentElement=s.parentNode},startPrefixMapping:function(e,t){},endPrefixMapping:function(e){},processingInstruction:function(e,t){var i=this.doc.createProcessingInstruction(e,t);this.locator&&o(this.locator,i);c(this,i)},ignorableWhitespace:function(e,t,i){},characters:function(e,t,i){e=l.apply(this,arguments);if(e){if(this.cdata){var s=this.doc.createCDATASection(e)}else{var s=this.doc.createTextNode(e)}if(this.currentElement){this.currentElement.appendChild(s)}else if(/^\s*$/.test(e)){this.doc.appendChild(s)}this.locator&&o(this.locator,s)}},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){if(this.locator=e){e.lineNumber=0}},comment:function(e,t,i){e=l.apply(this,arguments);var s=this.doc.createComment(e);this.locator&&o(this.locator,s);c(this,s)},startCDATA:function(){this.cdata=true},endCDATA:function(){this.cdata=false},startDTD:function(e,t,i){var s=this.doc.implementation;if(s&&s.createDocumentType){var n=s.createDocumentType(e,t,i);this.locator&&o(this.locator,n);c(this,n)}},warning:function(e){console.warn("[xmldom warning]	"+e,a(this.locator))},error:function(e){console.error("[xmldom error]	"+e,a(this.locator))},fatalError:function(e){console.error("[xmldom fatalError]	"+e,a(this.locator));throw e}};function a(e){if(e){return"\n@"+(e.systemId||"")+"#[line:"+e.lineNumber+",col:"+e.columnNumber+"]"}}function l(e,t,i){if(typeof e=="string"){return e.substr(t,i)}else{if(e.length>=t+i||t){return new java.lang.String(e,t,i)+""}return e}}"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(e){r.prototype[e]=function(){return null}});function c(e,t){if(!e.currentElement){e.doc.appendChild(t)}else{e.currentElement.appendChild(t)}}var d=e("./sax").XMLReader;var u=i.DOMImplementation=e("./dom").DOMImplementation;i.XMLSerializer=e("./dom").XMLSerializer;i.DOMParser=s},{"./dom":19,"./sax":20}],19:[function(e,t,i){function s(e,t){for(var i in e){t[i]=e[i]}}function n(e,t){var i=e.prototype;if(Object.create){var n=Object.create(t.prototype);i.__proto__=n}if(!(i instanceof t)){function r(){}r.prototype=t.prototype;r=new r;s(i,r);e.prototype=i=r}if(i.constructor!=e){if(typeof e!="function"){console.error("unknow Class:"+e)}i.constructor=e}}var r="http://www.w3.org/1999/xhtml";var o={};var a=o.ELEMENT_NODE=1;var l=o.ATTRIBUTE_NODE=2;var c=o.TEXT_NODE=3;var d=o.CDATA_SECTION_NODE=4;var u=o.ENTITY_REFERENCE_NODE=5;var h=o.ENTITY_NODE=6;var f=o.PROCESSING_INSTRUCTION_NODE=7;var p=o.COMMENT_NODE=8;var m=o.DOCUMENT_NODE=9;var g=o.DOCUMENT_TYPE_NODE=10;var v=o.DOCUMENT_FRAGMENT_NODE=11;var _=o.NOTATION_NODE=12;var b={};var w={};var y=b.INDEX_SIZE_ERR=(w[1]="Index size error",1);var C=b.DOMSTRING_SIZE_ERR=(w[2]="DOMString size error",2);var k=b.HIERARCHY_REQUEST_ERR=(w[3]="Hierarchy request error",3);var S=b.WRONG_DOCUMENT_ERR=(w[4]="Wrong document",4);var x=b.INVALID_CHARACTER_ERR=(w[5]="Invalid character",5);var I=b.NO_DATA_ALLOWED_ERR=(w[6]="No data allowed",6);var A=b.NO_MODIFICATION_ALLOWED_ERR=(w[7]="No modification allowed",7);var T=b.NOT_FOUND_ERR=(w[8]="Not found",8);var E=b.NOT_SUPPORTED_ERR=(w[9]="Not supported",9);var R=b.INUSE_ATTRIBUTE_ERR=(w[10]="Attribute in use",10);var $=b.INVALID_STATE_ERR=(w[11]="Invalid state",11);var O=b.SYNTAX_ERR=(w[12]="Syntax error",12);var L=b.INVALID_MODIFICATION_ERR=(w[13]="Invalid modification",13);var P=b.NAMESPACE_ERR=(w[14]="Invalid namespace",14);var D=b.INVALID_ACCESS_ERR=(w[15]="Invalid access",15);function M(e,t){if(t instanceof Error){var i=t}else{i=this;Error.call(this,w[e]);this.message=w[e];if(Error.captureStackTrace)Error.captureStackTrace(this,M)}i.code=e;if(t)this.message=this.message+": "+t;return i}M.prototype=Error.prototype;s(b,M);function V(){}V.prototype={length:0,item:function(e){return this[e]||null},toString:function(e,t){for(var i=[],s=0;s<this.length;s++){ge(this[s],i,e,t)}return i.join("")}};function N(e,t){this._node=e;this._refresh=t;z(this)}function z(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!=t){var i=e._refresh(e._node);be(e,"length",i.length);s(i,e);e._inc=t}}N.prototype.item=function(e){z(this);return this[e]};n(N,V);function B(){}function j(e,t){var i=e.length;while(i--){if(e[i]===t){return i}}}function F(e,t,i,s){if(s){t[j(t,s)]=i}else{t[t.length++]=i}if(e){i.ownerElement=e;var n=e.ownerDocument;if(n){s&&X(n,e,s);J(n,e,i)}}}function q(e,t,i){var s=j(t,i);if(s>=0){var n=t.length-1;while(s<n){t[s]=t[++s]}t.length=n;if(e){var r=e.ownerDocument;if(r){X(r,e,i);i.ownerElement=null}}}else{throw M(T,new Error(e.tagName+"@"+i))}}B.prototype={length:0,item:V.prototype.item,getNamedItem:function(e){var t=this.length;while(t--){var i=this[t];if(i.nodeName==e){return i}}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement){throw new M(R)}var i=this.getNamedItem(e.nodeName);F(this._ownerElement,this,e,i);return i},setNamedItemNS:function(e){var t=e.ownerElement,i;if(t&&t!=this._ownerElement){throw new M(R)}i=this.getNamedItemNS(e.namespaceURI,e.localName);F(this._ownerElement,this,e,i);return i},removeNamedItem:function(e){var t=this.getNamedItem(e);q(this._ownerElement,this,t);return t},removeNamedItemNS:function(e,t){var i=this.getNamedItemNS(e,t);q(this._ownerElement,this,i);return i},getNamedItemNS:function(e,t){var i=this.length;while(i--){var s=this[i];if(s.localName==t&&s.namespaceURI==e){return s}}return null}};function U(e){this._features={};if(e){for(var t in e){this._features=e[t]}}}U.prototype={hasFeature:function(e,t){var i=this._features[e.toLowerCase()];if(i&&(!t||t in i)){return true}else{return false}},createDocument:function(e,t,i){var s=new Z;s.implementation=this;s.childNodes=new V;s.doctype=i;if(i){s.appendChild(i)}if(t){var n=s.createElementNS(e,t);s.appendChild(n)}return s},createDocumentType:function(e,t,i){var s=new ae;s.name=e;s.nodeName=e;s.publicId=t;s.systemId=i;return s}};function H(){}H.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return G(this,e,t)},replaceChild:function(e,t){this.insertBefore(e,t);if(t){this.removeChild(t)}},removeChild:function(e){return Y(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(e){return _e(this.ownerDocument||this,this,e)},normalize:function(){var e=this.firstChild;while(e){var t=e.nextSibling;if(t&&t.nodeType==c&&e.nodeType==c){this.removeChild(t);e.appendData(t.data)}else{e.normalize();e=t}}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(e){var t=this;while(t){var i=t._nsMap;if(i){for(var s in i){if(i[s]==e){return s}}}t=t.nodeType==l?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){var t=this;while(t){var i=t._nsMap;if(i){if(e in i){return i[e]}}t=t.nodeType==l?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){var t=this.lookupPrefix(e);return t==null}};function W(e){return e=="<"&&"&lt;"||e==">"&&"&gt;"||e=="&"&&"&amp;"||e=='"'&&"&quot;"||"&#"+e.charCodeAt()+";"}s(o,H);s(o,H.prototype);function Q(e,t){if(t(e)){return true}if(e=e.firstChild){do{if(Q(e,t)){return true}}while(e=e.nextSibling)}}function Z(){}function J(e,t,i){e&&e._inc++;var s=i.namespaceURI;if(s=="http://www.w3.org/2000/xmlns/"){t._nsMap[i.prefix?i.localName:""]=i.value}}function X(e,t,i,s){e&&e._inc++;var n=i.namespaceURI;if(n=="http://www.w3.org/2000/xmlns/"){delete t._nsMap[i.prefix?i.localName:""]}}function K(e,t,i){if(e&&e._inc){e._inc++;var s=t.childNodes;if(i){s[s.length++]=i}else{var n=t.firstChild;var r=0;while(n){s[r++]=n;n=n.nextSibling}s.length=r}}}function Y(e,t){var i=t.previousSibling;var s=t.nextSibling;if(i){i.nextSibling=s}else{e.firstChild=s}if(s){s.previousSibling=i}else{e.lastChild=i}K(e.ownerDocument,e);return t}function G(e,t,i){var s=t.parentNode;if(s){s.removeChild(t)}if(t.nodeType===v){var n=t.firstChild;if(n==null){return t}var r=t.lastChild}else{n=r=t}var o=i?i.previousSibling:e.lastChild;n.previousSibling=o;r.nextSibling=i;if(o){o.nextSibling=n}else{e.firstChild=n}if(i==null){e.lastChild=r}else{i.previousSibling=r}do{n.parentNode=e}while(n!==r&&(n=n.nextSibling));K(e.ownerDocument||e,e);if(t.nodeType==v){t.firstChild=t.lastChild=null}return t}function ee(e,t){var i=t.parentNode;if(i){var s=e.lastChild;i.removeChild(t);var s=e.lastChild}var s=e.lastChild;t.parentNode=e;t.previousSibling=s;t.nextSibling=null;if(s){s.nextSibling=t}else{e.firstChild=t}e.lastChild=t;K(e.ownerDocument,e,t);return t}Z.prototype={nodeName:"#document",nodeType:m,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType==v){var i=e.firstChild;while(i){var s=i.nextSibling;this.insertBefore(i,t);i=s}return e}if(this.documentElement==null&&e.nodeType==a){this.documentElement=e}return G(this,e,t),e.ownerDocument=this,e},removeChild:function(e){if(this.documentElement==e){this.documentElement=null}return Y(this,e)},importNode:function(e,t){return ve(this,e,t)},getElementById:function(e){var t=null;Q(this.documentElement,function(i){if(i.nodeType==a){if(i.getAttribute("id")==e){t=i;return true}}});return t},createElement:function(e){var t=new te;t.ownerDocument=this;t.nodeName=e;t.tagName=e;t.childNodes=new V;var i=t.attributes=new B;i._ownerElement=t;return t},createDocumentFragment:function(){var e=new ue;e.ownerDocument=this;e.childNodes=new V;return e},createTextNode:function(e){var t=new ne;t.ownerDocument=this;t.appendData(e);return t},createComment:function(e){var t=new re;t.ownerDocument=this;t.appendData(e);return t},createCDATASection:function(e){var t=new oe;t.ownerDocument=this;t.appendData(e);return t},createProcessingInstruction:function(e,t){var i=new he;i.ownerDocument=this;i.tagName=i.target=e;i.nodeValue=i.data=t;return i},createAttribute:function(e){var t=new ie;t.ownerDocument=this;t.name=e;t.nodeName=e;t.localName=e;t.specified=true;return t},createEntityReference:function(e){var t=new de;t.ownerDocument=this;t.nodeName=e;return t},createElementNS:function(e,t){var i=new te;var s=t.split(":");var n=i.attributes=new B;i.childNodes=new V;i.ownerDocument=this;i.nodeName=t;i.tagName=t;i.namespaceURI=e;if(s.length==2){i.prefix=s[0];i.localName=s[1]}else{i.localName=t}n._ownerElement=i;return i},createAttributeNS:function(e,t){var i=new ie;var s=t.split(":");i.ownerDocument=this;i.nodeName=t;i.name=t;i.namespaceURI=e;i.specified=true;if(s.length==2){i.prefix=s[0];i.localName=s[1]}else{i.localName=t}return i}};n(Z,H);function te(){this._nsMap={}}te.prototype={nodeType:a,hasAttribute:function(e){return this.getAttributeNode(e)!=null},getAttribute:function(e){var t=this.getAttributeNode(e);return t&&t.value||""},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){var i=this.ownerDocument.createAttribute(e);i.value=i.nodeValue=""+t;this.setAttributeNode(i)},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},appendChild:function(e){if(e.nodeType===v){return this.insertBefore(e,null)}else{return ee(this,e)}},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var i=this.getAttributeNodeNS(e,t);i&&this.removeAttributeNode(i)},hasAttributeNS:function(e,t){return this.getAttributeNodeNS(e,t)!=null},getAttributeNS:function(e,t){var i=this.getAttributeNodeNS(e,t);return i&&i.value||""},setAttributeNS:function(e,t,i){var s=this.ownerDocument.createAttributeNS(e,t);s.value=s.nodeValue=""+i;this.setAttributeNode(s)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(e){return new N(this,function(t){var i=[];Q(t,function(s){if(s!==t&&s.nodeType==a&&(e==="*"||s.tagName==e)){i.push(s)}});return i})},getElementsByTagNameNS:function(e,t){return new N(this,function(i){var s=[];Q(i,function(n){if(n!==i&&n.nodeType===a&&(e==="*"||n.namespaceURI===e)&&(t==="*"||n.localName==t)){s.push(n)}});return s})}};Z.prototype.getElementsByTagName=te.prototype.getElementsByTagName;Z.prototype.getElementsByTagNameNS=te.prototype.getElementsByTagNameNS;n(te,H);function ie(){}ie.prototype.nodeType=l;n(ie,H);function se(){}se.prototype={data:"",substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e;this.nodeValue=this.data=e;this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(e){throw new Error(w[k])},deleteData:function(e,t){this.replaceData(e,t,"")},replaceData:function(e,t,i){var s=this.data.substring(0,e);var n=this.data.substring(e+t);i=s+i+n;this.nodeValue=this.data=i;this.length=i.length}};n(se,H);function ne(){}ne.prototype={nodeName:"#text",nodeType:c,splitText:function(e){var t=this.data;var i=t.substring(e);t=t.substring(0,e);this.data=this.nodeValue=t;this.length=t.length;var s=this.ownerDocument.createTextNode(i);if(this.parentNode){this.parentNode.insertBefore(s,this.nextSibling)}return s}};n(ne,se);function re(){}re.prototype={nodeName:"#comment",nodeType:p};n(re,se);function oe(){}oe.prototype={nodeName:"#cdata-section",nodeType:d};n(oe,se);function ae(){}ae.prototype.nodeType=g;n(ae,H);function le(){}le.prototype.nodeType=_;n(le,H);function ce(){}ce.prototype.nodeType=h;n(ce,H);function de(){}de.prototype.nodeType=u;n(de,H);function ue(){}ue.prototype.nodeName="#document-fragment";ue.prototype.nodeType=v;n(ue,H);function he(){}he.prototype.nodeType=f;n(he,H);function fe(){}fe.prototype.serializeToString=function(e,t,i){return pe.call(e,t,i)};H.prototype.toString=pe;function pe(e,t){var i=[];var s=this.nodeType==9?this.documentElement:this;var n=s.prefix;var r=s.namespaceURI;if(r&&n==null){var n=s.lookupPrefix(r);if(n==null){var o=[{namespace:r,prefix:null}]}}ge(this,i,e,t,o);return i.join("")}function me(e,t,i){var s=e.prefix||"";var n=e.namespaceURI;if(!s&&!n){return false}if(s==="xml"&&n==="http://www.w3.org/XML/1998/namespace"||n=="http://www.w3.org/2000/xmlns/"){return false}var r=i.length;while(r--){var o=i[r];if(o.prefix==s){return o.namespace!=n}}return true;
}function ge(e,t,i,s,n){if(s){e=s(e);if(e){if(typeof e=="string"){t.push(e);return}}else{return}}switch(e.nodeType){case a:if(!n)n=[];var o=n.length;var h=e.attributes;var _=h.length;var b=e.firstChild;var w=e.tagName;i=r===e.namespaceURI||i;t.push("<",w);for(var y=0;y<_;y++){var C=h.item(y);if(C.prefix=="xmlns"){n.push({prefix:C.localName,namespace:C.value})}else if(C.nodeName=="xmlns"){n.push({prefix:"",namespace:C.value})}}for(var y=0;y<_;y++){var C=h.item(y);if(me(C,i,n)){var k=C.prefix||"";var S=C.namespaceURI;var x=k?" xmlns:"+k:" xmlns";t.push(x,'="',S,'"');n.push({prefix:k,namespace:S})}ge(C,t,i,s,n)}if(me(e,i,n)){var k=e.prefix||"";var S=e.namespaceURI;var x=k?" xmlns:"+k:" xmlns";t.push(x,'="',S,'"');n.push({prefix:k,namespace:S})}if(b||i&&!/^(?:meta|link|img|br|hr|input)$/i.test(w)){t.push(">");if(i&&/^script$/i.test(w)){while(b){if(b.data){t.push(b.data)}else{ge(b,t,i,s,n)}b=b.nextSibling}}else{while(b){ge(b,t,i,s,n);b=b.nextSibling}}t.push("</",w,">")}else{t.push("/>")}return;case m:case v:var b=e.firstChild;while(b){ge(b,t,i,s,n);b=b.nextSibling}return;case l:return t.push(" ",e.name,'="',e.value.replace(/[<&"]/g,W),'"');case c:return t.push(e.data.replace(/[<&]/g,W));case d:return t.push("<![CDATA[",e.data,"]]>");case p:return t.push("<!--",e.data,"-->");case g:var I=e.publicId;var A=e.systemId;t.push("<!DOCTYPE ",e.name);if(I){t.push(' PUBLIC "',I);if(A&&A!="."){t.push('" "',A)}t.push('">')}else if(A&&A!="."){t.push(' SYSTEM "',A,'">')}else{var T=e.internalSubset;if(T){t.push(" [",T,"]")}t.push(">")}return;case f:return t.push("<?",e.target," ",e.data,"?>");case u:return t.push("&",e.nodeName,";");default:t.push("??",e.nodeName)}}function ve(e,t,i){var s;switch(t.nodeType){case a:s=t.cloneNode(false);s.ownerDocument=e;case v:break;case l:i=true;break}if(!s){s=t.cloneNode(false)}s.ownerDocument=e;s.parentNode=null;if(i){var n=t.firstChild;while(n){s.appendChild(ve(e,n,i));n=n.nextSibling}}return s}function _e(e,t,i){var s=new t.constructor;for(var n in t){var r=t[n];if(typeof r!="object"){if(r!=s[n]){s[n]=r}}}if(t.childNodes){s.childNodes=new V}s.ownerDocument=e;switch(s.nodeType){case a:var o=t.attributes;var c=s.attributes=new B;var d=o.length;c._ownerElement=s;for(var u=0;u<d;u++){s.setAttributeNode(_e(e,o.item(u),true))}break;case l:i=true}if(i){var h=t.firstChild;while(h){s.appendChild(_e(e,h,i));h=h.nextSibling}}return s}function be(e,t,i){e[t]=i}try{if(Object.defineProperty){Object.defineProperty(N.prototype,"length",{get:function(){z(this);return this.$$length}});Object.defineProperty(H.prototype,"textContent",{get:function(){return we(this)},set:function(e){switch(this.nodeType){case a:case v:while(this.firstChild){this.removeChild(this.firstChild)}if(e||String(e)){this.appendChild(this.ownerDocument.createTextNode(e))}break;default:this.data=e;this.value=e;this.nodeValue=e}}});function we(e){switch(e.nodeType){case a:case v:var t=[];e=e.firstChild;while(e){if(e.nodeType!==7&&e.nodeType!==8){t.push(we(e))}e=e.nextSibling}return t.join("");default:return e.nodeValue}}be=function(e,t,i){e["$$"+t]=i}}}catch(ye){}i.DOMImplementation=U;i.XMLSerializer=fe},{}],20:[function(e,t,i){var s=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/;var n=new RegExp("[\\-\\.0-9"+s.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]");var r=new RegExp("^"+s.source+n.source+"*(?::"+s.source+n.source+"*)?$");var o=0;var a=1;var l=2;var c=3;var d=4;var u=5;var h=6;var f=7;function p(){}p.prototype={parse:function(e,t,i){var s=this.domBuilder;s.startDocument();y(t,t={});m(e,t,i,s,this.errorHandler);s.endDocument()}};function m(e,t,i,s,n){function r(e){if(e>65535){e-=65536;var t=55296+(e>>10),i=56320+(e&1023);return String.fromCharCode(t,i)}else{return String.fromCharCode(e)}}function o(e){var t=e.slice(1,-1);if(t in i){return i[t]}else if(t.charAt(0)==="#"){return r(parseInt(t.substr(1).replace("x","0x")))}else{n.error("entity not found:"+e);return e}}function a(t){if(t>m){var i=e.substring(m,t).replace(/&#?\w+;/g,o);h&&l(m);s.characters(i,0,t-m);m=t}}function l(t,i){while(t>=d&&(i=u.exec(e))){c=i.index;d=c+i[0].length;h.lineNumber++}h.columnNumber=t-c+1}var c=0;var d=0;var u=/.*(?:\r\n?|\n)|.*$/g;var h=s.locator;var f=[{currentNSMap:t}];var p={};var m=0;while(true){try{var y=e.indexOf("<",m);if(y<0){if(!e.substr(m).match(/^\s*$/)){var x=s.doc;var I=x.createTextNode(e.substr(m));x.appendChild(I);s.currentElement=I}return}if(y>m){a(y)}switch(e.charAt(y+1)){case"/":var A=e.indexOf(">",y+3);var T=e.substring(y+2,A);var E=f.pop();if(A<0){T=e.substring(y+2).replace(/[\s<].*/,"");n.error("end tag name: "+T+" is not complete:"+E.tagName);A=y+1+T.length}else if(T.match(/\s</)){T=T.replace(/[\s<].*/,"");n.error("end tag name: "+T+" maybe not complete");A=y+1+T.length}var R=E.localNSMap;var $=E.tagName==T;var O=$||E.tagName&&E.tagName.toLowerCase()==T.toLowerCase();if(O){s.endElement(E.uri,E.localName,T);if(R){for(var L in R){s.endPrefixMapping(L)}}if(!$){n.fatalError("end tag name: "+T+" is not match the current start tagName:"+E.tagName)}}else{f.push(E)}A++;break;case"?":h&&l(y);A=k(e,y,s);break;case"!":h&&l(y);A=C(e,y,s,n);break;default:h&&l(y);var P=new S;var D=f[f.length-1].currentNSMap;var A=v(e,y,P,D,o,n);var M=P.length;if(!P.closed&&w(e,A,P.tagName,p)){P.closed=true;if(!i.nbsp){n.warning("unclosed xml attribute")}}if(h&&M){var V=g(h,{});for(var N=0;N<M;N++){var z=P[N];l(z.offset);z.locator=g(h,{})}s.locator=V;if(_(P,s,D)){f.push(P)}s.locator=h}else{if(_(P,s,D)){f.push(P)}}if(P.uri==="http://www.w3.org/1999/xhtml"&&!P.closed){A=b(e,A,P.tagName,o,s)}else{A++}}}catch(B){n.error("element parse error: "+B);A=-1}if(A>m){m=A}else{a(Math.max(y,m)+1)}}}function g(e,t){t.lineNumber=e.lineNumber;t.columnNumber=e.columnNumber;return t}function v(e,t,i,s,n,r){var p;var m;var g=++t;var v=o;while(true){var _=e.charAt(g);switch(_){case"=":if(v===a){p=e.slice(t,g);v=c}else if(v===l){v=c}else{throw new Error("attribute equal must after attrName")}break;case"'":case'"':if(v===c||v===a){if(v===a){r.warning('attribute value must after "="');p=e.slice(t,g)}t=g+1;g=e.indexOf(_,t);if(g>0){m=e.slice(t,g).replace(/&#?\w+;/g,n);i.add(p,m,t-1);v=u}else{throw new Error("attribute value no end '"+_+"' match")}}else if(v==d){m=e.slice(t,g).replace(/&#?\w+;/g,n);i.add(p,m,t);r.warning('attribute "'+p+'" missed start quot('+_+")!!");t=g+1;v=u}else{throw new Error('attribute value must after "="')}break;case"/":switch(v){case o:i.setTagName(e.slice(t,g));case u:case h:case f:v=f;i.closed=true;case d:case a:case l:break;default:throw new Error("attribute invalid close char('/')")}break;case"":r.error("unexpected end of input");if(v==o){i.setTagName(e.slice(t,g))}return g;case">":switch(v){case o:i.setTagName(e.slice(t,g));case u:case h:case f:break;case d:case a:m=e.slice(t,g);if(m.slice(-1)==="/"){i.closed=true;m=m.slice(0,-1)}case l:if(v===l){m=p}if(v==d){r.warning('attribute "'+m+'" missed quot(")!!');i.add(p,m.replace(/&#?\w+;/g,n),t)}else{if(s[""]!=="http://www.w3.org/1999/xhtml"||!m.match(/^(?:disabled|checked|selected)$/i)){r.warning('attribute "'+m+'" missed value!! "'+m+'" instead!!')}i.add(m,m,t)}break;case c:throw new Error("attribute value missed!!")}return g;case"":_=" ";default:if(_<=" "){switch(v){case o:i.setTagName(e.slice(t,g));v=h;break;case a:p=e.slice(t,g);v=l;break;case d:var m=e.slice(t,g).replace(/&#?\w+;/g,n);r.warning('attribute "'+m+'" missed quot(")!!');i.add(p,m,t);case u:v=h;break}}else{switch(v){case l:var b=i.tagName;if(s[""]!=="http://www.w3.org/1999/xhtml"||!p.match(/^(?:disabled|checked|selected)$/i)){r.warning('attribute "'+p+'" missed value!! "'+p+'" instead2!!')}i.add(p,p,t);t=g;v=a;break;case u:r.warning('attribute space is required"'+p+'"!!');case h:v=a;t=g;break;case c:v=d;t=g;break;case f:throw new Error("elements closed character '/' and '>' must be connected to")}}}g++}}function _(e,t,i){var s=e.tagName;var n=null;var r=e.length;while(r--){var o=e[r];var a=o.qName;var l=o.value;var c=a.indexOf(":");if(c>0){var d=o.prefix=a.slice(0,c);var u=a.slice(c+1);var h=d==="xmlns"&&u}else{u=a;d=null;h=a==="xmlns"&&""}o.localName=u;if(h!==false){if(n==null){n={};y(i,i={})}i[h]=n[h]=l;o.uri="http://www.w3.org/2000/xmlns/";t.startPrefixMapping(h,l)}}var r=e.length;while(r--){o=e[r];var d=o.prefix;if(d){if(d==="xml"){o.uri="http://www.w3.org/XML/1998/namespace"}if(d!=="xmlns"){o.uri=i[d||""]}}}var c=s.indexOf(":");if(c>0){d=e.prefix=s.slice(0,c);u=e.localName=s.slice(c+1)}else{d=null;u=e.localName=s}var f=e.uri=i[d||""];t.startElement(f,u,s,e);if(e.closed){t.endElement(f,u,s);if(n){for(d in n){t.endPrefixMapping(d)}}}else{e.currentNSMap=i;e.localNSMap=n;return true}}function b(e,t,i,s,n){if(/^(?:script|textarea)$/i.test(i)){var r=e.indexOf("</"+i+">",t);var o=e.substring(t+1,r);if(/[&<]/.test(o)){if(/^script$/i.test(i)){n.characters(o,0,o.length);return r}o=o.replace(/&#?\w+;/g,s);n.characters(o,0,o.length);return r}}return t+1}function w(e,t,i,s){var n=s[i];if(n==null){n=e.lastIndexOf("</"+i+">");if(n<t){n=e.lastIndexOf("</"+i)}s[i]=n}return n<t}function y(e,t){for(var i in e){t[i]=e[i]}}function C(e,t,i,s){var n=e.charAt(t+2);switch(n){case"-":if(e.charAt(t+3)==="-"){var r=e.indexOf("-->",t+4);if(r>t){i.comment(e,t+4,r-t-4);return r+3}else{s.error("Unclosed comment");return-1}}else{return-1}default:if(e.substr(t+3,6)=="CDATA["){var r=e.indexOf("]]>",t+9);i.startCDATA();i.characters(e,t+9,r-t-9);i.endCDATA();return r+3}var o=I(e,t);var a=o.length;if(a>1&&/!doctype/i.test(o[0][0])){var l=o[1][0];var c=a>3&&/^public$/i.test(o[2][0])&&o[3][0];var d=a>4&&o[4][0];var u=o[a-1];i.startDTD(l,c&&c.replace(/^(['"])(.*?)\1$/,"$2"),d&&d.replace(/^(['"])(.*?)\1$/,"$2"));i.endDTD();return u.index+u[0].length}}return-1}function k(e,t,i){var s=e.indexOf("?>",t);if(s){var n=e.substring(t,s).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(n){var r=n[0].length;i.processingInstruction(n[1],n[2]);return s+2}else{return-1}}return-1}function S(e){}S.prototype={setTagName:function(e){if(!r.test(e)){throw new Error("invalid tagName:"+e)}this.tagName=e},add:function(e,t,i){if(!r.test(e)){throw new Error("invalid attribute:"+e)}this[this.length++]={qName:e,value:t,offset:i}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}};function x(e,t){e.__proto__=t;return e}if(!(x({},x.prototype)instanceof x)){x=function(e,t){function i(){}i.prototype=t;i=new i;for(t in e){i[t]=e[t]}return i}}function I(e,t){var i;var s=[];var n=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;n.lastIndex=t;n.exec(e);while(i=n.exec(e)){s.push(i);if(i[1])return s}}i.XMLReader=p},{}],"/src/js/docxtemplater.js":[function(e,t,i){"use strict";var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||false;s.configurable=true;if("value"in s)s.writable=true;Object.defineProperty(e,s.key,s)}}return function(t,i,s){if(i)e(t.prototype,i);if(s)e(t,s);return t}}();function n(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var r=e("./doc-utils");var o=e("./errors"),a=o.XTInternalError,l=o.throwFileTypeNotIdentified;r.traits=e("./traits");r.moduleWrapper=e("./module-wrapper");var c=r.moduleWrapper;var d=function(){function e(){n(this,e);if(arguments.length>0){throw new Error("The constructor with parameters has been removed in docxtemplater 3.0, please check the upgrade guide.")}this.compiled={};this.modules=[];this.setOptions({})}s(e,[{key:"setModules",value:function t(e){this.modules.forEach(function(t){t.set(e)})}},{key:"attachModule",value:function i(e){this.modules.push(c(e));return this}},{key:"setOptions",value:function o(e){var t=this;this.options=e;Object.keys(r.defaults).forEach(function(e){var i=r.defaults[e];t[e]=t.options[e]!=null?t.options[e]:i});if(this.zip){this.updateFileTypeConfig()}return this}},{key:"loadZip",value:function d(e){if(e.loadAsync){throw new a("Docxtemplater doesn't handle JSZip version >=3, see changelog")}this.zip=e;this.updateFileTypeConfig();return this}},{key:"compileFile",value:function u(e){var t=this.createTemplateClass(e);t.parse();this.compiled[e]=t}},{key:"compile",value:function h(){var e=this;this.options.xmlFileNames=[];this.modules=this.fileTypeConfig.baseModules.map(function(e){return e()}).concat(this.modules);this.options=this.modules.reduce(function(t,i){return i.optionsTransformer(t,e)},this.options);this.xmlDocuments=this.options.xmlFileNames.reduce(function(t,i){var s=e.zip.files[i].asText();t[i]=r.str2xml(s);return t},{});this.setModules({zip:this.zip,xmlDocuments:this.xmlDocuments,data:this.data});this.getTemplatedFiles();this.setModules({compiled:this.compiled});this.templatedFiles.forEach(function(t){if(e.zip.files[t]!=null){e.compileFile(t)}});return this}},{key:"updateFileTypeConfig",value:function f(){var t=this;var i={docx:"word/document.xml",pptx:"ppt/presentation.xml"};var s=Object.keys(i).reduce(function(e,s){if(e){return e}if(t.zip.files[i[s]]){return s}return e},null);if(!s){l()}this.fileType=s;this.fileTypeConfig=this.options.fileTypeConfig||e.FileTypeConfig[this.fileType];return this}},{key:"render",value:function p(){var e=this;this.compile();this.mapper=this.modules.reduce(function(e,t){return t.getRenderedMap(e)},{});Object.keys(this.mapper).forEach(function(t){var i=e.mapper[t];var s=i.from;var n=e.compiled[s];n.setTags(i.data);n.render(t);e.zip.file(t,n.content)});this.syncZip();return this}},{key:"syncZip",value:function m(){var e=this;Object.keys(this.xmlDocuments).forEach(function(t){e.zip.remove(t);var i=r.xml2str(e.xmlDocuments[t]);return e.zip.file(t,i,{})})}},{key:"setData",value:function g(e){this.data=e;return this}},{key:"getZip",value:function v(){return this.zip}},{key:"createTemplateClass",value:function _(e){var t=this.zip.files[e].asText();return this.createTemplateClassFromContent(t,e)}},{key:"createTemplateClassFromContent",value:function b(t,i){var s=this;var n={filePath:i};Object.keys(r.defaults).forEach(function(e){n[e]=s[e]});n.fileTypeConfig=this.fileTypeConfig;n.modules=this.modules;return new e.XmlTemplater(t,n)}},{key:"getFullText",value:function w(e){return this.createTemplateClass(e||this.fileTypeConfig.textPath).getFullText()}},{key:"getTemplatedFiles",value:function y(){this.templatedFiles=this.fileTypeConfig.getTemplatedFiles(this.zip);return this.templatedFiles}}]);return e}();d.DocUtils=e("./doc-utils");d.Errors=e("./errors");d.XmlTemplater=e("./xml-templater");d.FileTypeConfig=e("./file-type-config");d.XmlMatcher=e("./xml-matcher");t.exports=d},{"./doc-utils":1,"./errors":2,"./file-type-config":3,"./module-wrapper":6,"./traits":15,"./xml-matcher":16,"./xml-templater":17}]},{},[])("/src/js/docxtemplater.js")});(function(e){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=e()}else if(typeof define==="function"&&define.amd){define("extensions/adapt-exportFeedback/library/docxtemplater/jszip",[],e)}else{var t;if(typeof window!=="undefined"){t=window}else if(typeof global!=="undefined"){t=global}else if(typeof self!=="undefined"){t=self}else{t=this}t.JSZip=e()}})(function(){var e,t,i;return function s(e,t,i){function n(o,a){if(!t[o]){if(!e[o]){var l=typeof require=="function"&&require;if(!a&&l)return l(o,!0);if(r)return r(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var d=t[o]={exports:{}};e[o][0].call(d.exports,function(t){var i=e[o][1][t];return n(i?i:t)},d,d.exports,s,e,t,i)}return t[o].exports}var r=typeof require=="function"&&require;for(var o=0;o<i.length;o++)n(i[o]);return n}({1:[function(e,t,i){"use strict";var s=e("./dataReader");function n(e){if(e){this.data=e;this.length=this.data.length;this.index=0;this.zero=0;for(var t=0;t<this.data.length;t++){e[t]=e[t]&255}}}n.prototype=new s;n.prototype.byteAt=function(e){return this.data[this.zero+e]};n.prototype.lastIndexOfSignature=function(e){var t=e.charCodeAt(0),i=e.charCodeAt(1),s=e.charCodeAt(2),n=e.charCodeAt(3);for(var r=this.length-4;r>=0;--r){if(this.data[r]===t&&this.data[r+1]===i&&this.data[r+2]===s&&this.data[r+3]===n){return r-this.zero}}return-1};n.prototype.readData=function(e){this.checkOffset(e);if(e===0){return[]}var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);this.index+=e;return t};t.exports=n},{"./dataReader":6}],2:[function(e,t,i){"use strict";var s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(e,t){var i="";var n,r,o,a,l,c,d;var u=0;while(u<e.length){n=e.charCodeAt(u++);r=e.charCodeAt(u++);o=e.charCodeAt(u++);a=n>>2;l=(n&3)<<4|r>>4;c=(r&15)<<2|o>>6;d=o&63;if(isNaN(r)){c=d=64}else if(isNaN(o)){d=64}i=i+s.charAt(a)+s.charAt(l)+s.charAt(c)+s.charAt(d)}return i};i.decode=function(e,t){var i="";var n,r,o;var a,l,c,d;var u=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(u<e.length){a=s.indexOf(e.charAt(u++));l=s.indexOf(e.charAt(u++));c=s.indexOf(e.charAt(u++));d=s.indexOf(e.charAt(u++));n=a<<2|l>>4;r=(l&15)<<4|c>>2;o=(c&3)<<6|d;i=i+String.fromCharCode(n);if(c!=64){i=i+String.fromCharCode(r)}if(d!=64){i=i+String.fromCharCode(o)}}return i}},{}],3:[function(e,t,i){"use strict";function s(){this.compressedSize=0;this.uncompressedSize=0;this.crc32=0;this.compressionMethod=null;this.compressedContent=null}s.prototype={getContent:function(){return null},getCompressedContent:function(){return null}};t.exports=s},{}],4:[function(e,t,i){"use strict";i.STORE={magic:"\x00\x00",compress:function(e,t){return e},uncompress:function(e){return e},compressInputType:null,uncompressInputType:null};i.DEFLATE=e("./flate")},{"./flate":9}],5:[function(e,t,i){"use strict";var s=e("./utils");var n=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];t.exports=function r(e,t){if(typeof e==="undefined"||!e.length){return 0}var i=s.getTypeOf(e)!=="string";if(typeof t=="undefined"){t=0}var r=0;var o=0;var a=0;t=t^-1;for(var l=0,c=e.length;l<c;l++){a=i?e[l]:e.charCodeAt(l);o=(t^a)&255;r=n[o];t=t>>>8^r}return t^-1}},{"./utils":22}],6:[function(e,t,i){"use strict";var s=e("./utils");function n(e){this.data=null;this.length=0;this.index=0;this.zero=0}n.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0){throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")}},setIndex:function(e){this.checkIndex(e);this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(e){},readInt:function(e){var t=0,i;this.checkOffset(e);for(i=this.index+e-1;i>=this.index;i--){t=(t<<8)+this.byteAt(i)}this.index+=e;return t},readString:function(e){return s.transformTo("string",this.readData(e))},readData:function(e){},lastIndexOfSignature:function(e){},readDate:function(){var e=this.readInt(4);return new Date((e>>25&127)+1980,(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(e&31)<<1)}};t.exports=n},{"./utils":22}],7:[function(e,t,i){"use strict";i.base64=false;i.binary=false;i.dir=false;i.createFolders=false;i.date=null;i.compression=null;i.compressionOptions=null;i.comment=null;i.unixPermissions=null;i.dosPermissions=null},{}],8:[function(e,t,i){"use strict";var s=e("./utils");i.string2binary=function(e){return s.string2binary(e)};i.string2Uint8Array=function(e){return s.transformTo("uint8array",e)};i.uint8Array2String=function(e){return s.transformTo("string",e)};i.string2Blob=function(e){var t=s.transformTo("arraybuffer",e);return s.arrayBuffer2Blob(t)};i.arrayBuffer2Blob=function(e){return s.arrayBuffer2Blob(e)};i.transformTo=function(e,t){return s.transformTo(e,t)};i.getTypeOf=function(e){return s.getTypeOf(e)};i.checkSupport=function(e){return s.checkSupport(e)};i.MAX_VALUE_16BITS=s.MAX_VALUE_16BITS;i.MAX_VALUE_32BITS=s.MAX_VALUE_32BITS;i.pretty=function(e){return s.pretty(e)};i.findCompression=function(e){return s.findCompression(e)};i.isRegExp=function(e){return s.isRegExp(e)}},{"./utils":22}],9:[function(e,t,i){"use strict";var s=typeof Uint8Array!=="undefined"&&typeof Uint16Array!=="undefined"&&typeof Uint32Array!=="undefined";var n=e("pako");i.uncompressInputType=s?"uint8array":"array";i.compressInputType=s?"uint8array":"array";i.magic="\b\x00";i.compress=function(e,t){return n.deflateRaw(e,{level:t.level||-1})};i.uncompress=function(e){return n.inflateRaw(e)}},{pako:25}],10:[function(e,t,i){"use strict";var s=e("./base64");function n(e,t){if(!(this instanceof n))return new n(e,t);this.files={};this.comment=null;this.root="";if(e){this.load(e,t)}this.clone=function(){var e=new n;for(var t in this){if(typeof this[t]!=="function"){e[t]=this[t]}}return e}}n.prototype=e("./object");n.prototype.load=e("./load");n.support=e("./support");n.defaults=e("./defaults");n.utils=e("./deprecatedPublicUtils");n.base64={encode:function(e){return s.encode(e)},decode:function(e){return s.decode(e)}};n.compressions=e("./compressions");t.exports=n},{"./base64":2,"./compressions":4,"./defaults":7,"./deprecatedPublicUtils":8,"./load":11,"./object":14,"./support":18}],11:[function(e,t,i){"use strict";var s=e("./base64");var n=e("./utf8");var r=e("./utils");var o=e("./zipEntries");t.exports=function(e,t){var i,a,l,c;t=r.extend(t||{},{base64:false,checkCRC32:false,optimizedBinaryString:false,createFolders:false,decodeFileName:n.utf8decode});if(t.base64){e=s.decode(e)}a=new o(e,t);i=a.files;for(l=0;l<i.length;l++){c=i[l];this.file(c.fileNameStr,c.decompressed,{binary:true,optimizedBinaryString:true,date:c.date,dir:c.dir,comment:c.fileCommentStr.length?c.fileCommentStr:null,unixPermissions:c.unixPermissions,dosPermissions:c.dosPermissions,createFolders:t.createFolders})}if(a.zipComment.length){this.comment=a.zipComment}return this}},{"./base64":2,"./utf8":21,"./utils":22,"./zipEntries":23}],12:[function(e,t,i){(function(e){"use strict";t.exports=function(t,i){return new e(t,i)};t.exports.test=function(t){return e.isBuffer(t)}}).call(this,typeof Buffer!=="undefined"?Buffer:undefined)},{}],13:[function(e,t,i){"use strict";var s=e("./uint8ArrayReader");function n(e){this.data=e;this.length=this.data.length;this.index=0;this.zero=0}n.prototype=new s;n.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);this.index+=e;return t};t.exports=n},{"./uint8ArrayReader":19}],14:[function(e,t,i){"use strict";var s=e("./support");var n=e("./utils");var r=e("./crc32");var o=e("./signature");var a=e("./defaults");var l=e("./base64");var c=e("./compressions");var d=e("./compressedObject");var u=e("./nodeBuffer");var h=e("./utf8");var f=e("./stringWriter");var p=e("./uint8ArrayWriter");var m=function(e){if(e._data instanceof d){e._data=e._data.getContent();e.options.binary=true;e.options.base64=false;if(n.getTypeOf(e._data)==="uint8array"){var t=e._data;e._data=new Uint8Array(t.length);if(t.length!==0){e._data.set(t,0)}}}return e._data};var g=function(e){var t=m(e),i=n.getTypeOf(t);if(i==="string"){if(!e.options.binary){if(s.nodebuffer){return u(t,"utf-8")}}return e.asBinary()}return t};var v=function(e){var t=m(this);if(t===null||typeof t==="undefined"){return""}if(this.options.base64){t=l.decode(t)}if(e&&this.options.binary){t=E.utf8decode(t)}else{t=n.transformTo("string",t)}if(!e&&!this.options.binary){t=n.transformTo("string",E.utf8encode(t))}return t};var _=function(e,t,i){this.name=e;this.dir=i.dir;this.date=i.date;this.comment=i.comment;this.unixPermissions=i.unixPermissions;this.dosPermissions=i.dosPermissions;this._data=t;this.options=i;this._initialMetadata={dir:i.dir,date:i.date}};_.prototype={asText:function(){return v.call(this,true)},asBinary:function(){return v.call(this,false)},asNodeBuffer:function(){var e=g(this);return n.transformTo("nodebuffer",e)},asUint8Array:function(){var e=g(this);return n.transformTo("uint8array",e)},asArrayBuffer:function(){return this.asUint8Array().buffer}};var b=function(e,t){var i="",s;for(s=0;s<t;s++){i+=String.fromCharCode(e&255);e=e>>>8}return i};var w=function(e){e=e||{};if(e.base64===true&&(e.binary===null||e.binary===undefined)){e.binary=true}e=n.extend(e,a);e.date=e.date||new Date;if(e.compression!==null)e.compression=e.compression.toUpperCase();return e};var y=function(e,t,i){var s=n.getTypeOf(t),r;i=w(i);if(typeof i.unixPermissions==="string"){i.unixPermissions=parseInt(i.unixPermissions,8)}if(i.unixPermissions&&i.unixPermissions&16384){i.dir=true}if(i.dosPermissions&&i.dosPermissions&16){i.dir=true}if(i.dir){e=k(e)}if(i.createFolders&&(r=C(e))){S.call(this,r,true)}if(i.dir||t===null||typeof t==="undefined"){i.base64=false;i.binary=false;t=null;s=null}else if(s==="string"){if(i.binary&&!i.base64){if(i.optimizedBinaryString!==true){t=n.string2binary(t)}}}else{i.base64=false;i.binary=true;if(!s&&!(t instanceof d)){throw new Error("The data of '"+e+"' is in an unsupported format !")}if(s==="arraybuffer"){t=n.transformTo("uint8array",t)}}var o=new _(e,t,i);this.files[e]=o;return o};var C=function(e){if(e.slice(-1)=="/"){e=e.substring(0,e.length-1)}var t=e.lastIndexOf("/");return t>0?e.substring(0,t):""};var k=function(e){if(e.slice(-1)!="/"){e+="/"}return e};var S=function(e,t){t=typeof t!=="undefined"?t:false;e=k(e);if(!this.files[e]){y.call(this,e,null,{dir:true,createFolders:t})}return this.files[e]};var x=function(e,t,i){var s=new d,o;if(e._data instanceof d){s.uncompressedSize=e._data.uncompressedSize;s.crc32=e._data.crc32;if(s.uncompressedSize===0||e.dir){t=c["STORE"];s.compressedContent="";s.crc32=0}else if(e._data.compressionMethod===t.magic){s.compressedContent=e._data.getCompressedContent()}else{o=e._data.getContent();s.compressedContent=t.compress(n.transformTo(t.compressInputType,o),i)}}else{o=g(e);if(!o||o.length===0||e.dir){t=c["STORE"];o=""}s.uncompressedSize=o.length;s.crc32=r(o);s.compressedContent=t.compress(n.transformTo(t.compressInputType,o),i)}s.compressedSize=s.compressedContent.length;s.compressionMethod=t.magic;return s};var I=function(e,t){var i=e;if(!e){i=t?16893:33204}return(i&65535)<<16};var A=function(e,t){return(e||0)&63};var T=function(e,t,i,s,a,l){var c=i.compressedContent,d=l!==h.utf8encode,u=n.transformTo("string",l(t.name)),f=n.transformTo("string",h.utf8encode(t.name)),p=t.comment||"",m=n.transformTo("string",l(p)),g=n.transformTo("string",h.utf8encode(p)),v=f.length!==t.name.length,_=g.length!==p.length,w=t.options,y,C,k="",S="",x="",T,E;if(t._initialMetadata.dir!==t.dir){T=t.dir}else{T=w.dir}if(t._initialMetadata.date!==t.date){E=t.date}else{E=w.date}var R=0;var $=0;if(T){R|=16}if(a==="UNIX"){$=798;R|=I(t.unixPermissions,T)}else{$=20;R|=A(t.dosPermissions,T)}y=E.getHours();y=y<<6;y=y|E.getMinutes();y=y<<5;y=y|E.getSeconds()/2;C=E.getFullYear()-1980;C=C<<4;C=C|E.getMonth()+1;C=C<<5;C=C|E.getDate();if(v){S=b(1,1)+b(r(u),4)+f;k+="up"+b(S.length,2)+S}if(_){x=b(1,1)+b(this.crc32(m),4)+g;k+="uc"+b(x.length,2)+x}var O="";O+="\n\x00";O+=!d&&(v||_)?"\x00\b":"\x00\x00";O+=i.compressionMethod;O+=b(y,2);O+=b(C,2);O+=b(i.crc32,4);O+=b(i.compressedSize,4);O+=b(i.uncompressedSize,4);O+=b(u.length,2);O+=b(k.length,2);var L=o.LOCAL_FILE_HEADER+O+u+k;var P=o.CENTRAL_FILE_HEADER+b($,2)+O+b(m.length,2)+"\x00\x00"+"\x00\x00"+b(R,4)+b(s,4)+u+k+m;return{fileRecord:L,dirRecord:P,compressedObject:i}};var E={load:function(e,t){throw new Error("Load method is not defined. Is the file jszip-load.js included ?")},filter:function(e){var t=[],i,s,r,o;for(i in this.files){if(!this.files.hasOwnProperty(i)){continue}r=this.files[i];o=new _(r.name,r._data,n.extend(r.options));s=i.slice(this.root.length,i.length);if(i.slice(0,this.root.length)===this.root&&e(s,o)){t.push(o)}}return t},file:function(e,t,i){if(arguments.length===1){if(n.isRegExp(e)){var s=e;return this.filter(function(e,t){return!t.dir&&s.test(e)})}else{return this.filter(function(t,i){return!i.dir&&t===e})[0]||null}}else{e=this.root+e;y.call(this,e,t,i)}return this},folder:function(e){if(!e){return this}if(n.isRegExp(e)){return this.filter(function(t,i){return i.dir&&e.test(t)})}var t=this.root+e;var i=S.call(this,t);var s=this.clone();s.root=i.name;return s},remove:function(e){e=this.root+e;var t=this.files[e];if(!t){if(e.slice(-1)!="/"){e+="/"}t=this.files[e]}if(t&&!t.dir){delete this.files[e]}else{var i=this.filter(function(t,i){return i.name.slice(0,e.length)===e});for(var s=0;s<i.length;s++){delete this.files[i[s].name]}}return this},generate:function(e){e=n.extend(e||{},{base64:true,compression:"STORE",compressionOptions:null,type:"base64",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:h.utf8encode});n.checkSupport(e.type);if(e.platform==="darwin"||e.platform==="freebsd"||e.platform==="linux"||e.platform==="sunos"){e.platform="UNIX"}if(e.platform==="win32"){e.platform="DOS"}var t=[],i=0,s=0,r,a,d=n.transformTo("string",e.encodeFileName(e.comment||this.comment||""));for(var u in this.files){if(!this.files.hasOwnProperty(u)){continue}var m=this.files[u];var g=m.options.compression||e.compression.toUpperCase();var v=c[g];if(!v){throw new Error(g+" is not a valid compression method !")}var _=m.options.compressionOptions||e.compressionOptions||{};var w=x.call(this,m,v,_);var y=T.call(this,u,m,w,i,e.platform,e.encodeFileName);i+=y.fileRecord.length+w.compressedSize;s+=y.dirRecord.length;t.push(y)}var C="";C=o.CENTRAL_DIRECTORY_END+"\x00\x00"+"\x00\x00"+b(t.length,2)+b(t.length,2)+b(s,4)+b(i,4)+b(d.length,2)+d;
var k=e.type.toLowerCase();if(k==="uint8array"||k==="arraybuffer"||k==="blob"||k==="nodebuffer"){r=new p(i+s+C.length)}else{r=new f(i+s+C.length)}for(a=0;a<t.length;a++){r.append(t[a].fileRecord);r.append(t[a].compressedObject.compressedContent)}for(a=0;a<t.length;a++){r.append(t[a].dirRecord)}r.append(C);var S=r.finalize();switch(e.type.toLowerCase()){case"uint8array":case"arraybuffer":case"nodebuffer":return n.transformTo(e.type.toLowerCase(),S);case"blob":return n.arrayBuffer2Blob(n.transformTo("arraybuffer",S),e.mimeType);case"base64":return e.base64?l.encode(S):S;default:return S}},crc32:function(e,t){return r(e,t)},utf8encode:function(e){return n.transformTo("string",h.utf8encode(e))},utf8decode:function(e){return h.utf8decode(e)}};t.exports=E},{"./base64":2,"./compressedObject":3,"./compressions":4,"./crc32":5,"./defaults":7,"./nodeBuffer":12,"./signature":15,"./stringWriter":17,"./support":18,"./uint8ArrayWriter":20,"./utf8":21,"./utils":22}],15:[function(e,t,i){"use strict";i.LOCAL_FILE_HEADER="PK";i.CENTRAL_FILE_HEADER="PK";i.CENTRAL_DIRECTORY_END="PK";i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK";i.ZIP64_CENTRAL_DIRECTORY_END="PK";i.DATA_DESCRIPTOR="PK\b"},{}],16:[function(e,t,i){"use strict";var s=e("./dataReader");var n=e("./utils");function r(e,t){this.data=e;if(!t){this.data=n.string2binary(this.data)}this.length=this.data.length;this.index=0;this.zero=0}r.prototype=new s;r.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)};r.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero};r.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);this.index+=e;return t};t.exports=r},{"./dataReader":6,"./utils":22}],17:[function(e,t,i){"use strict";var s=e("./utils");var n=function(){this.data=[]};n.prototype={append:function(e){e=s.transformTo("string",e);this.data.push(e)},finalize:function(){return this.data.join("")}};t.exports=n},{"./utils":22}],18:[function(e,t,i){(function(e){"use strict";i.base64=true;i.array=true;i.string=true;i.arraybuffer=typeof ArrayBuffer!=="undefined"&&typeof Uint8Array!=="undefined";i.nodebuffer=typeof e!=="undefined";i.uint8array=typeof Uint8Array!=="undefined";if(typeof ArrayBuffer==="undefined"){i.blob=false}else{var t=new ArrayBuffer(0);try{i.blob=new Blob([t],{type:"application/zip"}).size===0}catch(s){try{var n=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;var r=new n;r.append(t);i.blob=r.getBlob("application/zip").size===0}catch(s){i.blob=false}}}}).call(this,typeof Buffer!=="undefined"?Buffer:undefined)},{}],19:[function(e,t,i){"use strict";var s=e("./arrayReader");function n(e){if(e){this.data=e;this.length=this.data.length;this.index=0;this.zero=0}}n.prototype=new s;n.prototype.readData=function(e){this.checkOffset(e);if(e===0){return new Uint8Array(0)}var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);this.index+=e;return t};t.exports=n},{"./arrayReader":1}],20:[function(e,t,i){"use strict";var s=e("./utils");var n=function(e){this.data=new Uint8Array(e);this.index=0};n.prototype={append:function(e){if(e.length!==0){e=s.transformTo("uint8array",e);this.data.set(e,this.index);this.index+=e.length}},finalize:function(){return this.data}};t.exports=n},{"./utils":22}],21:[function(e,t,i){"use strict";var s=e("./utils");var n=e("./support");var r=e("./nodeBuffer");var o=new Array(256);for(var a=0;a<256;a++){o[a]=a>=252?6:a>=248?5:a>=240?4:a>=224?3:a>=192?2:1}o[254]=o[254]=1;var l=function(e){var t,i,s,r,o,a=e.length,l=0;for(r=0;r<a;r++){i=e.charCodeAt(r);if((i&64512)===55296&&r+1<a){s=e.charCodeAt(r+1);if((s&64512)===56320){i=65536+(i-55296<<10)+(s-56320);r++}}l+=i<128?1:i<2048?2:i<65536?3:4}if(n.uint8array){t=new Uint8Array(l)}else{t=new Array(l)}for(o=0,r=0;o<l;r++){i=e.charCodeAt(r);if((i&64512)===55296&&r+1<a){s=e.charCodeAt(r+1);if((s&64512)===56320){i=65536+(i-55296<<10)+(s-56320);r++}}if(i<128){t[o++]=i}else if(i<2048){t[o++]=192|i>>>6;t[o++]=128|i&63}else if(i<65536){t[o++]=224|i>>>12;t[o++]=128|i>>>6&63;t[o++]=128|i&63}else{t[o++]=240|i>>>18;t[o++]=128|i>>>12&63;t[o++]=128|i>>>6&63;t[o++]=128|i&63}}return t};var c=function(e,t){var i;t=t||e.length;if(t>e.length){t=e.length}i=t-1;while(i>=0&&(e[i]&192)===128){i--}if(i<0){return t}if(i===0){return t}return i+o[e[i]]>t?i:t};var d=function(e){var t,i,n,r,a;var l=e.length;var c=new Array(l*2);for(n=0,i=0;i<l;){r=e[i++];if(r<128){c[n++]=r;continue}a=o[r];if(a>4){c[n++]=65533;i+=a-1;continue}r&=a===2?31:a===3?15:7;while(a>1&&i<l){r=r<<6|e[i++]&63;a--}if(a>1){c[n++]=65533;continue}if(r<65536){c[n++]=r}else{r-=65536;c[n++]=55296|r>>10&1023;c[n++]=56320|r&1023}}if(c.length!==n){if(c.subarray){c=c.subarray(0,n)}else{c.length=n}}return s.applyFromCharCode(c)};i.utf8encode=function u(e){if(n.nodebuffer){return r(e,"utf-8")}return l(e)};i.utf8decode=function h(e){if(n.nodebuffer){return s.transformTo("nodebuffer",e).toString("utf-8")}e=s.transformTo(n.uint8array?"uint8array":"array",e);var t=[],i=0,r=e.length,o=65536;while(i<r){var a=c(e,Math.min(i+o,r));if(n.uint8array){t.push(d(e.subarray(i,a)))}else{t.push(d(e.slice(i,a)))}i=a}return t.join("")}},{"./nodeBuffer":12,"./support":18,"./utils":22}],22:[function(e,t,i){"use strict";var s=e("./support");var n=e("./compressions");var r=e("./nodeBuffer");i.string2binary=function(e){var t="";for(var i=0;i<e.length;i++){t+=String.fromCharCode(e.charCodeAt(i)&255)}return t};i.arrayBuffer2Blob=function(e,t){i.checkSupport("blob");t=t||"application/zip";try{return new Blob([e],{type:t})}catch(s){try{var n=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;var r=new n;r.append(e);return r.getBlob(t)}catch(s){throw new Error("Bug : can't construct the Blob.")}}};function o(e){return e}function a(e,t){for(var i=0;i<e.length;++i){t[i]=e.charCodeAt(i)&255}return t}function l(e){var t=65536;var s=[],n=e.length,o=i.getTypeOf(e),a=0,l=true;try{switch(o){case"uint8array":String.fromCharCode.apply(null,new Uint8Array(0));break;case"nodebuffer":String.fromCharCode.apply(null,r(0));break}}catch(c){l=false}if(!l){var d="";for(var u=0;u<e.length;u++){d+=String.fromCharCode(e[u])}return d}while(a<n&&t>1){try{if(o==="array"||o==="nodebuffer"){s.push(String.fromCharCode.apply(null,e.slice(a,Math.min(a+t,n))))}else{s.push(String.fromCharCode.apply(null,e.subarray(a,Math.min(a+t,n))))}a+=t}catch(c){t=Math.floor(t/2)}}return s.join("")}i.applyFromCharCode=l;function c(e,t){for(var i=0;i<e.length;i++){t[i]=e[i]}return t}var d={};d["string"]={string:o,array:function(e){return a(e,new Array(e.length))},arraybuffer:function(e){return d["string"]["uint8array"](e).buffer},uint8array:function(e){return a(e,new Uint8Array(e.length))},nodebuffer:function(e){return a(e,r(e.length))}};d["array"]={string:l,array:o,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return r(e)}};d["arraybuffer"]={string:function(e){return l(new Uint8Array(e))},array:function(e){return c(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:o,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return r(new Uint8Array(e))}};d["uint8array"]={string:l,array:function(e){return c(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:o,nodebuffer:function(e){return r(e)}};d["nodebuffer"]={string:l,array:function(e){return c(e,new Array(e.length))},arraybuffer:function(e){return d["nodebuffer"]["uint8array"](e).buffer},uint8array:function(e){return c(e,new Uint8Array(e.length))},nodebuffer:o};i.transformTo=function(e,t){if(!t){t=""}if(!e){return t}i.checkSupport(e);var s=i.getTypeOf(t);var n=d[s][e](t);return n};i.getTypeOf=function(e){if(typeof e==="string"){return"string"}if(Object.prototype.toString.call(e)==="[object Array]"){return"array"}if(s.nodebuffer&&r.test(e)){return"nodebuffer"}if(s.uint8array&&e instanceof Uint8Array){return"uint8array"}if(s.arraybuffer&&e instanceof ArrayBuffer){return"arraybuffer"}};i.checkSupport=function(e){var t=s[e.toLowerCase()];if(!t){throw new Error(e+" is not supported by this browser")}};i.MAX_VALUE_16BITS=65535;i.MAX_VALUE_32BITS=-1;i.pretty=function(e){var t="",i,s;for(s=0;s<(e||"").length;s++){i=e.charCodeAt(s);t+="\\x"+(i<16?"0":"")+i.toString(16).toUpperCase()}return t};i.findCompression=function(e){for(var t in n){if(!n.hasOwnProperty(t)){continue}if(n[t].magic===e){return n[t]}}return null};i.isRegExp=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"};i.extend=function(){var e={},t,i;for(t=0;t<arguments.length;t++){for(i in arguments[t]){if(arguments[t].hasOwnProperty(i)&&typeof e[i]==="undefined"){e[i]=arguments[t][i]}}}return e}},{"./compressions":4,"./nodeBuffer":12,"./support":18}],23:[function(e,t,i){"use strict";var s=e("./stringReader");var n=e("./nodeBufferReader");var r=e("./uint8ArrayReader");var o=e("./arrayReader");var a=e("./utils");var l=e("./signature");var c=e("./zipEntry");var d=e("./support");var u=e("./object");function h(e,t){this.files=[];this.loadOptions=t;if(e){this.load(e)}}h.prototype={checkSignature:function(e){var t=this.reader.readString(4);if(t!==e){throw new Error("Corrupted zip or bug : unexpected signature "+"("+a.pretty(t)+", expected "+a.pretty(e)+")")}},isSignature:function(e,t){var i=this.reader.index;this.reader.setIndex(e);var s=this.reader.readString(4);var n=s===t;this.reader.setIndex(i);return n},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2);this.diskWithCentralDirStart=this.reader.readInt(2);this.centralDirRecordsOnThisDisk=this.reader.readInt(2);this.centralDirRecords=this.reader.readInt(2);this.centralDirSize=this.reader.readInt(4);this.centralDirOffset=this.reader.readInt(4);this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength);var t=d.uint8array?"uint8array":"array";var i=a.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(i)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8);this.versionMadeBy=this.reader.readString(2);this.versionNeeded=this.reader.readInt(2);this.diskNumber=this.reader.readInt(4);this.diskWithCentralDirStart=this.reader.readInt(4);this.centralDirRecordsOnThisDisk=this.reader.readInt(8);this.centralDirRecords=this.reader.readInt(8);this.centralDirSize=this.reader.readInt(8);this.centralDirOffset=this.reader.readInt(8);this.zip64ExtensibleData={};var e=this.zip64EndOfCentralSize-44,t=0,i,s,n;while(t<e){i=this.reader.readInt(2);s=this.reader.readInt(4);n=this.reader.readString(s);this.zip64ExtensibleData[i]={id:i,length:s,value:n}}},readBlockZip64EndOfCentralLocator:function(){this.diskWithZip64CentralDirStart=this.reader.readInt(4);this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8);this.disksCount=this.reader.readInt(4);if(this.disksCount>1){throw new Error("Multi-volumes zip are not supported")}},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++){t=this.files[e];this.reader.setIndex(t.localHeaderOffset);this.checkSignature(l.LOCAL_FILE_HEADER);t.readLocalPart(this.reader);t.handleUTF8();t.processAttributes()}},readCentralDir:function(){var e;this.reader.setIndex(this.centralDirOffset);while(this.reader.readString(4)===l.CENTRAL_FILE_HEADER){e=new c({zip64:this.zip64},this.loadOptions);e.readCentralPart(this.reader);this.files.push(e)}if(this.centralDirRecords!==this.files.length){if(this.centralDirRecords!==0&&this.files.length===0){throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)}else{}}},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(l.CENTRAL_DIRECTORY_END);if(e<0){var t=!this.isSignature(0,l.LOCAL_FILE_HEADER);if(t){throw new Error("Can't find end of central directory : is this a zip file ? "+"If it is, see http://stuk.github.io/jszip/documentation/howto/read_zip.html")}else{throw new Error("Corrupted zip : can't find end of central directory")}}this.reader.setIndex(e);var i=e;this.checkSignature(l.CENTRAL_DIRECTORY_END);this.readBlockEndOfCentral();if(this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){this.zip64=true;e=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR);if(e<0){throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator")}this.reader.setIndex(e);this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_LOCATOR);this.readBlockZip64EndOfCentralLocator();if(!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,l.ZIP64_CENTRAL_DIRECTORY_END)){this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(l.ZIP64_CENTRAL_DIRECTORY_END);if(this.relativeOffsetEndOfZip64CentralDir<0){throw new Error("Corrupted zip : can't find the ZIP64 end of central directory")}}this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir);this.checkSignature(l.ZIP64_CENTRAL_DIRECTORY_END);this.readBlockZip64EndOfCentral()}var s=this.centralDirOffset+this.centralDirSize;if(this.zip64){s+=20;s+=12+this.zip64EndOfCentralSize}var n=i-s;if(n>0){if(this.isSignature(i,l.CENTRAL_FILE_HEADER)){}else{this.reader.zero=n}}else if(n<0){throw new Error("Corrupted zip: missing "+Math.abs(n)+" bytes.")}},prepareReader:function(e){var t=a.getTypeOf(e);a.checkSupport(t);if(t==="string"&&!d.uint8array){this.reader=new s(e,this.loadOptions.optimizedBinaryString)}else if(t==="nodebuffer"){this.reader=new n(e)}else if(d.uint8array){this.reader=new r(a.transformTo("uint8array",e))}else if(d.array){this.reader=new o(a.transformTo("array",e))}else{throw new Error("Unexpected error: unsupported type '"+t+"'")}},load:function(e){this.prepareReader(e);this.readEndOfCentral();this.readCentralDir();this.readLocalFiles()}};t.exports=h},{"./arrayReader":1,"./nodeBufferReader":13,"./object":14,"./signature":15,"./stringReader":16,"./support":18,"./uint8ArrayReader":19,"./utils":22,"./zipEntry":24}],24:[function(e,t,i){"use strict";var s=e("./stringReader");var n=e("./utils");var r=e("./compressedObject");var o=e("./object");var a=e("./support");var l=0;var c=3;function d(e,t){this.options=e;this.loadOptions=t}d.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},prepareCompressedContent:function(e,t,i){return function(){var s=e.index;e.setIndex(t);var n=e.readData(i);e.setIndex(s);return n}},prepareContent:function(e,t,i,s,r){return function(){var e=n.transformTo(s.uncompressInputType,this.getCompressedContent());var t=s.uncompress(e);if(t.length!==r){throw new Error("Bug : uncompressed data size mismatch")}return t}},readLocalPart:function(e){var t,i;e.skip(22);this.fileNameLength=e.readInt(2);i=e.readInt(2);this.fileName=e.readData(this.fileNameLength);e.skip(i);if(this.compressedSize==-1||this.uncompressedSize==-1){throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory "+"(compressedSize == -1 || uncompressedSize == -1)")}t=n.findCompression(this.compressionMethod);if(t===null){throw new Error("Corrupted zip : compression "+n.pretty(this.compressionMethod)+" unknown (inner file : "+n.transformTo("string",this.fileName)+")")}this.decompressed=new r;this.decompressed.compressedSize=this.compressedSize;this.decompressed.uncompressedSize=this.uncompressedSize;this.decompressed.crc32=this.crc32;this.decompressed.compressionMethod=this.compressionMethod;this.decompressed.getCompressedContent=this.prepareCompressedContent(e,e.index,this.compressedSize,t);this.decompressed.getContent=this.prepareContent(e,e.index,this.compressedSize,t,this.uncompressedSize);if(this.loadOptions.checkCRC32){this.decompressed=n.transformTo("string",this.decompressed.getContent());if(o.crc32(this.decompressed)!==this.crc32){throw new Error("Corrupted zip : CRC32 mismatch")}}},readCentralPart:function(e){this.versionMadeBy=e.readInt(2);this.versionNeeded=e.readInt(2);this.bitFlag=e.readInt(2);this.compressionMethod=e.readString(2);this.date=e.readDate();this.crc32=e.readInt(4);this.compressedSize=e.readInt(4);this.uncompressedSize=e.readInt(4);this.fileNameLength=e.readInt(2);this.extraFieldsLength=e.readInt(2);this.fileCommentLength=e.readInt(2);this.diskNumberStart=e.readInt(2);this.internalFileAttributes=e.readInt(2);this.externalFileAttributes=e.readInt(4);this.localHeaderOffset=e.readInt(4);if(this.isEncrypted()){throw new Error("Encrypted zip are not supported")}this.fileName=e.readData(this.fileNameLength);this.readExtraFields(e);this.parseZIP64ExtraField(e);this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null;this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=this.externalFileAttributes&16?true:false;if(e===l){this.dosPermissions=this.externalFileAttributes&63}if(e===c){this.unixPermissions=this.externalFileAttributes>>16&65535}if(!this.dir&&this.fileNameStr.slice(-1)==="/"){this.dir=true}},parseZIP64ExtraField:function(e){if(!this.extraFields[1]){return}var t=new s(this.extraFields[1].value);if(this.uncompressedSize===n.MAX_VALUE_32BITS){this.uncompressedSize=t.readInt(8)}if(this.compressedSize===n.MAX_VALUE_32BITS){this.compressedSize=t.readInt(8)}if(this.localHeaderOffset===n.MAX_VALUE_32BITS){this.localHeaderOffset=t.readInt(8)}if(this.diskNumberStart===n.MAX_VALUE_32BITS){this.diskNumberStart=t.readInt(4)}},readExtraFields:function(e){var t=e.index,i,s,n;this.extraFields=this.extraFields||{};while(e.index<t+this.extraFieldsLength){i=e.readInt(2);s=e.readInt(2);n=e.readString(s);this.extraFields[i]={id:i,length:s,value:n}}},handleUTF8:function(){var e=a.uint8array?"uint8array":"array";if(this.useUTF8()){this.fileNameStr=o.utf8decode(this.fileName);this.fileCommentStr=o.utf8decode(this.fileComment)}else{var t=this.findExtraFieldUnicodePath();if(t!==null){this.fileNameStr=t}else{var i=n.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(i)}var s=this.findExtraFieldUnicodeComment();if(s!==null){this.fileCommentStr=s}else{var r=n.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(r)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=new s(e.value);if(t.readInt(1)!==1){return null}if(o.crc32(this.fileName)!==t.readInt(4)){return null}return o.utf8decode(t.readString(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=new s(e.value);if(t.readInt(1)!==1){return null}if(o.crc32(this.fileComment)!==t.readInt(4)){return null}return o.utf8decode(t.readString(e.length-5))}return null}};t.exports=d},{"./compressedObject":3,"./object":14,"./stringReader":16,"./support":18,"./utils":22}],25:[function(e,t,i){var s=e("./lib/utils/common").assign;var n=e("./lib/deflate");var r=e("./lib/inflate");var o=e("./lib/zlib/constants");var a={};s(a,n,r,o);t.exports=a},{"./lib/deflate":26,"./lib/inflate":27,"./lib/utils/common":28,"./lib/zlib/constants":31}],26:[function(e,t,i){"use strict";var s=e("./zlib/deflate");var n=e("./utils/common");var r=e("./utils/strings");var o=e("./zlib/messages");var a=e("./zlib/zstream");var l=Object.prototype.toString;var c=0;var d=4;var u=0;var h=1;var f=2;var p=-1;var m=0;var g=8;function v(e){if(!(this instanceof v))return new v(e);this.options=n.assign({level:p,method:g,chunkSize:16384,windowBits:15,memLevel:8,strategy:m,to:""},e||{});var t=this.options;if(t.raw&&t.windowBits>0){t.windowBits=-t.windowBits}else if(t.gzip&&t.windowBits>0&&t.windowBits<16){t.windowBits+=16}this.err=0;this.msg="";this.ended=false;this.chunks=[];this.strm=new a;this.strm.avail_out=0;var i=s.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(i!==u){throw new Error(o[i])}if(t.header){s.deflateSetHeader(this.strm,t.header)}if(t.dictionary){var c;if(typeof t.dictionary==="string"){c=r.string2buf(t.dictionary)}else if(l.call(t.dictionary)==="[object ArrayBuffer]"){c=new Uint8Array(t.dictionary)}else{c=t.dictionary}i=s.deflateSetDictionary(this.strm,c);if(i!==u){throw new Error(o[i])}this._dict_set=true}}v.prototype.push=function(e,t){var i=this.strm;var o=this.options.chunkSize;var a,p;if(this.ended){return false}p=t===~~t?t:t===true?d:c;if(typeof e==="string"){i.input=r.string2buf(e)}else if(l.call(e)==="[object ArrayBuffer]"){i.input=new Uint8Array(e)}else{i.input=e}i.next_in=0;i.avail_in=i.input.length;do{if(i.avail_out===0){i.output=new n.Buf8(o);i.next_out=0;i.avail_out=o}a=s.deflate(i,p);if(a!==h&&a!==u){this.onEnd(a);this.ended=true;return false}if(i.avail_out===0||i.avail_in===0&&(p===d||p===f)){if(this.options.to==="string"){this.onData(r.buf2binstring(n.shrinkBuf(i.output,i.next_out)))}else{this.onData(n.shrinkBuf(i.output,i.next_out))}}}while((i.avail_in>0||i.avail_out===0)&&a!==h);if(p===d){a=s.deflateEnd(this.strm);this.onEnd(a);this.ended=true;return a===u}if(p===f){this.onEnd(u);i.avail_out=0;return true}return true};v.prototype.onData=function(e){this.chunks.push(e)};v.prototype.onEnd=function(e){if(e===u){if(this.options.to==="string"){this.result=this.chunks.join("")}else{this.result=n.flattenChunks(this.chunks)}}this.chunks=[];this.err=e;this.msg=this.strm.msg};function _(e,t){var i=new v(t);i.push(e,true);if(i.err){throw i.msg}return i.result}function b(e,t){t=t||{};t.raw=true;return _(e,t)}function w(e,t){t=t||{};t.gzip=true;return _(e,t)}i.Deflate=v;i.deflate=_;i.deflateRaw=b;i.gzip=w},{"./utils/common":28,"./utils/strings":29,"./zlib/deflate":33,"./zlib/messages":38,"./zlib/zstream":40}],27:[function(e,t,i){"use strict";var s=e("./zlib/inflate");var n=e("./utils/common");var r=e("./utils/strings");var o=e("./zlib/constants");var a=e("./zlib/messages");var l=e("./zlib/zstream");var c=e("./zlib/gzheader");var d=Object.prototype.toString;function u(e){if(!(this instanceof u))return new u(e);this.options=n.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;if(t.raw&&t.windowBits>=0&&t.windowBits<16){t.windowBits=-t.windowBits;if(t.windowBits===0){t.windowBits=-15}}if(t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)){t.windowBits+=32}if(t.windowBits>15&&t.windowBits<48){if((t.windowBits&15)===0){t.windowBits|=15}}this.err=0;this.msg="";this.ended=false;this.chunks=[];this.strm=new l;this.strm.avail_out=0;var i=s.inflateInit2(this.strm,t.windowBits);if(i!==o.Z_OK){throw new Error(a[i])}this.header=new c;s.inflateGetHeader(this.strm,this.header)}u.prototype.push=function(e,t){var i=this.strm;var a=this.options.chunkSize;var l=this.options.dictionary;var c,u;var h,f,p;var m;var g=false;if(this.ended){return false}u=t===~~t?t:t===true?o.Z_FINISH:o.Z_NO_FLUSH;if(typeof e==="string"){i.input=r.binstring2buf(e)}else if(d.call(e)==="[object ArrayBuffer]"){i.input=new Uint8Array(e)}else{i.input=e}i.next_in=0;i.avail_in=i.input.length;do{if(i.avail_out===0){i.output=new n.Buf8(a);i.next_out=0;i.avail_out=a}c=s.inflate(i,o.Z_NO_FLUSH);if(c===o.Z_NEED_DICT&&l){if(typeof l==="string"){m=r.string2buf(l)}else if(d.call(l)==="[object ArrayBuffer]"){m=new Uint8Array(l)}else{m=l}c=s.inflateSetDictionary(this.strm,m)}if(c===o.Z_BUF_ERROR&&g===true){c=o.Z_OK;g=false}if(c!==o.Z_STREAM_END&&c!==o.Z_OK){this.onEnd(c);this.ended=true;return false}if(i.next_out){if(i.avail_out===0||c===o.Z_STREAM_END||i.avail_in===0&&(u===o.Z_FINISH||u===o.Z_SYNC_FLUSH)){if(this.options.to==="string"){h=r.utf8border(i.output,i.next_out);f=i.next_out-h;p=r.buf2string(i.output,h);i.next_out=f;i.avail_out=a-f;if(f){n.arraySet(i.output,i.output,h,f,0)}this.onData(p)}else{this.onData(n.shrinkBuf(i.output,i.next_out))}}}if(i.avail_in===0&&i.avail_out===0){g=true}}while((i.avail_in>0||i.avail_out===0)&&c!==o.Z_STREAM_END);if(c===o.Z_STREAM_END){u=o.Z_FINISH}if(u===o.Z_FINISH){c=s.inflateEnd(this.strm);this.onEnd(c);this.ended=true;return c===o.Z_OK}if(u===o.Z_SYNC_FLUSH){this.onEnd(o.Z_OK);i.avail_out=0;return true}return true};u.prototype.onData=function(e){this.chunks.push(e)};u.prototype.onEnd=function(e){if(e===o.Z_OK){if(this.options.to==="string"){this.result=this.chunks.join("")}else{this.result=n.flattenChunks(this.chunks)}}this.chunks=[];this.err=e;this.msg=this.strm.msg};function h(e,t){var i=new u(t);i.push(e,true);if(i.err){throw i.msg}return i.result}function f(e,t){t=t||{};t.raw=true;return h(e,t)}i.Inflate=u;i.inflate=h;i.inflateRaw=f;i.ungzip=h},{"./utils/common":28,"./utils/strings":29,"./zlib/constants":31,"./zlib/gzheader":34,"./zlib/inflate":36,"./zlib/messages":38,"./zlib/zstream":40}],28:[function(e,t,i){"use strict";var s=typeof Uint8Array!=="undefined"&&typeof Uint16Array!=="undefined"&&typeof Int32Array!=="undefined";i.assign=function(e){var t=Array.prototype.slice.call(arguments,1);while(t.length){var i=t.shift();if(!i){continue}if(typeof i!=="object"){throw new TypeError(i+"must be non-object")}for(var s in i){if(i.hasOwnProperty(s)){e[s]=i[s]}}}return e};i.shrinkBuf=function(e,t){if(e.length===t){return e}if(e.subarray){return e.subarray(0,t)}e.length=t;return e};var n={arraySet:function(e,t,i,s,n){if(t.subarray&&e.subarray){e.set(t.subarray(i,i+s),n);return}for(var r=0;r<s;r++){e[n+r]=t[i+r]}},flattenChunks:function(e){var t,i,s,n,r,o;s=0;for(t=0,i=e.length;t<i;t++){s+=e[t].length}o=new Uint8Array(s);n=0;for(t=0,i=e.length;t<i;t++){r=e[t];o.set(r,n);n+=r.length}return o}};var r={arraySet:function(e,t,i,s,n){for(var r=0;r<s;r++){e[n+r]=t[i+r]}},flattenChunks:function(e){return[].concat.apply([],e)}};i.setTyped=function(e){if(e){i.Buf8=Uint8Array;i.Buf16=Uint16Array;i.Buf32=Int32Array;i.assign(i,n)}else{i.Buf8=Array;i.Buf16=Array;i.Buf32=Array;i.assign(i,r)}};i.setTyped(s)},{}],29:[function(e,t,i){var s=e("./common");var n=true;var r=true;try{String.fromCharCode.apply(null,[0])}catch(o){n=false}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(o){r=false}var a=new s.Buf8(256);for(var l=0;l<256;l++){a[l]=l>=252?6:l>=248?5:l>=240?4:l>=224?3:l>=192?2:1}a[254]=a[254]=1;i.string2buf=function(e){var t,i,n,r,o,a=e.length,l=0;for(r=0;r<a;r++){i=e.charCodeAt(r);if((i&64512)===55296&&r+1<a){n=e.charCodeAt(r+1);if((n&64512)===56320){i=65536+(i-55296<<10)+(n-56320);r++}}l+=i<128?1:i<2048?2:i<65536?3:4}t=new s.Buf8(l);for(o=0,r=0;o<l;r++){i=e.charCodeAt(r);if((i&64512)===55296&&r+1<a){n=e.charCodeAt(r+1);if((n&64512)===56320){i=65536+(i-55296<<10)+(n-56320);r++}}if(i<128){t[o++]=i}else if(i<2048){t[o++]=192|i>>>6;t[o++]=128|i&63}else if(i<65536){t[o++]=224|i>>>12;t[o++]=128|i>>>6&63;t[o++]=128|i&63}else{t[o++]=240|i>>>18;t[o++]=128|i>>>12&63;t[o++]=128|i>>>6&63;t[o++]=128|i&63}}return t};function c(e,t){if(t<65537){if(e.subarray&&r||!e.subarray&&n){return String.fromCharCode.apply(null,s.shrinkBuf(e,t))}}var i="";for(var o=0;o<t;o++){i+=String.fromCharCode(e[o])}return i}i.buf2binstring=function(e){return c(e,e.length)};i.binstring2buf=function(e){var t=new s.Buf8(e.length);for(var i=0,n=t.length;i<n;i++){t[i]=e.charCodeAt(i)}return t};i.buf2string=function(e,t){var i,s,n,r;var o=t||e.length;var l=new Array(o*2);for(s=0,i=0;i<o;){n=e[i++];if(n<128){l[s++]=n;continue}r=a[n];if(r>4){l[s++]=65533;i+=r-1;continue}n&=r===2?31:r===3?15:7;while(r>1&&i<o){n=n<<6|e[i++]&63;r--}if(r>1){l[s++]=65533;continue}if(n<65536){l[s++]=n}else{n-=65536;l[s++]=55296|n>>10&1023;l[s++]=56320|n&1023}}return c(l,s)};i.utf8border=function(e,t){var i;t=t||e.length;if(t>e.length){t=e.length}i=t-1;while(i>=0&&(e[i]&192)===128){i--}if(i<0){return t}if(i===0){return t}return i+a[e[i]]>t?i:t}},{"./common":28}],30:[function(e,t,i){"use strict";function s(e,t,i,s){var n=e&65535|0,r=e>>>16&65535|0,o=0;while(i!==0){o=i>2e3?2e3:i;i-=o;do{n=n+t[s++]|0;r=r+n|0}while(--o);n%=65521;r%=65521}return n|r<<16|0}t.exports=s},{}],31:[function(e,t,i){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],32:[function(e,t,i){"use strict";function s(){var e,t=[];for(var i=0;i<256;i++){e=i;for(var s=0;s<8;s++){e=e&1?3988292384^e>>>1:e>>>1}t[i]=e}return t}var n=s();function r(e,t,i,s){var r=n,o=s+i;e^=-1;for(var a=s;a<o;a++){e=e>>>8^r[(e^t[a])&255]}return e^-1}t.exports=r},{}],33:[function(e,t,i){"use strict";var s=e("../utils/common");var n=e("./trees");var r=e("./adler32");var o=e("./crc32");var a=e("./messages");var l=0;var c=1;var d=3;var u=4;var h=5;var f=0;var p=1;var m=-2;var g=-3;var v=-5;var _=-1;var b=1;var w=2;var y=3;var C=4;var k=0;var S=2;var x=8;var I=9;var A=15;var T=8;var E=29;var R=256;var $=R+1+E;var O=30;var L=19;var P=2*$+1;var D=15;var M=3;var V=258;var N=V+M+1;var z=32;var B=42;var j=69;var F=73;var q=91;var U=103;var H=113;var W=666;var Q=1;var Z=2;var J=3;var X=4;var K=3;function Y(e,t){e.msg=a[t];return t}function G(e){return(e<<1)-(e>4?9:0)}function ee(e){var t=e.length;while(--t>=0){e[t]=0}}function te(e){var t=e.state;var i=t.pending;if(i>e.avail_out){i=e.avail_out}if(i===0){return}s.arraySet(e.output,t.pending_buf,t.pending_out,i,e.next_out);e.next_out+=i;t.pending_out+=i;e.total_out+=i;e.avail_out-=i;t.pending-=i;if(t.pending===0){t.pending_out=0}}function ie(e,t){n._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t);e.block_start=e.strstart;te(e.strm)}function se(e,t){e.pending_buf[e.pending++]=t}function ne(e,t){e.pending_buf[e.pending++]=t>>>8&255;e.pending_buf[e.pending++]=t&255}function re(e,t,i,n){var a=e.avail_in;if(a>n){a=n}if(a===0){return 0}e.avail_in-=a;s.arraySet(t,e.input,e.next_in,a,i);if(e.state.wrap===1){e.adler=r(e.adler,t,a,i)}else if(e.state.wrap===2){e.adler=o(e.adler,t,a,i)}e.next_in+=a;e.total_in+=a;return a}function oe(e,t){var i=e.max_chain_length;var s=e.strstart;var n;var r;var o=e.prev_length;var a=e.nice_match;var l=e.strstart>e.w_size-N?e.strstart-(e.w_size-N):0;var c=e.window;var d=e.w_mask;var u=e.prev;var h=e.strstart+V;var f=c[s+o-1];var p=c[s+o];if(e.prev_length>=e.good_match){i>>=2}if(a>e.lookahead){a=e.lookahead}do{n=t;if(c[n+o]!==p||c[n+o-1]!==f||c[n]!==c[s]||c[++n]!==c[s+1]){continue}s+=2;n++;do{}while(c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&c[++s]===c[++n]&&s<h);r=V-(h-s);s=h-V;if(r>o){e.match_start=t;o=r;if(r>=a){break}f=c[s+o-1];p=c[s+o]}}while((t=u[t&d])>l&&--i!==0);if(o<=e.lookahead){return o}return e.lookahead}function ae(e){var t=e.w_size;var i,n,r,o,a;do{o=e.window_size-e.lookahead-e.strstart;if(e.strstart>=t+(t-N)){s.arraySet(e.window,e.window,t,t,0);e.match_start-=t;e.strstart-=t;e.block_start-=t;n=e.hash_size;i=n;do{r=e.head[--i];e.head[i]=r>=t?r-t:0}while(--n);n=t;i=n;do{r=e.prev[--i];e.prev[i]=r>=t?r-t:0}while(--n);o+=t}if(e.strm.avail_in===0){break}n=re(e.strm,e.window,e.strstart+e.lookahead,o);e.lookahead+=n;if(e.lookahead+e.insert>=M){a=e.strstart-e.insert;e.ins_h=e.window[a];e.ins_h=(e.ins_h<<e.hash_shift^e.window[a+1])&e.hash_mask;while(e.insert){e.ins_h=(e.ins_h<<e.hash_shift^e.window[a+M-1])&e.hash_mask;e.prev[a&e.w_mask]=e.head[e.ins_h];e.head[e.ins_h]=a;a++;e.insert--;if(e.lookahead+e.insert<M){break}}}}while(e.lookahead<N&&e.strm.avail_in!==0)}function le(e,t){var i=65535;if(i>e.pending_buf_size-5){i=e.pending_buf_size-5}for(;;){if(e.lookahead<=1){ae(e);if(e.lookahead===0&&t===l){return Q}if(e.lookahead===0){break}}e.strstart+=e.lookahead;e.lookahead=0;var s=e.block_start+i;if(e.strstart===0||e.strstart>=s){e.lookahead=e.strstart-s;e.strstart=s;ie(e,false);if(e.strm.avail_out===0){return Q}}if(e.strstart-e.block_start>=e.w_size-N){ie(e,false);if(e.strm.avail_out===0){return Q}}}e.insert=0;if(t===u){ie(e,true);if(e.strm.avail_out===0){return J}return X}if(e.strstart>e.block_start){
ie(e,false);if(e.strm.avail_out===0){return Q}}return Q}function ce(e,t){var i;var s;for(;;){if(e.lookahead<N){ae(e);if(e.lookahead<N&&t===l){return Q}if(e.lookahead===0){break}}i=0;if(e.lookahead>=M){e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+M-1])&e.hash_mask;i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h];e.head[e.ins_h]=e.strstart}if(i!==0&&e.strstart-i<=e.w_size-N){e.match_length=oe(e,i)}if(e.match_length>=M){s=n._tr_tally(e,e.strstart-e.match_start,e.match_length-M);e.lookahead-=e.match_length;if(e.match_length<=e.max_lazy_match&&e.lookahead>=M){e.match_length--;do{e.strstart++;e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+M-1])&e.hash_mask;i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h];e.head[e.ins_h]=e.strstart}while(--e.match_length!==0);e.strstart++}else{e.strstart+=e.match_length;e.match_length=0;e.ins_h=e.window[e.strstart];e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask}}else{s=n._tr_tally(e,0,e.window[e.strstart]);e.lookahead--;e.strstart++}if(s){ie(e,false);if(e.strm.avail_out===0){return Q}}}e.insert=e.strstart<M-1?e.strstart:M-1;if(t===u){ie(e,true);if(e.strm.avail_out===0){return J}return X}if(e.last_lit){ie(e,false);if(e.strm.avail_out===0){return Q}}return Z}function de(e,t){var i;var s;var r;for(;;){if(e.lookahead<N){ae(e);if(e.lookahead<N&&t===l){return Q}if(e.lookahead===0){break}}i=0;if(e.lookahead>=M){e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+M-1])&e.hash_mask;i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h];e.head[e.ins_h]=e.strstart}e.prev_length=e.match_length;e.prev_match=e.match_start;e.match_length=M-1;if(i!==0&&e.prev_length<e.max_lazy_match&&e.strstart-i<=e.w_size-N){e.match_length=oe(e,i);if(e.match_length<=5&&(e.strategy===b||e.match_length===M&&e.strstart-e.match_start>4096)){e.match_length=M-1}}if(e.prev_length>=M&&e.match_length<=e.prev_length){r=e.strstart+e.lookahead-M;s=n._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-M);e.lookahead-=e.prev_length-1;e.prev_length-=2;do{if(++e.strstart<=r){e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+M-1])&e.hash_mask;i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h];e.head[e.ins_h]=e.strstart}}while(--e.prev_length!==0);e.match_available=0;e.match_length=M-1;e.strstart++;if(s){ie(e,false);if(e.strm.avail_out===0){return Q}}}else if(e.match_available){s=n._tr_tally(e,0,e.window[e.strstart-1]);if(s){ie(e,false)}e.strstart++;e.lookahead--;if(e.strm.avail_out===0){return Q}}else{e.match_available=1;e.strstart++;e.lookahead--}}if(e.match_available){s=n._tr_tally(e,0,e.window[e.strstart-1]);e.match_available=0}e.insert=e.strstart<M-1?e.strstart:M-1;if(t===u){ie(e,true);if(e.strm.avail_out===0){return J}return X}if(e.last_lit){ie(e,false);if(e.strm.avail_out===0){return Q}}return Z}function ue(e,t){var i;var s;var r,o;var a=e.window;for(;;){if(e.lookahead<=V){ae(e);if(e.lookahead<=V&&t===l){return Q}if(e.lookahead===0){break}}e.match_length=0;if(e.lookahead>=M&&e.strstart>0){r=e.strstart-1;s=a[r];if(s===a[++r]&&s===a[++r]&&s===a[++r]){o=e.strstart+V;do{}while(s===a[++r]&&s===a[++r]&&s===a[++r]&&s===a[++r]&&s===a[++r]&&s===a[++r]&&s===a[++r]&&s===a[++r]&&r<o);e.match_length=V-(o-r);if(e.match_length>e.lookahead){e.match_length=e.lookahead}}}if(e.match_length>=M){i=n._tr_tally(e,1,e.match_length-M);e.lookahead-=e.match_length;e.strstart+=e.match_length;e.match_length=0}else{i=n._tr_tally(e,0,e.window[e.strstart]);e.lookahead--;e.strstart++}if(i){ie(e,false);if(e.strm.avail_out===0){return Q}}}e.insert=0;if(t===u){ie(e,true);if(e.strm.avail_out===0){return J}return X}if(e.last_lit){ie(e,false);if(e.strm.avail_out===0){return Q}}return Z}function he(e,t){var i;for(;;){if(e.lookahead===0){ae(e);if(e.lookahead===0){if(t===l){return Q}break}}e.match_length=0;i=n._tr_tally(e,0,e.window[e.strstart]);e.lookahead--;e.strstart++;if(i){ie(e,false);if(e.strm.avail_out===0){return Q}}}e.insert=0;if(t===u){ie(e,true);if(e.strm.avail_out===0){return J}return X}if(e.last_lit){ie(e,false);if(e.strm.avail_out===0){return Q}}return Z}function fe(e,t,i,s,n){this.good_length=e;this.max_lazy=t;this.nice_length=i;this.max_chain=s;this.func=n}var pe;pe=[new fe(0,0,0,0,le),new fe(4,4,8,4,ce),new fe(4,5,16,8,ce),new fe(4,6,32,32,ce),new fe(4,4,16,16,de),new fe(8,16,32,32,de),new fe(8,16,128,128,de),new fe(8,32,128,256,de),new fe(32,128,258,1024,de),new fe(32,258,258,4096,de)];function me(e){e.window_size=2*e.w_size;ee(e.head);e.max_lazy_match=pe[e.level].max_lazy;e.good_match=pe[e.level].good_length;e.nice_match=pe[e.level].nice_length;e.max_chain_length=pe[e.level].max_chain;e.strstart=0;e.block_start=0;e.lookahead=0;e.insert=0;e.match_length=e.prev_length=M-1;e.match_available=0;e.ins_h=0}function ge(){this.strm=null;this.status=0;this.pending_buf=null;this.pending_buf_size=0;this.pending_out=0;this.pending=0;this.wrap=0;this.gzhead=null;this.gzindex=0;this.method=x;this.last_flush=-1;this.w_size=0;this.w_bits=0;this.w_mask=0;this.window=null;this.window_size=0;this.prev=null;this.head=null;this.ins_h=0;this.hash_size=0;this.hash_bits=0;this.hash_mask=0;this.hash_shift=0;this.block_start=0;this.match_length=0;this.prev_match=0;this.match_available=0;this.strstart=0;this.match_start=0;this.lookahead=0;this.prev_length=0;this.max_chain_length=0;this.max_lazy_match=0;this.level=0;this.strategy=0;this.good_match=0;this.nice_match=0;this.dyn_ltree=new s.Buf16(P*2);this.dyn_dtree=new s.Buf16((2*O+1)*2);this.bl_tree=new s.Buf16((2*L+1)*2);ee(this.dyn_ltree);ee(this.dyn_dtree);ee(this.bl_tree);this.l_desc=null;this.d_desc=null;this.bl_desc=null;this.bl_count=new s.Buf16(D+1);this.heap=new s.Buf16(2*$+1);ee(this.heap);this.heap_len=0;this.heap_max=0;this.depth=new s.Buf16(2*$+1);ee(this.depth);this.l_buf=0;this.lit_bufsize=0;this.last_lit=0;this.d_buf=0;this.opt_len=0;this.static_len=0;this.matches=0;this.insert=0;this.bi_buf=0;this.bi_valid=0}function ve(e){var t;if(!e||!e.state){return Y(e,m)}e.total_in=e.total_out=0;e.data_type=S;t=e.state;t.pending=0;t.pending_out=0;if(t.wrap<0){t.wrap=-t.wrap}t.status=t.wrap?B:H;e.adler=t.wrap===2?0:1;t.last_flush=l;n._tr_init(t);return f}function _e(e){var t=ve(e);if(t===f){me(e.state)}return t}function be(e,t){if(!e||!e.state){return m}if(e.state.wrap!==2){return m}e.state.gzhead=t;return f}function we(e,t,i,n,r,o){if(!e){return m}var a=1;if(t===_){t=6}if(n<0){a=0;n=-n}else if(n>15){a=2;n-=16}if(r<1||r>I||i!==x||n<8||n>15||t<0||t>9||o<0||o>C){return Y(e,m)}if(n===8){n=9}var l=new ge;e.state=l;l.strm=e;l.wrap=a;l.gzhead=null;l.w_bits=n;l.w_size=1<<l.w_bits;l.w_mask=l.w_size-1;l.hash_bits=r+7;l.hash_size=1<<l.hash_bits;l.hash_mask=l.hash_size-1;l.hash_shift=~~((l.hash_bits+M-1)/M);l.window=new s.Buf8(l.w_size*2);l.head=new s.Buf16(l.hash_size);l.prev=new s.Buf16(l.w_size);l.lit_bufsize=1<<r+6;l.pending_buf_size=l.lit_bufsize*4;l.pending_buf=new s.Buf8(l.pending_buf_size);l.d_buf=1*l.lit_bufsize;l.l_buf=(1+2)*l.lit_bufsize;l.level=t;l.strategy=o;l.method=i;return _e(e)}function ye(e,t){return we(e,t,x,A,T,k)}function Ce(e,t){var i,s;var r,a;if(!e||!e.state||t>h||t<0){return e?Y(e,m):m}s=e.state;if(!e.output||!e.input&&e.avail_in!==0||s.status===W&&t!==u){return Y(e,e.avail_out===0?v:m)}s.strm=e;i=s.last_flush;s.last_flush=t;if(s.status===B){if(s.wrap===2){e.adler=0;se(s,31);se(s,139);se(s,8);if(!s.gzhead){se(s,0);se(s,0);se(s,0);se(s,0);se(s,0);se(s,s.level===9?2:s.strategy>=w||s.level<2?4:0);se(s,K);s.status=H}else{se(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(!s.gzhead.extra?0:4)+(!s.gzhead.name?0:8)+(!s.gzhead.comment?0:16));se(s,s.gzhead.time&255);se(s,s.gzhead.time>>8&255);se(s,s.gzhead.time>>16&255);se(s,s.gzhead.time>>24&255);se(s,s.level===9?2:s.strategy>=w||s.level<2?4:0);se(s,s.gzhead.os&255);if(s.gzhead.extra&&s.gzhead.extra.length){se(s,s.gzhead.extra.length&255);se(s,s.gzhead.extra.length>>8&255)}if(s.gzhead.hcrc){e.adler=o(e.adler,s.pending_buf,s.pending,0)}s.gzindex=0;s.status=j}}else{var g=x+(s.w_bits-8<<4)<<8;var _=-1;if(s.strategy>=w||s.level<2){_=0}else if(s.level<6){_=1}else if(s.level===6){_=2}else{_=3}g|=_<<6;if(s.strstart!==0){g|=z}g+=31-g%31;s.status=H;ne(s,g);if(s.strstart!==0){ne(s,e.adler>>>16);ne(s,e.adler&65535)}e.adler=1}}if(s.status===j){if(s.gzhead.extra){r=s.pending;while(s.gzindex<(s.gzhead.extra.length&65535)){if(s.pending===s.pending_buf_size){if(s.gzhead.hcrc&&s.pending>r){e.adler=o(e.adler,s.pending_buf,s.pending-r,r)}te(e);r=s.pending;if(s.pending===s.pending_buf_size){break}}se(s,s.gzhead.extra[s.gzindex]&255);s.gzindex++}if(s.gzhead.hcrc&&s.pending>r){e.adler=o(e.adler,s.pending_buf,s.pending-r,r)}if(s.gzindex===s.gzhead.extra.length){s.gzindex=0;s.status=F}}else{s.status=F}}if(s.status===F){if(s.gzhead.name){r=s.pending;do{if(s.pending===s.pending_buf_size){if(s.gzhead.hcrc&&s.pending>r){e.adler=o(e.adler,s.pending_buf,s.pending-r,r)}te(e);r=s.pending;if(s.pending===s.pending_buf_size){a=1;break}}if(s.gzindex<s.gzhead.name.length){a=s.gzhead.name.charCodeAt(s.gzindex++)&255}else{a=0}se(s,a)}while(a!==0);if(s.gzhead.hcrc&&s.pending>r){e.adler=o(e.adler,s.pending_buf,s.pending-r,r)}if(a===0){s.gzindex=0;s.status=q}}else{s.status=q}}if(s.status===q){if(s.gzhead.comment){r=s.pending;do{if(s.pending===s.pending_buf_size){if(s.gzhead.hcrc&&s.pending>r){e.adler=o(e.adler,s.pending_buf,s.pending-r,r)}te(e);r=s.pending;if(s.pending===s.pending_buf_size){a=1;break}}if(s.gzindex<s.gzhead.comment.length){a=s.gzhead.comment.charCodeAt(s.gzindex++)&255}else{a=0}se(s,a)}while(a!==0);if(s.gzhead.hcrc&&s.pending>r){e.adler=o(e.adler,s.pending_buf,s.pending-r,r)}if(a===0){s.status=U}}else{s.status=U}}if(s.status===U){if(s.gzhead.hcrc){if(s.pending+2>s.pending_buf_size){te(e)}if(s.pending+2<=s.pending_buf_size){se(s,e.adler&255);se(s,e.adler>>8&255);e.adler=0;s.status=H}}else{s.status=H}}if(s.pending!==0){te(e);if(e.avail_out===0){s.last_flush=-1;return f}}else if(e.avail_in===0&&G(t)<=G(i)&&t!==u){return Y(e,v)}if(s.status===W&&e.avail_in!==0){return Y(e,v)}if(e.avail_in!==0||s.lookahead!==0||t!==l&&s.status!==W){var b=s.strategy===w?he(s,t):s.strategy===y?ue(s,t):pe[s.level].func(s,t);if(b===J||b===X){s.status=W}if(b===Q||b===J){if(e.avail_out===0){s.last_flush=-1}return f}if(b===Z){if(t===c){n._tr_align(s)}else if(t!==h){n._tr_stored_block(s,0,0,false);if(t===d){ee(s.head);if(s.lookahead===0){s.strstart=0;s.block_start=0;s.insert=0}}}te(e);if(e.avail_out===0){s.last_flush=-1;return f}}}if(t!==u){return f}if(s.wrap<=0){return p}if(s.wrap===2){se(s,e.adler&255);se(s,e.adler>>8&255);se(s,e.adler>>16&255);se(s,e.adler>>24&255);se(s,e.total_in&255);se(s,e.total_in>>8&255);se(s,e.total_in>>16&255);se(s,e.total_in>>24&255)}else{ne(s,e.adler>>>16);ne(s,e.adler&65535)}te(e);if(s.wrap>0){s.wrap=-s.wrap}return s.pending!==0?f:p}function ke(e){var t;if(!e||!e.state){return m}t=e.state.status;if(t!==B&&t!==j&&t!==F&&t!==q&&t!==U&&t!==H&&t!==W){return Y(e,m)}e.state=null;return t===H?Y(e,g):f}function Se(e,t){var i=t.length;var n;var o,a;var l;var c;var d;var u;var h;if(!e||!e.state){return m}n=e.state;l=n.wrap;if(l===2||l===1&&n.status!==B||n.lookahead){return m}if(l===1){e.adler=r(e.adler,t,i,0)}n.wrap=0;if(i>=n.w_size){if(l===0){ee(n.head);n.strstart=0;n.block_start=0;n.insert=0}h=new s.Buf8(n.w_size);s.arraySet(h,t,i-n.w_size,n.w_size,0);t=h;i=n.w_size}c=e.avail_in;d=e.next_in;u=e.input;e.avail_in=i;e.next_in=0;e.input=t;ae(n);while(n.lookahead>=M){o=n.strstart;a=n.lookahead-(M-1);do{n.ins_h=(n.ins_h<<n.hash_shift^n.window[o+M-1])&n.hash_mask;n.prev[o&n.w_mask]=n.head[n.ins_h];n.head[n.ins_h]=o;o++}while(--a);n.strstart=o;n.lookahead=M-1;ae(n)}n.strstart+=n.lookahead;n.block_start=n.strstart;n.insert=n.lookahead;n.lookahead=0;n.match_length=n.prev_length=M-1;n.match_available=0;e.next_in=d;e.input=u;e.avail_in=c;n.wrap=l;return f}i.deflateInit=ye;i.deflateInit2=we;i.deflateReset=_e;i.deflateResetKeep=ve;i.deflateSetHeader=be;i.deflate=Ce;i.deflateEnd=ke;i.deflateSetDictionary=Se;i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":28,"./adler32":30,"./crc32":32,"./messages":38,"./trees":39}],34:[function(e,t,i){"use strict";function s(){this.text=0;this.time=0;this.xflags=0;this.os=0;this.extra=null;this.extra_len=0;this.name="";this.comment="";this.hcrc=0;this.done=false}t.exports=s},{}],35:[function(e,t,i){"use strict";var s=30;var n=12;t.exports=function r(e,t){var i;var r;var o;var a;var l;var c;var d;var u;var h;var f;var p;var m;var g;var v;var _;var b;var w;var y;var C;var k;var S;var x;var I;var A,T;i=e.state;r=e.next_in;A=e.input;o=r+(e.avail_in-5);a=e.next_out;T=e.output;l=a-(t-e.avail_out);c=a+(e.avail_out-257);d=i.dmax;u=i.wsize;h=i.whave;f=i.wnext;p=i.window;m=i.hold;g=i.bits;v=i.lencode;_=i.distcode;b=(1<<i.lenbits)-1;w=(1<<i.distbits)-1;e:do{if(g<15){m+=A[r++]<<g;g+=8;m+=A[r++]<<g;g+=8}y=v[m&b];t:for(;;){C=y>>>24;m>>>=C;g-=C;C=y>>>16&255;if(C===0){T[a++]=y&65535}else if(C&16){k=y&65535;C&=15;if(C){if(g<C){m+=A[r++]<<g;g+=8}k+=m&(1<<C)-1;m>>>=C;g-=C}if(g<15){m+=A[r++]<<g;g+=8;m+=A[r++]<<g;g+=8}y=_[m&w];i:for(;;){C=y>>>24;m>>>=C;g-=C;C=y>>>16&255;if(C&16){S=y&65535;C&=15;if(g<C){m+=A[r++]<<g;g+=8;if(g<C){m+=A[r++]<<g;g+=8}}S+=m&(1<<C)-1;if(S>d){e.msg="invalid distance too far back";i.mode=s;break e}m>>>=C;g-=C;C=a-l;if(S>C){C=S-C;if(C>h){if(i.sane){e.msg="invalid distance too far back";i.mode=s;break e}}x=0;I=p;if(f===0){x+=u-C;if(C<k){k-=C;do{T[a++]=p[x++]}while(--C);x=a-S;I=T}}else if(f<C){x+=u+f-C;C-=f;if(C<k){k-=C;do{T[a++]=p[x++]}while(--C);x=0;if(f<k){C=f;k-=C;do{T[a++]=p[x++]}while(--C);x=a-S;I=T}}}else{x+=f-C;if(C<k){k-=C;do{T[a++]=p[x++]}while(--C);x=a-S;I=T}}while(k>2){T[a++]=I[x++];T[a++]=I[x++];T[a++]=I[x++];k-=3}if(k){T[a++]=I[x++];if(k>1){T[a++]=I[x++]}}}else{x=a-S;do{T[a++]=T[x++];T[a++]=T[x++];T[a++]=T[x++];k-=3}while(k>2);if(k){T[a++]=T[x++];if(k>1){T[a++]=T[x++]}}}}else if((C&64)===0){y=_[(y&65535)+(m&(1<<C)-1)];continue i}else{e.msg="invalid distance code";i.mode=s;break e}break}}else if((C&64)===0){y=v[(y&65535)+(m&(1<<C)-1)];continue t}else if(C&32){i.mode=n;break e}else{e.msg="invalid literal/length code";i.mode=s;break e}break}}while(r<o&&a<c);k=g>>3;r-=k;g-=k<<3;m&=(1<<g)-1;e.next_in=r;e.next_out=a;e.avail_in=r<o?5+(o-r):5-(r-o);e.avail_out=a<c?257+(c-a):257-(a-c);i.hold=m;i.bits=g;return}},{}],36:[function(e,t,i){"use strict";var s=e("../utils/common");var n=e("./adler32");var r=e("./crc32");var o=e("./inffast");var a=e("./inftrees");var l=0;var c=1;var d=2;var u=4;var h=5;var f=6;var p=0;var m=1;var g=2;var v=-2;var _=-3;var b=-4;var w=-5;var y=8;var C=1;var k=2;var S=3;var x=4;var I=5;var A=6;var T=7;var E=8;var R=9;var $=10;var O=11;var L=12;var P=13;var D=14;var M=15;var V=16;var N=17;var z=18;var B=19;var j=20;var F=21;var q=22;var U=23;var H=24;var W=25;var Q=26;var Z=27;var J=28;var X=29;var K=30;var Y=31;var G=32;var ee=852;var te=592;var ie=15;var se=ie;function ne(e){return(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24)}function re(){this.mode=0;this.last=false;this.wrap=0;this.havedict=false;this.flags=0;this.dmax=0;this.check=0;this.total=0;this.head=null;this.wbits=0;this.wsize=0;this.whave=0;this.wnext=0;this.window=null;this.hold=0;this.bits=0;this.length=0;this.offset=0;this.extra=0;this.lencode=null;this.distcode=null;this.lenbits=0;this.distbits=0;this.ncode=0;this.nlen=0;this.ndist=0;this.have=0;this.next=null;this.lens=new s.Buf16(320);this.work=new s.Buf16(288);this.lendyn=null;this.distdyn=null;this.sane=0;this.back=0;this.was=0}function oe(e){var t;if(!e||!e.state){return v}t=e.state;e.total_in=e.total_out=t.total=0;e.msg="";if(t.wrap){e.adler=t.wrap&1}t.mode=C;t.last=0;t.havedict=0;t.dmax=32768;t.head=null;t.hold=0;t.bits=0;t.lencode=t.lendyn=new s.Buf32(ee);t.distcode=t.distdyn=new s.Buf32(te);t.sane=1;t.back=-1;return p}function ae(e){var t;if(!e||!e.state){return v}t=e.state;t.wsize=0;t.whave=0;t.wnext=0;return oe(e)}function le(e,t){var i;var s;if(!e||!e.state){return v}s=e.state;if(t<0){i=0;t=-t}else{i=(t>>4)+1;if(t<48){t&=15}}if(t&&(t<8||t>15)){return v}if(s.window!==null&&s.wbits!==t){s.window=null}s.wrap=i;s.wbits=t;return ae(e)}function ce(e,t){var i;var s;if(!e){return v}s=new re;e.state=s;s.window=null;i=le(e,t);if(i!==p){e.state=null}return i}function de(e){return ce(e,se)}var ue=true;var he,fe;function pe(e){if(ue){var t;he=new s.Buf32(512);fe=new s.Buf32(32);t=0;while(t<144){e.lens[t++]=8}while(t<256){e.lens[t++]=9}while(t<280){e.lens[t++]=7}while(t<288){e.lens[t++]=8}a(c,e.lens,0,288,he,0,e.work,{bits:9});t=0;while(t<32){e.lens[t++]=5}a(d,e.lens,0,32,fe,0,e.work,{bits:5});ue=false}e.lencode=he;e.lenbits=9;e.distcode=fe;e.distbits=5}function me(e,t,i,n){var r;var o=e.state;if(o.window===null){o.wsize=1<<o.wbits;o.wnext=0;o.whave=0;o.window=new s.Buf8(o.wsize)}if(n>=o.wsize){s.arraySet(o.window,t,i-o.wsize,o.wsize,0);o.wnext=0;o.whave=o.wsize}else{r=o.wsize-o.wnext;if(r>n){r=n}s.arraySet(o.window,t,i-n,r,o.wnext);n-=r;if(n){s.arraySet(o.window,t,i-n,n,0);o.wnext=n;o.whave=o.wsize}else{o.wnext+=r;if(o.wnext===o.wsize){o.wnext=0}if(o.whave<o.wsize){o.whave+=r}}}return 0}function ge(e,t){var i;var ee,te;var ie;var se;var re,oe;var ae;var le;var ce,de;var ue;var he;var fe;var ge=0;var ve,_e,be;var we,ye,Ce;var ke;var Se;var xe=new s.Buf8(4);var Ie;var Ae;var Te=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&e.avail_in!==0){return v}i=e.state;if(i.mode===L){i.mode=P}se=e.next_out;te=e.output;oe=e.avail_out;ie=e.next_in;ee=e.input;re=e.avail_in;ae=i.hold;le=i.bits;ce=re;de=oe;Se=p;e:for(;;){switch(i.mode){case C:if(i.wrap===0){i.mode=P;break}while(le<16){if(re===0){break e}re--;ae+=ee[ie++]<<le;le+=8}if(i.wrap&2&&ae===35615){i.check=0;xe[0]=ae&255;xe[1]=ae>>>8&255;i.check=r(i.check,xe,2,0);ae=0;le=0;i.mode=k;break}i.flags=0;if(i.head){i.head.done=false}if(!(i.wrap&1)||(((ae&255)<<8)+(ae>>8))%31){e.msg="incorrect header check";i.mode=K;break}if((ae&15)!==y){e.msg="unknown compression method";i.mode=K;break}ae>>>=4;le-=4;ke=(ae&15)+8;if(i.wbits===0){i.wbits=ke}else if(ke>i.wbits){e.msg="invalid window size";i.mode=K;break}i.dmax=1<<ke;e.adler=i.check=1;i.mode=ae&512?$:L;ae=0;le=0;break;case k:while(le<16){if(re===0){break e}re--;ae+=ee[ie++]<<le;le+=8}i.flags=ae;if((i.flags&255)!==y){e.msg="unknown compression method";i.mode=K;break}if(i.flags&57344){e.msg="unknown header flags set";i.mode=K;break}if(i.head){i.head.text=ae>>8&1}if(i.flags&512){xe[0]=ae&255;xe[1]=ae>>>8&255;i.check=r(i.check,xe,2,0)}ae=0;le=0;i.mode=S;case S:while(le<32){if(re===0){break e}re--;ae+=ee[ie++]<<le;le+=8}if(i.head){i.head.time=ae}if(i.flags&512){xe[0]=ae&255;xe[1]=ae>>>8&255;xe[2]=ae>>>16&255;xe[3]=ae>>>24&255;i.check=r(i.check,xe,4,0)}ae=0;le=0;i.mode=x;case x:while(le<16){if(re===0){break e}re--;ae+=ee[ie++]<<le;le+=8}if(i.head){i.head.xflags=ae&255;i.head.os=ae>>8}if(i.flags&512){xe[0]=ae&255;xe[1]=ae>>>8&255;i.check=r(i.check,xe,2,0)}ae=0;le=0;i.mode=I;case I:if(i.flags&1024){while(le<16){if(re===0){break e}re--;ae+=ee[ie++]<<le;le+=8}i.length=ae;if(i.head){i.head.extra_len=ae}if(i.flags&512){xe[0]=ae&255;xe[1]=ae>>>8&255;i.check=r(i.check,xe,2,0)}ae=0;le=0}else if(i.head){i.head.extra=null}i.mode=A;case A:if(i.flags&1024){ue=i.length;if(ue>re){ue=re}if(ue){if(i.head){ke=i.head.extra_len-i.length;if(!i.head.extra){i.head.extra=new Array(i.head.extra_len)}s.arraySet(i.head.extra,ee,ie,ue,ke)}if(i.flags&512){i.check=r(i.check,ee,ue,ie)}re-=ue;ie+=ue;i.length-=ue}if(i.length){break e}}i.length=0;i.mode=T;case T:if(i.flags&2048){if(re===0){break e}ue=0;do{ke=ee[ie+ue++];if(i.head&&ke&&i.length<65536){i.head.name+=String.fromCharCode(ke)}}while(ke&&ue<re);if(i.flags&512){i.check=r(i.check,ee,ue,ie)}re-=ue;ie+=ue;if(ke){break e}}else if(i.head){i.head.name=null}i.length=0;i.mode=E;case E:if(i.flags&4096){if(re===0){break e}ue=0;do{ke=ee[ie+ue++];if(i.head&&ke&&i.length<65536){i.head.comment+=String.fromCharCode(ke)}}while(ke&&ue<re);if(i.flags&512){i.check=r(i.check,ee,ue,ie)}re-=ue;ie+=ue;if(ke){break e}}else if(i.head){i.head.comment=null}i.mode=R;case R:if(i.flags&512){while(le<16){if(re===0){break e}re--;ae+=ee[ie++]<<le;le+=8}if(ae!==(i.check&65535)){e.msg="header crc mismatch";i.mode=K;break}ae=0;le=0}if(i.head){i.head.hcrc=i.flags>>9&1;i.head.done=true}e.adler=i.check=0;i.mode=L;break;case $:while(le<32){if(re===0){break e}re--;ae+=ee[ie++]<<le;le+=8}e.adler=i.check=ne(ae);ae=0;le=0;i.mode=O;case O:if(i.havedict===0){e.next_out=se;e.avail_out=oe;e.next_in=ie;e.avail_in=re;i.hold=ae;i.bits=le;return g}e.adler=i.check=1;i.mode=L;case L:if(t===h||t===f){break e}case P:if(i.last){ae>>>=le&7;le-=le&7;i.mode=Z;break}while(le<3){if(re===0){break e}re--;ae+=ee[ie++]<<le;le+=8}i.last=ae&1;ae>>>=1;le-=1;switch(ae&3){case 0:i.mode=D;break;case 1:pe(i);i.mode=j;if(t===f){ae>>>=2;le-=2;break e}break;case 2:i.mode=N;break;case 3:e.msg="invalid block type";i.mode=K}ae>>>=2;le-=2;break;case D:ae>>>=le&7;le-=le&7;while(le<32){if(re===0){break e}re--;ae+=ee[ie++]<<le;le+=8}if((ae&65535)!==(ae>>>16^65535)){e.msg="invalid stored block lengths";i.mode=K;break}i.length=ae&65535;ae=0;le=0;i.mode=M;if(t===f){break e}case M:i.mode=V;case V:ue=i.length;if(ue){if(ue>re){ue=re}if(ue>oe){ue=oe}if(ue===0){break e}s.arraySet(te,ee,ie,ue,se);re-=ue;ie+=ue;oe-=ue;se+=ue;i.length-=ue;break}i.mode=L;break;case N:while(le<14){if(re===0){break e}re--;ae+=ee[ie++]<<le;le+=8}i.nlen=(ae&31)+257;ae>>>=5;le-=5;i.ndist=(ae&31)+1;ae>>>=5;le-=5;i.ncode=(ae&15)+4;ae>>>=4;le-=4;if(i.nlen>286||i.ndist>30){e.msg="too many length or distance symbols";i.mode=K;break}i.have=0;i.mode=z;case z:while(i.have<i.ncode){while(le<3){if(re===0){break e}re--;ae+=ee[ie++]<<le;le+=8}i.lens[Te[i.have++]]=ae&7;ae>>>=3;le-=3}while(i.have<19){i.lens[Te[i.have++]]=0}i.lencode=i.lendyn;i.lenbits=7;Ie={bits:i.lenbits};Se=a(l,i.lens,0,19,i.lencode,0,i.work,Ie);i.lenbits=Ie.bits;if(Se){e.msg="invalid code lengths set";i.mode=K;break}i.have=0;i.mode=B;case B:while(i.have<i.nlen+i.ndist){for(;;){ge=i.lencode[ae&(1<<i.lenbits)-1];ve=ge>>>24;_e=ge>>>16&255;be=ge&65535;if(ve<=le){break}if(re===0){break e}re--;ae+=ee[ie++]<<le;le+=8}if(be<16){ae>>>=ve;le-=ve;i.lens[i.have++]=be}else{if(be===16){Ae=ve+2;while(le<Ae){if(re===0){break e}re--;ae+=ee[ie++]<<le;le+=8}ae>>>=ve;le-=ve;if(i.have===0){e.msg="invalid bit length repeat";i.mode=K;break}ke=i.lens[i.have-1];ue=3+(ae&3);ae>>>=2;le-=2}else if(be===17){Ae=ve+3;while(le<Ae){if(re===0){break e}re--;ae+=ee[ie++]<<le;le+=8}ae>>>=ve;le-=ve;ke=0;ue=3+(ae&7);ae>>>=3;le-=3}else{Ae=ve+7;while(le<Ae){if(re===0){break e}re--;ae+=ee[ie++]<<le;le+=8}ae>>>=ve;le-=ve;ke=0;ue=11+(ae&127);ae>>>=7;le-=7}if(i.have+ue>i.nlen+i.ndist){e.msg="invalid bit length repeat";i.mode=K;break}while(ue--){i.lens[i.have++]=ke}}}if(i.mode===K){break}if(i.lens[256]===0){e.msg="invalid code -- missing end-of-block";i.mode=K;break}i.lenbits=9;Ie={bits:i.lenbits};Se=a(c,i.lens,0,i.nlen,i.lencode,0,i.work,Ie);i.lenbits=Ie.bits;if(Se){e.msg="invalid literal/lengths set";i.mode=K;break}i.distbits=6;i.distcode=i.distdyn;Ie={bits:i.distbits};Se=a(d,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,Ie);i.distbits=Ie.bits;if(Se){e.msg="invalid distances set";i.mode=K;break}i.mode=j;if(t===f){break e}case j:i.mode=F;case F:if(re>=6&&oe>=258){e.next_out=se;e.avail_out=oe;e.next_in=ie;e.avail_in=re;i.hold=ae;i.bits=le;o(e,de);se=e.next_out;te=e.output;oe=e.avail_out;ie=e.next_in;ee=e.input;re=e.avail_in;ae=i.hold;le=i.bits;if(i.mode===L){i.back=-1}break}i.back=0;for(;;){ge=i.lencode[ae&(1<<i.lenbits)-1];ve=ge>>>24;_e=ge>>>16&255;be=ge&65535;if(ve<=le){break}if(re===0){break e}re--;ae+=ee[ie++]<<le;le+=8}if(_e&&(_e&240)===0){we=ve;ye=_e;Ce=be;for(;;){ge=i.lencode[Ce+((ae&(1<<we+ye)-1)>>we)];ve=ge>>>24;_e=ge>>>16&255;be=ge&65535;if(we+ve<=le){break}if(re===0){break e}re--;ae+=ee[ie++]<<le;le+=8}ae>>>=we;le-=we;i.back+=we}ae>>>=ve;le-=ve;i.back+=ve;i.length=be;if(_e===0){i.mode=Q;break}if(_e&32){i.back=-1;i.mode=L;break}if(_e&64){e.msg="invalid literal/length code";i.mode=K;break}i.extra=_e&15;i.mode=q;case q:if(i.extra){Ae=i.extra;while(le<Ae){if(re===0){break e}re--;ae+=ee[ie++]<<le;le+=8}i.length+=ae&(1<<i.extra)-1;ae>>>=i.extra;le-=i.extra;i.back+=i.extra}i.was=i.length;i.mode=U;case U:for(;;){ge=i.distcode[ae&(1<<i.distbits)-1];ve=ge>>>24;_e=ge>>>16&255;be=ge&65535;if(ve<=le){break}if(re===0){break e}re--;ae+=ee[ie++]<<le;le+=8}if((_e&240)===0){we=ve;ye=_e;Ce=be;for(;;){ge=i.distcode[Ce+((ae&(1<<we+ye)-1)>>we)];ve=ge>>>24;_e=ge>>>16&255;be=ge&65535;if(we+ve<=le){break}if(re===0){break e}re--;ae+=ee[ie++]<<le;le+=8}ae>>>=we;le-=we;i.back+=we}ae>>>=ve;le-=ve;i.back+=ve;if(_e&64){e.msg="invalid distance code";i.mode=K;break}i.offset=be;i.extra=_e&15;i.mode=H;case H:if(i.extra){Ae=i.extra;while(le<Ae){if(re===0){break e}re--;ae+=ee[ie++]<<le;le+=8}i.offset+=ae&(1<<i.extra)-1;ae>>>=i.extra;le-=i.extra;i.back+=i.extra}if(i.offset>i.dmax){e.msg="invalid distance too far back";i.mode=K;break}i.mode=W;case W:if(oe===0){break e}ue=de-oe;if(i.offset>ue){ue=i.offset-ue;if(ue>i.whave){if(i.sane){e.msg="invalid distance too far back";i.mode=K;break}}if(ue>i.wnext){ue-=i.wnext;he=i.wsize-ue}else{he=i.wnext-ue}if(ue>i.length){ue=i.length}fe=i.window}else{fe=te;he=se-i.offset;ue=i.length}if(ue>oe){ue=oe}oe-=ue;i.length-=ue;do{te[se++]=fe[he++]}while(--ue);if(i.length===0){i.mode=F}break;case Q:if(oe===0){break e}te[se++]=i.length;oe--;i.mode=F;break;case Z:if(i.wrap){while(le<32){if(re===0){break e}re--;ae|=ee[ie++]<<le;le+=8}de-=oe;e.total_out+=de;i.total+=de;if(de){e.adler=i.check=i.flags?r(i.check,te,de,se-de):n(i.check,te,de,se-de)}de=oe;if((i.flags?ae:ne(ae))!==i.check){e.msg="incorrect data check";i.mode=K;break}ae=0;le=0}i.mode=J;case J:if(i.wrap&&i.flags){while(le<32){if(re===0){break e}re--;ae+=ee[ie++]<<le;le+=8}if(ae!==(i.total&4294967295)){e.msg="incorrect length check";i.mode=K;break}ae=0;le=0}i.mode=X;case X:Se=m;break e;case K:Se=_;break e;case Y:return b;case G:default:return v}}e.next_out=se;e.avail_out=oe;e.next_in=ie;e.avail_in=re;i.hold=ae;i.bits=le;if(i.wsize||de!==e.avail_out&&i.mode<K&&(i.mode<Z||t!==u)){if(me(e,e.output,e.next_out,de-e.avail_out)){i.mode=Y;return b}}ce-=e.avail_in;de-=e.avail_out;e.total_in+=ce;e.total_out+=de;i.total+=de;if(i.wrap&&de){e.adler=i.check=i.flags?r(i.check,te,de,e.next_out-de):n(i.check,te,de,e.next_out-de)}e.data_type=i.bits+(i.last?64:0)+(i.mode===L?128:0)+(i.mode===j||i.mode===M?256:0);if((ce===0&&de===0||t===u)&&Se===p){Se=w}return Se}function ve(e){if(!e||!e.state){return v}var t=e.state;if(t.window){t.window=null}e.state=null;return p}function _e(e,t){var i;if(!e||!e.state){return v}i=e.state;if((i.wrap&2)===0){return v}i.head=t;t.done=false;return p}function be(e,t){var i=t.length;var s;var r;var o;if(!e||!e.state){return v}s=e.state;if(s.wrap!==0&&s.mode!==O){return v}if(s.mode===O){r=1;r=n(r,t,i,0);if(r!==s.check){return _}}o=me(e,t,i,i);if(o){s.mode=Y;return b}s.havedict=1;return p}i.inflateReset=ae;i.inflateReset2=le;i.inflateResetKeep=oe;i.inflateInit=de;i.inflateInit2=ce;i.inflate=ge;i.inflateEnd=ve;i.inflateGetHeader=_e;i.inflateSetDictionary=be;i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":28,"./adler32":30,"./crc32":32,"./inffast":35,"./inftrees":37}],37:[function(e,t,i){"use strict";var s=e("../utils/common");var n=15;var r=852;var o=592;var a=0;var l=1;var c=2;var d=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0];var u=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78];var h=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0];var f=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function p(e,t,i,m,g,v,_,b){var w=b.bits;var y=0;var C=0;var k=0,S=0;var x=0;var I=0;var A=0;var T=0;var E=0;var R=0;var $;var O;var L;var P;var D;var M=null;var V=0;var N;var z=new s.Buf16(n+1);var B=new s.Buf16(n+1);var j=null;var F=0;var q,U,H;for(y=0;y<=n;y++){z[y]=0}for(C=0;C<m;C++){z[t[i+C]]++}x=w;for(S=n;S>=1;S--){if(z[S]!==0){break}}if(x>S){x=S}if(S===0){g[v++]=1<<24|64<<16|0;g[v++]=1<<24|64<<16|0;b.bits=1;return 0}for(k=1;k<S;k++){if(z[k]!==0){break}}if(x<k){x=k}T=1;for(y=1;y<=n;y++){T<<=1;T-=z[y];if(T<0){return-1}}if(T>0&&(e===a||S!==1)){return-1}B[1]=0;for(y=1;y<n;y++){B[y+1]=B[y]+z[y]}for(C=0;C<m;C++){if(t[i+C]!==0){_[B[t[i+C]]++]=C}}if(e===a){M=j=_;N=19}else if(e===l){M=d;V-=257;j=u;F-=257;N=256}else{M=h;j=f;N=-1}R=0;C=0;y=k;D=v;I=x;A=0;L=-1;E=1<<x;P=E-1;if(e===l&&E>r||e===c&&E>o){return 1}var W=0;for(;;){W++;q=y-A;if(_[C]<N){U=0;H=_[C]}else if(_[C]>N){U=j[F+_[C]];H=M[V+_[C]]}else{U=32+64;H=0}$=1<<y-A;O=1<<I;k=O;do{O-=$;g[D+(R>>A)+O]=q<<24|U<<16|H|0}while(O!==0);$=1<<y-1;while(R&$){$>>=1}if($!==0){R&=$-1;R+=$}else{R=0}C++;if(--z[y]===0){if(y===S){break}y=t[i+_[C]]}if(y>x&&(R&P)!==L){if(A===0){A=x}D+=k;I=y-A;T=1<<I;while(I+A<S){T-=z[I+A];if(T<=0){break}I++;T<<=1}E+=1<<I;if(e===l&&E>r||e===c&&E>o){return 1}L=R&P;g[L]=x<<24|I<<16|D-v|0}}if(R!==0){g[D+R]=y-A<<24|64<<16|0}b.bits=x;return 0}},{"../utils/common":28}],38:[function(e,t,i){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],39:[function(e,t,i){"use strict";var s=e("../utils/common");var n=4;var r=0;var o=1;var a=2;function l(e){var t=e.length;while(--t>=0){e[t]=0}}var c=0;var d=1;var u=2;var h=3;var f=258;var p=29;var m=256;var g=m+1+p;var v=30;var _=19;var b=2*g+1;var w=15;var y=16;var C=7;var k=256;var S=16;var x=17;var I=18;var A=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0];var T=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];var E=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7];var R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];var $=512;var O=new Array((g+2)*2);l(O);var L=new Array(v*2);l(L);var P=new Array($);l(P);var D=new Array(f-h+1);l(D);var M=new Array(p);l(M);var V=new Array(v);l(V);function N(e,t,i,s,n){this.static_tree=e;this.extra_bits=t;this.extra_base=i;this.elems=s;this.max_length=n;this.has_stree=e&&e.length}var z;var B;var j;function F(e,t){this.dyn_tree=e;this.max_code=0;this.stat_desc=t}function q(e){return e<256?P[e]:P[256+(e>>>7)]}function U(e,t){e.pending_buf[e.pending++]=t&255;e.pending_buf[e.pending++]=t>>>8&255}function H(e,t,i){if(e.bi_valid>y-i){e.bi_buf|=t<<e.bi_valid&65535;U(e,e.bi_buf);e.bi_buf=t>>y-e.bi_valid;e.bi_valid+=i-y}else{e.bi_buf|=t<<e.bi_valid&65535;e.bi_valid+=i}}function W(e,t,i){H(e,i[t*2],i[t*2+1])}function Q(e,t){var i=0;do{i|=e&1;e>>>=1;i<<=1}while(--t>0);return i>>>1}function Z(e){if(e.bi_valid===16){U(e,e.bi_buf);e.bi_buf=0;e.bi_valid=0}else if(e.bi_valid>=8){e.pending_buf[e.pending++]=e.bi_buf&255;e.bi_buf>>=8;e.bi_valid-=8}}function J(e,t){var i=t.dyn_tree;var s=t.max_code;var n=t.stat_desc.static_tree;var r=t.stat_desc.has_stree;var o=t.stat_desc.extra_bits;var a=t.stat_desc.extra_base;var l=t.stat_desc.max_length;var c;var d,u;var h;var f;var p;var m=0;for(h=0;h<=w;h++){e.bl_count[h]=0}i[e.heap[e.heap_max]*2+1]=0;for(c=e.heap_max+1;c<b;c++){d=e.heap[c];h=i[i[d*2+1]*2+1]+1;if(h>l){h=l;m++}i[d*2+1]=h;if(d>s){continue}e.bl_count[h]++;f=0;if(d>=a){f=o[d-a]}p=i[d*2];e.opt_len+=p*(h+f);if(r){e.static_len+=p*(n[d*2+1]+f)}}if(m===0){return}do{h=l-1;while(e.bl_count[h]===0){h--}e.bl_count[h]--;e.bl_count[h+1]+=2;e.bl_count[l]--;m-=2}while(m>0);for(h=l;h!==0;h--){d=e.bl_count[h];while(d!==0){u=e.heap[--c];if(u>s){continue}if(i[u*2+1]!==h){e.opt_len+=(h-i[u*2+1])*i[u*2];i[u*2+1]=h}d--}}}function X(e,t,i){var s=new Array(w+1);var n=0;var r;var o;for(r=1;r<=w;r++){s[r]=n=n+i[r-1]<<1}for(o=0;o<=t;o++){var a=e[o*2+1];if(a===0){continue}e[o*2]=Q(s[a]++,a)}}function K(){var e;var t;var i;var s;var n;var r=new Array(w+1);i=0;for(s=0;s<p-1;s++){M[s]=i;for(e=0;e<1<<A[s];e++){D[i++]=s}}D[i-1]=s;n=0;for(s=0;s<16;s++){V[s]=n;for(e=0;e<1<<T[s];e++){P[n++]=s}}n>>=7;for(;s<v;s++){V[s]=n<<7;for(e=0;e<1<<T[s]-7;e++){P[256+n++]=s}}for(t=0;t<=w;t++){r[t]=0}e=0;while(e<=143){O[e*2+1]=8;e++;r[8]++}while(e<=255){O[e*2+1]=9;e++;r[9]++}while(e<=279){O[e*2+1]=7;e++;r[7]++}while(e<=287){O[e*2+1]=8;
e++;r[8]++}X(O,g+1,r);for(e=0;e<v;e++){L[e*2+1]=5;L[e*2]=Q(e,5)}z=new N(O,A,m+1,g,w);B=new N(L,T,0,v,w);j=new N(new Array(0),E,0,_,C)}function Y(e){var t;for(t=0;t<g;t++){e.dyn_ltree[t*2]=0}for(t=0;t<v;t++){e.dyn_dtree[t*2]=0}for(t=0;t<_;t++){e.bl_tree[t*2]=0}e.dyn_ltree[k*2]=1;e.opt_len=e.static_len=0;e.last_lit=e.matches=0}function G(e){if(e.bi_valid>8){U(e,e.bi_buf)}else if(e.bi_valid>0){e.pending_buf[e.pending++]=e.bi_buf}e.bi_buf=0;e.bi_valid=0}function ee(e,t,i,n){G(e);if(n){U(e,i);U(e,~i)}s.arraySet(e.pending_buf,e.window,t,i,e.pending);e.pending+=i}function te(e,t,i,s){var n=t*2;var r=i*2;return e[n]<e[r]||e[n]===e[r]&&s[t]<=s[i]}function ie(e,t,i){var s=e.heap[i];var n=i<<1;while(n<=e.heap_len){if(n<e.heap_len&&te(t,e.heap[n+1],e.heap[n],e.depth)){n++}if(te(t,s,e.heap[n],e.depth)){break}e.heap[i]=e.heap[n];i=n;n<<=1}e.heap[i]=s}function se(e,t,i){var s;var n;var r=0;var o;var a;if(e.last_lit!==0){do{s=e.pending_buf[e.d_buf+r*2]<<8|e.pending_buf[e.d_buf+r*2+1];n=e.pending_buf[e.l_buf+r];r++;if(s===0){W(e,n,t)}else{o=D[n];W(e,o+m+1,t);a=A[o];if(a!==0){n-=M[o];H(e,n,a)}s--;o=q(s);W(e,o,i);a=T[o];if(a!==0){s-=V[o];H(e,s,a)}}}while(r<e.last_lit)}W(e,k,t)}function ne(e,t){var i=t.dyn_tree;var s=t.stat_desc.static_tree;var n=t.stat_desc.has_stree;var r=t.stat_desc.elems;var o,a;var l=-1;var c;e.heap_len=0;e.heap_max=b;for(o=0;o<r;o++){if(i[o*2]!==0){e.heap[++e.heap_len]=l=o;e.depth[o]=0}else{i[o*2+1]=0}}while(e.heap_len<2){c=e.heap[++e.heap_len]=l<2?++l:0;i[c*2]=1;e.depth[c]=0;e.opt_len--;if(n){e.static_len-=s[c*2+1]}}t.max_code=l;for(o=e.heap_len>>1;o>=1;o--){ie(e,i,o)}c=r;do{o=e.heap[1];e.heap[1]=e.heap[e.heap_len--];ie(e,i,1);a=e.heap[1];e.heap[--e.heap_max]=o;e.heap[--e.heap_max]=a;i[c*2]=i[o*2]+i[a*2];e.depth[c]=(e.depth[o]>=e.depth[a]?e.depth[o]:e.depth[a])+1;i[o*2+1]=i[a*2+1]=c;e.heap[1]=c++;ie(e,i,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1];J(e,t);X(i,l,e.bl_count)}function re(e,t,i){var s;var n=-1;var r;var o=t[0*2+1];var a=0;var l=7;var c=4;if(o===0){l=138;c=3}t[(i+1)*2+1]=65535;for(s=0;s<=i;s++){r=o;o=t[(s+1)*2+1];if(++a<l&&r===o){continue}else if(a<c){e.bl_tree[r*2]+=a}else if(r!==0){if(r!==n){e.bl_tree[r*2]++}e.bl_tree[S*2]++}else if(a<=10){e.bl_tree[x*2]++}else{e.bl_tree[I*2]++}a=0;n=r;if(o===0){l=138;c=3}else if(r===o){l=6;c=3}else{l=7;c=4}}}function oe(e,t,i){var s;var n=-1;var r;var o=t[0*2+1];var a=0;var l=7;var c=4;if(o===0){l=138;c=3}for(s=0;s<=i;s++){r=o;o=t[(s+1)*2+1];if(++a<l&&r===o){continue}else if(a<c){do{W(e,r,e.bl_tree)}while(--a!==0)}else if(r!==0){if(r!==n){W(e,r,e.bl_tree);a--}W(e,S,e.bl_tree);H(e,a-3,2)}else if(a<=10){W(e,x,e.bl_tree);H(e,a-3,3)}else{W(e,I,e.bl_tree);H(e,a-11,7)}a=0;n=r;if(o===0){l=138;c=3}else if(r===o){l=6;c=3}else{l=7;c=4}}}function ae(e){var t;re(e,e.dyn_ltree,e.l_desc.max_code);re(e,e.dyn_dtree,e.d_desc.max_code);ne(e,e.bl_desc);for(t=_-1;t>=3;t--){if(e.bl_tree[R[t]*2+1]!==0){break}}e.opt_len+=3*(t+1)+5+5+4;return t}function le(e,t,i,s){var n;H(e,t-257,5);H(e,i-1,5);H(e,s-4,4);for(n=0;n<s;n++){H(e,e.bl_tree[R[n]*2+1],3)}oe(e,e.dyn_ltree,t-1);oe(e,e.dyn_dtree,i-1)}function ce(e){var t=4093624447;var i;for(i=0;i<=31;i++,t>>>=1){if(t&1&&e.dyn_ltree[i*2]!==0){return r}}if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0){return o}for(i=32;i<m;i++){if(e.dyn_ltree[i*2]!==0){return o}}return r}var de=false;function ue(e){if(!de){K();de=true}e.l_desc=new F(e.dyn_ltree,z);e.d_desc=new F(e.dyn_dtree,B);e.bl_desc=new F(e.bl_tree,j);e.bi_buf=0;e.bi_valid=0;Y(e)}function he(e,t,i,s){H(e,(c<<1)+(s?1:0),3);ee(e,t,i,true)}function fe(e){H(e,d<<1,3);W(e,k,O);Z(e)}function pe(e,t,i,s){var r,o;var l=0;if(e.level>0){if(e.strm.data_type===a){e.strm.data_type=ce(e)}ne(e,e.l_desc);ne(e,e.d_desc);l=ae(e);r=e.opt_len+3+7>>>3;o=e.static_len+3+7>>>3;if(o<=r){r=o}}else{r=o=i+5}if(i+4<=r&&t!==-1){he(e,t,i,s)}else if(e.strategy===n||o===r){H(e,(d<<1)+(s?1:0),3);se(e,O,L)}else{H(e,(u<<1)+(s?1:0),3);le(e,e.l_desc.max_code+1,e.d_desc.max_code+1,l+1);se(e,e.dyn_ltree,e.dyn_dtree)}Y(e);if(s){G(e)}}function me(e,t,i){e.pending_buf[e.d_buf+e.last_lit*2]=t>>>8&255;e.pending_buf[e.d_buf+e.last_lit*2+1]=t&255;e.pending_buf[e.l_buf+e.last_lit]=i&255;e.last_lit++;if(t===0){e.dyn_ltree[i*2]++}else{e.matches++;t--;e.dyn_ltree[(D[i]+m+1)*2]++;e.dyn_dtree[q(t)*2]++}return e.last_lit===e.lit_bufsize-1}i._tr_init=ue;i._tr_stored_block=he;i._tr_flush_block=pe;i._tr_tally=me;i._tr_align=fe},{"../utils/common":28}],40:[function(e,t,i){"use strict";function s(){this.input=null;this.next_in=0;this.avail_in=0;this.total_in=0;this.output=null;this.next_out=0;this.avail_out=0;this.total_out=0;this.msg="";this.state=null;this.data_type=2;this.adler=0}t.exports=s},{}]},{},[10])(10)});!function(e){"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define("extensions/adapt-exportFeedback/library/docxtemplater/jszip-utils",e):"undefined"!=typeof window?window.JSZipUtils=e():"undefined"!=typeof global?global.JSZipUtils=e():"undefined"!=typeof self&&(self.JSZipUtils=e())}(function(){var e,t,i;return function s(e,t,i){function n(o,a){if(!t[o]){if(!e[o]){var l=typeof require=="function"&&require;if(!a&&l)return l(o,!0);if(r)return r(o,!0);throw new Error("Cannot find module '"+o+"'")}var c=t[o]={exports:{}};e[o][0].call(c.exports,function(t){var i=e[o][1][t];return n(i?i:t)},c,c.exports,s,e,t,i)}return t[o].exports}var r=typeof require=="function"&&require;for(var o=0;o<i.length;o++)n(i[o]);return n}({1:[function(e,t,i){"use strict";var s={};s._getBinaryFromXHR=function(e){return e.response||e.responseText};function n(){try{return new window.XMLHttpRequest}catch(e){}}function r(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}var o=window.ActiveXObject?function(){return n()||r()}:n;s.getBinaryContent=function(e,t){try{var i=o();i.open("GET",e,true);if("responseType"in i){i.responseType="arraybuffer"}if(i.overrideMimeType){i.overrideMimeType("text/plain; charset=x-user-defined")}i.onreadystatechange=function(n){var r,o;if(i.readyState===4){if(i.status===200||i.status===0){r=null;o=null;try{r=s._getBinaryFromXHR(i)}catch(a){o=new Error(a)}t(o,r)}else{t(new Error("Ajax error for "+e+" : "+this.status+" "+this.statusText),null)}}};i.send()}catch(n){t(new Error(n),null)}};t.exports=s},{}]},{},[1])(1)});var saveAs=saveAs||typeof navigator!=="undefined"&&navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob.bind(navigator)||function(e){"use strict";if(typeof navigator!=="undefined"&&/MSIE [1-9]\./.test(navigator.userAgent)){return}var t=e.document,i=function(){return e.URL||e.webkitURL||e},s=e.URL||e.webkitURL||e,n=t.createElementNS("http://www.w3.org/1999/xhtml","a"),r=!e.externalHost&&"download"in n,o=function(i){var s=t.createEvent("MouseEvents");s.initMouseEvent("click",true,false,e,0,0,0,0,0,false,false,false,false,0,null);i.dispatchEvent(s)},a=e.webkitRequestFileSystem,l=e.requestFileSystem||a||e.mozRequestFileSystem,c=function(t){(e.setImmediate||e.setTimeout)(function(){throw t},0)},d="application/octet-stream",u=0,h=[],f=function(){var e=h.length;while(e--){var t=h[e];if(typeof t==="string"){s.revokeObjectURL(t)}else{t.remove()}}h.length=0},p=function(e,t,i){t=[].concat(t);var s=t.length;while(s--){var n=e["on"+t[s]];if(typeof n==="function"){try{n.call(e,i||e)}catch(r){c(r)}}}},m=function(s,o){var c=this,f=s.type,m=false,g,v,_=function(){var e=i().createObjectURL(s);h.push(e);return e},b=function(){p(c,"writestart progress write writeend".split(" "))},w=function(){if(m||!g){g=_(s)}if(v){v.location.href=g}else{window.open(g,"_blank")}c.readyState=c.DONE;b()},y=function(e){return function(){if(c.readyState!==c.DONE){return e.apply(this,arguments)}}},C={create:true,exclusive:false},k;c.readyState=c.INIT;if(!o){o="download"}if(r){g=_(s);t=e.document;n=t.createElementNS("http://www.w3.org/1999/xhtml","a");n.href=g;n.download=o;var S=t.createEvent("MouseEvents");S.initMouseEvent("click",true,false,e,0,0,0,0,0,false,false,false,false,0,null);n.dispatchEvent(S);c.readyState=c.DONE;b();return}if(e.chrome&&f&&f!==d){k=s.slice||s.webkitSlice;s=k.call(s,0,s.size,d);m=true}if(a&&o!=="download"){o+=".download"}if(f===d||a){v=e}if(!l){w();return}u+=s.size;l(e.TEMPORARY,u,y(function(e){e.root.getDirectory("saved",C,y(function(e){var t=function(){e.getFile(o,C,y(function(e){e.createWriter(y(function(t){t.onwriteend=function(t){v.location.href=e.toURL();h.push(e);c.readyState=c.DONE;p(c,"writeend",t)};t.onerror=function(){var e=t.error;if(e.code!==e.ABORT_ERR){w()}};"writestart progress write abort".split(" ").forEach(function(e){t["on"+e]=c["on"+e]});t.write(s);c.abort=function(){t.abort();c.readyState=c.DONE};c.readyState=c.WRITING}),w)}),w)};e.getFile(o,{create:false},y(function(e){e.remove();t()}),y(function(e){if(e.code===e.NOT_FOUND_ERR){t()}else{w()}}))}),w)}),w)},g=m.prototype,v=function(e,t){return new m(e,t)};g.abort=function(){var e=this;e.readyState=e.DONE;p(e,"abort")};g.readyState=g.INIT=0;g.WRITING=1;g.DONE=2;g.error=g.onwritestart=g.onprogress=g.onwrite=g.onabort=g.onerror=g.onwriteend=null;e.addEventListener("unload",f,false);v.unload=function(){f();e.removeEventListener("unload",f,false)};return v}(typeof self!=="undefined"&&self||typeof window!=="undefined"&&window||this.content);if(typeof module!=="undefined")module.exports=saveAs;define("extensions/adapt-exportFeedback/library/docxtemplater/filesaver",function(){});define("extensions/adapt-exportFeedback/js/createDocument",["core/js/adapt","backbone","../library/docxtemplater/docxtemplater","../library/docxtemplater/jszip","../library/docxtemplater/jszip-utils","../library/docxtemplater/filesaver"],function(e,t,i,s,n,r){var o=t.View.extend({initialize:function(){var e=this.model.get("_exportFeedback")._documentContent.templatePath;this.loadFile(e,this.loadWordDocument)},loadFile:function(e,t){n.getBinaryContent(e,_.bind(t,this))},loadWordDocument:function(e,t){if(e){throw e}var n=new s(t);var r=(new i).loadZip(n);var o=this.model.get("_exportFeedback")._documentContent;var a={};a.content=o;var l=this;if(o.display=="selected"){var c=this.model.get("_items");var d=o.selectableItems[0];var u=_.pluck(this.model.get(d),"showFeedback");if(_.contains(u,true)){a.incorrectFeedbackText=l.model.get("inCorrectFeedbackDocumentText");a.incorrectFeedbackTextVisible=true;a.items=this.model.get(d);a.hasItems=true}else{a.feedbackText=l.model.get("correctFeedbackDocumentText");a.feedbackItemsText=l.model.get("correctFeedbackDocumentItemsText")}}else{a.items=this.model.get("_items")}a.textArea=this.model.get("_items")._textAreaText||[];r.setData(a);try{r.render()}catch(e){var h={message:e.message,name:e.name,stack:e.stack,properties:e.properties};console.log(JSON.stringify({error:h}));throw e}var f=r.getZip().generate({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"});var p=this.model.get("_exportFeedback").documentName?this.model.get("_exportFeedback").documentName:"documentName"+".docx";_.delay(saveAs(f,p),2e3)}});return o});define("extensions/adapt-exportFeedback/js/adapt-exportFeedback",["core/js/adapt","backbone","./createDocument"],function(e,t,i){var s;e.on("componentView:postRender",n);function n(e){var t=e.model;if(!t.has("_exportFeedback"))return;if(!t.get("_exportFeedback")._isEnabled)return;this.componentView=e.$el;this.listenTo(t,"change:_isComplete",r);this.listenTo(t,"questionView:showFeedback",r)}function r(e){var t=e.get("_exportFeedback")._documentContent;if(!e.get("_isEmailVisible")){var i=e.get("_exportFeedback");if(i._isEmail){var s=i._emailContent;var n="mailto:"+s.emailTo;n+="?cc="+s.emailCc;n+="&subject="+encodeURIComponent(s.emailSubject);if(s.emailSartText){s.emailBody=s.emailSartText+" "+s.emailBody}if(s.hasModelAsBody){s.emailBody+=a(e)}if(s.emailEndText){s.emailBody=s.emailBody+"\n"+s.emailEndText}if(s.emailBody){n+="&body="+encodeURIComponent(s.emailBody)}var r=$("<div/>");r.addClass("email");if(s.emailInstruction){var l=$("<div/>");l.addClass("email-instruction");l.html(s.emailInstruction);r.append(l)}var c=$("<img/>");c.addClass("email-button");c.attr("src",s.imgSrc);c.on("load",function(e){r.append(c);c.focus()});if(t.display=="selected"&&e.get("_numberOfCorrectAnswers")||e.get("_component")==="textinput"){var d=$("."+e.get("_id"));if(i.appendTo!==""){$body=$("body");_.delay(function(){var e=$body.find("."+i.appendTo);if(!$(e).find(".email").length)$(e).append(r)},500)}else{if(!$(d.find(".component-inner")).find(".email").length)$(d.find(".component-inner")).append(r)}c.on("click",function(t){t.preventDefault();if(i.useEmailAsDownload){o(e)}else if(i._isEmailContent){window.location.href=n}$(".notify-popup-done").removeClass("display-none")})}}if(i._isDocument&&!i.useEmailAsDownload){o(e)}}}function o(e){new i({model:e})}function a(e){var t=e.get("_exportFeedback");var i=t._emailContent;var s=i.emailBodyContent;var n="";if(s.componentText.length>0){_.each(s.componentText,function(t){n+=e.get(t)})}if(s.items){if(s.items.format=="list"){if(s.items.selectable.length>0){var r=e.get("_items");var o=0;_.each(r,function(e){_.each(s.items.selectable,function(t,i){if(e["_isSelected"]){o++;n+=e[t]}})})}}}return n}});define("extensions/adapt-nevigateBack/js/nevigateBackView",["require","coreJS/adapt","backbone"],function(e){var t=e("coreJS/adapt");var i=e("backbone");var s=i.View.extend({className:"navigateBack-container",initialize:function(){this.listenTo(t,"remove",this.remove);this.render()},events:{"click .navigateBackBtn":"nevigateBack"},onComplete:function(){this.$el.removeClass("display-none")},nevigateBack:function(e){var t=this.model.get("_nevigateBack")._nevigateTo;if(t!=""){i.history.navigate("#/id/"+t)}else{i.history.history.back()}},render:function(){var e=this.model.get("_nevigateBack");var t=Handlebars.templates["nevigateBack"];if(e._isEnabledOnCompleted){this.$el.addClass("display-none");this.listenTo(this.model,"change:_isComplete",this.onComplete)}this.$el.html(t(e));this.$el.css(e._style);return this}});return s});define("extensions/adapt-nevigateBack/js/adapt-nevigateBack",["require","coreJS/adapt","backbone","extensions/adapt-nevigateBack/js/nevigateBackView"],function(e){var t=e("coreJS/adapt");var i=e("backbone");var s=e("extensions/adapt-nevigateBack/js/nevigateBackView");function n(e){var t=e.model.get("_nevigateBack");if(t&&t._isEnabled){e.$el.append(new s({model:e.model}).$el)}}t.on("pageView:postRender",function(e){if(!t.course.get("_nevigateBack")||!t.course.get("_nevigateBack")._isEnabled){return}n(e)});t.on("articleView:postRender",function(e){if(!t.course.get("_nevigateBack")||!t.course.get("_nevigateBack")._isEnabled){return}n(e)});t.on("blockView:postRender",function(e){if(!t.course.get("_nevigateBack")||!t.course.get("_nevigateBack")._isEnabled){return}n(e)});t.on("componentView:postRender",function(e){if(!t.course.get("_nevigateBack")||!t.course.get("_nevigateBack")._isEnabled){return}n(e)})});(function(e){var t={url:false,callback:false,target:false,duration:120,on:"click",touch:true,onZoomIn:false,onZoomOut:false,magnify:1};e.zoom=function(t,i,s,n){var r,o,a,l,c,d,u,h=e(t),f=h.css("position"),p=e(i);t.style.position=/(absolute|fixed)/.test(f)?f:"relative";t.style.overflow="hidden";s.style.width=s.style.height="";e(s).addClass("zoomImg").css({position:"absolute",top:0,left:0,opacity:0,width:s.width*n,height:s.height*n,border:"none",maxWidth:"none",maxHeight:"none"}).appendTo(t);return{init:function(){o=h.outerWidth();r=h.outerHeight();if(i===t){l=o;a=r}else{l=p.outerWidth();a=p.outerHeight()}c=(s.width-o)/l;d=(s.height-r)/a;u=p.offset()},move:function(e){var t=e.pageX-u.left,i=e.pageY-u.top;i=Math.max(Math.min(i,a),0);t=Math.max(Math.min(t,l),0);s.style.left=t*-c+"px";s.style.top=i*-d+"px"}}};e.fn.zoom=function(i){return this.each(function(){var s=e.extend({},t,i||{}),n=s.target&&e(s.target)[0]||this,r=this,o=e(r),a=document.createElement("img"),l=e(a),c="mousemove.zoom",d=false,u=false;if(!s.url){var h=r.querySelector("img");if(h){s.url=h.getAttribute("data-src")||h.currentSrc||h.src}if(!s.url){return}}o.one("zoom.destroy",function(e,t){o.off(".zoom");n.style.position=e;n.style.overflow=t;a.onload=null;l.remove()}.bind(this,n.style.position,n.style.overflow));a.onload=function(){var t=e.zoom(n,r,a,s.magnify);function i(i){t.init();t.move(i);l.stop().fadeTo(e.support.opacity?s.duration:0,1,e.isFunction(s.onZoomIn)?s.onZoomIn.call(a):false)}function h(){l.stop().fadeTo(s.duration,0,e.isFunction(s.onZoomOut)?s.onZoomOut.call(a):false)}if(s.on==="grab"){o.on("mousedown.zoom",function(s){if(s.which===1){e(document).one("mouseup.zoom",function(){h();e(document).off(c,t.move)});i(s);e(document).on(c,t.move);s.preventDefault()}})}else if(s.on==="click"){o.on("click.zoom",function(s){if(d){return}else{d=true;i(s);e(document).on(c,t.move);e(document).one("click.zoom",function(){h();d=false;e(document).off(c,t.move)});return false}})}else if(s.on==="toggle"){o.on("click.zoom",function(e){if(d){h()}else{i(e)}d=!d})}else if(s.on==="mouseover"){t.init();o.on("mouseenter.zoom",i).on("mouseleave.zoom",h).on(c,t.move)}if(s.touch){o.on("touchstart.zoom",function(e){e.preventDefault();if(u){u=false;h()}else{u=true;i(e.originalEvent.touches[0]||e.originalEvent.changedTouches[0])}}).on("touchmove.zoom",function(e){e.preventDefault();t.move(e.originalEvent.touches[0]||e.originalEvent.changedTouches[0])}).on("touchend.zoom",function(e){e.preventDefault();if(u){u=false;h()}})}if(e.isFunction(s.callback)){s.callback.call(a)}};a.setAttribute("role","presentation");a.src=s.url})};e.fn.zoom.defaults=t})(window.jQuery);define("extensions/adapt-pinchZoomer/js/jquery.zoom",function(){});define("extensions/adapt-pinchZoomer/js/adapt-pinchZoomerContainerView",["backbone","coreJS/adapt","extensions/adapt-pinchZoomer/js/jquery.zoom"],function(e,t,i){var s=e.View.extend({className:"pinchZoomerContainer",events:{"click .pinchZoomer img":"activatePinchZoomer"},initialize:function(e){this.listenTo(t,"remove",this.remove);this.render();console.log("after render")},activatePinchZoomer:function(e){var t=$(e.currentTarget);t.find(".zoomImg").remove();var i=this.model.get("zoomGraphicSrc")||t.data("zoomimage");t.css("display","block").parent().zoom({url:i,on:"grab"})},postRender:function(){},render:function(){var e=this.model.toJSON();var t=Handlebars.templates["pinchZoomer"];this.$el.html(t(e));this.postRender();return this}});return s});define("extensions/adapt-pinchZoomer/js/adapt-pinchZoomer",["backbone","coreJS/adapt","./adapt-pinchZoomerContainerView"],function(e,t,i){function s(s){var n=s.model.get("_pinchZoomer")||{};if(n.isApplyOnPopup)return;if(n._isEnabled!==true)return;if(t.device.screenSize==="large"&&n._isDesktop===true){var r=new i({model:new e.Model(n)}).$el;var o=s.$el.find("."+(n.wrapTo||"component-widget"));o.wrap(r)}else if(t.device.screenSize==="small"||t.device.screenWidth<=768){var r=new i({model:new e.Model(n)}).$el;var o=s.$el.find("."+(n.wrapTo||"component-widget"));o.wrap(r)}}t.on("componentView:postRender",function(e){var i=t.course.get("_pinchZoomer");if(i&&i._isEnabled){s(e)}});t.on("popup:opened",function(t,s){if(s&&s._pinchZoomer&&s._pinchZoomer._isEnabled){if(!s._pinchZoomer.isApplyOnPopup)return;var n=new i({model:new e.Model(s)}).$el;t.find(".notify-popup-body").wrap(n)}})});define("extensions/adapt-textSourceContent/js/adapt-textSourceContent",["coreJS/adapt","backbone"],function(e,t){var i=0;function s(i){var s=t.View.extend({initialize:function(){var t=i.model;this.listenTo(e,"remove",this.remove,this);this.listenTo(e,"pageView:ready",this.onPageViewReady,this);if(t.get("_textSourceContent")){if(t.get("_textSourceContent")._isEnabled){this.listenTo(t,"change:_isComplete",this.showSourceText)}}},onPageViewReady:function(){if(this.model.get("_textSourceContent")){if(this.model.get("_textSourceContent")._isEnabled){this.setUpPage()}}},showSourceText:function(e){i.$el.find(".sourceText").removeClass("display-none")},setUpPage:function(){this.setUpBar()},setUpBar:function(){var e=this.model.toJSON();var t=this.model.get("_textSourceContent").insertAfter;var s=Handlebars.templates["textSourceContent"];if(t===undefined){t=".component-body"}$(s(e._textSourceContent)).insertAfter(i.$el.find(t))}});new s({model:i.model})}e.on("componentView:postRender",function(e){s(e)});e.on("blockView:postRender",function(e){s(e)})});define("core/js/views/menuView",["core/js/adapt","core/js/views/adaptView"],function(e,t){var i=t.extend({className:function(){var e="visibility-hidden";if(this.model.get("_isVisible")){e=""}return"menu "+"menu-"+this.model.get("_id")+" "+this.model.get("_classes")+" "+this.setVisibility()+" "+(this.model.get("_isComplete")?"completed":"")},preRender:function(){this.disableAnimation=e.config.has("_disableAnimation")?e.config.get("_disableAnimation"):false;this.$el.css("opacity",0);this.listenTo(this.model,"change:_isReady",this.isReady)},postRender:function(){},isReady:function(){if(this.model.get("_isReady")){_.defer(function(){$(".loading").hide();$(window).scrollTop(0);e.trigger("menuView:ready",this);var t={opacity:1};if(this.disableAnimation){this.$el.css(t);$.inview()}else{this.$el.velocity(t,{duration:"fast",complete:function(){$.inview()}})}$(window).scroll()}.bind(this))}}},{type:"menu"});return i});define("menu/adapt-contrib-boxMenu/js/adapt-contrib-boxmenu",["coreJS/adapt","coreViews/menuView"],function(e,t){var i=t.extend({postRender:function(){var e=0;this.$(".menu-container-inner").append('<div class="menu-item-wrapper"></div>');this.model.getChildren().each(function(t){if(t.get("_isAvailable")){e++;t.set("_nthChild",e);this.$(".menu-item-wrapper").append(new s({model:t}).$el)}})}},{template:"boxmenu"});var s=t.extend({events:{"click button":"onClickMenuItemButton"},className:function(){var e=this.model.get("_nthChild");return["menu-item","menu-item-"+this.model.get("_id"),this.model.get("_classes"),this.model.get("_isVisited")?"visited":"",this.model.get("_isComplete")?"completed":"",this.model.get("_isLocked")?"locked":"","nth-child-"+e,e%2===0?"nth-child-even":"nth-child-odd"].join(" ")},preRender:function(){this.model.checkCompletionStatus();this.model.checkInteractionCompletionStatus()},postRender:function(){var e=this.model.get("_graphic");if(e&&e.src&&e.src.length>0){this.$el.imageready(_.bind(function(){this.setReadyStatus()},this))}else{this.setReadyStatus()}},onClickMenuItemButton:function(e){if(e&&e.preventDefault)e.preventDefault();console.log("Event ",e.delegateTarget);if(this.model.get("_isLocked"))return;else Backbone.history.navigate("#/id/"+this.model.get("_id"),{trigger:true})}},{template:"boxmenu-item"});e.on("router:menu",function(e){$("#wrapper").append(new i({model:e}).$el)})});define("theme/adapt-contrib-vanilla/js/theme-block",["require","coreJS/adapt","backbone"],function(e){var t=e("coreJS/adapt");var i=e("backbone");var s=i.View.extend({initialize:function(){this.setStyles();this.listenTo(t,"device:resize",this.setStyles);this.listenTo(t,"remove",this.remove)},setStyles:function(){this.setBackground();this.setMinHeight();this.setDividerBlock()},setBackground:function(){var e=this.model.get("_themeBlockConfig")._backgroundColor;if(e){this.$el.addClass(e)}},setMinHeight:function(){var e=0;var i=this.model.get("_themeBlockConfig")._minimumHeights;if(i){if(t.device.screenSize=="large"){e=i._large}else if(t.device.screenSize=="medium"){e=i._medium}else{e=i._small}}this.$el.css({minHeight:e+"px"})},setDividerBlock:function(){var e=this.model.get("_themeBlockConfig")._isDividerBlock;if(e){this.$el.addClass("divider-block")}}});return s});define("theme/adapt-contrib-vanilla/js/vanilla",["require","coreJS/adapt","backbone","theme/adapt-contrib-vanilla/js/theme-block"],function(e){var t=e("coreJS/adapt");var i=e("backbone");var s=e("theme/adapt-contrib-vanilla/js/theme-block");t.on("blockView:postRender",function(e){var t=e.model.get("_theme");if(t){new s({model:new i.Model({_themeBlockConfig:t}),el:e.$el})}})});define("plugins",["components/adapt-animatedImages/js/adapt-animatedImages","components/adapt-balloonActivity/js/adapt-balloonActivity","components/adapt-clickAndLearn-horizontal/js/adapt-clickAndLearn-horizontal","components/adapt-contrib-accordion/js/adapt-contrib-accordion","components/adapt-contrib-analysis/js/adapt-contrib-analysis","components/adapt-contrib-assessmentResults/js/adapt-contrib-assessmentResults","components/adapt-contrib-blank/js/adapt-contrib-blank","components/adapt-contrib-clickAndLearn/js/adapt-contrib-clickAndLearn","components/adapt-contrib-flipcard/js/adapt-contrib-flipcard","components/adapt-contrib-gmcq/js/adapt-contrib-gmcq","components/adapt-contrib-graphic/js/adapt-contrib-graphic","components/adapt-contrib-hotgraphic/js/adapt-contrib-hotgraphic","components/adapt-contrib-matching/js/adapt-contrib-matching","components/adapt-contrib-mcq/js/adapt-contrib-mcq","components/adapt-contrib-media/js/adapt-contrib-media","components/adapt-contrib-narrative/js/adapt-contrib-narrative","components/adapt-contrib-objectMatching/js/adapt-contrib-objectMatching","components/adapt-contrib-reveal/js/adapt-contrib-reveal","components/adapt-contrib-slider/js/adapt-contrib-slider","components/adapt-contrib-text/js/adapt-contrib-text","components/adapt-contrib-textInput/js/adapt-contrib-textInput","components/adapt-expose/js/adapt-expose","components/adapt-graphicSlider/js/adapt-graphicSlider","components/adapt-likert/js/adapt-likert","components/adapt-multiColTextPlus/js/adapt-multiColTextPlus","components/adapt-multipleSelect-likert/js/adapt-multipleSelect-likert","components/adapt-multipleTextInput/js/adapt-multipleTextInput","components/adapt-objectMachingNumber/js/adapt-objectMachingNumber","components/adapt-questionSlider/js/adapt-questionSlider","components/adapt-questionSliderDropDown/js/adapt-questionSliderDropDown","components/adapt-sentenceOrdering/js/adapt-sentenceOrdering","components/adapt-stacklist/js/adapt-stacklist","components/adapt-tabs/js/adapt-tabs","components/adapt-textPlus/js/adapt-textPlus","extensions/adapt-certificate/js/adapt-certificate","extensions/adapt-contrib-assessment/js/adapt-assessmentArticleExtension","extensions/adapt-contrib-bookmarking/js/adapt-contrib-bookmarking","extensions/adapt-contrib-languagePicker/js/adapt-languagePicker","extensions/adapt-contrib-pageLevelProgress/js/adapt-contrib-pageLevelProgress","extensions/adapt-contrib-resources/js/adapt-contrib-resources","extensions/adapt-contrib-spoor/js/adapt-contrib-spoor","extensions/adapt-contrib-trickle/js/adapt-contrib-trickle","extensions/adapt-contrib-tutor/js/adapt-contrib-tutor","extensions/adapt-exportFeedback/js/adapt-exportFeedback","extensions/adapt-nevigateBack/js/adapt-nevigateBack","extensions/adapt-pinchZoomer/js/adapt-pinchZoomer","extensions/adapt-textSourceContent/js/adapt-textSourceContent","menu/adapt-contrib-boxMenu/js/adapt-contrib-boxmenu","theme/adapt-contrib-vanilla/js/vanilla"],function(){});require(["core/js/adapt","core/js/adaptCollection","core/js/startController","core/js/models/buildModel","core/js/models/articleModel","core/js/models/blockModel","core/js/models/configModel","core/js/models/contentObjectModel","core/js/models/componentModel","core/js/models/courseModel","core/js/models/questionModel","core/js/views/navigationView","core/js/accessibility","core/js/offlineStorage","core/js/logging","core/js/tracking","core/js/device","core/js/drawer","core/js/notify","core/js/popupManager","core/js/router","core/js/models/lockingModel","core/js/helpers","plugins"],function(e,t,i,s,n,r,o,a,l,c,d,u){window.Handlebars=_.extend(require("handlebars"),window.Handlebars);var h=Handlebars.templates["loading"];$("#wrapper").append(h());e.build=new s(null,{url:"adapt/js/build.min.js",reset:true});e.checkDataIsLoaded=function(t){if(e.contentObjects.models.length>0&&e.articles.models.length>0&&e.blocks.models.length>0&&e.components.models.length>0&&e.course.get("_id")){g();v();e.log.debug("Firing app:dataLoaded");try{e.trigger("app:dataLoaded")}catch(i){e.log.error("Error during app:dataLoading trigger",i)}e.setupMapping();e.wait.queue(function(){f(t)})}};function f(t){if(t){e.trigger("app:languageChanged",t);_.defer(function(){var e=new i;var t="#/";if(e.isEnabled()){t=e.getStartHash(true)}Backbone.history.navigate(t,{trigger:true,replace:true})})}e.log.debug("Firing app:dataReady");try{e.trigger("app:dataReady")}catch(s){e.log.error("Error during app:dataReady trigger",s)}e.wait.queue(p)}function p(){e.log.debug("Calling Adapt.initialize");m();e.initialize();e.off("adaptCollection:dataLoaded courseModel:dataLoaded")}function m(){var t=e.course.get("_navigation");if(t&&t._isDefaultNavigationDisabled){e.trigger("navigation:initialize");return}e.navigation=new u}function g(){var t=e.config.get("_inview");var i=t&&t._allowScrollOver===false?false:true;$.inview.config({allowScrollOver:i})}function v(){e.contentObjects._byAdaptID=e.contentObjects.groupBy("_id");e.articles._byAdaptID=e.articles.groupBy("_id");e.blocks._byAdaptID=e.blocks.groupBy("_id");e.components._byAdaptID=e.components.groupBy("_id")}e.loadCourseData=function(i){e.on("adaptCollection:dataLoaded courseModel:dataLoaded",function(){e.checkDataIsLoaded(i)});var s=e.config.get("_activeLanguage");var o=e.build.get("jsonext");var u="course/"+s+"/";$("html").attr("lang",s);e.course=new c(null,{url:u+"course."+o,reset:true});e.contentObjects=new t(null,{model:a,url:u+"contentObjects."+o});e.articles=new t(null,{model:n,url:u+"articles."+o});e.blocks=new t(null,{model:r,url:u+"blocks."+o});e.components=new t(null,{model:function(t){var i=e.componentStore[t._component];if(!i){throw new Error(t._component+" component not found. Is it installed and included?")}if(i.model){return new i.model(t)}var s=i.view||i;if(s._isQuestionType){return new d(t)}return new l(t)},url:u+"components."+o})};function b(t,i){e.offlineStorage.set("lang",i);e.loadCourseData(i)}function w(e,t){if(t==="rtl"){$("html").removeClass("dir-ltr").addClass("dir-rtl").attr("dir","rtl")}else{$("html").removeClass("dir-rtl").addClass("dir-ltr").attr("dir","ltr")}}function y(){if(e.config.get("_activeLanguage")){e.loadCourseData()}else{e.config.set("_activeLanguage",e.config.get("_defaultLanguage"))}}function C(){e.config=new o(null,{url:"course/config."+e.build.get("jsonext"),reset:true});e.config.on({"change:_activeLanguage":b,"change:_defaultDirection":w});e.once("configModel:loadCourseData",y)}e.once("buildModel:dataLoaded",C)});define("core/js/app",function(){});